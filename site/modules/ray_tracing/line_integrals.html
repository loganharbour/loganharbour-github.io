<!DOCTYPE html><head><meta charset="UTF-8"><title>line_integrals.md|MOOSE Ray Tracing Module</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="/modules/ray_tracing" class="left moose-logo hide-on-med-and-down">MOOSE Ray Tracing Module</a><a href="https://github.com/idaholab/moose" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="c95dbbd3-947e-47bc-888e-c5aadb369a30"><i class="material-icons">menu</i></a><ul class="sidenav" id="c95dbbd3-947e-47bc-888e-c5aadb369a30"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/modules/ray_tracing" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">modules</span><a href="." class="breadcrumb">ray_tracing</a><a href="#" class="breadcrumb">line_integrals</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="ca81f753-a11b-4cf0-9ce1-be262322f4a8" data-section-level="1" data-section-text="Computing Line Integrals"><h1 id="computing-line-integrals">Computing Line Integrals</h1><p>The <a href="index.html">Ray Tracing Module</a> can be utilized to integrate fields along a line throughout the domain. Example fields include <a href="../../syntax/Variables/index.html">Variables</a>, <a href="../../syntax/AuxVariables/index.html">AuxVariables</a>, <a href="../../syntax/Materials/index.html">Material properties</a>, and <a href="../../syntax/Functions/index.html">Functions</a>.</p><p>The discussion that follows will describe how to integrate a variable across a line in a simple diffusion problem. To integrate other fields, the process remains is the same except for the definition of the RayKernel.</p><section class="scrollspy" id="949335e8-6201-47e9-bdf7-fd85ba26a665" data-section-level="2" data-section-text="Problem Definition"><h2 id="problem-definition">Problem Definition</h2><p>We begin with the standard &quot;simple diffusion&quot; problem:</p><pre class="moose-pre"><code class="language-text">[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 5
    ny = 5
    xmax = 5
    ymax = 5
  []
[]

[Variables/u]
[]

[Kernels/diff]
  type = Diffusion
  variable = u
[]

[BCs]
  [left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  []
  [right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  []
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]
</code></pre><a href="#dce435f0-baa5-4980-a065-6a65e31dd73f" class="modal-trigger">(modules/ray_tracing/test/tests/ray_kernels/variable_integral_ray_kernel/simple_diffusion_line_integral.i)</a><div class="modal moose-modal" id="dce435f0-baa5-4980-a065-6a65e31dd73f"><div class="modal-content"><h4>/Users/harblh/projects/moc/private_moose/modules/ray_tracing/test/tests/ray_kernels/variable_integral_ray_kernel/simple_diffusion_line_integral.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 5
    ny = 5
    xmax = 5
    ymax = 5
  []
[]

[Variables/u]
[]

[Kernels/diff]
  type = Diffusion
  variable = u
[]

[BCs]
  [left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  []
  [right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  []
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = false
  csv = true
[]

[UserObjects/study]
  type = RepeatableRayStudy
  names = &#x27;diag
           right_up&#x27;
  start_points = &#x27;0 0 0
                  5 0 0&#x27;
  end_points = &#x27;5 5 0
                5 5 0&#x27;
  execute_on = TIMESTEP_END
[]

[RayKernels/u_integral]
  type = VariableIntegralRayKernel
  variable = u
  rays = &#x27;diag right_up&#x27;
[]

[Postprocessors]
  [diag_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = diag
  []
  [right_up_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = right_up
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p>For this problem, we seek the value of the integral</p><span class="moose-katex-block-equation"><span tex="\int_L u_h~dr, \quad L = \{\vec{r}_1 + t\vec{r}_2 \mid t \in [0, 1]\}" bookmark="moose-equation-feef3b88-dae2-4208-8aaa-ceb03f3cc02f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-feef3b88-dae2-4208-8aaa-ceb03f3cc02f"></span><script>var element = document.getElementById("moose-equation-feef3b88-dae2-4208-8aaa-ceb03f3cc02f");katex.render("\\int_L u_h~dr, \\quad L = \\{\\vec{r}_1 + t\\vec{r}_2 \\mid t \\in [0, 1]\\}", element, {displayMode:true,throwOnError:false});</script></span><p>for the lines defined by</p><span class="moose-katex-block-equation"><span tex="\vec{r}_1 = (0, 0)\,, \quad \vec{r}_1 = (5, 5)" bookmark="moose-equation-eed850b8-19a8-4f84-9cde-37d379a37ce3" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-eed850b8-19a8-4f84-9cde-37d379a37ce3"></span><script>var element = document.getElementById("moose-equation-eed850b8-19a8-4f84-9cde-37d379a37ce3");katex.render("\\vec{r}_1 = (0, 0)\\,, \\quad \\vec{r}_1 = (5, 5)", element, {displayMode:true,throwOnError:false});</script></span><p>and</p><span class="moose-katex-block-equation"><span tex="\vec{r}_1 = (5, 0)\,, \quad \vec{r}_1 = (5, 5)" bookmark="moose-equation-36f77ee6-e873-474e-8cf0-046d5b2f7480" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-36f77ee6-e873-474e-8cf0-046d5b2f7480"></span><script>var element = document.getElementById("moose-equation-36f77ee6-e873-474e-8cf0-046d5b2f7480");katex.render("\\vec{r}_1 = (5, 0)\\,, \\quad \\vec{r}_1 = (5, 5)", element, {displayMode:true,throwOnError:false});</script></span><p>For simplicity, we will denote the lines as <code>diag</code> and <code>right_up</code>, respectively.</p></section><section class="scrollspy" id="dcf97ff2-fa46-47b0-92d0-836047bdb6b9" data-section-level="2" data-section-text="Defining the Study"><h2 id="defining-the-study">Defining the Study</h2><p>A <a href="../../source/userobjects/RepeatableRayStudy.html">RepeatableRayStudy</a> is defined that generates and executes the rays that compute the variable line integral:</p><pre class="moose-pre"><code class="language-text">[UserObjects/study]
  type = RepeatableRayStudy
  names = &#x27;diag
           right_up&#x27;
  start_points = &#x27;0 0 0
                  5 0 0&#x27;
  end_points = &#x27;5 5 0
                5 5 0&#x27;
  execute_on = TIMESTEP_END
[]
</code></pre><a href="#d75afe9f-c86e-40e6-a68c-5b301c9fd882" class="modal-trigger">(modules/ray_tracing/test/tests/ray_kernels/variable_integral_ray_kernel/simple_diffusion_line_integral.i)</a><div class="modal moose-modal" id="d75afe9f-c86e-40e6-a68c-5b301c9fd882"><div class="modal-content"><h4>/Users/harblh/projects/moc/private_moose/modules/ray_tracing/test/tests/ray_kernels/variable_integral_ray_kernel/simple_diffusion_line_integral.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 5
    ny = 5
    xmax = 5
    ymax = 5
  []
[]

[Variables/u]
[]

[Kernels/diff]
  type = Diffusion
  variable = u
[]

[BCs]
  [left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  []
  [right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  []
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = false
  csv = true
[]

[UserObjects/study]
  type = RepeatableRayStudy
  names = &#x27;diag
           right_up&#x27;
  start_points = &#x27;0 0 0
                  5 0 0&#x27;
  end_points = &#x27;5 5 0
                5 5 0&#x27;
  execute_on = TIMESTEP_END
[]

[RayKernels/u_integral]
  type = VariableIntegralRayKernel
  variable = u
  rays = &#x27;diag right_up&#x27;
[]

[Postprocessors]
  [diag_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = diag
  []
  [right_up_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = right_up
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p>The <code>study</code> object defines two rays to be exectued on <code>TIMESTEP_END</code>:</p><ul class="browser-default"><li><p><code>diag</code> from <span tex="(0, 0)" bookmark="moose-equation-dcabbb9d-68d5-43b8-aac9-398ef6e768c2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-dcabbb9d-68d5-43b8-aac9-398ef6e768c2"><script>var element = document.getElementById("moose-equation-dcabbb9d-68d5-43b8-aac9-398ef6e768c2");katex.render("(0, 0)", element, {displayMode:false,throwOnError:false});</script></span> to <span tex="(5, 5)" bookmark="moose-equation-aa0d5756-b1ec-46db-a341-2af7fb4718b0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-aa0d5756-b1ec-46db-a341-2af7fb4718b0"><script>var element = document.getElementById("moose-equation-aa0d5756-b1ec-46db-a341-2af7fb4718b0");katex.render("(5, 5)", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p><code>right_up</code> from <span tex="(5, 0)" bookmark="moose-equation-e3e7a287-0e7c-4172-b573-03ba89ba57cb" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e3e7a287-0e7c-4172-b573-03ba89ba57cb"><script>var element = document.getElementById("moose-equation-e3e7a287-0e7c-4172-b573-03ba89ba57cb");katex.render("(5, 0)", element, {displayMode:false,throwOnError:false});</script></span> to <span tex="(5, 5)" bookmark="moose-equation-3f269cb6-74d9-45db-9731-239c5c1ef03b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3f269cb6-74d9-45db-9731-239c5c1ef03b"><script>var element = document.getElementById("moose-equation-3f269cb6-74d9-45db-9731-239c5c1ef03b");katex.render("(5, 5)", element, {displayMode:false,throwOnError:false});</script></span></p></li></ul></section><section class="scrollspy" id="283dc5c4-1067-4007-82ae-e6d8808c3d4b" data-section-level="2" data-section-text="Defining the RayKernel"><h2 id="defining-the-raykernel">Defining the RayKernel</h2><p><a href="../../syntax/RayKernels/index.html">RayKernels</a> are objects that are executed on the segments of the rays. In this case, we wish to compute the integral of a variable so we will define a <a href="../../source/ray_kernels/VariableIntegralRayKernel.html">VariableIntegralRayKernel</a>:</p><pre class="moose-pre"><code class="language-text">[RayKernels/u_integral]
  type = VariableIntegralRayKernel
  variable = u
  rays = &#x27;diag right_up&#x27;
[]
</code></pre><a href="#a6979b2b-3e7a-4165-aea8-6a3db8a7807c" class="modal-trigger">(modules/ray_tracing/test/tests/ray_kernels/variable_integral_ray_kernel/simple_diffusion_line_integral.i)</a><div class="modal moose-modal" id="a6979b2b-3e7a-4165-aea8-6a3db8a7807c"><div class="modal-content"><h4>/Users/harblh/projects/moc/private_moose/modules/ray_tracing/test/tests/ray_kernels/variable_integral_ray_kernel/simple_diffusion_line_integral.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 5
    ny = 5
    xmax = 5
    ymax = 5
  []
[]

[Variables/u]
[]

[Kernels/diff]
  type = Diffusion
  variable = u
[]

[BCs]
  [left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  []
  [right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  []
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = false
  csv = true
[]

[UserObjects/study]
  type = RepeatableRayStudy
  names = &#x27;diag
           right_up&#x27;
  start_points = &#x27;0 0 0
                  5 0 0&#x27;
  end_points = &#x27;5 5 0
                5 5 0&#x27;
  execute_on = TIMESTEP_END
[]

[RayKernels/u_integral]
  type = VariableIntegralRayKernel
  variable = u
  rays = &#x27;diag right_up&#x27;
[]

[Postprocessors]
  [diag_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = diag
  []
  [right_up_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = right_up
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p>The <code>u_integral</code> <a href="../../source/ray_kernels/VariableIntegralRayKernel.html">VariableIntegralRayKernel</a> will accumulate the variable line integral of the <code>u</code> Variable for our defined rays, <code>diag</code> and <code>right_up</code>.</p><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>Other commonly used <a href="../../source/ray_kernels/IntegralRayKernel.html">IntegralRayKernels</a> are the <a href="../../source/ray_kernels/FunctionIntegralRayKernel.html">FunctionIntegralRayKernel</a> and the <a href="../../source/ray_kernels/MaterialIntegralRayKernel.html">MaterialIntegralRayKernel</a>.</p></p></div></div></div></section><section class="scrollspy" id="54d3ab1c-b62e-4c25-80c6-4bc3e0d9b283" data-section-level="2" data-section-text="Outputting the Integrals"><h2 id="outputting-the-integrals">Outputting the Integrals</h2><p>Lastly, we need to obtain the accumulated integrals from the <code>study</code>. We will utilize a <code>RayIntegralValue</code> <a href="../../syntax/Postprocessors/index.html">Postprocessor</a> to achieve this:</p><pre class="moose-pre"><code class="language-text">[Postprocessors]
  [diag_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = diag
  []
  [right_up_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = right_up
  []
[]
</code></pre><a href="#8102f873-4d57-4c85-97f0-21149a7af8d4" class="modal-trigger">(modules/ray_tracing/test/tests/ray_kernels/variable_integral_ray_kernel/simple_diffusion_line_integral.i)</a><div class="modal moose-modal" id="8102f873-4d57-4c85-97f0-21149a7af8d4"><div class="modal-content"><h4>/Users/harblh/projects/moc/private_moose/modules/ray_tracing/test/tests/ray_kernels/variable_integral_ray_kernel/simple_diffusion_line_integral.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 5
    ny = 5
    xmax = 5
    ymax = 5
  []
[]

[Variables/u]
[]

[Kernels/diff]
  type = Diffusion
  variable = u
[]

[BCs]
  [left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  []
  [right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  []
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = false
  csv = true
[]

[UserObjects/study]
  type = RepeatableRayStudy
  names = &#x27;diag
           right_up&#x27;
  start_points = &#x27;0 0 0
                  5 0 0&#x27;
  end_points = &#x27;5 5 0
                5 5 0&#x27;
  execute_on = TIMESTEP_END
[]

[RayKernels/u_integral]
  type = VariableIntegralRayKernel
  variable = u
  rays = &#x27;diag right_up&#x27;
[]

[Postprocessors]
  [diag_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = diag
  []
  [right_up_line_integral]
    type = RayIntegralValue
    ray_kernel = u_integral
    ray = right_up
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p>The accumulated integrals are seen in output:</p><pre class="moose-pre"><code class="language-text">
Postprocessor Values:
+----------------+--------------------+------------------------+
| time           | diag_line_integral | right_up_line_integral |
+----------------+--------------------+------------------------+
|   0.000000e+00 |       0.000000e+00 |           0.000000e+00 |
|   1.000000e+00 |       3.535534e+00 |           5.000000e+00 |
+----------------+--------------------+------------------------+
</code></pre></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#949335e8-6201-47e9-bdf7-fd85ba26a665" class="tooltipped" data-position="left" data-tooltip="Problem Definition">Problem Definition</a></li><li><a href="#dcf97ff2-fa46-47b0-92d0-836047bdb6b9" class="tooltipped" data-position="left" data-tooltip="Defining the Study">Defining the Study</a></li><li><a href="#283dc5c4-1067-4007-82ae-e6d8808c3d4b" class="tooltipped" data-position="left" data-tooltip="Defining the RayKernel">Defining the RayKernel</a></li><li><a href="#54d3ab1c-b62e-4c25-80c6-4bc3e0d9b283" class="tooltipped" data-position="left" data-tooltip="Outputting the Integrals">Outputting the Integrals</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>