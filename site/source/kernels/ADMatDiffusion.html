<!DOCTYPE html><head><meta charset="UTF-8"><title>ADMatDiffusion.md|MOOSE Ray Tracing Module</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="/modules/ray_tracing" class="left moose-logo hide-on-med-and-down">MOOSE Ray Tracing Module</a><a href="https://github.com/idaholab/moose" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="5b466f23-f82d-4b4c-a052-7953f7a1a136"><i class="material-icons">menu</i></a><ul class="sidenav" id="5b466f23-f82d-4b4c-a052-7953f7a1a136"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/modules/ray_tracing" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">kernels</span><a href="#" class="breadcrumb">ADMatDiffusion</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="8bdc7869-9f68-4757-99b6-15a36c24949c" data-section-level="1" data-section-text="ADMatDiffusion"><h1 id="admatdiffusion">ADMatDiffusion</h1><section class="scrollspy" id="4b097fe4-9dc1-4a24-bbbb-96ee19d8974d" data-section-level="2" data-section-text="Description"><h2 id="description">Description</h2><p><code>ADMatDiffusion</code> implements the term <span class="moose-katex-block-equation"><span tex="\nabla\cdot D(a,b,\dots) \nabla u," bookmark="moose-equation-762a2373-4cf9-454d-853b-743c726c9eb6" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-762a2373-4cf9-454d-853b-743c726c9eb6"></span><script>var element = document.getElementById("moose-equation-762a2373-4cf9-454d-853b-743c726c9eb6");katex.render("\\nabla\\cdot D(a,b,\\dots) \\nabla u,", element, {displayMode:true,throwOnError:false});</script></span> where the diffusion coefficient <span tex="D" bookmark="moose-equation-d92973ef-0674-418b-8c08-9491cce40ed9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d92973ef-0674-418b-8c08-9491cce40ed9"><script>var element = document.getElementById("moose-equation-d92973ef-0674-418b-8c08-9491cce40ed9");katex.render("D", element, {displayMode:false,throwOnError:false});</script></span> (<code>diffusivity</code>) is provided by a <code>Material</code> or <code>ADMaterial</code> and <span tex="u" bookmark="moose-equation-2d3a7606-dfdb-4ee2-a48f-25725c0757ec" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2d3a7606-dfdb-4ee2-a48f-25725c0757ec"><script>var element = document.getElementById("moose-equation-2d3a7606-dfdb-4ee2-a48f-25725c0757ec");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span> is the non-linear variable the kernel is operating on.  </p><p>This kernel can be used in a coupled form if the optional <code>v</code> variable is specified. This allows applying the diffusion operator to a variable <span tex="u" bookmark="moose-equation-313239b5-4d1c-4446-965c-9ad95afc2d20" recursive="True" class="moose-katex-inline-equation" id="moose-equation-313239b5-4d1c-4446-965c-9ad95afc2d20"><script>var element = document.getElementById("moose-equation-313239b5-4d1c-4446-965c-9ad95afc2d20");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span> given by <code>v</code>, which is different from the kernel variable.</p><p><span tex="D" bookmark="moose-equation-8f01e9a1-c476-4f49-996b-b051defc465a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8f01e9a1-c476-4f49-996b-b051defc465a"><script>var element = document.getElementById("moose-equation-8f01e9a1-c476-4f49-996b-b051defc465a");katex.render("D", element, {displayMode:false,throwOnError:false});</script></span> can depend on arbitrary non-linear variables <span tex="a,b,\dots" bookmark="moose-equation-565cc612-b215-47ef-9386-146b21d365f8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-565cc612-b215-47ef-9386-146b21d365f8"><script>var element = document.getElementById("moose-equation-565cc612-b215-47ef-9386-146b21d365f8");katex.render("a,b,\\dots", element, {displayMode:false,throwOnError:false});</script></span>. The complete Jacobian contributions are provided by automatic differentiation as long as <span tex="D" bookmark="moose-equation-4e7bc7b4-a549-431e-9083-eb30e3479d48" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4e7bc7b4-a549-431e-9083-eb30e3479d48"><script>var element = document.getElementById("moose-equation-4e7bc7b4-a549-431e-9083-eb30e3479d48");katex.render("D", element, {displayMode:false,throwOnError:false});</script></span> is given using an <code>ADMaterial</code> derived object.</p></section><section class="scrollspy" id="750f7862-6b36-4e9a-a280-9cb12180ea0b" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="f2f8eff0-33b5-4a4b-b286-fa81eb40fefd" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">variable</span><span class="moose-parameter-header-description">The name of the variable that this Kernel operates on</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>NonlinearVariableName</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The name of the variable that this Kernel operates on</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="c4ffcaa6-c732-4f79-a133-0deb78d685d3" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">block</span><span class="moose-parameter-header-description">The list of block ids (SubdomainID) that this object will be applied</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<SubdomainName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The list of block ids (SubdomainID) that this object will be applied</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">diffusivity</span><span class="moose-parameter-header-default">D</span><span class="moose-parameter-header-description">The diffusivity value or material property</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>D</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The diffusivity value or material property</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">displacements</span><span class="moose-parameter-header-description">The displacements</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<VariableName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The displacements</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">v</span><span class="moose-parameter-header-description">Coupled concentration variable for kernel to operate on; if this is not specified, the kernel's nonlinear variable will be used as usual</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<VariableName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Coupled concentration variable for kernel to operate on; if this is not specified, the kernel's nonlinear variable will be used as usual</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="6ef5e007-dff3-44d9-87b9-f49dc626dc29" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<std::string></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">diag_save_in</span><span class="moose-parameter-header-description">The name of auxiliary variables to save this Kernel's diagonal Jacobian contributions to. Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<AuxVariableName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The name of auxiliary variables to save this Kernel's diagonal Jacobian contributions to. Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">implicit</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Determines whether this object is calculated using an implicit or explicit form</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Determines whether this object is calculated using an implicit or explicit form</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">save_in</span><span class="moose-parameter-header-description">The name of auxiliary variables to save this Kernel's residual contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<AuxVariableName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The name of auxiliary variables to save this Kernel's residual contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">seed</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The seed for the master random number generator</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The seed for the master random number generator</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_displaced_mesh</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Whether or not this object should use the displaced mesh for computation. Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Whether or not this object should use the displaced mesh for computation. Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section><section id="52b2c2d2-fd68-4c39-95e3-15e911051fe8" data-section-level="3" data-section-text="Tagging Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">extra_matrix_tags</span><span class="moose-parameter-header-description">The extra tags for the matrices this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<TagName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The extra tags for the matrices this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">extra_vector_tags</span><span class="moose-parameter-header-description">The extra tags for the vectors this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<TagName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The extra tags for the vectors this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">matrix_tags</span><span class="moose-parameter-header-default">system</span><span class="moose-parameter-header-description">The tag for the matrices this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>system</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>nontime system</p><p class="moose-parameter-description"><span>Description:</span>The tag for the matrices this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">vector_tags</span><span class="moose-parameter-header-default">nontime</span><span class="moose-parameter-header-description">The tag for the vectors this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>nontime</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>nontime time</p><p class="moose-parameter-description"><span>Description:</span>The tag for the vectors this Kernel should fill</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Tagging Parameters</h3></summary></details></section></section><section class="scrollspy" id="fd509839-983c-4b1d-8206-442ea4ddee6a" data-section-level="2" data-section-text="Input Files"><h2 id="input-files">Input Files</h2><ul class="moose-list-inputs browser-default"><li><a href="#2b24c082-dfad-481a-991e-784ef9f46313" class="modal-trigger">test/tests/materials/derivative_material_interface/ad_derivative_parsed_material.i</a></li><li><a href="#51f5042a-83f6-438d-bb00-d6f23d4cd1d0" class="modal-trigger">modules/combined/test/tests/exception/ad.i</a></li><li><a href="#db4ec8bc-1761-4077-a3ff-8f93fabda206" class="modal-trigger">modules/xfem/test/tests/moving_interface/ad_phase_transition.i</a></li><li><a href="#65d06b78-c1d0-435a-9a4f-8e83f2f6193f" class="modal-trigger">test/tests/materials/derivative_material_interface/ad_bad_evaluation.i</a></li><li><a href="#3b9cfe5f-8fa7-4fcf-8a1a-b247e9e32240" class="modal-trigger">modules/stochastic_tools/examples/parameter_study/diffusion.i</a></li><li><a href="#d892a8c7-9c49-49f6-9bb6-7b52ee357c58" class="modal-trigger">test/tests/materials/ad_material/ad_global_index_mapping.i</a></li><li><a href="#19d4b55d-386b-4c7b-a805-df3e52197698" class="modal-trigger">test/tests/materials/derivative_material_interface/ad_parsed_material.i</a></li><li><a href="#8083cf96-4bb6-43d3-bbe8-7b541f7db4a6" class="modal-trigger">modules/xfem/test/tests/moving_interface/moving_ad_diffusion.i</a></li><li><a href="#88beccb5-46d5-4041-ac05-bef5085020e2" class="modal-trigger">test/tests/kernels/ad_mat_diffusion/ad_1D_transient.i</a></li><li><a href="#cac6727f-97bb-46a8-8708-de60bb4b6d10" class="modal-trigger">modules/stochastic_tools/examples/sobol/diffusion.i</a></li><li><a href="#6dc0b2c4-1fd9-4431-9c3d-601add54373b" class="modal-trigger">test/tests/kernels/ad_mat_diffusion/ad_2d_steady_state.i</a></li></ul><div class="modal moose-modal" id="2b24c082-dfad-481a-991e-784ef9f46313"><div class="modal-content"><h4>test/tests/materials/derivative_material_interface/ad_derivative_parsed_material.i</h4><pre class="moose-pre"><code class="language-text">#
# Test the AD version of derivative parsed material
#

[Mesh]
  type = GeneratedMesh
  dim = 2
[]

[Variables]
  [./eta]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = x
    [../]
  [../]
[]

[Kernels]
  [./diff]
    type = ADMatDiffusion
    variable = eta
    diffusivity = F
  []
  [./dt]
    type = TimeDerivative
    variable = eta
  []
[]

[Materials]
  [./Fbar]
    type = ADDerivativeParsedMaterial
    args  = &#x27;eta&#x27;
    f_name = Fbar
    function =&#x27;1/3*(eta-0.5)^3&#x27;
  []
  [./F]
    type = ADParsedMaterial
    args  = &#x27;eta&#x27;
    material_property_names = &#x27;F:=D[Fbar,eta]&#x27;
    function =&#x27;F&#x27;
    outputs = exodus
  []
[]

[Executioner]
  type = Transient
  num_steps = 1
  dt = 0.1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="51f5042a-83f6-438d-bb00-d6f23d4cd1d0"><div class="modal-content"><h4>modules/combined/test/tests/exception/ad.i</h4><pre class="moose-pre"><code class="language-text">[GlobalParams]
  order = SECOND
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Problem]
  coord_type = RZ
[]

[Mesh]
  patch_update_strategy = iteration
  [./gen]
    type = FileMeshGenerator
    file = mesh.e
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./temp]
    initial_condition = 501
  [../]
[]

[AuxVariables]
  [./density_aux]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[Modules/TensorMechanics/Master]
  [./finite]
    strain = FINITE
    use_automatic_differentiation = true
  [../]
[]

[Kernels]
  [./gravity]
    type = ADGravity
    variable = disp_y
    value = -9.81
  [../]
  [./heat]
    type = ADMatDiffusion
    variable = temp
    diffusivity = 1
  [../]
  [./heat_ie]
    type = ADTimeDerivative
    variable = temp
  [../]
[]

[AuxKernels]
  [./conductance]
    type = ADMaterialRealAux
    property = density
    variable = density_aux
    boundary = inner_surface
  [../]
[]

[ThermalContact]
  [./thermal_contact]
    type = GapHeatTransfer
    variable = temp
    primary = outer_interior
    secondary = inner_surface
    emissivity_primary = 0
    emissivity_secondary = 0
    quadrature = true
  [../]
[]

[BCs]
  [./no_x]
    type = ADDirichletBC
    variable = disp_x
    boundary = &#x27;centerline&#x27;
    value = 0.0
  [../]
  [./no_y]
    type = ADDirichletBC
    variable = disp_y
    boundary = &#x27;centerline outer_exterior&#x27;
    value = 0.0
  [../]
  [./temp]
    type = FunctionDirichletBC
    boundary = outer_exterior
    variable = temp
    function = &#x27;500 + t&#x27;
  [../]
[]

[Materials]
  [./density]
    type = ADGenericConstantMaterial
    prop_names = &#x27;density&#x27;
    prop_values = &#x27;1&#x27;
  [../]

  [./elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 1e11
    poissons_ratio = 0.3
  [../]

  [./inner_elastic_stress]
    type = ADComputeMultipleInelasticStress
    inelastic_models = &#x27;inner_creep&#x27;
    block = inner
    outputs = all
  [../]

  [./inner_creep]
    type = ADPowerLawCreepExceptionTest
    coefficient = 10e-22
    n_exponent = 2
    activation_energy = 0
    block = inner
  [../]

  [./outer_stressstress]
    type = ADComputeFiniteStrainElasticStress
    block = outer
  [../]
[]

[Executioner]
  type = Transient
  petsc_options = &#x27; -snes_converged_reason -ksp_converged_reason&#x27;
  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
  line_search = none

  nl_abs_tol = 1e-7
  l_max_its = 20

  num_steps = 1
  dt = 1
  dtmin = .1
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="db4ec8bc-1761-4077-a3ff-8f93fabda206"><div class="modal-content"><h4>modules/xfem/test/tests/moving_interface/ad_phase_transition.i</h4><pre class="moose-pre"><code class="language-text">[GlobalParams]
  order = FIRST
  family = LAGRANGE
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 11
  ny = 1
  xmin = 0
  xmax = 2
  ymin = 0
  ymax = 1
  elem_type = QUAD4
[]

[XFEM]
  qrule = volfrac
  output_cut_plane = true
[]

[UserObjects]
  [./velocity]
    type = XFEMPhaseTransitionMovingInterfaceVelocity
    diffusivity_at_positive_level_set = 5
    diffusivity_at_negative_level_set = 1
    equilibrium_concentration_jump = 1
    value_at_interface_uo = value_uo
  [../]
  [./value_uo]
    type = PointValueAtXFEMInterface
    variable = &#x27;u&#x27;
    geometric_cut_userobject = &#x27;moving_line_segments&#x27;
    execute_on = &#x27;nonlinear&#x27;
    level_set_var = ls
  [../]
  [./moving_line_segments]
    type = MovingLineSegmentCutSetUserObject
    cut_data = &#x27;0.5 0 0.5 1.0 0 0&#x27;
    heal_always = true
    interface_velocity = velocity
  [../]
[]

[Variables]
  [./u]
  [../]
[]

[ICs]
  [./ic_u]
    type = FunctionIC
    variable = u
    function = &#x27;if(x&lt;0.51, 2, 1)&#x27;
  [../]
[]

[AuxVariables]
  [./ls]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Constraints]
  [./u_constraint]
    type = XFEMEqualValueAtInterface
    geometric_cut_userobject = &#x27;moving_line_segments&#x27;
    use_displaced_mesh = false
    variable = u
    value = 2
    alpha = 1e5
  [../]
[]

[Kernels]
  [./diff]
    type = ADMatDiffusion
    variable = u
    diffusivity = diffusion_coefficient
  [../]
  [./time]
    type = ADTimeDerivative
    variable = u
  [../]
[]

[AuxKernels]
  [./ls]
    type = LineSegmentLevelSetAux
    line_segment_cut_set_user_object = &#x27;moving_line_segments&#x27;
    variable = ls
  [../]
[]

[Materials]
  [./diffusivity_A]
    type = ADGenericConstantMaterial
    prop_names = A_diffusion_coefficient
    prop_values = 5
  [../]
  [./diffusivity_B]
    type = ADGenericConstantMaterial
    prop_names = B_diffusion_coefficient
    prop_values = 1
  [../]
  [./diff_combined]
    type = ADLevelSetBiMaterialReal
    levelset_positive_base = &#x27;A&#x27;
    levelset_negative_base = &#x27;B&#x27;
    level_set_var = ls
    prop_name = diffusion_coefficient
  [../]
[]

[BCs]
  [./left_u]
    type = ADDirichletBC
    variable = u
    value = 2
    boundary = 3
  [../]
  [./right_u]
    type = ADNeumannBC
    variable = u
    boundary = 1
    value = 0
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
  line_search = &#x27;none&#x27;

  l_tol = 1e-8
  nl_max_its = 15
  nl_rel_tol = 1e-11
  nl_abs_tol = 1e-12

  start_time = 0.0
  dt = 0.01
  dtmin = 0.01
  num_steps = 4
  max_xfem_update = 1
[]


[Outputs]
  execute_on = timestep_end
  exodus = true
  perf_graph = true
  file_base = phase_transition_out
  [./console]
    type = Console
    output_linear = true
  [../]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="65d06b78-c1d0-435a-9a4f-8e83f2f6193f"><div class="modal-content"><h4>test/tests/materials/derivative_material_interface/ad_bad_evaluation.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 1
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = ADMatDiffusion
    variable = u
    diffusivity = F
  [../]
[]

[Materials]
  [./time_no_ad]
    type = GenericFunctionMaterial
    prop_names = &#x27;time_no_ad&#x27;
    prop_values = &#x27;t&#x27;
    outputs = all
  [../]
  [./time]
    type = MaterialConverter
    reg_props_in = time_no_ad
    ad_props_out = time
  [../]

  [./F]
    type = ADDerivativeParsedMaterial
    f_name = F
    material_property_names = &#x27;time&#x27;
    function = &#x27;if (time &lt; 1.9, 1, log(-1))&#x27;
    disable_fpoptimizer = true
    evalerror_behavior = nan
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 2
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3b9cfe5f-8fa7-4fcf-8a1a-b247e9e32240"><div class="modal-content"><h4>modules/stochastic_tools/examples/parameter_study/diffusion.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables/T]
[]

[Kernels]
  [time]
    type = ADTimeDerivative
    variable = T
  []
  [diff]
    type = ADMatDiffusion
    variable = T
    diffusivity = diffusivity
  []
  [source]
    type = ADBodyForce
    variable = T
    value = 1
    function = 1
  []
[]

[BCs]
  [left]
    type = ADDirichletBC
    variable = T
    boundary = left
    value = -10
  []
  [right]
    type = ADNeumannBC
    variable = T
    boundary = right
    value = -100
  []
[]

[Materials/constant]
  type = ADGenericConstantMaterial
  prop_names = &#x27;diffusivity&#x27;
  prop_values = 1
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  num_steps = 4
  dt = 0.25
[]

[Postprocessors]
  [T_avg]
    type = AverageNodalVariableValue
    variable = T
  []
  [q_left]
    type = ADSideFluxAverage
    variable = T
    boundary = left
    diffusivity = diffusivity
  []
[]

[Controls/stochastic]
  type = SamplerReceiver
[]

[Outputs]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d892a8c7-9c49-49f6-9bb6-7b52ee357c58"><div class="modal-content"><h4>test/tests/materials/ad_material/ad_global_index_mapping.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 2
  second_order = true
[]

[Variables]
  [u]
    initial_condition = 1
  []
  [v]
    initial_condition = 1
    order = SECOND
  []
[]

[Kernels]
  [u_diff]
    type = ADMatDiffusion
    variable = u
    diffusivity = diffusivity
  []
  [v_diff]
    type = ADMatDiffusion
    variable = v
    diffusivity = diffusivity
  []
[]

[BCs]
  [left_u]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  []
  [right_u]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  []
  [left_v]
    type = DirichletBC
    variable = v
    boundary = left
    value = 1
  []
  [right_v]
    type = DirichletBC
    variable = v
    boundary = right
    value = 0
  []
[]

[Materials]
  [ad_coupled_mat]
    type = ADCheckGlobalToDerivativeMap
    u = u
    v = v
    mat_prop = diffusivity
  []
[]

[Executioner]
  type = Steady
  solve_type = &#x27;Newton&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="19d4b55d-386b-4c7b-a805-df3e52197698"><div class="modal-content"><h4>test/tests/materials/derivative_material_interface/ad_parsed_material.i</h4><pre class="moose-pre"><code class="language-text">#
# Test the parsed function free enery Allen-Cahn Bulk kernel
#

[Mesh]
  type = GeneratedMesh
  dim = 2
[]

[Variables]
  [./eta]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = x
    [../]
  [../]
[]

[Kernels]
  [./diff]
    type = ADMatDiffusion
    variable = eta
    diffusivity = F
  [../]
  [./dt]
    type = TimeDerivative
    variable = eta
  [../]
[]

[Materials]
  [./consts]
    type = ADParsedMaterial
    args  = &#x27;eta&#x27;
    function =&#x27;(eta-0.5)^2&#x27;
    outputs = exodus
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 1
  dt = 0.1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8083cf96-4bb6-43d3-bbe8-7b541f7db4a6"><div class="modal-content"><h4>modules/xfem/test/tests/moving_interface/moving_ad_diffusion.i</h4><pre class="moose-pre"><code class="language-text">[GlobalParams]
  order = FIRST
  family = LAGRANGE
[]

[XFEM]
  qrule = volfrac
  output_cut_plane = true
[]

[UserObjects]
  [./level_set_cut_uo]
    type = LevelSetCutUserObject
    level_set_var = ls
    heal_always = true
  [../]
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 5
  ny = 3
  xmin = 0.0
  xmax = 1
  ymin = 0.0
  ymax = 1
  elem_type = QUAD4
[]

[AuxVariables]
  [./ls]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxKernels]
  [./ls_function]
    type = FunctionAux
    variable = ls
    function = ls_func
  [../]
[]

[Variables]
  [./u]
  [../]
[]

[Functions]
  [./ls_func]
    type = ParsedFunction
    value = &#x27;x-0.76+0.21*t&#x27;
  [../]
[]

[Kernels]
  [./diff]
    type = ADMatDiffusion
    variable = u
    diffusivity = diffusion_coefficient
  [../]
  [./time_deriv]
    type = ADTimeDerivative
    variable = u
  [../]
[]

[Constraints]
  [./u_constraint]
    type = XFEMSingleVariableConstraint
    use_displaced_mesh = false
    variable = u
    jump = 0
    use_penalty = true
    alpha = 1e5
    geometric_cut_userobject = &#x27;level_set_cut_uo&#x27;
  [../]
[]

[BCs]
  [./right_u]
    type = ADDirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./left_u]
    type = ADDirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Materials]
  [./diffusivity_A]
    type = ADGenericConstantMaterial
    prop_names = A_diffusion_coefficient
    prop_values = 5
  [../]

  [./diffusivity_B]
    type = ADGenericConstantMaterial
    prop_names = B_diffusion_coefficient
    prop_values = 0.5
  [../]

  [./diff_combined]
    type = ADLevelSetBiMaterialReal
    levelset_positive_base = &#x27;A&#x27;
    levelset_negative_base = &#x27;B&#x27;
    level_set_var = ls
    prop_name = diffusion_coefficient
  [../]
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-ksp_gmres_restart -pc_type -pc_hypre_type -pc_hypre_boomeramg_max_iter&#x27;
  petsc_options_value = &#x27;201                hypre    boomeramg      8&#x27;

  l_max_its = 20
  l_tol = 1e-8
  nl_max_its = 15
  nl_rel_tol = 1e-12
  nl_abs_tol = 1e-50

  start_time = 0.0
  dt = 1
  end_time = 2

  max_xfem_update = 1
[]

[Outputs]
  exodus = true
  execute_on = timestep_end
  csv = true
  file_base = moving_diffusion_out
  perf_graph = true
  [./console]
    type = Console
    output_linear = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="88beccb5-46d5-4041-ac05-bef5085020e2"><div class="modal-content"><h4>test/tests/kernels/ad_mat_diffusion/ad_1D_transient.i</h4><pre class="moose-pre"><code class="language-text"># This test solves a 1D transient heat equation
# The error is caclulated by comparing to the analytical solution
# The problem setup and analytical solution are taken from &quot;Advanced Engineering
# Mathematics, 10th edition&quot; by Erwin Kreyszig.
# http://www.amazon.com/Advanced-Engineering-Mathematics-Erwin-Kreyszig/dp/0470458364
# It is Example 1 in section 12.6 on page 561

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 160
  xmax = 80
[]

[Variables]
  [./T]
  [../]
[]

[ICs]
  [./T_IC]
    type = FunctionIC
    variable = T
    function = &#x27;100*sin(pi*x/80)&#x27;
  [../]
[]

[Kernels]
  [./diff]
    type = ADMatDiffusion
    variable = T
    diffusivity = diffusivity
  [../]
  [./dt]
    type = CoefTimeDerivative
    variable = T
    Coefficient = 0.82064
  [../]
[]

[BCs]
  [./sides]
    type = DirichletBC
    variable = T
    boundary = &#x27;left right&#x27;
    value = 0
  [../]
[]

[Materials]
  [./k]
    type = ADGenericConstantMaterial
    prop_names = &#x27;diffusivity&#x27;
    prop_values = &#x27;0.95&#x27;
  [../]
[]

[Executioner]
  type = Transient
  dt = 1e-2
  end_time = 1
[]

[Postprocessors]
  [./error]
    type = NodalL2Error
    function = &#x27;100*sin(pi*x/80)*exp(-0.95/(0.092*8.92)*pi^2/80^2*t)&#x27;
    variable = T
    outputs = console
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="cac6727f-97bb-46a8-8708-de60bb4b6d10"><div class="modal-content"><h4>modules/stochastic_tools/examples/sobol/diffusion.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables/T]
[]

[Kernels]
  [time]
    type = ADTimeDerivative
    variable = T
  []
  [diff]
    type = ADMatDiffusion
    variable = T
    diffusivity = diffusivity
  []
  [source]
    type = ADBodyForce
    variable = T
    value = 1
    function = 1
  []
[]

[BCs]
  [left]
    type = ADDirichletBC
    variable = T
    boundary = left
    value = -10
  []
  [right]
    type = ADNeumannBC
    variable = T
    boundary = right
    value = -100
  []
[]

[Materials/constant]
  type = ADGenericConstantMaterial
  prop_names = &#x27;diffusivity&#x27;
  prop_values = 1
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  num_steps = 4
  dt = 0.25
[]

[Postprocessors]
  [T_avg]
    type = AverageNodalVariableValue
    variable = T
  []
  [q_left]
    type = ADSideFluxAverage
    variable = T
    boundary = left
    diffusivity = diffusivity
  []
[]

[Controls/stochastic]
  type = SamplerReceiver
[]

[Outputs]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6dc0b2c4-1fd9-4431-9c3d-601add54373b"><div class="modal-content"><h4>test/tests/kernels/ad_mat_diffusion/ad_2d_steady_state.i</h4><pre class="moose-pre"><code class="language-text"># This test solves a 2D steady state heat equation
# The error is found by comparing to the analytical solution

# Note that the thermal conductivity, specific heat, and density in this problem
# Are set to 1, and need to be changed to the constants of the material being
# Analyzed

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 30
  ny = 30
  xmax = 2
  ymax = 2
[]

[Variables]
  [./T]
  [../]
[]

[Kernels]
  [./HeatDiff]
    type = ADMatDiffusion
    variable = T
    diffusivity = diffusivity
  [../]
[]

[BCs]
  [./zero]
    type = DirichletBC
    variable = T
    boundary = &#x27;left right bottom&#x27;
    value = 0
  [../]
  [./top]
    type = ADFunctionDirichletBC
    variable = T
    boundary = top
    function = &#x27;10*sin(pi*x*0.5)&#x27;
  [../]
[]

[Materials]
  [./k]
    type = ADGenericConstantMaterial
    prop_names = diffusivity
    prop_values = 1
  [../]
[]


[Postprocessors]
  [./nodal_error]
    type = NodalL2Error
    function = &#x27;10/(sinh(pi))*sin(pi*x*0.5)*sinh(pi*y*0.5)&#x27;
    variable = T
    outputs = console
  [../]
  [./elemental_error]
    type = ElementL2Error
    function = &#x27;10/(sinh(pi))*sin(pi*x*0.5)*sinh(pi*y*0.5)&#x27;
    variable = T
    outputs = console
  [../]
[]

[Executioner]
  type = Steady
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section><section class="scrollspy" id="f992d306-32fa-4731-aebb-2556855c81da" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol></ol></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#4b097fe4-9dc1-4a24-bbbb-96ee19d8974d" class="tooltipped" data-position="left" data-tooltip="Description">Description</a></li><li><a href="#750f7862-6b36-4e9a-a280-9cb12180ea0b" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#fd509839-983c-4b1d-8206-442ea4ddee6a" class="tooltipped" data-position="left" data-tooltip="Input Files">Input Files</a></li><li><a href="#f992d306-32fa-4731-aebb-2556855c81da" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>