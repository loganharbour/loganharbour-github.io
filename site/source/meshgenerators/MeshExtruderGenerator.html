<!DOCTYPE html><head><meta charset="UTF-8"><title>MeshExtruderGenerator.md|MOOSE Ray Tracing Module</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="/modules/ray_tracing" class="left moose-logo hide-on-med-and-down">MOOSE Ray Tracing Module</a><a href="https://github.com/idaholab/moose" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="daf7bbff-c30b-46c1-9365-989dd792af4c"><i class="material-icons">menu</i></a><ul class="sidenav" id="daf7bbff-c30b-46c1-9365-989dd792af4c"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/modules/ray_tracing" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">meshgenerators</span><a href="#" class="breadcrumb">MeshExtruderGenerator</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="b00b76be-f6d8-4527-a8ef-2b95939d1168" data-section-level="1" data-section-text="MeshExtruderGenerator"><h1 id="meshextrudergenerator">MeshExtruderGenerator</h1><p>Takes a 1D or 2D mesh and extrudes the entire structure along the specified axis increasing the dimensionality of the mesh.</p><section class="scrollspy" id="2a99b126-a6ea-4f4f-9e06-907fc7316283" data-section-level="2" data-section-text="Overview"><h2 id="overview">Overview</h2><p>The mesh extruder generator is a tool for increasing the dimensionality of a lower dimension mesh (1D or 2D). Each element is converted to one or more copies of its corresponding higher dimensional element along the specified axis. The Mesh Extruder can also add in the extra sidesets resulting from increasing the dimensionality of the original mesh. Existing sidesets are extruded.</p></section><section class="scrollspy" id="849de3a8-dce8-4dff-8a42-dd43513c9231" data-section-level="2" data-section-text="Visual Example"><h2 id="visual-example">Visual Example</h2><section id="2177b421-276c-47cd-911a-2df68295f2f9" data-section-level="3" data-section-text="Input 2 D Mesh"><h3 id="input-2-d-mesh">Input 2D Mesh</h3><div class="card moose-float" style="width:500px;"><div class="card-content"><img src="../../media/framework/mesh_modifiers/quad4.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-text">2D mesh consisting of a ring of QUAD4 elements.</span></p></div></div></section><section id="40479fe6-2e3e-4208-8f18-70faa4e19382" data-section-level="3" data-section-text="Output of MeshExtruderGenerator"><h3 id="output-of-meshextrudergenerator">Output of MeshExtruderGenerator</h3><div class="card moose-float"><div class="card-content"><img src="../../media/framework/mesh_modifiers/extrude_angle.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-text">Resulting mesh after extrusion along the vector (1, 1, 0).</span></p></div></div></section></section><section class="scrollspy" id="c7d385d2-3b97-4beb-a2ce-1a8b615ec2f9" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="418ce6ff-fec4-43a1-aca8-5463aa2ba38f" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">extrusion_vector</span><span class="moose-parameter-header-description">The direction and length of the extrusion</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>libMesh::VectorValue<double></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The direction and length of the extrusion</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">input</span><span class="moose-parameter-header-description">the mesh we want to extrude</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MeshGeneratorName</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>the mesh we want to extrude</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="926833b8-3dc4-4458-b462-9cfdb865abd0" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">bottom_sideset</span><span class="moose-parameter-header-description">The boundary that will be applied to the bottom of the extruded mesh</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<BoundaryName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The boundary that will be applied to the bottom of the extruded mesh</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">existing_subdomains</span><span class="moose-parameter-header-description">The subdomains that will be remapped for specific layers</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<unsigned short></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The subdomains that will be remapped for specific layers</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">layers</span><span class="moose-parameter-header-description">The layers where the "existing_subdomain" will be remapped to new ids</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<unsigned int></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The layers where the "existing_subdomain" will be remapped to new ids</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">new_ids</span><span class="moose-parameter-header-description">The list of new ids, This list should be either length "existing_subdomains" or "existing_subdomains" * layers</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<unsigned int></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The list of new ids, This list should be either length "existing_subdomains" or "existing_subdomains" * layers</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">num_layers</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">The number of layers in the extruded mesh</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The number of layers in the extruded mesh</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">top_sideset</span><span class="moose-parameter-header-description">The boundary that will be to the top of the extruded mesh</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<BoundaryName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The boundary that will be to the top of the extruded mesh</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="55b62d5f-1596-4532-85e7-73eb7c59c7a2" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<std::string></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section></section><section class="scrollspy" id="c1e6c98a-91db-42a0-9fd5-3f7259f02d37" data-section-level="2" data-section-text="Input Files"><h2 id="input-files">Input Files</h2><ul class="moose-list-inputs browser-default"><li><a href="#a59a0a6e-63ac-49d9-86d6-da3c3b814bdd" class="modal-trigger">modules/porous_flow/examples/tutorial/03.i</a></li><li><a href="#8f723934-af43-49fb-8eb0-35f52e41004b" class="modal-trigger">modules/porous_flow/examples/tutorial/06_KT.i</a></li><li><a href="#307a7bbb-5551-435c-866f-27d19fa9587f" class="modal-trigger">modules/combined/examples/stochastic/graphite_ring_thermomechanics.i</a></li><li><a href="#7cf04026-777e-44ac-96a9-a4760001a461" class="modal-trigger">modules/porous_flow/examples/tutorial/00.i</a></li><li><a href="#6ee690a9-eb74-4c55-8f42-43c810cb7b80" class="modal-trigger">test/tests/meshgenerators/mesh_extruder_generator/extrude_remap_layer1.i</a></li><li><a href="#e5ba51f9-5d15-406c-8845-46fbeb5512a8" class="modal-trigger">modules/porous_flow/test/tests/thm_rehbinder/free_outer.i</a></li><li><a href="#ec9a3fed-b4ab-4f0f-9ddd-f66d66fbaa6d" class="modal-trigger">modules/porous_flow/examples/tutorial/05_tabulated.i</a></li><li><a href="#3ed83451-63f5-4f09-b6a3-9ce636d4dbc8" class="modal-trigger">modules/porous_flow/examples/tutorial/10.i</a></li><li><a href="#e8add1fe-b25f-435b-a42f-f54ee75c17b8" class="modal-trigger">modules/porous_flow/examples/tutorial/07.i</a></li><li><a href="#956b23c7-3d4f-4641-a10e-1ce290ea0d58" class="modal-trigger">test/tests/meshgenerators/mesh_extruder_generator/extrude_quad.i</a></li><li><a href="#2c2b2172-a1c9-462a-9c92-c824f6c46445" class="modal-trigger">modules/porous_flow/examples/tutorial/05.i</a></li><li><a href="#fe8df40e-6c42-4283-b225-593b31de08b1" class="modal-trigger">modules/porous_flow/examples/tutorial/08.i</a></li><li><a href="#c6e36a91-2470-454e-b4a7-5bd0784539b9" class="modal-trigger">modules/porous_flow/examples/tutorial/08_KT.i</a></li><li><a href="#459ef608-5dea-419d-816a-99bc69c12b6e" class="modal-trigger">modules/porous_flow/examples/tutorial/01.i</a></li><li><a href="#3b1e9224-bdd6-4d31-ab1d-4cdc9ee7c0db" class="modal-trigger">test/tests/meshgenerators/mesh_extruder_generator/extrude_angle.i</a></li><li><a href="#ac46bb85-3ca0-4ae9-a754-d78754eaa783" class="modal-trigger">modules/porous_flow/test/tests/thm_rehbinder/fixed_outer.i</a></li><li><a href="#1cd45849-d08c-4868-bebc-a67fa82a451a" class="modal-trigger">modules/porous_flow/examples/tutorial/04.i</a></li><li><a href="#d22611ce-e84f-43ff-97a8-3908a9b3ce65" class="modal-trigger">test/tests/mesh/mesh_only/mesh_only.i</a></li><li><a href="#f6fabc1e-4ca4-4fa0-9123-ef8d2cf39571" class="modal-trigger">modules/porous_flow/examples/tutorial/11.i</a></li><li><a href="#b8e2975f-5226-442a-8997-17b93d937cb7" class="modal-trigger">modules/tensor_mechanics/tutorials/basics/part_3_1.i</a></li><li><a href="#38a1b470-e578-42f9-954e-2dc4fae8bed2" class="modal-trigger">modules/porous_flow/examples/tutorial/06.i</a></li><li><a href="#77860353-17a2-4ad3-9606-5f8607984fea" class="modal-trigger">test/tests/meshgenerators/mesh_extruder_generator/extrude_remap_layer2.i</a></li><li><a href="#7aed2ef0-b28c-4a18-a412-e40d93cb3a49" class="modal-trigger">test/tests/meshgenerators/mesh_extruder_generator/gen_extrude.i</a></li></ul><div class="modal moose-modal" id="a59a0a6e-63ac-49d9-86d6-da3c3b814bdd"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/03.i</h4><pre class="moose-pre"><code class="language-text"># Darcy flow with heat advection and conduction
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
    input = annular
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
  [../]
  [./temperature]
    initial_condition = 293
    scaling = 1E-8
  [../]
[]

[PorousFlowBasicTHM]
  porepressure = porepressure
  temperature = temperature
  coupling_type = ThermoHydro
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = injection_area
  [../]
  [./constant_injection_temperature]
    type = DirichletBC
    variable = temperature
    value = 313
    boundary = injection_area
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0E-3
      density0 = 1000.0
      thermal_expansion = 0.0002
      cp = 4194
      cv = 4186
      porepressure_coefficient = 0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.8
    solid_bulk_compliance = 2E-7
    fluid_bulk_modulus = 1E7
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]

  [./thermal_expansion]
    type = PorousFlowConstantThermalExpansionCoefficient
    biot_coefficient = 0.8
    drained_coefficient = 0.003
    fluid_coefficient = 0.0002
  [../]
  [./rock_internal_energy]
    type = PorousFlowMatrixInternalEnergy
    density = 2500.0
    specific_heat_capacity = 1200.0
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;10 0 0  0 10 0  0 0 10&#x27;
    block = &#x27;caps aquifer&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_abs_tol = 1E-10
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8f723934-af43-49fb-8eb0-35f52e41004b"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/06_KT.i</h4><pre class="moose-pre"><code class="language-text"># Darcy flow with a tracer
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
    input = annular
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer_concentration]
  [../]
[]

[ICs]
  [./tracer_concentration]
    type = FunctionIC
    function = &#x27;0.5*if(x*x+y*y&lt;1.01,1,0)&#x27;
    variable = tracer_concentration
  [../]
[]

[PorousFlowFullySaturated]
  porepressure = porepressure
  coupling_type = Hydro
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  mass_fraction_vars = tracer_concentration
  stabilization = KT
  flux_limiter_type = superbee
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = injection_area
  [../]
  [./constant_outer_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = rmax
  [../]
  [./injected_tracer]
    type = DirichletBC
    variable = tracer_concentration
    value = 0.5
    boundary = injection_area
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0E-3
      density0 = 1000.0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_rel_tol = 1E-14
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="307a7bbb-5551-435c-866f-27d19fa9587f"><div class="modal-content"><h4>modules/combined/examples/stochastic/graphite_ring_thermomechanics.i</h4><pre class="moose-pre"><code class="language-text"># Generate 1/4 of a 2-ring disk and extrude it by half to obtain
# 1/8 of a 3D tube.  Mirror boundary conditions will exist on the
# cut portions.

[Mesh]
  [disk]
    type = ConcentricCircleMeshGenerator
    num_sectors = 10
    radii = &#x27;1.0 1.1 1.2&#x27;
    rings = &#x27;1 1 1&#x27;
    has_outer_square = false
    preserve_volumes = false
    portion = top_right
  []
  [ring]
    type = BlockDeletionGenerator
    input = disk
    block_id = 1
    new_boundary = &#x27;inner&#x27;
  []
  [cylinder]
    type = MeshExtruderGenerator
    input = ring
    extrusion_vector = &#x27;0 0 1.5&#x27;
    num_layers = 15
    bottom_sideset = &#x27;back&#x27;
    top_sideset = &#x27;front&#x27;
  []
[]

[Variables]
  [T]
    initial_condition = 300
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[Kernels]
  [hc]
    type = HeatConduction
    variable = T
  []
  [TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  []
[]

[BCs]
  [temp_inner]
    type = FunctionNeumannBC
    variable = T
    boundary = &#x27;inner&#x27;
    function = surface_source
  []
  [temp_front]
    type = ConvectiveHeatFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    T_infinity = 300
    heat_transfer_coefficient = 10
  []
  [temp_outer]
    type = ConvectiveHeatFluxBC
    variable = T
    boundary = &#x27;outer&#x27;
    T_infinity = 300
    heat_transfer_coefficient = 10
  []
  # mirror boundary conditions.
  [disp_x]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;left&#x27;
    value = 0.0
  []
  [disp_y]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;bottom&#x27;
    value = 0.0
  []
  [disp_z]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0.0
  []
[]

[Materials]
  [cond_inner]
    type = GenericConstantMaterial
    block = 2
    prop_names = thermal_conductivity
    prop_values = 25
  []
  [cond_outer]
    type = GenericConstantMaterial
    block = 3
    prop_names = thermal_conductivity
    prop_values = 100
  []
  [elasticity_tensor_inner]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
    block = 2
  []
  [elasticity_tensor_outer]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 3.1e5
    poissons_ratio = 0.2
    block = 3
  []
  [thermal_strain_inner]
    type = ComputeThermalExpansionEigenstrain
    thermal_expansion_coeff = 2e-6
    temperature = T
    stress_free_temperature = 300
    eigenstrain_name = eigenstrain_inner
    block = 2
  []
  [thermal_strain_outer]
    type = ComputeThermalExpansionEigenstrain
    thermal_expansion_coeff = 1e-6
    temperature = T
    stress_free_temperature = 300
    eigenstrain_name = eigenstrain_outer
    block = 3
  []
  [strain_inner] #We use small deformation mechanics
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    eigenstrain_names = &#x27;eigenstrain_inner&#x27;
    block = 2
  []
  [strain_outer] #We use small deformation mechanics
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    eigenstrain_names = &#x27;eigenstrain_outer&#x27;
    block = 3
  []
  [stress] #We use linear elasticity
    type = ComputeLinearElasticStress
  []
[]

[Functions]
  [surface_source]
    type = ParsedFunction
    value = &#x27;Q_t*pi/2.0/3.0 * cos(pi/3.0*z)&#x27;
    vars = &#x27;Q_t&#x27;
    vals = heat_source
  []
[]

[Executioner]
  type = Steady

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;hypre boomeramg 101&#x27;

  l_max_its = 30
  nl_max_its = 100
  nl_abs_tol = 1e-9
  l_tol = 1e-04
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
  []
[]

[Controls]
  [stochastic]
    type = SamplerReceiver
  []
[]

[VectorPostprocessors]
  [temp_center]
    type = LineValueSampler
    variable = T
    start_point = &#x27;1 0 0&#x27;
    end_point = &#x27;1.2 0 0&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [temp_end]
    type = LineValueSampler
    variable = T
    start_point = &#x27;1 0 1.5&#x27;
    end_point = &#x27;1.2 0 1.5&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [dispx_center]
    type = LineValueSampler
    variable = disp_x
    start_point = &#x27;1 0 0&#x27;
    end_point = &#x27;1.2 0 0&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [dispx_end]
    type = LineValueSampler
    variable = disp_x
    start_point = &#x27;1 0 1.5&#x27;
    end_point = &#x27;1.2 0 1.5&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [dispz_end]
    type = LineValueSampler
    variable = disp_z
    start_point = &#x27;1 0 1.5&#x27;
    end_point = &#x27;1.2 0 1.5&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
[]

[Postprocessors]
  [heat_source]
    type = FunctionValuePostprocessor
    function = 1
    scale_factor = 10000
    execute_on = linear
  []
  [temp_center_inner]
    type = PointValue
    variable = T
    point = &#x27;1 0 0&#x27;
  []
  [temp_center_outer]
    type = PointValue
    variable = T
    point = &#x27;1.2 0 0&#x27;
  []
  [temp_end_inner]
    type = PointValue
    variable = T
    point = &#x27;1 0 1.5&#x27;
  []
  [temp_end_outer]
    type = PointValue
    variable = T
    point = &#x27;1.2 0 1.5&#x27;
  []
  [dispx_center_inner]
    type = PointValue
    variable = disp_x
    point = &#x27;1 0 0&#x27;
  []
  [dispx_center_outer]
    type = PointValue
    variable = disp_x
    point = &#x27;1.2 0 0&#x27;
  []
  [dispx_end_inner]
    type = PointValue
    variable = disp_x
    point = &#x27;1 0 1.5&#x27;
  []
  [dispx_end_outer]
    type = PointValue
    variable = disp_x
    point = &#x27;1.2 0 1.5&#x27;
  []
  [dispz_inner]
    type = PointValue
    variable = disp_z
    point = &#x27;1 0 1.5&#x27;
  []
  [dispz_outer]
    type = PointValue
    variable = disp_z
    point = &#x27;1.2 0 1.5&#x27;
  []
[]

[Outputs]
  exodus = false
  csv = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7cf04026-777e-44ac-96a9-a4760001a461"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/00.i</h4><pre class="moose-pre"><code class="language-text"># Creates the mesh for the remainder of the tutorial
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
    input = annular
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[Variables]
  [./dummy_var]
  [../]
[]
[Kernels]
  [./dummy_diffusion]
    type = Diffusion
    variable = dummy_var
  [../]
[]

[Executioner]
  type = Steady
[]

[Outputs]
  file_base = 3D_mesh
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6ee690a9-eb74-4c55-8f42-43c810cb7b80"><div class="modal-content"><h4>test/tests/meshgenerators/mesh_extruder_generator/extrude_remap_layer1.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [./fmg]
    type = FileMeshGenerator
    file = multiblock.e
  []

  [./extrude]
    type = MeshExtruderGenerator
    input = fmg
    num_layers = 6
    extrusion_vector = &#x27;0 0 2&#x27;
    bottom_sideset = &#x27;new_bottom&#x27;
    top_sideset = &#x27;new_top&#x27;

    # Remap layers
    existing_subdomains = &#x27;1 2 5&#x27;
    layers = &#x27;1 3 5&#x27;
    new_ids = &#x27;10 12 15
               30 32 35
               50 52 55&#x27;
  [../]
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
[]

[BCs]
  [./bottom]
    type = DirichletBC
    variable = u
    boundary = &#x27;new_bottom&#x27;
    value = 0
  [../]

  [./top]
    type = DirichletBC
    variable = u
    boundary = &#x27;new_top&#x27;
    value = 1
  [../]
[]

[Executioner]
  type = Steady

  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e5ba51f9-5d15-406c-8845-46fbeb5512a8"><div class="modal-content"><h4>modules/porous_flow/test/tests/thm_rehbinder/free_outer.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 40
    nt = 16
    rmin = 0.1
    rmax = 1
    dmin = 0.0
    dmax = 90
    growth_r = 1.1
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    bottom_sideset = bottom
    top_sideset = top
    extrusion_vector = &#x27;0 0 1&#x27;
    num_layers = 1
  [../]
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  biot_coefficient = 1.0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
  [./temperature]
  [../]
[]

[BCs]
  # sideset 1 = outer
  # sideset 2 = cavity
  # sideset 3 = ymin
  # sideset 4 = xmin
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = dmin
  [../]
  [./xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = dmax
  [../]

  [./cavity_temperature]
    type = DirichletBC
    variable = temperature
    value = 1000
    boundary = rmin
  [../]
  [./cavity_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = rmin
  [../]
  [./cavity_zero_effective_stress_x]
    type = Pressure
    component = 0
    variable = disp_x
    function = 1E6
    boundary = rmin
    use_displaced_mesh = false
  [../]
  [./cavity_zero_effective_stress_y]
    type = Pressure
    component = 1
    variable = disp_y
    function = 1E6
    boundary = rmin
    use_displaced_mesh = false
  [../]

  [./outer_temperature]
    type = DirichletBC
    variable = temperature
    value = 0
    boundary = rmax
  [../]
  [./outer_pressure]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = rmax
  [../]
[]

[AuxVariables]
  [./stress_rr]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_pp]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./stress_rr]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_rr
    scalar_type = RadialStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
  [./stress_pp]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_pp
    scalar_type = HoopStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 1E12
      viscosity = 1.0E-3
      density0 = 1000.0
      cv = 1000.0
      cp = 1000.0
      porepressure_coefficient = 0.0
    [../]
  [../]
[]

[PorousFlowBasicTHM]
  coupling_type = ThermoHydroMechanical
  multiply_by_density = false
  add_stress_aux = true
  porepressure = porepressure
  temperature = temperature
  eigenstrain_names = thermal_contribution
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 1E10
    poissons_ratio = 0.2
  [../]
  [./strain]
    type = ComputeSmallStrain
    eigenstrain_names = thermal_contribution
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = temperature
    thermal_expansion_coeff = 1E-6
    eigenstrain_name = thermal_contribution
    stress_free_temperature = 0.0
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is ever used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    solid_bulk_compliance = 1E-10
    fluid_bulk_modulus = 1E12
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0   0 1E-12 0   0 0 1E-12&#x27;
  [../]
  [./thermal_expansion]
    type = PorousFlowConstantThermalExpansionCoefficient
    fluid_coefficient = 1E-6
    drained_coefficient = 1E-6
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;1E6 0 0  0 1E6 0  0 0 1E6&#x27;
  [../]
[]

[VectorPostprocessors]
  [./P]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = porepressure
  [../]
  [./T]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = temperature
  [../]
  [./U]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = disp_x
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_rtol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           1E-8&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  file_base = free_outer
  execute_on = timestep_end
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ec9a3fed-b4ab-4f0f-9ddd-f66d66fbaa6d"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/05_tabulated.i</h4><pre class="moose-pre"><code class="language-text"># Darcy flow with heat advection and conduction, using Water97 properties
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
    input = annular
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
    initial_condition = 1E6
  [../]
  [./temperature]
    initial_condition = 313
    scaling = 1E-8
  [../]
[]

[PorousFlowBasicTHM]
  porepressure = porepressure
  temperature = temperature
  coupling_type = ThermoHydro
  gravity = &#x27;0 0 0&#x27;
  fp = tabulated_water
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 2E6
    boundary = injection_area
  [../]
  [./constant_injection_temperature]
    type = DirichletBC
    variable = temperature
    value = 333
    boundary = injection_area
  [../]
[]

[Modules]
  [./FluidProperties]
    [./true_water]
      type = Water97FluidProperties
    [../]
    [./tabulated_water]
      type = TabulatedFluidProperties
      fp = true_water
      temperature_min = 275
      interpolated_properties = &#x27;density viscosity enthalpy internal_energy&#x27;
      fluid_property_file = water97_tabulated.csv
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.8
    solid_bulk_compliance = 2E-7
    fluid_bulk_modulus = 1E7
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]

  [./thermal_expansion]
    type = PorousFlowConstantThermalExpansionCoefficient
    biot_coefficient = 0.8
    drained_coefficient = 0.003
    fluid_coefficient = 0.0002
  [../]
  [./rock_internal_energy]
    type = PorousFlowMatrixInternalEnergy
    density = 2500.0
    specific_heat_capacity = 1200.0
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;10 0 0  0 10 0  0 0 10&#x27;
    block = &#x27;caps aquifer&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_abs_tol = 1E-10
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3ed83451-63f5-4f09-b6a3-9ce636d4dbc8"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/10.i</h4><pre class="moose-pre"><code class="language-text"># Unsaturated Darcy-Richards flow without using an Action
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pp
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    alpha = 1E-6
    m = 0.6
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
  [../]
[]

[Kernels]
  [./time_derivative]
    type = PorousFlowMassTimeDerivative
    variable = pp
  [../]
  [./flux]
    type = PorousFlowAdvectiveFlux
    variable = pp
    gravity = &#x27;0 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./sat]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./saturation]
    type = PorousFlowPropertyAux
    variable = sat
    property = saturation
  [../]
[]


[BCs]
  [./production]
    type = PorousFlowSink
    variable = pp
    fluid_phase = 0
    flux_function = 1E-2
    use_relperm = true
    boundary = injection_area
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0E-3
      density0 = 1000.0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]
  [./saturation_calculator]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./temperature]
    type = PorousFlowTemperature
    temperature = 293
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = the_simple_fluid
    phase = 0
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 3
    s_res = 0.1
    sum_s_res = 0.1
    phase = 0
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_abs_tol = 1E-7
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e8add1fe-b25f-435b-a42f-f54ee75c17b8"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/07.i</h4><pre class="moose-pre"><code class="language-text"># Darcy flow with a tracer that precipitates causing mineralisation and porosity changes and permeability changes
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer_concentration]
  [../]
[]

[PorousFlowFullySaturated]
  porepressure = porepressure
  coupling_type = Hydro
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  mass_fraction_vars = tracer_concentration
  number_aqueous_kinetic = 1
  temperature = 283.0
[]

[AuxVariables]
  [./eqm_k]
    initial_condition = 0.1
  [../]
  [./mineral_conc]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./initial_and_reference_conc]
    initial_condition = 0
  [../]
  [./porosity]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./permeability]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./mineral_conc]
    type = PorousFlowPropertyAux
    property = mineral_concentration
    mineral_species = 0
    variable = mineral_conc
  [../]
  [./porosity]
    type = PorousFlowPropertyAux
    property = porosity
    variable = porosity
  [../]
  [./permeability]
    type = PorousFlowPropertyAux
    property = permeability
    column = 0
    row = 0
    variable = permeability
  [../]
[]

[Kernels]
  [./precipitation_dissolution]
    type = PorousFlowPreDis
    mineral_density = 1000.0
    stoichiometry = 1
    variable = tracer_concentration
  [../]
[]

[BCs]
  [./constant_injection_of_tracer]
    type = PorousFlowSink
    variable = tracer_concentration
    flux_function = -5E-3
    boundary = injection_area
  [../]
  [./constant_outer_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = rmax
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0E-3
      density0 = 1000.0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
    chemical = true
    initial_mineral_concentrations = initial_and_reference_conc
    reference_chemistry = initial_and_reference_conc
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityKozenyCarman
    block = aquifer
    k0 = 1E-14
    m = 2
    n = 3
    phi0 = 0.1
    poroperm_function = kozeny_carman_phi0
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityKozenyCarman
    block = caps
    k0 = 1E-15
    k_anisotropy = &#x27;1 0 0  0 1 0  0 0 0.1&#x27;
    m = 2
    n = 3
    phi0 = 0.1
    poroperm_function = kozeny_carman_phi0
  [../]
  [./precipitation_dissolution]
    type = PorousFlowAqueousPreDisChemistry
    reference_temperature = 283.0
    activation_energy = 1 # irrelevant because T=Tref
    equilibrium_constants = eqm_k # equilibrium tracer concentration
    kinetic_rate_constant = 1E-8
    molar_volume = 1
    num_reactions = 1
    primary_activity_coefficients = 1
    primary_concentrations = tracer_concentration
    reactions = 1
    specific_reactive_surface_area = 1
  [../]
  [./mineral_concentration]
    type = PorousFlowAqueousPreDisMineral
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_abs_tol = 1E-10
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="956b23c7-3d4f-4641-a10e-1ce290ea0d58"><div class="modal-content"><h4>test/tests/meshgenerators/mesh_extruder_generator/extrude_quad.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [./fmg]
    type = FileMeshGenerator
    file = chimney_quad.e
  []

  [./extrude]
    type = MeshExtruderGenerator
    input = fmg
    num_layers = 20
    extrusion_vector = &#x27;0 1e-2 0&#x27;
    bottom_sideset = &#x27;new_bottom&#x27;
    top_sideset = &#x27;new_top&#x27;
  []
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
[]

[BCs]
  [./bottom]
    type = DirichletBC
    variable = u
    boundary = &#x27;new_bottom&#x27;
    value = 0
  [../]

  [./top]
    type = DirichletBC
    variable = u
    boundary = &#x27;new_top&#x27;
    value = 1
  [../]
[]

[Executioner]
  type = Steady

  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  file_base = out_quad
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2c2b2172-a1c9-462a-9c92-c824f6c46445"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/05.i</h4><pre class="moose-pre"><code class="language-text"># Darcy flow with heat advection and conduction, using Water97 properties
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
    input = annular
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
    initial_condition = 1E6
  [../]
  [./temperature]
    initial_condition = 313
    scaling = 1E-8
  [../]
[]

[PorousFlowBasicTHM]
  porepressure = porepressure
  temperature = temperature
  coupling_type = ThermoHydro
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 2E6
    boundary = injection_area
  [../]
  [./constant_injection_temperature]
    type = DirichletBC
    variable = temperature
    value = 333
    boundary = injection_area
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = Water97FluidProperties
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.8
    solid_bulk_compliance = 2E-7
    fluid_bulk_modulus = 1E7
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]

  [./thermal_expansion]
    type = PorousFlowConstantThermalExpansionCoefficient
    biot_coefficient = 0.8
    drained_coefficient = 0.003
    fluid_coefficient = 0.0002
  [../]
  [./rock_internal_energy]
    type = PorousFlowMatrixInternalEnergy
    density = 2500.0
    specific_heat_capacity = 1200.0
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;10 0 0  0 10 0  0 0 10&#x27;
    block = &#x27;caps aquifer&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_abs_tol = 1E-10
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="fe8df40e-6c42-4283-b225-593b31de08b1"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/08.i</h4><pre class="moose-pre"><code class="language-text"># Unsaturated Darcy-Richards flow
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
  [../]
[]

[PorousFlowUnsaturated]
  porepressure = porepressure
  coupling_type = Hydro
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  relative_permeability_exponent = 3
  relative_permeability_type = Corey
  residual_saturation = 0.1
  van_genuchten_alpha = 1E-6
  van_genuchten_m = 0.6
[]

[BCs]
  [./production]
    type = PorousFlowSink
    variable = porepressure
    fluid_phase = 0
    flux_function = 1E-2
    use_relperm = true
    boundary = injection_area
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0E-3
      density0 = 1000.0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_abs_tol = 1E-7
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c6e36a91-2470-454e-b4a7-5bd0784539b9"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/08_KT.i</h4><pre class="moose-pre"><code class="language-text"># Unsaturated Darcy-Richards flow
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
  [../]
[]

[PorousFlowUnsaturated]
  porepressure = porepressure
  coupling_type = Hydro
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  relative_permeability_exponent = 3
  relative_permeability_type = Corey
  residual_saturation = 0.1
  van_genuchten_alpha = 1E-6
  van_genuchten_m = 0.6
  stabilization = KT
  flux_limiter_type = None
[]

[BCs]
  [./production]
    type = PorousFlowSink
    variable = porepressure
    fluid_phase = 0
    flux_function = 1E-2
    use_relperm = true
    boundary = injection_area
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0E-3
      density0 = 1000.0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E5
  dt = 1E5
  nl_rel_tol = 1E-14
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="459ef608-5dea-419d-816a-99bc69c12b6e"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/01.i</h4><pre class="moose-pre"><code class="language-text"># Darcy flow
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
    input = annular
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
  [../]
[]

[PorousFlowBasicTHM]
  porepressure = porepressure
  coupling_type = Hydro
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = injection_area
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0E-3
      density0 = 1000.0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.8
    solid_bulk_compliance = 2E-7
    fluid_bulk_modulus = 1E7
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_abs_tol = 1E-13
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3b1e9224-bdd6-4d31-ab1d-4cdc9ee7c0db"><div class="modal-content"><h4>test/tests/meshgenerators/mesh_extruder_generator/extrude_angle.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [./fmg]
    type = FileMeshGenerator
    file = chimney_quad.e
  []

  [./extrude]
    type = MeshExtruderGenerator
    input = fmg
    num_layers = 20
    extrusion_vector = &#x27;1e-2 1e-2 0&#x27;
    bottom_sideset = &#x27;10&#x27;
    top_sideset = &#x27;20&#x27;
  []
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
[]

[BCs]
  [./bottom]
    type = DirichletBC
    variable = u
    boundary = 10
    value = 0
  [../]

  [./top]
    type = DirichletBC
    variable = u
    boundary = 20
    value = 1
  [../]
[]

[Executioner]
  type = Steady

  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  file_base = out_quad_angle
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ac46bb85-3ca0-4ae9-a754-d78754eaa783"><div class="modal-content"><h4>modules/porous_flow/test/tests/thm_rehbinder/fixed_outer.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 40
    nt = 16
    rmin = 0.1
    rmax = 1
    dmin = 0.0
    dmax = 90
    growth_r = 1.1
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    bottom_sideset = bottom
    top_sideset = top
    extrusion_vector = &#x27;0 0 1&#x27;
    num_layers = 1
  [../]
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  biot_coefficient = 1.0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
  [./temperature]
  [../]
[]

[BCs]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = dmin
  [../]
  [./xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = dmax
  [../]

  [./cavity_temperature]
    type = DirichletBC
    variable = temperature
    value = 1000
    boundary = rmin
  [../]
  [./cavity_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = rmin
  [../]
  [./cavity_zero_effective_stress_x]
    type = Pressure
    component = 0
    variable = disp_x
    function = 1E6
    boundary = rmin
    use_displaced_mesh = false
  [../]
  [./cavity_zero_effective_stress_y]
    type = Pressure
    component = 1
    variable = disp_y
    function = 1E6
    boundary = rmin
    use_displaced_mesh = false
  [../]

  [./outer_temperature]
    type = DirichletBC
    variable = temperature
    value = 0
    boundary = rmax
  [../]
  [./outer_pressure]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = rmax
  [../]
  [./fixed_outer_x]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = rmax
  [../]
  [./fixed_outer_y]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = rmax
  [../]
[]

[AuxVariables]
  [./stress_rr]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_pp]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./stress_rr]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_rr
    scalar_type = RadialStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
  [./stress_pp]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_pp
    scalar_type = HoopStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 1E12
      viscosity = 1.0E-3
      density0 = 1000.0
      cv = 1000.0
      cp = 1000.0
      porepressure_coefficient = 0.0
    [../]
  [../]
[]

[PorousFlowBasicTHM]
  coupling_type = ThermoHydroMechanical
  multiply_by_density = false
  add_stress_aux = true
  porepressure = porepressure
  temperature = temperature
  eigenstrain_names = thermal_contribution
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 1E10
    poissons_ratio = 0.2
  [../]
  [./strain]
    type = ComputeSmallStrain
    eigenstrain_names = thermal_contribution
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = temperature
    thermal_expansion_coeff = 1E-6
    eigenstrain_name = thermal_contribution
    stress_free_temperature = 0.0
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is ever used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    solid_bulk_compliance = 1E-10
    fluid_bulk_modulus = 1E12
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0   0 1E-12 0   0 0 1E-12&#x27;
  [../]
  [./thermal_expansion]
    type = PorousFlowConstantThermalExpansionCoefficient
    fluid_coefficient = 1E-6
    drained_coefficient = 1E-6
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;1E6 0 0  0 1E6 0  0 0 1E6&#x27;
  [../]
[]

[VectorPostprocessors]
  [./P]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = porepressure
  [../]
  [./T]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = temperature
  [../]
  [./U]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = disp_x
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_rtol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           1E-8&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  file_base = fixed_outer
  execute_on = timestep_end
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1cd45849-d08c-4868-bebc-a67fa82a451a"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/04.i</h4><pre class="moose-pre"><code class="language-text"># Darcy flow with heat advection and conduction, and elasticity
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
    input = annular
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  biot_coefficient = 1.0
[]

[Variables]
  [./porepressure]
  [../]
  [./temperature]
    initial_condition = 293
    scaling = 1E-8
  [../]
  [./disp_x]
    scaling = 1E-10
  [../]
  [./disp_y]
    scaling = 1E-10
  [../]
  [./disp_z]
    scaling = 1E-10
  [../]
[]

[PorousFlowBasicTHM]
  porepressure = porepressure
  temperature = temperature
  coupling_type = ThermoHydroMechanical
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  eigenstrain_names = thermal_contribution
  use_displaced_mesh = false
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = injection_area
  [../]
  [./constant_injection_temperature]
    type = DirichletBC
    variable = temperature
    value = 313
    boundary = injection_area
  [../]

  [./roller_tmax]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = dmax
  [../]
  [./roller_tmin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = dmin
  [../]
  [./roller_top_bottom]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./cavity_pressure_x]
    type = Pressure
    boundary = injection_area
    variable = disp_x
    component = 0
    factor = 1E6
    use_displaced_mesh = false
  [../]
  [./cavity_pressure_y]
    type = Pressure
    boundary = injection_area
    variable = disp_y
    component = 1
    factor = 1E6
    use_displaced_mesh = false
  [../]
[]

[AuxVariables]
  [./stress_rr]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_pp]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./stress_rr]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_rr
    scalar_type = RadialStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
  [./stress_pp]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_pp
    scalar_type = HoopStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0E-3
      density0 = 1000.0
      thermal_expansion = 0.0002
      cp = 4194
      cv = 4186
      porepressure_coefficient = 0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    solid_bulk_compliance = 2E-7
    fluid_bulk_modulus = 1E7
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]

  [./thermal_expansion]
    type = PorousFlowConstantThermalExpansionCoefficient
    drained_coefficient = 0.003
    fluid_coefficient = 0.0002
  [../]
  [./rock_internal_energy]
    type = PorousFlowMatrixInternalEnergy
    density = 2500.0
    specific_heat_capacity = 1200.0
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;10 0 0  0 10 0  0 0 10&#x27;
    block = &#x27;caps aquifer&#x27;
  [../]

  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 5E9
    poissons_ratio = 0.0
  [../]
  [./strain]
    type = ComputeSmallStrain
    eigenstrain_names = thermal_contribution
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = temperature
    thermal_expansion_coeff = 0.001 # this is the linear thermal expansion coefficient
    eigenstrain_name = thermal_contribution
    stress_free_temperature = 293
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_abs_tol = 1E-15
  nl_rel_tol = 1E-14
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d22611ce-e84f-43ff-97a8-3908a9b3ce65"><div class="modal-content"><h4>test/tests/mesh/mesh_only/mesh_only.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  uniform_refine = 1
  [file]
    type = FileMeshGenerator
    file = chimney_quad.e
  []
  [./extrude]
    input = file
    type = MeshExtruderGenerator
    num_layers = 20
    extrusion_vector = &#x27;0 1e-2 0&#x27;
    bottom_sideset = &#x27;2&#x27;
    top_sideset = &#x27;4&#x27;
  [../]
[]

# This input file is intended to be run with the &quot;--mesh-only&quot; option so
# no other sections are required
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f6fabc1e-4ca4-4fa0-9123-ef8d2cf39571"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/11.i</h4><pre class="moose-pre"><code class="language-text"># Two-phase borehole injection problem
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pwater pgas T disp_x disp_y&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    alpha = 1E-6
    m = 0.6
  [../]
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  gravity = &#x27;0 0 0&#x27;
  biot_coefficient = 1.0
  PorousFlowDictator = dictator
[]

[Variables]
  [./pwater]
    initial_condition = 20E6
  [../]
  [./pgas]
    initial_condition = 20.1E6
  [../]
  [./T]
    initial_condition = 330
    scaling = 1E-5
  [../]
  [./disp_x]
    scaling = 1E-5
  [../]
  [./disp_y]
    scaling = 1E-5
  [../]
[]

[Kernels]
  [./mass_water_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./flux_water]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./vol_strain_rate_water]
    type = PorousFlowMassVolumetricExpansion
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./mass_co2_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    use_displaced_mesh = false
    variable = pgas
  [../]
  [./flux_co2]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    use_displaced_mesh = false
    variable = pgas
  [../]
  [./vol_strain_rate_co2]
    type = PorousFlowMassVolumetricExpansion
    fluid_component = 1
    use_displaced_mesh = false
    variable = pgas
  [../]
  [./energy_dot]
    type = PorousFlowEnergyTimeDerivative
    use_displaced_mesh = false
    variable = T
  [../]
  [./advection]
    type = PorousFlowHeatAdvection
    use_displaced_mesh = false
    variable = T
  [../]
  [./conduction]
    type = PorousFlowHeatConduction
    use_displaced_mesh = false
    variable = T
  [../]
  [./vol_strain_rate_heat]
    type = PorousFlowHeatVolumetricExpansion
    use_displaced_mesh = false
    variable = T
  [../]
  [./grad_stress_x]
    type = StressDivergenceTensors
    temperature = T
    variable = disp_x
    eigenstrain_names = thermal_contribution
    use_displaced_mesh = false
    component = 0
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    variable = disp_x
    use_displaced_mesh = false
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    temperature = T
    variable = disp_y
    eigenstrain_names = thermal_contribution
    use_displaced_mesh = false
    component = 1
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    variable = disp_y
    use_displaced_mesh = false
    component = 1
  [../]
[]

[AuxVariables]
  [./disp_z]
  [../]
  [./effective_fluid_pressure]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./mass_frac_phase0_species0]
    initial_condition = 1 # all water in phase=0
  [../]
  [./mass_frac_phase1_species0]
    initial_condition = 0 # no water in phase=1
  [../]
  [./sgas]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./swater]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_rr]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_tt]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./porosity]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./effective_fluid_pressure]
    type = ParsedAux
    args = &#x27;pwater pgas swater sgas&#x27;
    function = &#x27;pwater * swater + pgas * sgas&#x27;
    variable = effective_fluid_pressure
  [../]
  [./swater]
    type = PorousFlowPropertyAux
    variable = swater
    property = saturation
    phase = 0
    execute_on = timestep_end
  [../]
  [./sgas]
    type = PorousFlowPropertyAux
    variable = sgas
    property = saturation
    phase = 1
    execute_on = timestep_end
  [../]
  [./stress_rr]
    type = RankTwoScalarAux
    variable = stress_rr
    rank_two_tensor = stress
    scalar_type = RadialStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
    execute_on = timestep_end
  [../]
  [./stress_tt]
    type = RankTwoScalarAux
    variable = stress_tt
    rank_two_tensor = stress
    scalar_type = HoopStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
    execute_on = timestep_end
  [../]
  [./stress_zz]
    type = RankTwoAux
    variable = stress_zz
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    execute_on = timestep_end
  [../]
  [./porosity]
    type = PorousFlowPropertyAux
    variable = porosity
    property = porosity
    execute_on = timestep_end
  [../]
[]


[BCs]
  [./roller_tmax]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = dmax
  [../]
  [./roller_tmin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = dmin
  [../]
  [./pinned_top_bottom_x]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./pinned_top_bottom_y]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./cavity_pressure_x]
    type = Pressure
    boundary = injection_area
    variable = disp_x
    component = 0
    postprocessor = constrained_effective_fluid_pressure_at_wellbore
    use_displaced_mesh = false
  [../]
  [./cavity_pressure_y]
    type = Pressure
    boundary = injection_area
    variable = disp_y
    component = 1
    postprocessor = constrained_effective_fluid_pressure_at_wellbore
    use_displaced_mesh = false
  [../]

  [./cold_co2]
    type = DirichletBC
    boundary = injection_area
    variable = T
    value = 290  # injection temperature
    use_displaced_mesh = false
  [../]
  [./constant_co2_injection]
    type = PorousFlowSink
    boundary = injection_area
    variable = pgas
    fluid_phase = 1
    flux_function = -1E-4
    use_displaced_mesh = false
  [../]

  [./outer_water_removal]
    type = PorousFlowPiecewiseLinearSink
    boundary = rmax
    variable = pwater
    fluid_phase = 0
    pt_vals = &#x27;0 1E9&#x27;
    multipliers = &#x27;0 1E8&#x27;
    PT_shift = 20E6
    use_mobility = true
    use_relperm = true
    use_displaced_mesh = false
  [../]
  [./outer_co2_removal]
    type = PorousFlowPiecewiseLinearSink
    boundary = rmax
    variable = pgas
    fluid_phase = 1
    pt_vals = &#x27;0 1E9&#x27;
    multipliers = &#x27;0 1E8&#x27;
    PT_shift = 20.1E6
    use_mobility = true
    use_relperm = true
    use_displaced_mesh = false
  [../]
[]

[Modules]
  [./FluidProperties]
    [./true_water]
      type = Water97FluidProperties
    [../]
    [./tabulated_water]
      type = TabulatedFluidProperties
      fp = true_water
      temperature_min = 275
      pressure_max = 1E8
      interpolated_properties = &#x27;density viscosity enthalpy internal_energy&#x27;
      fluid_property_file = water97_tabulated_11.csv
    [../]
    [./true_co2]
      type = CO2FluidProperties
    [../]
    [./tabulated_co2]
      type = TabulatedFluidProperties
      fp = true_co2
      temperature_min = 275
      pressure_max = 1E8
      interpolated_properties = &#x27;density viscosity enthalpy internal_energy&#x27;
      fluid_property_file = co2_tabulated_11.csv
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = T
  [../]
  [./saturation_calculator]
    type = PorousFlow2PhasePP
    phase0_porepressure = pwater
    phase1_porepressure = pgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;mass_frac_phase0_species0 mass_frac_phase1_species0&#x27;
  [../]
  [./water]
    type = PorousFlowSingleComponentFluid
    fp = tabulated_water
    phase = 0
  [../]
  [./co2]
    type = PorousFlowSingleComponentFluid
    fp = tabulated_co2
    phase = 1
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 4
    s_res = 0.1
    sum_s_res = 0.2
    phase = 0
  [../]
  [./relperm_co2]
    type = PorousFlowRelativePermeabilityBC
    nw_phase = true
    lambda = 2
    s_res = 0.1
    sum_s_res = 0.2
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosity
    fluid = true
    mechanical = true
    thermal = true
    porosity_zero = 0.1
    reference_temperature = 330
    reference_porepressure = 20E6
    thermal_expansion_coeff = 15E-6 # volumetric
    solid_bulk = 8E9 # unimportant since biot = 1
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityKozenyCarman
    block = aquifer
    poroperm_function = kozeny_carman_phi0
    phi0 = 0.1
    n = 2
    m = 2
    k0 = 1E-12
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityKozenyCarman
    block = caps
    poroperm_function = kozeny_carman_phi0
    phi0 = 0.1
    n = 2
    m = 2
    k0 = 1E-15
    k_anisotropy = &#x27;1 0 0  0 1 0  0 0 0.1&#x27;
  [../]
  [./rock_thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;2 0 0  0 2 0  0 0 2&#x27;
  [../]
  [./rock_internal_energy]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 1100
    density = 2300
  [../]

  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 5E9
    poissons_ratio = 0.0
  [../]
  [./strain]
    type = ComputeSmallStrain
    eigenstrain_names = &#x27;thermal_contribution initial_stress&#x27;
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = T
    thermal_expansion_coeff = 5E-6 # this is the linear thermal expansion coefficient
    eigenstrain_name = thermal_contribution
    stress_free_temperature = 330
  [../]
  [./initial_strain]
    type = ComputeEigenstrainFromInitialStress
    initial_stress = &#x27;20E6 0 0  0 20E6 0  0 0 20E6&#x27;
    eigenstrain_name = initial_stress
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]

  [./effective_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./volumetric_strain]
    type = PorousFlowVolumetricStrain
  [../]
[]

[Postprocessors]
  [./effective_fluid_pressure_at_wellbore]
    type = PointValue
    variable = effective_fluid_pressure
    point = &#x27;1 0 0&#x27;
    execute_on = timestep_begin
    use_displaced_mesh = false
  [../]
  [./constrained_effective_fluid_pressure_at_wellbore]
    type = FunctionValuePostprocessor
    function = constrain_effective_fluid_pressure
    execute_on = timestep_begin
  [../]
[]

[Functions]
  [./constrain_effective_fluid_pressure]
    type = ParsedFunction
    vars = effective_fluid_pressure_at_wellbore
    vals = effective_fluid_pressure_at_wellbore
    value = &#x27;max(effective_fluid_pressure_at_wellbore, 20E6)&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1E3
    growth_factor = 1.2
    optimal_iterations = 10
  [../]
  nl_abs_tol = 1E-7
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b8e2975f-5226-442a-8997-17b93d937cb7"><div class="modal-content"><h4>modules/tensor_mechanics/tutorials/basics/part_3_1.i</h4><pre class="moose-pre"><code class="language-text">#Tensor Mechanics tutorial: the basics
#Step 3, part 1
#3D simulation of uniaxial tension with J2 plasticity

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Mesh]
  [file_mesh]
    type = FileMeshGenerator
    file = necking_quad4.e
  []
  [extrude]
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 0.5&#x27;
    num_layers = 2
    bottom_sideset = &#x27;back&#x27;
    top_sideset = &#x27;front&#x27;
    input = file_mesh
  []
  uniform_refine = 0
  second_order = true
[]

[Modules/TensorMechanics/Master]
  [./block1]
    strain = FINITE
    add_variables = true
    generate_output = &#x27;stress_yy strain_yy&#x27;
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
  [../]
  [./stress]
    type = ComputeMultiPlasticityStress
    ep_plastic_tolerance = 1e-9
    plastic_models = J2
  [../]
[]

[UserObjects]
  [./hardening]
    type = TensorMechanicsHardeningCubic
    value_0 = 2.4e2
    value_residual = 3.0e2
    internal_0 = 0
    internal_limit = 0.005
  [../]
  [./J2]
    type = TensorMechanicsPlasticJ2
    yield_strength = hardening
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-9
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = disp_x #change the variable to reflect the new displacement names
    boundary = 1
    value = 0.0
  [../]
  [./back]
    type = DirichletBC
    variable = disp_z #change the variable to reflect the new displacement names
    boundary = back
    value = 0.0
  [../]
  [./bottom]
    type = DirichletBC
    variable = disp_y #change the variable to reflect the new displacement names
    boundary = 3
    value = 0.0
  [../]
  [./top]
    type = FunctionDirichletBC
    variable = disp_y #change the variable to reflect the new displacement names
    boundary = 4
    function = &#x27;0.0007*t&#x27;
  [../]
[]

[Preconditioning]
  [./SMP]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  dt = 0.25
  end_time = 16

  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-pc_type -sub_pc_type -pc_asm_overlap -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;asm lu 1 101&#x27;
[]

[Postprocessors]
  [./ave_stress_bottom]
    type = SideAverageValue
    variable = stress_yy
    boundary = 3
  [../]
  [./ave_strain_bottom]
    type = SideAverageValue
    variable = strain_yy
    boundary = 3
  [../]
[]

[Outputs]
  exodus = true
  perf_graph = true
  csv = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="38a1b470-e578-42f9-954e-2dc4fae8bed2"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/06.i</h4><pre class="moose-pre"><code class="language-text"># Darcy flow with a tracer
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
    input = annular
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer_concentration]
  [../]
[]

[ICs]
  [./tracer_concentration]
    type = FunctionIC
    function = &#x27;0.5*if(x*x+y*y&lt;1.01,1,0)&#x27;
    variable = tracer_concentration
  [../]
[]

[PorousFlowFullySaturated]
  porepressure = porepressure
  coupling_type = Hydro
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  mass_fraction_vars = tracer_concentration
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = injection_area
  [../]
  [./constant_outer_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = rmax
  [../]
  [./injected_tracer]
    type = DirichletBC
    variable = tracer_concentration
    value = 0.5
    boundary = injection_area
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0E-3
      density0 = 1000.0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityConst
    block = aquifer
    permeability = &#x27;1E-14 0 0   0 1E-14 0   0 0 1E-14&#x27;
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityConst
    block = caps
    permeability = &#x27;1E-15 0 0   0 1E-15 0   0 0 1E-16&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E5
  nl_rel_tol = 1E-14
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="77860353-17a2-4ad3-9606-5f8607984fea"><div class="modal-content"><h4>test/tests/meshgenerators/mesh_extruder_generator/extrude_remap_layer2.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [./fmg]
    type = FileMeshGenerator
    file = multiblock.e
  []

  [./extrude]
    type = MeshExtruderGenerator
    input = fmg
    num_layers = 6
    extrusion_vector = &#x27;0 0 2&#x27;
    bottom_sideset = &#x27;new_bottom&#x27;
    top_sideset = &#x27;new_top&#x27;

    # Remap layers
    existing_subdomains = &#x27;1 2 5&#x27;
    layers = &#x27;1 3 5&#x27;
    new_ids = &#x27;10 12 15&#x27; # Repeat this remapping for each layer
  []
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
[]

[BCs]
  [./bottom]
    type = DirichletBC
    variable = u
    boundary = &#x27;new_bottom&#x27;
    value = 0
  [../]

  [./top]
    type = DirichletBC
    variable = u
    boundary = &#x27;new_top&#x27;
    value = 1
  [../]
[]

[Executioner]
  type = Steady

  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7aed2ef0-b28c-4a18-a412-e40d93cb3a49"><div class="modal-content"><h4>test/tests/meshgenerators/mesh_extruder_generator/gen_extrude.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [./gmg]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 6
    ny = 6
    nz = 0
    zmin = 0
    zmax = 0
    elem_type = QUAD4
  []

  [./extrude]
    type = MeshExtruderGenerator
    input = gmg
    num_layers = 6
    extrusion_vector = &#x27;1 0 1&#x27;
    bottom_sideset = &#x27;new_front&#x27;
    top_sideset = &#x27;new_back&#x27;
  []
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
[]

[BCs]
  [./first]
    type = DirichletBC
    variable = u
    boundary = &#x27;new_front&#x27;
    value = 0
  [../]

  [./second]
    type = DirichletBC
    variable = u
    boundary = &#x27;new_back&#x27;
    value = 1
  [../]
[]

[Executioner]
  type = Steady

  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#2a99b126-a6ea-4f4f-9e06-907fc7316283" class="tooltipped" data-position="left" data-tooltip="Overview">Overview</a></li><li><a href="#849de3a8-dce8-4dff-8a42-dd43513c9231" class="tooltipped" data-position="left" data-tooltip="Visual Example">Visual Example</a></li><li><a href="#c7d385d2-3b97-4beb-a2ce-1a8b615ec2f9" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#c1e6c98a-91db-42a0-9fd5-3f7259f02d37" class="tooltipped" data-position="left" data-tooltip="Input Files">Input Files</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>