<!DOCTYPE html><head><meta charset="UTF-8"><title>FunctionValuePostprocessor.md|MOOSE Ray Tracing Module</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="/modules/ray_tracing" class="left moose-logo hide-on-med-and-down">MOOSE Ray Tracing Module</a><a href="https://github.com/idaholab/moose" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="4004564d-85b5-466c-a50c-018f9efe2a46"><i class="material-icons">menu</i></a><ul class="sidenav" id="4004564d-85b5-466c-a50c-018f9efe2a46"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/modules/ray_tracing" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">postprocessors</span><a href="#" class="breadcrumb">FunctionValuePostprocessor</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="59c5ad8d-382b-42d6-9d79-3d8641e52eb9" data-section-level="1" data-section-text="FunctionValuePostprocessor"><h1 id="functionvaluepostprocessor">FunctionValuePostprocessor</h1><p>Computes the value of a supplied function at a single point (scalable)</p><section class="scrollspy" id="813145d5-5d97-4d4a-9073-bec5d09df275" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="0230731a-f42c-4434-90fd-a54894a314d9" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">function</span><span class="moose-parameter-header-description">The function which supplies the postprocessor value.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>FunctionName</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The function which supplies the postprocessor value.</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="05caa0a0-e8e7-4703-8bb5-6281965a0065" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">execute_on</span><span class="moose-parameter-header-default">TIMESTEP_END</span><span class="moose-parameter-header-description">The list of flag(s) indicating when this object should be executed, the available options include NONE, INITIAL, LINEAR, NONLINEAR, TIMESTEP_END, TIMESTEP_BEGIN, FINAL, CUSTOM.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>TIMESTEP_END</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>ExecFlagEnum</p><p class="moose-parameter-description-options"><span>Options:</span>NONE INITIAL LINEAR NONLINEAR TIMESTEP_END TIMESTEP_BEGIN FINAL CUSTOM TRANSFER</p><p class="moose-parameter-description"><span>Description:</span>The list of flag(s) indicating when this object should be executed, the available options include NONE, INITIAL, LINEAR, NONLINEAR, TIMESTEP_END, TIMESTEP_BEGIN, FINAL, CUSTOM.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">point</span><span class="moose-parameter-header-default">0 0 0</span><span class="moose-parameter-header-description">A point in space to be given to the function Default: (0, 0, 0)</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0 0 0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>libMesh::Point</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>A point in space to be given to the function Default: (0, 0, 0)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">scale_factor</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">A scale factor to be applied to the function</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>A scale factor to be applied to the function</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="0807ba84-efa8-426a-9c23-ca462dabe174" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">allow_duplicate_execution_on_initial</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">In the case where this UserObject is depended upon by an initial condition, allow it to be executed twice during the initial setup (once before the IC and again after mesh adaptivity (if applicable).</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>In the case where this UserObject is depended upon by an initial condition, allow it to be executed twice during the initial setup (once before the IC and again after mesh adaptivity (if applicable).</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<std::string></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">force_preaux</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Forces the GeneralUserObject to be executed in PREAUX</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Forces the GeneralUserObject to be executed in PREAUX</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">force_preic</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Forces the GeneralUserObject to be executed in PREIC during initial setup</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Forces the GeneralUserObject to be executed in PREIC during initial setup</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">outputs</span><span class="moose-parameter-header-description">Vector of output names were you would like to restrict the output of variables(s) associated with this object</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<OutputName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Vector of output names were you would like to restrict the output of variables(s) associated with this object</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_displaced_mesh</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section></section><section class="scrollspy" id="6bed8e54-b6b2-42bb-aebe-1159b09b7064" data-section-level="2" data-section-text="Input Files"><h2 id="input-files">Input Files</h2><ul class="moose-list-inputs browser-default"><li><a href="#77f66a29-0d22-4d54-8a3c-6961ddb67a25" class="modal-trigger">modules/porous_flow/test/tests/gravity/fully_saturated_grav01b.i</a></li><li><a href="#436b26ca-ac74-4006-91ee-16150cd1f15c" class="modal-trigger">test/tests/time_steppers/iteration_adaptive/adapt_tstep_reject_large_dt.i</a></li><li><a href="#1c620149-7a70-4386-8ddf-d52457b3828d" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_lumped_18.i</a></li><li><a href="#7869ebcf-d2c7-4b8d-b7cd-614717865913" class="modal-trigger">test/tests/auxkernels/pp_depend/pp_depend.i</a></li><li><a href="#e346e7ea-8df4-4d33-b936-8792d7b8d1ee" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except07.i</a></li><li><a href="#38331b3e-58eb-4ede-9e52-b94b0164fafa" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_lumped_08.i</a></li><li><a href="#3c4abf36-1c8b-4eb3-98e1-30b6de62c50f" class="modal-trigger">test/tests/parser/param_substitution/unit_conversion.i</a></li><li><a href="#1ac58505-31df-4e31-a909-baf17471bf39" class="modal-trigger">modules/richards/test/tests/dirac/bh09.i</a></li><li><a href="#2fc7e8d5-ffa3-4d55-a2ce-f51a9b684534" class="modal-trigger">modules/tensor_mechanics/test/tests/rom_stress_update/lower_limit.i</a></li><li><a href="#b86e8f4c-12ce-47a6-b4ff-7ae1e6e50fb0" class="modal-trigger">modules/ray_tracing/test/tests/ray_kernels/line_source_ray_kernel/line_source_ray_kernel.i</a></li><li><a href="#53ad9a2d-b071-49f2-9a3b-e296e24bd6e8" class="modal-trigger">test/tests/postprocessors/execute_on_final/execute_on_final.i</a></li><li><a href="#b9c4dd18-031e-4e12-bc2d-3a1419fd628c" class="modal-trigger">modules/tensor_mechanics/test/tests/tensile/random_smoothed.i</a></li><li><a href="#08752c3f-a28a-46df-99d3-d210ee6dbe79" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except10.i</a></li><li><a href="#154689b3-6fb8-4bdb-bb83-bb1601c0f13a" class="modal-trigger">test/tests/userobjects/postprocessor_spatial_user_object/sub.i</a></li><li><a href="#9058af27-a90e-484f-b993-025d013cfa80" class="modal-trigger">modules/fluid_properties/test/tests/functions/saturation_temperature_function/saturation_temperature_function.i</a></li><li><a href="#42cf6662-f511-463c-a26a-b041483f3f25" class="modal-trigger">modules/tensor_mechanics/test/tests/mean_cap_TC/random04.i</a></li><li><a href="#db82ee2e-9dfd-47b7-82bb-cffebb94e529" class="modal-trigger">modules/porous_flow/examples/tutorial/11.i</a></li><li><a href="#fbcc2062-f6d7-460f-9521-f01db8f19f8e" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except14.i</a></li><li><a href="#d9d1e785-1cb4-4cda-a3b4-6ae5426da60b" class="modal-trigger">python/chigger/tests/simple/mug_blocks.i</a></li><li><a href="#18dc2266-368f-4dd5-9cb8-acf0ab161a4b" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh04.i</a></li><li><a href="#0b637ebd-53bb-4016-a88a-a6fad9c9fd10" class="modal-trigger">modules/chemical_reactions/test/tests/desorption/langmuir_desorption.i</a></li><li><a href="#26362263-d6ce-4476-b075-e5bb250ecec1" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh06.i</a></li><li><a href="#684cf2c2-0710-4ed9-9d91-255e92033237" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/pp_generation_unconfined_basicthm.i</a></li><li><a href="#8d2b30ec-add2-48a9-b5e2-3b9397523ba2" class="modal-trigger">modules/porous_flow/test/tests/sinks/s01.i</a></li><li><a href="#a06d5dcc-f91c-41bf-959b-ab3f8d8463ad" class="modal-trigger">modules/combined/test/tests/cavity_pressure/additional_volume.i</a></li><li><a href="#22c9ae7b-7471-4c1b-8b63-1dd53ef143ab" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/terzaghi.i</a></li><li><a href="#afae0f3c-1ea3-4a64-8875-82b309aefecf" class="modal-trigger">modules/richards/test/tests/excav/ex01.i</a></li><li><a href="#7e0b338c-ea14-4787-8f1e-6f42c2d91a21" class="modal-trigger">modules/tensor_mechanics/test/tests/weak_plane_shear/large_deform3.i</a></li><li><a href="#ed61b15e-fe13-4e85-836f-f09f856b247c" class="modal-trigger">modules/porous_flow/examples/lava_lamp/2phase_convection.i</a></li><li><a href="#d0dda624-69ca-400a-b5d8-25407c02dd65" class="modal-trigger">modules/tensor_mechanics/test/tests/recompute_radial_return/affine_plasticity.i</a></li><li><a href="#6fefd64c-84c3-46f9-a1c2-41570123f31a" class="modal-trigger">modules/combined/test/tests/poro_mechanics/terzaghi.i</a></li><li><a href="#a4acdbc8-0d72-46cb-bfb0-68dbce205279" class="modal-trigger">modules/tensor_mechanics/test/tests/capped_mohr_coulomb/random2.i</a></li><li><a href="#3e9bca02-1f2c-470a-b967-3149a60ae2bb" class="modal-trigger">modules/tensor_mechanics/test/tests/ad_viscoplasticity_stress_update/lps_dual.i</a></li><li><a href="#ade07661-1b10-497e-9955-34caf4e6c4e0" class="modal-trigger">modules/tensor_mechanics/test/tests/drucker_prager/random_hyperbolic.i</a></li><li><a href="#07840637-d01d-4b26-871a-2befc5e296d0" class="modal-trigger">test/tests/kernels/ode/parsedode_sys_impl_test.i</a></li><li><a href="#59ff4659-fda6-4189-97c6-36b943e5e2a7" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_05.i</a></li><li><a href="#571c7deb-b110-43aa-a065-6c802ad4a010" class="modal-trigger">test/tests/postprocessors/geometry/3d_geometry.i</a></li><li><a href="#92a06a7c-c2dd-47a7-b79c-b248ffbe4342" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh07.i</a></li><li><a href="#1125896e-1246-4f22-947e-4b173cce3512" class="modal-trigger">modules/tensor_mechanics/test/tests/mohr_coulomb/planar_hard4.i</a></li><li><a href="#94ed6e2a-ed33-4ecf-8a8d-b42fbbcbcd8b" class="modal-trigger">test/tests/functions/parsed/combined.i</a></li><li><a href="#cba35934-87a0-457b-b435-02a3c116d583" class="modal-trigger">test/tests/kernels/ode/parsedode_pp_test.i</a></li><li><a href="#f9f62c4b-8759-43cf-a48e-35445acba5af" class="modal-trigger">test/tests/controls/tag_based_naming_access/param.i</a></li><li><a href="#badcd9fd-ed50-4500-ba59-c4e29381e8a4" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_lumped_17.i</a></li><li><a href="#be00f3dc-7789-43ee-acb3-979c57ee7728" class="modal-trigger">modules/richards/test/tests/dirac/bh05.i</a></li><li><a href="#98d2f0eb-5be4-433f-b518-21e588d83755" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav02d.i</a></li><li><a href="#4d7ede17-dcc2-4345-a56e-f02de8efe456" class="modal-trigger">modules/tensor_mechanics/test/tests/tensile/random_planar.i</a></li><li><a href="#2f9a2bc6-358b-4bd9-82e1-042e361d0b9a" class="modal-trigger">modules/porous_flow/test/tests/energy_conservation/heat04_action.i</a></li><li><a href="#1d93b59b-3167-4bdc-9409-04df0636f448" class="modal-trigger">modules/richards/test/tests/sinks/s_fu_01.i</a></li><li><a href="#8324ea6e-2630-4b1a-994f-7e37e9df990a" class="modal-trigger">modules/porous_flow/examples/tutorial/11_2D.i</a></li><li><a href="#2b6f1b03-ceb9-4e2a-86f6-45207dc5469d" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/pp_generation_fullysat_action.i</a></li><li><a href="#d7044ebf-eafa-45c8-af89-8d4d6c94e516" class="modal-trigger">test/tests/postprocessors/change_over_time/change_over_time.i</a></li><li><a href="#334d96b3-bae0-484d-a766-acf6d44f1276" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/mandel_fully_saturated.i</a></li><li><a href="#15f743bb-9edb-4186-abad-049bc2107d91" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/pp_generation_action.i</a></li><li><a href="#7dc45f54-b47d-418b-a43f-d0cecedf81fc" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh03.i</a></li><li><a href="#103cac5e-6a0f-4921-b611-bf705015fe08" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/pls03_action.i</a></li><li><a href="#c527e744-509d-4002-95c8-876f77cff2af" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh02.i</a></li><li><a href="#6e9ca874-77bf-4108-b7df-6f5a3e9a6fb3" class="modal-trigger">modules/combined/examples/phase_field-mechanics/kks_mechanics_VTS.i</a></li><li><a href="#62c38fd1-757e-4dcf-ae97-2e48fed2b6a3" class="modal-trigger">modules/tensor_mechanics/test/tests/mohr_coulomb/planar_hard5.i</a></li><li><a href="#489fe9e4-49d4-4e11-8776-f62b8942320f" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav02a.i</a></li><li><a href="#4a1574a6-a49d-4c26-b365-7be4f98caac3" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_06.i</a></li><li><a href="#885158df-ed05-4142-a942-cd44b1ced8bd" class="modal-trigger">modules/richards/test/tests/dirac/bh10.i</a></li><li><a href="#457c11dd-ad05-413d-8245-6ed9676c6e03" class="modal-trigger">modules/combined/doc/richards/user/excav/ex01.i</a></li><li><a href="#e55a90c6-2650-47d4-a617-30da5c7717d3" class="modal-trigger">modules/tensor_mechanics/test/tests/mean_cap_TC/random01.i</a></li><li><a href="#62e4e418-3697-4aa2-a378-d1ae11402928" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/mandel_fully_saturated_volume.i</a></li><li><a href="#b3fdeb80-6338-4489-a7b9-b18e3fb9bf0a" class="modal-trigger">modules/combined/test/tests/poro_mechanics/borehole_highres.i</a></li><li><a href="#fb97734f-d026-40bb-b6b2-13d7e32c5501" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/terzaghi_basicthm.i</a></li><li><a href="#c78a29ac-ad52-4bb2-94d4-7cb252c50357" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav01a.i</a></li><li><a href="#0e4d6956-42f7-4848-82bd-45f3174c6b71" class="modal-trigger">modules/heat_conduction/test/tests/heat_conduction_ortho/heat_conduction_ortho.i</a></li><li><a href="#32ebe994-6517-466c-8b28-8e63d1e64dee" class="modal-trigger">test/tests/controls/moose_base_naming_access/base_object_param.i</a></li><li><a href="#fe9f3ea5-7119-44c5-b01b-ef06a3a08bc5" class="modal-trigger">modules/tensor_mechanics/test/tests/mohr_coulomb/random.i</a></li><li><a href="#951da0b7-d5a3-4902-b6a9-31cce8b4f32c" class="modal-trigger">modules/tensor_mechanics/test/tests/mean_cap_TC/random02.i</a></li><li><a href="#ca77ee9b-7139-49d5-ad5f-3b76fef88c6a" class="modal-trigger">test/tests/controls/moose_base_naming_access/base_param.i</a></li><li><a href="#85fef5cf-7cd7-4aa8-a8f6-f5f1ab69a97d" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_17.i</a></li><li><a href="#564a6e6b-3626-41f8-8727-e43dc0b0c26f" class="modal-trigger">modules/tensor_mechanics/test/tests/weak_plane_shear/large_deform4.i</a></li><li><a href="#65607b9d-ed3e-4999-97a4-ba74df463050" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except06.i</a></li><li><a href="#869f3028-90ab-4ca8-854c-812d357d5b3d" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/pls02.i</a></li><li><a href="#c5f4d651-f905-47ed-a2e2-d26bac138ea6" class="modal-trigger">modules/porous_flow/test/tests/gravity/fully_saturated_grav01a.i</a></li><li><a href="#6e8ea869-6f7b-4eae-949e-20bc23d3738c" class="modal-trigger">modules/tensor_mechanics/test/tests/ad_viscoplasticity_stress_update/exact.i</a></li><li><a href="#8b75669e-e934-48a9-8771-03ec47cef4fc" class="modal-trigger">modules/tensor_mechanics/test/tests/capped_mohr_coulomb/random4.i</a></li><li><a href="#dc4a319b-d097-4642-b099-bdb63e35b126" class="modal-trigger">modules/tensor_mechanics/test/tests/capped_mohr_coulomb/random1.i</a></li><li><a href="#6f36f147-0458-456f-823e-a2cefd36b722" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh03.i</a></li><li><a href="#58d10b6b-a944-4391-9e29-6c1140479f58" class="modal-trigger">test/tests/kernels/2d_diffusion/2d_diffusion_bodyforce_test.i</a></li><li><a href="#3d7e4015-f169-4924-9b8a-8ddb43177460" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/mandel_basicthm.i</a></li><li><a href="#614cfea5-36ed-42cd-a8ae-3e761959d890" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except08.i</a></li><li><a href="#52091371-da31-4e98-a3ec-6ef994961758" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/pls01.i</a></li><li><a href="#4cb23507-9036-41af-8995-177cdefe8ef9" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh18.i</a></li><li><a href="#66e950bc-17f8-4433-b5d9-636caa44357c" class="modal-trigger">modules/porous_flow/test/tests/sinks/s06.i</a></li><li><a href="#8428c049-17ab-41bd-be3c-00b0164259fc" class="modal-trigger">modules/richards/test/tests/sinks/s01.i</a></li><li><a href="#967a684f-7c53-4d9f-8371-37a54b21b0a9" class="modal-trigger">modules/richards/test/tests/dirac/bh08.i</a></li><li><a href="#11fa38d7-fd6f-448c-856c-97494d34efa7" class="modal-trigger">modules/tensor_mechanics/test/tests/weak_plane_shear/large_deform_harden3.i</a></li><li><a href="#929e5a9f-fbbd-440b-97e8-ea6c19f54bfe" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_18.i</a></li><li><a href="#9eced40d-76dc-48f5-b801-a09b7a91c4b7" class="modal-trigger">modules/richards/test/tests/dirac/bh02.i</a></li><li><a href="#0fd4eb2c-8c0a-41cd-b047-4076ebf39011" class="modal-trigger">test/tests/controls/output/controllable.i</a></li><li><a href="#44ec1c57-96e6-4bf0-8f2e-20267703576b" class="modal-trigger">modules/porous_flow/test/tests/energy_conservation/heat04_fullysat_action.i</a></li><li><a href="#33930eb2-22d6-44a9-8303-b39954f6de2c" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except09.i</a></li><li><a href="#fdb396c1-41a8-466b-a7c4-dffa7d6cdb08" class="modal-trigger">test/tests/controls/syntax_based_naming_access/system_asterisk_param.i</a></li><li><a href="#7e051b28-dbc4-49f8-8997-9a5ffff4f4f1" class="modal-trigger">modules/richards/test/tests/dirac/bh_fu_05.i</a></li><li><a href="#465f50bb-6665-4b74-aee4-d90d425f65f1" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except03.i</a></li><li><a href="#54450029-04b9-454e-af2e-c94426264d6c" class="modal-trigger">modules/porous_flow/test/tests/energy_conservation/heat04_action_KT.i</a></li><li><a href="#e8311200-af79-42ac-9ee0-8cf02815a220" class="modal-trigger">modules/richards/test/tests/excav/ex02.i</a></li><li><a href="#7d4af12a-1f40-4fb6-bee6-a9bb3c9c1236" class="modal-trigger">python/chigger/tests/input/mug_blocks.i</a></li><li><a href="#0c81381a-4195-4741-a7a0-b3bc012ca4e4" class="modal-trigger">modules/tensor_mechanics/test/tests/mohr_coulomb/planar_hard3.i</a></li><li><a href="#7173df4e-ac4d-4be7-9df6-c7a02e2efcc8" class="modal-trigger">modules/richards/test/tests/sinks/s03.i</a></li><li><a href="#6dd0cc7b-6071-42f8-b761-ca0040de9afc" class="modal-trigger">modules/combined/test/tests/ad_cavity_pressure/additional_volume.i</a></li><li><a href="#dbc672eb-0b93-43c1-bbbd-333d95beb617" class="modal-trigger">test/tests/controls/syntax_based_naming_access/object_param.i</a></li><li><a href="#f2063a9a-b124-4286-9d2a-472928404537" class="modal-trigger">modules/richards/test/tests/sinks/s02.i</a></li><li><a href="#61901f19-7edf-439d-a40d-bf346d1a8d21" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/pp_generation_unconfined_fully_saturated_volume.i</a></li><li><a href="#3d34048d-2738-4196-916c-bd167c9719b5" class="modal-trigger">modules/combined/examples/stochastic/graphite_ring_thermomechanics.i</a></li><li><a href="#96493817-b812-4d6a-a09c-e5c4eb304e1a" class="modal-trigger">test/tests/functions/vector_postprocessor_function/vector_postprocessor_function.i</a></li><li><a href="#7db93e65-4617-40e7-9ca8-2fde2730f46f" class="modal-trigger">modules/richards/test/tests/dirac/st01.i</a></li><li><a href="#54c7ad3e-cf98-4dd6-8949-0e3789a1e4b8" class="modal-trigger">modules/porous_flow/test/tests/sinks/s05.i</a></li><li><a href="#c1ff8e67-037c-47de-a152-1a32db2c3d46" class="modal-trigger">modules/porous_flow/test/tests/sinks/s03.i</a></li><li><a href="#ce78c6a0-dbdf-4fee-a176-2ec7802f171a" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_lumped_07.i</a></li><li><a href="#961a8008-dd02-447f-b90a-1544f5adeffa" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except01.i</a></li><li><a href="#15458957-9030-4c56-b413-391cc96c8d25" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh05.i</a></li><li><a href="#f4fcf122-59cf-49b2-9973-df4e860c90b5" class="modal-trigger">modules/tensor_mechanics/test/tests/multi/rock1.i</a></li><li><a href="#61a9a7f6-c592-4529-a486-23639a2ba0df" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except05.i</a></li><li><a href="#c80581a1-2895-43b0-8ebb-be0141da7bac" class="modal-trigger">test/tests/controls/output/controllable_clear.i</a></li><li><a href="#1c9c65ce-36a0-4c0e-b0fa-10b34ff75dfa" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except16.i</a></li><li><a href="#bb115f4b-58e7-43b9-b78f-63f4f1dbe228" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except02.i</a></li><li><a href="#23b3101d-3be0-4bbd-b095-c5ba4d8b06cd" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_bounded_17.i</a></li><li><a href="#5aa2a9ff-3c17-412f-abb1-f5fc0e39dfaa" class="modal-trigger">modules/tensor_mechanics/test/tests/capped_mohr_coulomb/random3.i</a></li><li><a href="#0aa41d74-0a65-4d12-a477-7a55d0923e79" class="modal-trigger">test/tests/controls/syntax_based_naming_access/param.i</a></li><li><a href="#5652c841-b64b-434c-b08e-f261bad67dd9" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh05.i</a></li><li><a href="#8462bd99-208b-4de3-8d20-5da1c1b18f6e" class="modal-trigger">test/tests/controls/syntax_based_naming_access/system_object_param.i</a></li><li><a href="#cbb98e39-ce4e-4239-93a9-c9f86af4ba6b" class="modal-trigger">modules/richards/test/tests/dirac/bh_fu_03.i</a></li><li><a href="#d85f1dd6-18ec-4269-83c5-8ecc17214313" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/mandel.i</a></li><li><a href="#8d0aa926-6ffc-40d7-82e7-9f56a034b56d" class="modal-trigger">modules/richards/test/tests/dirac/bh_fu_04.i</a></li><li><a href="#5fec2da5-e574-400a-ab43-b2de4a4d7ac4" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav01d.i</a></li><li><a href="#88cdeb58-4362-4458-87e9-27a81130f32c" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav01c.i</a></li><li><a href="#5adf82a2-df7d-49ba-a867-c1425c3aab30" class="modal-trigger">modules/porous_flow/test/tests/radioactive_decay/radioactive_decay01.i</a></li><li><a href="#f3c5bc4e-9998-453e-98b4-d9d642a34eca" class="modal-trigger">modules/richards/test/tests/sinks/s05.i</a></li><li><a href="#bca39eda-5b73-4b43-8d98-23754ff63686" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/mandel_constM.i</a></li><li><a href="#31e74016-5f84-4e0f-a192-90f6c1e43363" class="modal-trigger">modules/porous_flow/test/tests/sinks/s08.i</a></li><li><a href="#8367a690-fc4b-422a-b3a5-d54d1e73bd7c" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh16.i</a></li><li><a href="#7ea47746-d1fc-4fcf-97a8-8d1011e543bd" class="modal-trigger">modules/fluid_properties/test/tests/sodium/exact.i</a></li><li><a href="#a3f8d540-7fb3-4cd7-921b-aec8d7ec2c79" class="modal-trigger">modules/porous_flow/test/tests/energy_conservation/heat04.i</a></li><li><a href="#420ec901-d48b-4885-bca6-9a899d873901" class="modal-trigger">modules/richards/test/tests/sinks/s_fu_03.i</a></li><li><a href="#792693f2-e9fa-422c-87e8-4db363794d1d" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav01c_action.i</a></li><li><a href="#60293b94-80ea-45d2-8e84-76917d4a3d60" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh08.i</a></li><li><a href="#4412797b-5e13-43db-b02b-48c86aeb8c44" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/frompps.i</a></li><li><a href="#b91a9620-1f59-460e-8a31-b4e8ade25aa0" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_02.i</a></li><li><a href="#3f0e8c33-8a90-48b8-b06a-ac7709602ab4" class="modal-trigger">modules/porous_flow/examples/lava_lamp/1phase_convection.i</a></li><li><a href="#6260c296-20a4-4e1e-b67c-c2c889ba01ae" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/terzaghi_constM.i</a></li><li><a href="#655c2a1c-6379-4e6c-a2fe-3c11ed838ee4" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh02.i</a></li><li><a href="#394c4f2d-18c9-42c4-9050-5f3f22254364" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav02c.i</a></li><li><a href="#7efb0f59-f6a6-4956-bb86-e47c99391ba4" class="modal-trigger">modules/richards/test/tests/dirac/bh_fu_02.i</a></li><li><a href="#1c31fecc-87c1-4502-a0d3-ea54d8884447" class="modal-trigger">modules/richards/test/tests/dirac/bh03.i</a></li><li><a href="#e83881a6-2d94-460d-9870-cb785c9d81d4" class="modal-trigger">modules/phase_field/examples/measure_interface_energy/1Dinterface_energy.i</a></li><li><a href="#3f8cfe87-6e59-4224-aad3-fad8b9ef1d78" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav01b.i</a></li><li><a href="#432b5e1e-289d-4885-af55-6b48de0b2f85" class="modal-trigger">test/tests/kernels/ad_2d_diffusion/2d_diffusion_bodyforce_test.i</a></li><li><a href="#29a4c980-c952-4b4b-b27b-12f989629abb" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except12.i</a></li><li><a href="#ffa867cf-b236-4e0d-a63d-2a3478183cae" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except13.i</a></li><li><a href="#e105d1bc-21b6-4bfd-bf3e-8c0f776e0411" class="modal-trigger">modules/porous_flow/test/tests/sinks/s07.i</a></li><li><a href="#d20059fe-bbcc-41f7-99ee-52dfcea4c730" class="modal-trigger">modules/chemical_reactions/test/tests/desorption/mollified_langmuir_desorption.i</a></li><li><a href="#74a81db9-d169-42eb-818c-ed69045cac82" class="modal-trigger">modules/tensor_mechanics/test/tests/mean_cap_TC/random03.i</a></li><li><a href="#10f4eac8-c3d6-496c-a301-2dac6930080f" class="modal-trigger">test/tests/postprocessors/geometry/2d_geometry.i</a></li><li><a href="#68673489-7059-42d1-880c-7482a5c480bf" class="modal-trigger">modules/richards/test/tests/dirac/bh04.i</a></li><li><a href="#87be9796-3655-4c1f-85a2-9fc0dc19ef17" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh01.i</a></li><li><a href="#ddf9700a-f648-4c14-9ebb-e3cb4d4da8d6" class="modal-trigger">test/tests/postprocessors/function_value_pps/function_value_pps.i</a></li><li><a href="#bf39309c-572f-419e-a8ee-fb58b37a4dfd" class="modal-trigger">modules/combined/test/tests/poro_mechanics/borehole_lowres.i</a></li><li><a href="#e1dbba57-82ff-4885-a3f7-eb5209f42652" class="modal-trigger">examples/ex18_scalar_kernel/ex18_parsed.i</a></li><li><a href="#60b0703a-fe79-47f4-b53e-cc412345700b" class="modal-trigger">modules/tensor_mechanics/test/tests/rom_stress_update/verification.i</a></li><li><a href="#86b8ffb9-ae37-4161-ae1c-bb691429ec0c" class="modal-trigger">examples/ex18_scalar_kernel/ex18.i</a></li><li><a href="#9c48a23d-53a9-48a5-a314-782cc3cd912f" class="modal-trigger">modules/combined/examples/phase_field-mechanics/kks_mechanics_KHS.i</a></li><li><a href="#ff05e4d9-00bf-4964-a952-7eeb4d860eb0" class="modal-trigger">test/tests/time_steppers/iteration_adaptive/adapt_tstep_pps_lim.i</a></li><li><a href="#b67cf2e6-dfbb-4778-a933-611eae228ab6" class="modal-trigger">test/tests/functions/vector_postprocessor_function/vpp_time_interpolation.i</a></li><li><a href="#4ada25a0-4a95-4826-a8f3-37b6cd15e088" class="modal-trigger">modules/tensor_mechanics/test/tests/tensile/random_update.i</a></li><li><a href="#1ecfb1c5-314b-43b7-b706-02fe4f4cf280" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh04.i</a></li><li><a href="#3d9c24e3-8f5d-4d1b-b5b7-971b8ae62ff1" class="modal-trigger">test/tests/kernels/ode/ode_sys_impl_test.i</a></li><li><a href="#b5c2b8eb-e53e-40be-9f11-1191898c318a" class="modal-trigger">modules/tensor_mechanics/test/tests/capped_drucker_prager/random.i</a></li><li><a href="#9a3135fa-1c11-42f6-a42c-08441d437923" class="modal-trigger">modules/combined/test/tests/poro_mechanics/mandel.i</a></li><li><a href="#406c56ce-19fe-4bbb-98ed-e5690b8b7891" class="modal-trigger">test/tests/time_integrators/explicit_ssp_runge_kutta/explicit_ssp_runge_kutta.i</a></li><li><a href="#5664bdbd-7258-445e-98a3-f047f2250597" class="modal-trigger">modules/fluid_properties/test/tests/functions/saturation_pressure_function/saturation_pressure_function.i</a></li><li><a href="#41adbce5-8843-4346-9e04-3b80d8fe2b15" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/pp_generation_unconfined_fully_saturated.i</a></li><li><a href="#521fa31f-53f9-4267-8d60-999a99c79dc7" class="modal-trigger">modules/tensor_mechanics/test/tests/mohr_coulomb/many_deforms_cap.i</a></li><li><a href="#b6eaf3ed-34b6-411e-b739-2ac5bba4b28e" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh17.i</a></li><li><a href="#3a2b88c4-de95-42a6-9e62-c47c6fbdd31a" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav02b.i</a></li><li><a href="#47c0a376-28c7-4c31-b0e6-246bf8c4d614" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_01.i</a></li><li><a href="#acdc96e7-41b2-4243-a5c9-61d0e76c04fb" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/terzaghi_fully_saturated_volume.i</a></li><li><a href="#77330e6d-fcc2-42c3-8b44-3b897a752bb9" class="modal-trigger">modules/tensor_mechanics/test/tests/mean_cap/random.i</a></li><li><a href="#f3914cfc-aab3-46ac-9689-593ba10f9663" class="modal-trigger">modules/tensor_mechanics/test/tests/mohr_coulomb/random_planar.i</a></li><li><a href="#5ea12dd8-64f1-4415-a943-0f0577679977" class="modal-trigger">test/tests/controls/tag_based_naming_access/system_object_param.i</a></li><li><a href="#bf75fd3b-1f90-4e08-ab1b-a8dafbdf2cc4" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/pp_generation.i</a></li><li><a href="#1d75ecec-f630-48d3-a1de-1dc8bf0f2565" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/pls03.i</a></li><li><a href="#81ddcfdf-a798-45b9-b56e-e466b7767ee2" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except15.i</a></li><li><a href="#f377561b-597d-4ecd-a544-1d27aef40aa3" class="modal-trigger">modules/porous_flow/test/tests/sinks/s02.i</a></li><li><a href="#521aaf68-364d-44e5-92b9-a5e13a471c37" class="modal-trigger">modules/porous_flow/test/tests/sinks/s04.i</a></li><li><a href="#728110b6-2b04-40a6-b7d0-ca082f03df38" class="modal-trigger">test/tests/multiapps/initial_transfer/master.i</a></li><li><a href="#c9c3272b-6d51-4acd-851a-d7977b115403" class="modal-trigger">modules/porous_flow/test/tests/gravity/fully_saturated_grav01c.i</a></li><li><a href="#cbb57dc1-2d8d-487a-966d-1f54d847399b" class="modal-trigger">test/tests/controls/tag_based_naming_access/object_param.i</a></li><li><a href="#7355a448-fdb3-4b8c-99ed-c469f7005af5" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except04.i</a></li><li><a href="#2c2276cf-7870-461f-968c-f013604f189c" class="modal-trigger">test/tests/controls/tag_based_naming_access/system_asterisk_param.i</a></li><li><a href="#8ebd9e62-9b34-454e-b38a-9400c3c51212" class="modal-trigger">test/tests/functions/parsed/mms_transient_coupled.i</a></li><li><a href="#f284db1e-54ba-48ed-a03b-d4c2d9244513" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh_except11.i</a></li><li><a href="#6d63c3d9-fc21-45d6-a8f2-e3dac52e5898" class="modal-trigger">modules/tensor_mechanics/test/tests/weak_plane_shear/small_deform3.i</a></li><li><a href="#d40cf410-0f6a-4886-a14f-fbb02cdf1a14" class="modal-trigger">modules/porous_flow/test/tests/poro_elasticity/pp_generation_unconfined.i</a></li><li><a href="#de053dbf-97f8-4851-99ed-b7d9cb773464" class="modal-trigger">modules/tensor_mechanics/test/tests/ad_viscoplasticity_stress_update/lps_single_split.i</a></li></ul><div class="modal moose-modal" id="77f66a29-0d22-4d54-8a3c-6961ddb67a25"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/fully_saturated_grav01b.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established
# 1phase, constant and large fluid-bulk, constant viscosity, constant permeability
# fully saturated with fully-saturated Kernel
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = RandomIC
      min = 0
      max = 1
    [../]
  [../]
[]

[Kernels]
  [./flux0]
    type = PorousFlowFullySaturatedDarcyBase
    variable = pp
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_pp]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 1E3 0 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[BCs]
  [./z]
    type = DirichletBC
    variable = pp
    boundary = right
    value = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1e3
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
[]

[Postprocessors]
  [./pp_base]
    type = PointValue
    variable = pp
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_analytical]
    type = FunctionValuePostprocessor
    function = ana_pp
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = fully_saturated_grav01b
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="436b26ca-ac74-4006-91ee-16150cd1f15c"><div class="modal-content"><h4>test/tests/time_steppers/iteration_adaptive/adapt_tstep_reject_large_dt.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 50
  ny = 2
  xmax = 5
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Functions]
  [./timestep_fn]
    type = PiecewiseConstant
    x = &#x27;0.   10.0&#x27;
    y = &#x27;10.0 1.0&#x27;
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./dt]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 10
  [../]
  [./right]
    type = NeumannBC
    variable = u
    boundary = right
    value = -1
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  start_time = 0.0
  end_time = 12.0
  dtmax = 10.0
  dtmin = 0.1
  [./TimeStepper]
    type = IterationAdaptiveDT
    timestep_limiting_postprocessor = timestep_pp
    reject_large_step = true
    reject_large_step_threshold = 0.5
    dt = 3.0
    growth_factor = 1.0
  [../]
[]

[Postprocessors]
  [./_dt]
    type = TimestepSize
  [../]

# Just use a simple postprocessor to test capability to limit the time step length to the postprocessor value
  [./timestep_pp]
    type = FunctionValuePostprocessor
    function = timestep_fn
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
  checkpoint = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1c620149-7a70-4386-8ddf-d52457b3828d"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_lumped_18.i</h4><pre class="moose-pre"><code class="language-text"># with immobile saturation
# unsaturated = true
# gravity = true
# supg = true
# transient = true
# lumped = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 0.5E-3&#x27;
  gravity = &#x27;-1 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 0.5E1 0.5E2 0.4E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.4
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh_lumped_18
  execute_on = &#x27;timestep_end final&#x27;
  interval = 100000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7869ebcf-d2c7-4b8d-b7cd-614717865913"><div class="modal-content"><h4>test/tests/auxkernels/pp_depend/pp_depend.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
[]

[AuxVariables]
  [./pp_aux]
  [../]
[]

[Functions]
  [./t_func]
    type = ParsedFunction
    value = t
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.01
  [../]
[]

[AuxKernels]
  [./pp_aux]
    type = PostprocessorAux
    variable = pp_aux
    execute_on = timestep_end
    pp = t_pp
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Postprocessors]
  [./t_pp]
    type = FunctionValuePostprocessor
    function = t_func
  [../]
[]

[Problem]
  type = FEProblem
  solve = false
[]

[Executioner]
  type = Transient
  solve_type = PJFNK
  dt = 1
  num_steps = 5
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e346e7ea-8df4-4d33-b936-8792d7b8d1ee"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except07.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02.bh
    use_mobility = true
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="38331b3e-58eb-4ede-9e52-b94b0164fafa"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_lumped_08.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = true
# transient = true
# lumped = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 0.5E-3&#x27;
  gravity = &#x27;-1 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_lumped_08
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3c4abf36-1c8b-4eb3-98e1-30b6de62c50f"><div class="modal-content"><h4>test/tests/parser/param_substitution/unit_conversion.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 1
[]

[Variables]
  [./u]
  [../]
[]

[Problem]
  kernel_coverage_check = false
  solve = false
[]

[Executioner]
  type = Steady
[]

[Postprocessors]
  [./km_to_m]
    type = FunctionValuePostprocessor
    function = ${units 1 km -&gt; m}
  [../]
  [./Jmol_to_eVat]
    type = FunctionValuePostprocessor
    function = ${units 1 J/mol -&gt; eV/at}
  [../]
  [./mW]
    type = FunctionValuePostprocessor
    function = ${units 3 mW}
  [../]
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1ac58505-31df-4e31-a909-baf17471bf39"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh09.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
# with anisotropic permeability
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;2E-12 1E-12 0  1E-12 2E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON

[]

[Outputs]
  file_base = bh09
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2fc7e8d5-ffa3-4d55-a2ce-f51a9b684534"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/rom_stress_update/lower_limit.i</h4><pre class="moose-pre"><code class="language-text">temp = 800.0160634
disp = 1.0053264195e6

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[AuxVariables]
  [./temperature]
    initial_condition = ${temp}
  [../]
[]

[Functions]
  [./temp_weight]
    type = ParsedFunction
    vars = &#x27;lower_limit avg&#x27;
    vals = &#x27;800.0160634 temp_avg&#x27;
    value = &#x27;val := 2 * avg / lower_limit - 1;
             clamped := if(val &lt;= -1, -0.99999, if(val &gt;= 1, 0.99999, val));
             plus := exp(-2 / (1 + clamped));
             minus := exp(-2 / (1 - clamped));
             plus / (plus + minus)&#x27;
  [../]
  [./stress_weight]
    type = ParsedFunction
    vars = &#x27;lower_limit avg&#x27;
    vals = &#x27;2.010652839e6 vonmises_stress&#x27;
    value = &#x27;val := 2 * avg / lower_limit - 1;
             clamped := if(val &lt;= -1, -0.99999, if(val &gt;= 1, 0.99999, val));
             plus := exp(-2 / (1 + clamped));
             minus := exp(-2 / (1 - clamped));
             plus / (plus + minus)&#x27;
  [../]
  [./creep_rate_exact]
    type = ParsedFunction
    vars = &#x27;lower_limit_strain temp_weight stress_weight&#x27;
    vals = &#x27;3.370764e-12       temp_weight stress_weight&#x27;
    value = &#x27;lower_limit_strain * temp_weight * stress_weight&#x27;
  [../]
[]

[Modules/TensorMechanics/Master]
  [./all]
    strain = FINITE
    add_variables = true
    use_automatic_differentiation = true
    generate_output = vonmises_stress
  [../]
[]

[BCs]
  [./symmy]
    type = ADDirichletBC
    variable = disp_y
    boundary = bottom
    value = 0
  [../]
  [./symmx]
    type = ADDirichletBC
    variable = disp_x
    boundary = left
    value = 0
  [../]
  [./symmz]
    type = ADDirichletBC
    variable = disp_z
    boundary = back
    value = 0
  [../]
  [./pressure_x]
    type = ADPressure
    variable = disp_x
    component = 0
    boundary = right
    constant = ${disp}
  [../]
  [./pressure_y]
    type = ADPressure
    variable = disp_y
    component = 1
    boundary = top
    constant = -${disp}
  [../]
  [./pressure_z]
    type = ADPressure
    variable = disp_z
    component = 2
    boundary = front
    constant = -${disp}
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 3.30e11
    poissons_ratio = 0.3
  [../]
  [./stress]
    type = ADComputeMultipleInelasticStress
    inelastic_models = rom_stress_prediction
  [../]
  [./rom_stress_prediction]
    type = SS316HLAROMANCEStressUpdateTest
    temperature = temperature
    initial_cell_dislocation_density = 6.0e12
    initial_wall_dislocation_density = 4.4e11
    outputs = all
    apply_strain = false
  [../]
[]

[Executioner]
  type = Transient

  solve_type = &#x27;NEWTON&#x27;

  nl_abs_tol = 1e-12
  automatic_scaling = true
  compute_scaling_once = false

  num_steps = 1
  dt = 1e5
[]

[Postprocessors]
  [./creep_rate_exact]
    type = FunctionValuePostprocessor
    function = creep_rate_exact
  [../]
  [./creep_rate_avg]
    type = ElementAverageValue
    variable = creep_rate
  [../]
  [./creep_rate_diff]
    type = DifferencePostprocessor
    value1 = creep_rate_exact
    value2 = creep_rate_avg
  [../]
  [./temp_avg]
    type = ElementAverageValue
    variable = temperature
  [../]
  [./cell_dislocations]
    type = ElementAverageValue
    variable = cell_dislocations
  [../]
  [./wall_disloactions]
    type = ElementAverageValue
    variable = wall_dislocations
  [../]
  [./vonmises_stress]
    type = ElementAverageValue
    variable = vonmises_stress
  [../]
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b86e8f4c-12ce-47a6-b4ff-7ae1e6e50fb0"><div class="modal-content"><h4>modules/ray_tracing/test/tests/ray_kernels/line_source_ray_kernel/line_source_ray_kernel.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 5
  ny = 5
  xmax = 5
  ymax = 5
[]

[Variables/u]
  order = FIRST
  family = LAGRANGE
[]

[BCs/zero]
  type = DirichletBC
  variable = u
  value = 0
  boundary = &#x27;top right bottom left&#x27;
[]

[Kernels/diffusion]
  type = Diffusion
  variable = u
[]

[Postprocessors/postprocessor]
  type = FunctionValuePostprocessor
  function = 3
  execute_on = initial
[]

[RayKernels]
  [constant_source]
    type = LineSourceRayKernel
    variable = u
    value = 5
    rays = constant_source
  []
  [pp_source]
    type = LineSourceRayKernel
    variable = u
    postprocessor = postprocessor
    rays = pp_source
  []
  [function_source]
    type = LineSourceRayKernel
    variable = u
    function = &#x27;x + 2 * y&#x27;
    rays = function_source
  []
  [mixed_source]
    type = LineSourceRayKernel
    variable = u
    value = 5
    postprocessor = postprocessor
    function = &#x27;x + 2 * y&#x27;
    rays = mixed_source
  []
[]

[UserObjects/study]
  type = RepeatableRayStudy
  start_points = &#x27;0 2 0
                  0.5 0.5 0
                  1 1 0
                  5 5 0&#x27;
  end_points = &#x27;3 5 0
                4.5 1.5 0
                2 2 0
                4 1 0&#x27;
  names = &#x27;constant_source
           pp_source
           function_source
           mixed_source&#x27;
  execute_on = PRE_KERNELS
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="53ad9a2d-b071-49f2-9a3b-e296e24bd6e8"><div class="modal-content"><h4>test/tests/postprocessors/execute_on_final/execute_on_final.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 1
[]

[Problem]
  solve = false
[]

[Executioner]
  type = Transient
  dt = 1
  num_steps = 4
[]

[Functions]
  [func]
    type = ConstantFunction
    value = 5
  []
[]

[Postprocessors]
  [timestep_end]
    type = FunctionValuePostprocessor
    function = &#x27;t&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  []
  [final]
    type = FunctionValuePostprocessor
    function = &#x27;2*t&#x27;
    execute_on = &#x27;final&#x27;
  []
[]

[Outputs]
  csv = true
  [on_final]
    type = CSV
    execute_on = final
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b9c4dd18-031e-4e12-bc2d-3a1419fd628c"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/tensile/random_smoothed.i</h4><pre class="moose-pre"><code class="language-text"># Plasticity models:
# Smoothed tensile with strength = 1MPa
#
# Lame lambda = 1GPa.  Lame mu = 1.3GPa
#
# A line of elements is perturbed randomly, and return to the yield surface at each quadpoint is checked

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 1234
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 1234
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Modules/TensorMechanics/Master]
  [./all]
    add_variables = true
    incremental = true
    strain = finite
    generate_output = &#x27;stress_xx stress_xy stress_xz stress_yy stress_yz stress_zz&#x27;
  [../]
[]

[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./f0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./f0]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = f0
  [../]
  [./int0]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    factor = 1E6
    index = 0
    variable = int0
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./tot_iters]
    type = ElementIntegralMaterialProperty
    mat_prop = plastic_NR_iterations
    outputs = console
  [../]
  [./raw_f0]
    type = ElementExtremeValue
    variable = f0
    outputs = console
  [../]
  [./iter]
    type = ElementExtremeValue
    variable = iter
    outputs = console
  [../]
  [./f0]
    type = FunctionValuePostprocessor
    function = should_be_zero0_fcn
  [../]
[]

[Functions]
  [./should_be_zero0_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f0&#x27;
  [../]
[]

[UserObjects]
  [./ts]
    type = TensorMechanicsHardeningConstant
    value = 1E6
  [../]
  [./tensile]
    type = TensorMechanicsPlasticTensile
    tensile_strength = ts
    tensile_tip_smoother = 1E5
    yield_function_tolerance = 1.0E-1
    internal_constraint_tolerance = 1.0E-7
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;1E9 1.3E9&#x27;
  [../]
  [./multi]
    type = ComputeMultiPlasticityStress
    block = 0
    ep_plastic_tolerance = 1E-7
    plastic_models = &#x27;tensile&#x27;
    max_NR_iterations = 20
    min_stepsize = 1E-4
    max_stepsize_for_dumb = 1E-3
    debug_fspb = crash
    debug_jac_at_stress = &#x27;10 0 0 0 10 0 0 0 10&#x27;
    debug_jac_at_pm = &#x27;1 1 1 1&#x27;
    debug_jac_at_intnl = &#x27;1 1 1 1&#x27;
    debug_stress_change = 1E1
    debug_pm_change = &#x27;1E-6 1E-6 1E-6 1E-6&#x27;
    debug_intnl_change = &#x27;1E-6 1E-6 1E-6 1E-6&#x27;
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random_smoothed
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="08752c3f-a28a-46df-99d3-d210ee6dbe79"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except10.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
    compute_internal_energy = false
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02.bh
    use_mobility = true
    use_internal_energy = true
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="154689b3-6fb8-4bdb-bb83-bb1601c0f13a"><div class="modal-content"><h4>test/tests/userobjects/postprocessor_spatial_user_object/sub.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 1
  xmin = -0.01
  xmax = 0.01
[]

[Functions]
  [./fn]
    type = ParsedFunction
    value = &#x27;if(a &lt; 0.8625, 1, 0)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;a_avg&#x27;
  [../]
[]

[Variables]
  [./u]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxVariables]
  [./a]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[Kernels]
  [./td]
    type = TimeDerivative
    variable = u
  [../]
  [./rhs]
    type = BodyForce
    variable = u
    function = 1
  [../]
[]

[Postprocessors]
  [./fn_pps]
    type = FunctionValuePostprocessor
    function = fn
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./a_avg]
    type = ElementAverageValue
    variable = a
  [../]
[]

[UserObjects]
  [./fn_uo]
    type = PostprocessorSpatialUserObject
    postprocessor = fn_pps
  [../]
[]

[Executioner]
  type = Transient
  dt = 0.1
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9058af27-a90e-484f-b993-025d013cfa80"><div class="modal-content"><h4>modules/fluid_properties/test/tests/functions/saturation_temperature_function/saturation_temperature_function.i</h4><pre class="moose-pre"><code class="language-text"># TestTwoPhaseFluidProperties has the following saturation temperature function:
#   T_sat(p) = 2 p
# Thus for p = 5, T_sat should be 10.

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 1
[]

[Modules]
  [./FluidProperties]
    [./fp_liquid]
      type = IdealGasFluidProperties
    [../]
    [./fp_vapor]
      type = IdealGasFluidProperties
    [../]
    [./fp_2phase]
      type = TestTwoPhaseFluidProperties
      fp_liquid = fp_liquid
      fp_vapor = fp_vapor
    [../]
  []
[]

[Functions]
  [./p]
    type = ConstantFunction
    value = 5
  [../]
  [./T_sat]
    type = SaturationTemperatureFunction
    p = p
    fp_2phase = fp_2phase
  [../]
[]

[Postprocessors]
  [./T_sat_pp]
    type = FunctionValuePostprocessor
    function = T_sat
    execute_on = &#x27;INITIAL&#x27;
  [../]
[]

[Problem]
  solve = false
[]

[Executioner]
  type = Steady
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="42cf6662-f511-463c-a26a-b041483f3f25"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mean_cap_TC/random04.i</h4><pre class="moose-pre"><code class="language-text"># apply many random large deformations, checking that the algorithm returns correctly to
# the yield surface each time.
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 125
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 125
  zmin = 0
  zmax = 1
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./max_yield_fcn]
    type = ElementExtremeValue
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./av_iter]
    type = ElementAverageValue
    variable = iter
    outputs = &#x27;console&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;max_yield_fcn&#x27;
  [../]
[]

[UserObjects]
  [./tensile_strength]
    type = TensorMechanicsHardeningCubic
    value_0 = 1
    value_residual = 0.1
    internal_limit = 0.1
  [../]
  [./compressive_strength]
    type = TensorMechanicsHardeningCubic
    value_0 = -1.5
    value_residual = 0
    internal_limit = 0.1
  [../]
  [./cap]
    type = TensorMechanicsPlasticMeanCapTC
    tensile_strength = tensile_strength
    compressive_strength = compressive_strength
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-9
    use_custom_returnMap = true
    use_custom_cto = true
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0.7E7 1E7&#x27;
  [../]
  [./strain]
    type = ComputeIncrementalSmallStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    max_NR_iterations = 2
    ep_plastic_tolerance = 1E-6
    plastic_models = cap
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random04
  exodus = false
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="db82ee2e-9dfd-47b7-82bb-cffebb94e529"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/11.i</h4><pre class="moose-pre"><code class="language-text"># Two-phase borehole injection problem
[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 10
    rmin = 1.0
    rmax = 10
    growth_r = 1.4
    nt = 4
    dmin = 0
    dmax = 90
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    extrusion_vector = &#x27;0 0 12&#x27;
    num_layers = 3
    bottom_sideset = &#x27;bottom&#x27;
    top_sideset = &#x27;top&#x27;
  [../]
  [./shift_down]
    type = TransformGenerator
    transform = TRANSLATE
    vector_value = &#x27;0 0 -6&#x27;
    input = make3D
  [../]
  [./aquifer]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 -2&#x27;
    top_right = &#x27;10 10 2&#x27;
    input = shift_down
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x*x+y*y&lt;1.01&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pwater pgas T disp_x disp_y&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    alpha = 1E-6
    m = 0.6
  [../]
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  gravity = &#x27;0 0 0&#x27;
  biot_coefficient = 1.0
  PorousFlowDictator = dictator
[]

[Variables]
  [./pwater]
    initial_condition = 20E6
  [../]
  [./pgas]
    initial_condition = 20.1E6
  [../]
  [./T]
    initial_condition = 330
    scaling = 1E-5
  [../]
  [./disp_x]
    scaling = 1E-5
  [../]
  [./disp_y]
    scaling = 1E-5
  [../]
[]

[Kernels]
  [./mass_water_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./flux_water]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./vol_strain_rate_water]
    type = PorousFlowMassVolumetricExpansion
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./mass_co2_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    use_displaced_mesh = false
    variable = pgas
  [../]
  [./flux_co2]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    use_displaced_mesh = false
    variable = pgas
  [../]
  [./vol_strain_rate_co2]
    type = PorousFlowMassVolumetricExpansion
    fluid_component = 1
    use_displaced_mesh = false
    variable = pgas
  [../]
  [./energy_dot]
    type = PorousFlowEnergyTimeDerivative
    use_displaced_mesh = false
    variable = T
  [../]
  [./advection]
    type = PorousFlowHeatAdvection
    use_displaced_mesh = false
    variable = T
  [../]
  [./conduction]
    type = PorousFlowHeatConduction
    use_displaced_mesh = false
    variable = T
  [../]
  [./vol_strain_rate_heat]
    type = PorousFlowHeatVolumetricExpansion
    use_displaced_mesh = false
    variable = T
  [../]
  [./grad_stress_x]
    type = StressDivergenceTensors
    temperature = T
    variable = disp_x
    eigenstrain_names = thermal_contribution
    use_displaced_mesh = false
    component = 0
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    variable = disp_x
    use_displaced_mesh = false
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    temperature = T
    variable = disp_y
    eigenstrain_names = thermal_contribution
    use_displaced_mesh = false
    component = 1
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    variable = disp_y
    use_displaced_mesh = false
    component = 1
  [../]
[]

[AuxVariables]
  [./disp_z]
  [../]
  [./effective_fluid_pressure]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./mass_frac_phase0_species0]
    initial_condition = 1 # all water in phase=0
  [../]
  [./mass_frac_phase1_species0]
    initial_condition = 0 # no water in phase=1
  [../]
  [./sgas]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./swater]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_rr]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_tt]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./porosity]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./effective_fluid_pressure]
    type = ParsedAux
    args = &#x27;pwater pgas swater sgas&#x27;
    function = &#x27;pwater * swater + pgas * sgas&#x27;
    variable = effective_fluid_pressure
  [../]
  [./swater]
    type = PorousFlowPropertyAux
    variable = swater
    property = saturation
    phase = 0
    execute_on = timestep_end
  [../]
  [./sgas]
    type = PorousFlowPropertyAux
    variable = sgas
    property = saturation
    phase = 1
    execute_on = timestep_end
  [../]
  [./stress_rr]
    type = RankTwoScalarAux
    variable = stress_rr
    rank_two_tensor = stress
    scalar_type = RadialStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
    execute_on = timestep_end
  [../]
  [./stress_tt]
    type = RankTwoScalarAux
    variable = stress_tt
    rank_two_tensor = stress
    scalar_type = HoopStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
    execute_on = timestep_end
  [../]
  [./stress_zz]
    type = RankTwoAux
    variable = stress_zz
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    execute_on = timestep_end
  [../]
  [./porosity]
    type = PorousFlowPropertyAux
    variable = porosity
    property = porosity
    execute_on = timestep_end
  [../]
[]


[BCs]
  [./roller_tmax]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = dmax
  [../]
  [./roller_tmin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = dmin
  [../]
  [./pinned_top_bottom_x]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./pinned_top_bottom_y]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./cavity_pressure_x]
    type = Pressure
    boundary = injection_area
    variable = disp_x
    component = 0
    postprocessor = constrained_effective_fluid_pressure_at_wellbore
    use_displaced_mesh = false
  [../]
  [./cavity_pressure_y]
    type = Pressure
    boundary = injection_area
    variable = disp_y
    component = 1
    postprocessor = constrained_effective_fluid_pressure_at_wellbore
    use_displaced_mesh = false
  [../]

  [./cold_co2]
    type = DirichletBC
    boundary = injection_area
    variable = T
    value = 290  # injection temperature
    use_displaced_mesh = false
  [../]
  [./constant_co2_injection]
    type = PorousFlowSink
    boundary = injection_area
    variable = pgas
    fluid_phase = 1
    flux_function = -1E-4
    use_displaced_mesh = false
  [../]

  [./outer_water_removal]
    type = PorousFlowPiecewiseLinearSink
    boundary = rmax
    variable = pwater
    fluid_phase = 0
    pt_vals = &#x27;0 1E9&#x27;
    multipliers = &#x27;0 1E8&#x27;
    PT_shift = 20E6
    use_mobility = true
    use_relperm = true
    use_displaced_mesh = false
  [../]
  [./outer_co2_removal]
    type = PorousFlowPiecewiseLinearSink
    boundary = rmax
    variable = pgas
    fluid_phase = 1
    pt_vals = &#x27;0 1E9&#x27;
    multipliers = &#x27;0 1E8&#x27;
    PT_shift = 20.1E6
    use_mobility = true
    use_relperm = true
    use_displaced_mesh = false
  [../]
[]

[Modules]
  [./FluidProperties]
    [./true_water]
      type = Water97FluidProperties
    [../]
    [./tabulated_water]
      type = TabulatedFluidProperties
      fp = true_water
      temperature_min = 275
      pressure_max = 1E8
      interpolated_properties = &#x27;density viscosity enthalpy internal_energy&#x27;
      fluid_property_file = water97_tabulated_11.csv
    [../]
    [./true_co2]
      type = CO2FluidProperties
    [../]
    [./tabulated_co2]
      type = TabulatedFluidProperties
      fp = true_co2
      temperature_min = 275
      pressure_max = 1E8
      interpolated_properties = &#x27;density viscosity enthalpy internal_energy&#x27;
      fluid_property_file = co2_tabulated_11.csv
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = T
  [../]
  [./saturation_calculator]
    type = PorousFlow2PhasePP
    phase0_porepressure = pwater
    phase1_porepressure = pgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;mass_frac_phase0_species0 mass_frac_phase1_species0&#x27;
  [../]
  [./water]
    type = PorousFlowSingleComponentFluid
    fp = tabulated_water
    phase = 0
  [../]
  [./co2]
    type = PorousFlowSingleComponentFluid
    fp = tabulated_co2
    phase = 1
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 4
    s_res = 0.1
    sum_s_res = 0.2
    phase = 0
  [../]
  [./relperm_co2]
    type = PorousFlowRelativePermeabilityBC
    nw_phase = true
    lambda = 2
    s_res = 0.1
    sum_s_res = 0.2
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosity
    fluid = true
    mechanical = true
    thermal = true
    porosity_zero = 0.1
    reference_temperature = 330
    reference_porepressure = 20E6
    thermal_expansion_coeff = 15E-6 # volumetric
    solid_bulk = 8E9 # unimportant since biot = 1
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityKozenyCarman
    block = aquifer
    poroperm_function = kozeny_carman_phi0
    phi0 = 0.1
    n = 2
    m = 2
    k0 = 1E-12
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityKozenyCarman
    block = caps
    poroperm_function = kozeny_carman_phi0
    phi0 = 0.1
    n = 2
    m = 2
    k0 = 1E-15
    k_anisotropy = &#x27;1 0 0  0 1 0  0 0 0.1&#x27;
  [../]
  [./rock_thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;2 0 0  0 2 0  0 0 2&#x27;
  [../]
  [./rock_internal_energy]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 1100
    density = 2300
  [../]

  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 5E9
    poissons_ratio = 0.0
  [../]
  [./strain]
    type = ComputeSmallStrain
    eigenstrain_names = &#x27;thermal_contribution initial_stress&#x27;
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = T
    thermal_expansion_coeff = 5E-6 # this is the linear thermal expansion coefficient
    eigenstrain_name = thermal_contribution
    stress_free_temperature = 330
  [../]
  [./initial_strain]
    type = ComputeEigenstrainFromInitialStress
    initial_stress = &#x27;20E6 0 0  0 20E6 0  0 0 20E6&#x27;
    eigenstrain_name = initial_stress
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]

  [./effective_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./volumetric_strain]
    type = PorousFlowVolumetricStrain
  [../]
[]

[Postprocessors]
  [./effective_fluid_pressure_at_wellbore]
    type = PointValue
    variable = effective_fluid_pressure
    point = &#x27;1 0 0&#x27;
    execute_on = timestep_begin
    use_displaced_mesh = false
  [../]
  [./constrained_effective_fluid_pressure_at_wellbore]
    type = FunctionValuePostprocessor
    function = constrain_effective_fluid_pressure
    execute_on = timestep_begin
  [../]
[]

[Functions]
  [./constrain_effective_fluid_pressure]
    type = ParsedFunction
    vars = effective_fluid_pressure_at_wellbore
    vals = effective_fluid_pressure_at_wellbore
    value = &#x27;max(effective_fluid_pressure_at_wellbore, 20E6)&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1E3
    growth_factor = 1.2
    optimal_iterations = 10
  [../]
  nl_abs_tol = 1E-7
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="fbcc2062-f6d7-460f-9521-f01db8f19f8e"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except14.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02_huge.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d9d1e785-1cb4-4cda-a3b4-6ae5426da60b"><div class="modal-content"><h4>python/chigger/tests/simple/mug_blocks.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = FileMesh
  file = mug.e
[]

[MeshModifiers]
  [./subdomains]
    type = SubdomainBoundingBox
    top_right = &#x27;3 3 3&#x27;
    bottom_left = &#x27;0 -3 -2.1&#x27;
    block_id = &#x27;76&#x27;
  [../]
[]

[Variables]
  [./convected]
    order = FIRST
    family = LAGRANGE
  [../]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./aux_elem]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[Kernels]
  [./diff_convected]
    type = Diffusion
    variable = convected
  [../]
  [./conv]
    # Couple a variable into the convection kernel using local_name = simulationg_name syntax
    type = Convection
    variable = convected
    velocity = &#x27;1 1 1&#x27;
  [../]
  [./diff_diffused]
    type = Diffusion
    variable = diffused
  [../]
  [./diff_t]
    type = TimeDerivative
    variable = diffused
  [../]
  [./conv_t]
    type = TimeDerivative
    variable = convected
    block = &#x27;76&#x27;
  [../]
[]

[BCs]
  [./bottom_convected]
    type = DirichletBC
    variable = convected
    boundary = bottom
    value = 1
  [../]
  [./top_convected]
    type = DirichletBC
    variable = convected
    boundary = top
    value = 0
  [../]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = bottom
    value = 2
  [../]
  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = top
    value = 0
  [../]
[]

[Postprocessors]
  [./func_pp]
    type = FunctionValuePostprocessor
    function = 2*t
  [../]
[]

[Executioner]
  # Preconditioned JFNK (default)
  type = Transient
  num_steps = 20
  solve_type = PJFNK
  dt = 0.1
[]

[Outputs]
  exodus = true
[]

[ICs]
  [./aux_ic]
    variable = aux_elem
    max = 10
    seed = 2
    type = RandomIC
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="18dc2266-368f-4dd5-9cb8-acf0ab161a4b"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh04.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1 1E1 1E2 1E3&#x27;
    x = &#x27;0 1E-1 1 1E1 1E2 1E3&#x27;
  [../]
[]

[Variables]
  [./pp]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityFLAC
    m = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    variable = pp
    SumQuantityUO = borehole_total_outflow_mass
    point_file = bh02.bh
    fluid_phase = 0
    bottom_p_or_t = -1E6
    unit_weight = &#x27;0 0 0&#x27;
    use_mobility = true
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1E3
  solve_type = NEWTON
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bh04
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0b637ebd-53bb-4016-a88a-a6fad9c9fd10"><div class="modal-content"><h4>modules/chemical_reactions/test/tests/desorption/langmuir_desorption.i</h4><pre class="moose-pre"><code class="language-text"># testing the entire desorption DEs
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 1
  xmin = 0
  xmax = 1
[]

[Variables]
  [./pressure]
  [../]
  [./conc]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./p_ic]
    type = ConstantIC
    variable = pressure
    value = 1.0
  [../]
  [./conc_ic]
    type = ConstantIC
    variable = conc
    value = 1.0
  [../]
[]


[Kernels]
  [./c_dot]
    type = TimeDerivative
    variable = conc
  [../]
  [./flow_from_matrix]
    type = DesorptionFromMatrix
    variable = conc
    pressure_var = pressure
  [../]
  [./rho_dot]
    type = TimeDerivative
    variable = pressure
  [../]
  [./flux_to_porespace]
    type = DesorptionToPorespace
    variable = pressure
    conc_var = conc
  [../]
[]

[Postprocessors]
  [./mass_rho]
    type = ElementIntegralVariablePostprocessor
    block = 0
    variable = pressure
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./mass_conc]
    type = ElementIntegralVariablePostprocessor
    block = 0
    variable = conc
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./mass_tot]
    type = FunctionValuePostprocessor
    function = mass_fcn
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;0 0 0&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./c0]
    type = PointValue
    variable = conc
    point = &#x27;0 0 0&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Functions]
  [./mass_fcn]
    type = ParsedFunction
    value = a+b
    vars = &#x27;a b&#x27;
    vals = &#x27;mass_rho mass_conc&#x27;
  [../]
[]

[Materials]
  [./lang_stuff]
    type = LangmuirMaterial
    block = 0
    one_over_desorption_time_const = 0.90909091
    one_over_adsorption_time_const = 0.90909091
    langmuir_density = 0.88
    langmuir_pressure = 1.23
    pressure_var = pressure
    conc_var = conc
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    #petsc_options = &#x27;-snes_test_display&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 0.01
  end_time = 2
[]
[Outputs]
  file_base = langmuir_desorption
  interval = 10
  exodus = true
  csv = 10
[] # Outputs
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="26362263-d6ce-4476-b075-e5bb250ecec1"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh06.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = false
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh06
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="684cf2c2-0710-4ed9-9d91-255e92033237"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/pp_generation_unconfined_basicthm.i</h4><pre class="moose-pre"><code class="language-text"># Identical to pp_generation_unconfined_fullysat_volume.i but using an Action
#
# A sample is constrained on all sides, except its top
# and its boundaries are
# also impermeable.  Fluid is pumped into the sample via a
# volumetric source (ie m^3/second per cubic meter), and the
# rise in the top surface, porepressure, and stress are observed.
#
# In the standard poromechanics scenario, the Biot Modulus is held
# fixed and the source has units 1/s.  Then the expected result
# is
# strain_zz = disp_z = BiotCoefficient*BiotModulus*s*t/((bulk + 4*shear/3) + BiotCoefficient^2*BiotModulus)
# porepressure = BiotModulus*(s*t - BiotCoefficient*strain_zz)
# stress_xx = (bulk - 2*shear/3)*strain_zz   (remember this is effective stress)
# stress_zz = (bulk + 4*shear/3)*strain_zz   (remember this is effective stress)
#
# In standard porous_flow, everything is based on mass, eg the source has
# units kg/s/m^3.  This is discussed in the other pp_generation_unconfined
# models.  In this test, we use the FullySaturated Kernel and set
# multiply_by_density = false
# meaning the fluid Kernel has units of volume, and the source, s, has units 1/time
#
# The ratios are:
# stress_xx/strain_zz = (bulk - 2*shear/3) = 1 (for the parameters used here)
# stress_zz/strain_zz = (bulk + 4*shear/3) = 4 (for the parameters used here)
# porepressure/strain_zz = 13.3333333 (for the parameters used here)
#
# Expect
# disp_z = 0.3*10*s*t/((2 + 4*1.5/3) + 0.3^2*10) = 0.612245*s*t
# porepressure = 10*(s*t - 0.3*0.612245*s*t) = 8.163265*s*t
# stress_xx = (2 - 2*1.5/3)*0.612245*s*t = 0.612245*s*t
# stress_zz = (2 + 4*shear/3)*0.612245*s*t = 2.44898*s*t
#
# Finally, note that the volumetric strain has
# consistent_with_displaced_mesh = false
# which is needed when using the FullySaturated version of the Kernels
# in order to generate the above results

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back&#x27;
  [../]
[]


[Kernels]
  [./source]
    type = BodyForce
    function = 0.1
    variable = porepressure
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 3.3333333333
      viscosity = 1.0
      density0 = 1.0
    [../]
  [../]
[]

[PorousFlowBasicTHM]
  coupling_type = HydroMechanical
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  multiply_by_density = false
  porepressure = porepressure
  biot_coefficient = 0.3
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]


[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # the &quot;const&quot; is irrelevant here: all that uses Porosity is the BiotModulus, which just uses the initial value of porosity
    porosity = 0.1
    PorousFlowDictator = dictator
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    PorousFlowDictator = dictator
    biot_coefficient = 0.3
    fluid_bulk_modulus = 3.3333333333
    solid_bulk_compliance = 0.5
  [../]
  [./permeability_irrelevant]
    type = PorousFlowPermeabilityConst
    PorousFlowDictator = dictator
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0.5&#x27;
    variable = disp_z
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./stress_xx_over_strain]
    type = FunctionValuePostprocessor
    function = stress_xx_over_strain_fcn
    outputs = csv
  [../]
  [./stress_zz_over_strain]
    type = FunctionValuePostprocessor
    function = stress_zz_over_strain_fcn
    outputs = csv
  [../]
  [./p_over_strain]
    type = FunctionValuePostprocessor
    function = p_over_strain_fcn
    outputs = csv
  [../]
[]

[Functions]
  [./stress_xx_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;stress_xx zdisp&#x27;
  [../]
  [./stress_zz_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;stress_zz zdisp&#x27;
  [../]
  [./p_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;p0 zdisp&#x27;
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  dt = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = pp_generation_unconfined_basicthm
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8d2b30ec-add2-48a9-b5e2-3b9397523ba2"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s01.i</h4><pre class="moose-pre"><code class="language-text"># apply a sink flux and observe the correct behavior
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  zmin = 0
  zmax = 2
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Variables]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = y+1
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.3
      density0 = 1.1
      thermal_expansion = 0
      viscosity = 1.1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-5 0 0 0 1E-5 0 0 0 1E-5&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[AuxVariables]
  [./flux_out]
  [../]
  [./xval]
  [../]
  [./yval]
  [../]
[]

[ICs]
  [./xval]
    type = FunctionIC
    variable = xval
    function = x
  [../]
  [./yval]
    type = FunctionIC
    variable = yval
    function = y
  [../]
[]

[Functions]
  [./mass00]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)&#x27;
    vars = &#x27;vol por dens0 pp bulk&#x27;
    vals = &#x27;0.25 0.1 1.1 p00 1.3&#x27;
  [../]
  [./mass01]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)&#x27;
    vars = &#x27;vol por dens0 pp bulk&#x27;
    vals = &#x27;0.25 0.1 1.1 p01 1.3&#x27;
  [../]
  [./expected_mass_change00]
    type = ParsedFunction
    value = &#x27;fcn*perm*dens0*exp(pp/bulk)/visc*area*dt&#x27;
    vars = &#x27;fcn perm dens0 pp bulk visc area dt&#x27;
    vals = &#x27;6   1    1      0  1.3  1  0.5  1E-3&#x27;
  [../]
[]

[Postprocessors]
  [./p00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m00]
    type = FunctionValuePostprocessor
    function = mass00
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./del_m00]
    type = FunctionValuePostprocessor
    function = expected_mass_change00
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./p10]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p01]
    type = PointValue
    point = &#x27;0 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m01]
    type = FunctionValuePostprocessor
    function = mass01
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p11]
    type = PointValue
    point = &#x27;1 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[BCs]
  [./flux]
    type = PorousFlowSink
    boundary = &#x27;left&#x27;
    variable = pp
    use_mobility = false
    use_relperm = true
    fluid_phase = 0
    flux_function = 6
    save_in = flux_out
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 10000 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E-3
  end_time = 1E-2
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[Outputs]
  file_base = s01
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a06d5dcc-f91c-41bf-959b-ab3f8d8463ad"><div class="modal-content"><h4>modules/combined/test/tests/cavity_pressure/additional_volume.i</h4><pre class="moose-pre"><code class="language-text">#
# Cavity Pressure Test
#
# This test is designed to compute an internal pressure based on
# p = n * R * / (V_cavity / T_cavity + V_add / T_add)
# where
#  p is the pressure
#  n is the amount of material in the volume (moles)
#  R is the universal gas constant
#  T_cavity is the temperature in the cavity
#  T_add is the temperature of the additional volume
#
# The mesh is composed of one block (1) with an interior cavity of volume 8.
#   Block 2 sits in the cavity and has a volume of 1.  Thus, the total
#   initial volume is 7. An additional volume of 2 is added.
#
# The test adjusts n, T, and V in the following way:
#   n =&gt; n0 + alpha * t
#   T =&gt; T0 + beta * t
#   V =&gt; V_cavity0 + gamma * t + V_add
# with
#   alpha = n0
#   beta = T0 / 2
#   gamma = -(0.003322259...) * V0
#   T0 = 240.54443866068704
#   V_cavity0 = 7
#   V_add = 2
#   T_add = 100
#   n0 = f(p0)
#   p0 = 100
#   R = 8.314472 J * K^(-1) * mol^(-1)
#
#  An additional volume of 2 with a temperature of 100.0 is included.
#
# So, n0 = p0 * (V_cavity / T_cavity + V_add / T_add) / R
#        = 100 * (7 / 240.544439 + 2 / 100) / 8.314472
#        = 0.59054
#
# The parameters combined at t = 1 gives p = 249.647.
#
# This test sets the initial temperature to 500, but the CavityPressure
#   is told that that initial temperature is T0.  Thus, the final solution
#   is unchanged.

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Mesh]
  file = 3d.e
[]

[GlobalParams]
  volumetric_locking_correction = true
[]

[Functions]
  [./displ_positive]
    type = PiecewiseLinear
    x = &#x27;0 1&#x27;
    y = &#x27;0 0.0029069767441859684&#x27;
  [../]
  [./displ_negative]
    type = PiecewiseLinear
    x = &#x27;0 1&#x27;
    y = &#x27;0 -0.0029069767441859684&#x27;
  [../]
  [./temp1]
    type = PiecewiseLinear
    x = &#x27;0 1&#x27;
    y = &#x27;1 1.5&#x27;
    scale_factor = 240.54443866068704
  [../]
  [./material_input_function]
    type = PiecewiseLinear
    x = &#x27;0    1&#x27;
    y = &#x27;0 0.59054&#x27;
  [../]
  [./additional_volume]
    type = ConstantFunction
    value = 2
  [../]
  [./temperature_of_additional_volume]
    type = ConstantFunction
    value = 100
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./temp]
    initial_condition = 500
  [../]
  [./material_input]
  [../]
[]

[AuxVariables]
  [./pressure_residual_x]
  [../]
  [./pressure_residual_y]
  [../]
  [./pressure_residual_z]
  [../]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zx]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[Kernels]
  [./TensorMechanics]
    use_displaced_mesh = true
  [../]
  [./heat]
    type = Diffusion
    variable = temp
    use_displaced_mesh = true
  [../]
  [./material_input_dummy]
    type = Diffusion
    variable = material_input
    use_displaced_mesh = true
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
    variable = stress_xx
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 1
    index_j = 1
    variable = stress_yy
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    variable = stress_zz
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 0
    index_j = 1
    variable = stress_xy
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 1
    index_j = 2
    variable = stress_yz
  [../]
  [./stress_zx]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 2
    index_j = 0
    variable = stress_zx
  [../]
[]

[BCs]
  [./no_x_exterior]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;7 8&#x27;
    value = 0.0
  [../]
  [./no_y_exterior]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;9 10&#x27;
    value = 0.0
  [../]
  [./no_z_exterior]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;11 12&#x27;
    value = 0.0
  [../]
  [./prescribed_left]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = 13
    function = displ_positive
  [../]
  [./prescribed_right]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = 14
    function = displ_negative
  [../]
  [./no_y]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;15 16&#x27;
    value = 0.0
  [../]
  [./no_z]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;17 18&#x27;
    value = 0.0
  [../]
  [./no_x_interior]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;1 2&#x27;
    value = 0.0
  [../]
  [./no_y_interior]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;3 4&#x27;
    value = 0.0
  [../]
  [./no_z_interior]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;5 6&#x27;
    value = 0.0
  [../]
  [./temperatureInterior]
    type = FunctionDirichletBC
    boundary = 100
    function = temp1
    variable = temp
  [../]
  [./MaterialInput]
    type = FunctionDirichletBC
    boundary = &#x27;100 13 14 15 16&#x27;
    function = material_input_function
    variable = material_input
  [../]
  [./CavityPressure]
    [./1]
      boundary = 100
      initial_pressure = 100
      material_input = materialInput
      R = 8.314472
      temperature = aveTempInterior
      initial_temperature = 240.54443866068704
      volume = internalVolume
      startup_time = 0.5
      output = ppress
      save_in = &#x27;pressure_residual_x pressure_residual_y pressure_residual_z&#x27;
      additional_volumes = volume1
      temperature_of_additional_volumes = temperature1
    [../]
  [../]
[]

[Materials]
  [./elast_tensor1]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0 5&#x27;
    fill_method = symmetric_isotropic
    block = 1
  [../]
  [./strain1]
    type = ComputeFiniteStrain
    block = 1
  [../]
  [./stress1]
    type = ComputeFiniteStrainElasticStress
    block = 1
  [../]
  [./elast_tensor2]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0 5&#x27;
    fill_method = symmetric_isotropic
    block = 2
  [../]
  [./strain2]
    type = ComputeFiniteStrain
    block = 2
  [../]
  [./stress2]
    type = ComputeFiniteStrainElasticStress
    block = 2
  [../]
[]

[Executioner]
  type = Transient

  petsc_options_iname = &#x27;-pc_type -sub_pc_type&#x27;
  petsc_options_value = &#x27;asm       lu&#x27;

  nl_rel_tol = 1e-12
  l_tol = 1e-12

  l_max_its = 20

  dt = 0.5
  end_time = 1.0

  snesmf_reuse_base = false
[]

[Postprocessors]
  [./internalVolume]
    type = InternalVolume
    boundary = 100
    execute_on = &#x27;initial linear&#x27;
  [../]
  [./aveTempInterior]
    type = SideAverageValue
    boundary = 100
    variable = temp
    execute_on = &#x27;initial linear&#x27;
  [../]
  [./materialInput]
    type = SideAverageValue
    boundary = &#x27;7 8 9 10 11 12&#x27;
    variable = material_input
    execute_on = linear
  [../]
  [./volume1]
    type = FunctionValuePostprocessor
    function = additional_volume
    execute_on = &#x27;initial linear&#x27;
  [../]
  [./temperature1]
    type = FunctionValuePostprocessor
    function = temperature_of_additional_volume
    execute_on = &#x27;initial linear&#x27;
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="22c9ae7b-7471-4c1b-8b63-1dd53ef143ab"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/terzaghi.i</h4><pre class="moose-pre"><code class="language-text"># Terzaghi&#x27;s problem of consolodation of a drained medium
#
# A saturated soil sample sits in a bath of water.
# It is constrained on its sides, and bottom.
# Its sides and bottom are also impermeable.
# Initially it is unstressed.
# A normal stress, q, is applied to the soil&#x27;s top.
# The soil then slowly compresses as water is squeezed
# out from the sample from its top (the top BC for
# the porepressure is porepressure = 0).
#
# See, for example.  Section 2.2 of the online manuscript
# Arnold Verruijt &quot;Theory and Problems of Poroelasticity&quot; Delft University of Technology 2013
# but note that the &quot;sigma&quot; in that paper is the negative
# of the stress in TensorMechanics
#
# Here are the problem&#x27;s parameters, and their values:
# Soil height.  h = 10
# Soil&#x27;s Lame lambda.  la = 2
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = 3
# Soil bulk modulus.  K = la + 2*mu/3 = 4
# Soil confined compressibility.  m = 1/(K + 4mu/3) = 0.125
# Soil bulk compliance.  1/K = 0.25
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Soil initial storativity, which is the reciprocal of the initial Biot modulus.  S = phi0/Kf + (alpha - phi0)(1 - alpha)/K = 0.0625
# Consolidation coefficient.  c = k/(S + alpha^2 m) = 13.95348837
# Normal stress on top.  q = 1
# Initial porepressure, resulting from instantaneous application of q, assuming corresponding instantaneous increase of porepressure (Note that this is calculated by MOOSE: we only need it for the analytical solution).  p0 = alpha*m*q/(S + alpha^2 m) = 0.69767442
# Initial vertical displacement (down is positive), resulting from instantaneous application of q (Note this is calculated by MOOSE: we only need it for the analytical solution).  uz0 = q*m*h*S/(S + alpha^2 m)
# Final vertical displacement (down in positive) (Note this is calculated by MOOSE: we only need it for the analytical solution).  uzinf = q*m*h
#
# The solution for porepressure is
# P = 4*p0/\pi \sum_{k=1}^{\infty} \frac{(-1)^{k-1}}{2k-1} \cos ((2k-1)\pi z/(2h)) \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))
# This series converges very slowly for ct/h^2 small, so in that domain
# P = p0 erf( (1-(z/h))/(2 \sqrt(ct/h^2)) )
#
# The degree of consolidation is defined as
# U = (uz - uz0)/(uzinf - uz0)
# where uz0 and uzinf are defined above, and
# uz = the vertical displacement of the top (down is positive)
# U = 1 - (8/\pi^2)\sum_{k=1}^{\infty} \frac{1}{(2k-1)^2} \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))
#
# FINAL NOTE: The above solution assumes constant Biot Modulus.
# In porous_flow this is not true.  Therefore the solution is
# a little different than in the paper.  This test was therefore
# validated against MOOSE&#x27;s poromechanics, which can choose either
# a constant Biot Modulus (which has been shown to agree with
# the analytic solution), or a non-constant Biot Modulus (which
# gives the same results as porous_flow).

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 10
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = 0
  zmax = 10
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./basefixed]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = back
  [../]
  [./topdrained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = front
  [../]
  [./topload]
    type = NeumannBC
    variable = disp_z
    value = -1
    boundary = front
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    component = 2
    variable = disp_z
  [../]
  [./poro_vol_exp]
    type = PorousFlowMassVolumetricExpansion
    variable = porepressure
    fluid_component = 0
  [../]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = porepressure
  [../]
  [./flux]
    type = PorousFlowAdvectiveFlux
    variable = porepressure
    gravity = &#x27;0 0 0&#x27;
    fluid_component = 0
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 8
      density0 = 1
      thermal_expansion = 0
      viscosity = 0.96
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;2 3&#x27;
    # bulk modulus is lambda + 2*mu/3 = 2 + 2*3/3 = 4
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure_qp]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    fluid = true
    mechanical = true
    ensure_positive = false
    porosity_zero = 0.1
    biot_coefficient = 0.6
    solid_bulk = 4
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 0 # unimportant in this fully-saturated situation
    phase = 0
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 1&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 2&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 3&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 4&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 5&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 6&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 7&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 8&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 9&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = disp_z
    use_displaced_mesh = false
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.5*t&lt;0.1,0.5*t,0.1)
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.0001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = terzaghi
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="afae0f3c-1ea3-4a64-8875-82b309aefecf"><div class="modal-content"><h4>modules/richards/test/tests/excav/ex01.i</h4><pre class="moose-pre"><code class="language-text">###########################################
#                                         #
#   THIS EXAMPLE CONTAINS AN EXCAVATION   #
#                                         #
###########################################


# Easiest way of figuring out what&#x27;s happening:
# Run this example, load into paraview, take
# a slice through (0,0,0) with normal (0,0,1),
# colour by pressure and play the animation.


# This mesh has an interior sideset called excav_bdy
[Mesh]
  type = FileMesh
  file = ex01_input.e
[]



# This is a boundary condition acting on excav_bdy
# All it does is to set the pressure to p_excav=0
# at places on excav_bdy wherever excav_fcn tells it to.
[BCs]
  [./excav_bdy]
    type = RichardsExcav
    boundary = excav_bdy
    p_excav = 0.0
    variable = pressure
    excav_geom_function = excav_fcn
  [../]
[]



[Functions]
# excav_fcn controls where to set pressure=p_excav
# You supply start and end positions and times and
# by a linear interpolation these define the position
# of the coal face at all times
  [./excav_fcn]
    type = RichardsExcavGeom
    start_posn = &#x27;0 -500 0&#x27;
    start_time = 0
    end_posn = &#x27;0 -300 0&#x27;
    end_time = 6E6
    active_length = 1E4
  [../]

# mass_bal_fcn calculates the mass balance
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((mi-fout-mf)/2/(mi+mf))
    vars = &#x27;mi mf fout&#x27;
    vals = &#x27;mass_init mass_final flux_out&#x27;
  [../]

# initial pressure - unimportant in this example
  [./initial_pressure]
    type = ParsedFunction
    value = -10000*(z-100)
  [../]
[]




# following is needed by postprocessors, kernels, etc
# unimportant in this example
[GlobalParams]
  richardsVarNames_UO = PPNames
[]




# following does the calculation of relevant
# masses and mass-flux to the excavation
[Postprocessors]

# note that this is calculated at beginning of timestep
  [./mass_init]
    type = RichardsMass
    variable = pressure
    execute_on = &#x27;initial timestep_begin&#x27;
  [../]

# note this is calculated at end of timestep
  [./mass_final]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

# this is what calculates the mass flux to the excavation
# it is calculating it for boundary=excav_bdy, and the
# excavation time-dependence is set through the excav_fcn
  [./flux_out]
    type = RichardsExcavFlow
    boundary = excav_bdy
    variable = pressure
    excav_geom_function = excav_fcn
  [../]

# mass_bal just outputs the result to screen
  [./mass_bal]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
  [../]
[]




######################################
#                                    #
#  THE FOLLOWING STUFF IS STANDARD   #
#                                    #
######################################


[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E+2
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = &#x27;1 2 3 4&#x27;
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-15 0 0  0 1E-15 0  0 0 1E-15&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 -10&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-14 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 6E6
  dt = 3E6
  solve_type = NEWTON
[]

[Outputs]
  file_base = ex01
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7e0b338c-ea14-4787-8f1e-6f42c2d91a21"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/weak_plane_shear/large_deform3.i</h4><pre class="moose-pre"><code class="language-text"># apply a number of &quot;random&quot; configurations and
# check that the algorithm returns to the yield surface
#
# must be careful here - we cannot put in arbitrary values of C_ijkl, otherwise the condition
# df/dsigma * C * flow_dirn &lt; 0 for some stresses
# The important features that must be obeyed are:
# 0 = C_0222 = C_1222  (holds for transversely isotropic, for instance)
# C_0212 &lt; C_0202 = C_1212 (holds for transversely isotropic)

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[BCs]
  [./bottomx]
    type = DirichletBC
    variable = disp_x
    boundary = back
    value = 0.0
  [../]
  [./bottomy]
    type = DirichletBC
    variable = disp_y
    boundary = back
    value = 0.0
  [../]
  [./bottomz]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]

  # the following are &quot;random&quot; deformations
  # each is O(1E-1) to provide large deformations
  [./topx]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = front
    function = &#x27;(sin(0.1*t)+x)/1E1&#x27;
  [../]
  [./topy]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = front
    function = &#x27;(cos(t)+x*y)/1E1&#x27;
  [../]
  [./topz]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = front
    function = &#x27;sin(0.4321*t)*x*y*z/1E1&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = yield_fcn
  [../]
[]

[Postprocessors]
  [./yield_fcn_at_zero]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;yield_fcn_at_zero&#x27;
  [../]
[]

[UserObjects]
  [./coh]
    type = TensorMechanicsHardeningConstant
    value = 1E3
  [../]
  [./tanphi]
    type = TensorMechanicsHardeningConstant
    value = 0.577350269
  [../]
  [./tanpsi]
    type = TensorMechanicsHardeningConstant
    value = 0.08748866
  [../]
  [./wps]
    type = TensorMechanicsPlasticWeakPlaneShear
    cohesion = coh
    tan_friction_angle = tanphi
    tan_dilation_angle = tanpsi
    smoother = 100
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-3
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    # the following is transversely isotropic, i think.
    fill_method = symmetric9
    C_ijkl = &#x27;3E9 1E9 3E9 3E9 3E9 6E9 1E9 1E9 9E9&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    plastic_models = wps
    transverse_direction = &#x27;0 0 1&#x27;
    max_NR_iterations = 100
    ep_plastic_tolerance = 1E-3
    debug_fspb = crash
  [../]
[]


[Executioner]
  end_time = 1E4
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = large_deform3
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ed61b15e-fe13-4e85-836f-f09f856b247c"><div class="modal-content"><h4>modules/porous_flow/examples/lava_lamp/2phase_convection.i</h4><pre class="moose-pre"><code class="language-text"># Two phase density-driven convection of dissolved CO2 in brine
#
# Initially, the model has a gas phase at the top with a saturation of 0.29
# (which corresponds to an initial value of zi = 0.2).
# Diffusion of the dissolved CO2
# component from the saturated liquid to the unsaturated liquid below reduces the
# amount of CO2 in the gas phase. As the density of the CO2-saturated brine is greater
# than the unsaturated brine, a gravitational instability arises and density-driven
# convection of CO2-rich fingers descend into the unsaturated brine.
#
# The instability is seeded by a random perturbation to the porosity field.
# Mesh adaptivity is used to refine the mesh as the fingers form.
#
# Note: this model is computationally expensive, so should be run with multiple cores,
# preferably on a cluster.

[GlobalParams]
  PorousFlowDictator = &#x27;dictator&#x27;
  gravity = &#x27;0 -9.81 0&#x27;
[]

[Adaptivity]
  max_h_level = 2
  marker = marker
  initial_marker = initial
  initial_steps = 2
  [./Indicators]
    [./indicator]
      type = GradientJumpIndicator
      variable = zi
    [../]
  [../]
  [./Markers]
    [./marker]
      type = ErrorFractionMarker
      indicator = indicator
      refine = 0.8
    [../]
    [./initial]
      type = BoxMarker
      bottom_left = &#x27;0 1.95 0&#x27;
      top_right = &#x27;2 2 0&#x27;
      inside = REFINE
      outside = DO_NOTHING
    [../]
  [../]
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  ymax = 2
  xmax = 2
  ny = 40
  nx = 40
  bias_y = 0.95
[]

[AuxVariables]
  [./xnacl]
    initial_condition = 0.01
  [../]
  [./saturation_gas]
    order = FIRST
    family = MONOMIAL
  [../]
  [./xco2l]
    order = FIRST
    family = MONOMIAL
  [../]
  [./density_liquid]
    order = FIRST
    family = MONOMIAL
  [../]
  [./porosity]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./saturation_gas]
    type = PorousFlowPropertyAux
    variable = saturation_gas
    property = saturation
    phase = 1
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./xco2l]
    type = PorousFlowPropertyAux
    variable = xco2l
    property = mass_fraction
    phase = 0
    fluid_component = 1
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./density_liquid]
    type = PorousFlowPropertyAux
    variable = density_liquid
    property = density
    phase = 0
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[Variables]
  [./pgas]
  [../]
  [./zi]
    scaling = 1e4
  [../]
[]

[ICs]
  [./pressure]
    type = FunctionIC
    function = 10e6-9.81*1000*y
    variable = pgas
  [../]
  [./zi]
    type = BoundingBoxIC
    variable = zi
    x1 = 0
    x2 = 2
    y1 = 1.95
    y2 = 2
    inside = 0.2
    outside = 0
  [../]
  [./porosity]
    type = RandomIC
    variable = porosity
    min = 0.25
    max = 0.275
    seed = 0
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pgas
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pgas
  [../]
  [./diff0]
    type = PorousFlowDispersiveFlux
    fluid_component = 0
    variable = pgas
    disp_long = &#x27;0 0&#x27;
    disp_trans = &#x27;0 0&#x27;
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = zi
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = zi
  [../]
  [./diff1]
    type = PorousFlowDispersiveFlux
    fluid_component = 1
    variable = zi
    disp_long = &#x27;0 0&#x27;
    disp_trans = &#x27;0 0&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pgas zi&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
  [./fs]
    type = PorousFlowBrineCO2
    brine_fp = brine
    co2_fp = co2
    capillary_pressure = pc
  [../]
[]

[Modules]
  [./FluidProperties]
    [./co2sw]
      type = CO2FluidProperties
    [../]
    [./co2]
      type = TabulatedFluidProperties
      fp = co2sw
    [../]
    [./brine]
      type = BrineFluidProperties
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = &#x27;45&#x27;
  [../]
  [./brineco2]
    type = PorousFlowFluidState
    gas_porepressure = &#x27;pgas&#x27;
    z = &#x27;zi&#x27;
    temperature_unit = Celsius
    xnacl = &#x27;xnacl&#x27;
    capillary_pressure = pc
    fluid_state = fs
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = porosity
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-11 0 0 0 1e-11 0 0 0 1e-11&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    phase = 0
    n = 2
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 2
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./diffusivity]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;2e-9 2e-9 2e-9 2e-9&#x27;
    tortuosity = &#x27;1 1&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./mumps_is_best_for_parallel_jobs]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
  [./basic]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2             &#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 1e6
  nl_max_its = 25
  l_max_its = 100
  dtmax = 1e4
  nl_abs_tol = 1e-6
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 10
    growth_factor = 2
    cutback_factor = 0.5
  [../]
[]

[Functions]
  [./flux]
    type = ParsedFunction
    vals = &#x27;delta_xco2 dt&#x27;
    vars = &#x27;dx dt&#x27;
    value = &#x27;dx/dt&#x27;
  [../]
[]

[Postprocessors]
  [./total_co2_in_gas]
    type = PorousFlowFluidMass
    phase = 1
    fluid_component = 1
  [../]
  [./total_co2_in_liquid]
    type = PorousFlowFluidMass
    phase = 0
    fluid_component = 1
  [../]
  [./numdofs]
    type = NumDOFs
  [../]
  [./delta_xco2]
    type = ChangeOverTimePostprocessor
    postprocessor = total_co2_in_liquid
  [../]
  [./dt]
    type = TimestepSize
  [../]
  [./flux]
    type = FunctionValuePostprocessor
    function = flux
  [../]
[]

[Outputs]
  print_linear_residuals = false
  perf_graph = true
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d0dda624-69ca-400a-b5d8-25407c02dd65"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/recompute_radial_return/affine_plasticity.i</h4><pre class="moose-pre"><code class="language-text"># Affine Plasticity Test for Transient Stress Eigenvalues with Stationary Eigenvectors

# This test is taken from K. Jamojjala, R. Brannon, A. Sadeghirad, J. Guilkey,
#  &quot;Verification tests in solid mechanics,&quot; Engineering with Computers, Vol 31.,
#  p. 193-213.

# The test involves applying particular strains and expecting particular stresses.

# The material properties are:
#  Yield in shear     165 MPa
#  Shear modulus       79 GPa
#  Poisson&#x27;s ratio    1/3

# The strains are:
#  Time        e11        e22        e33
#  0             0          0          0
#  1        -0.003     -0.003      0.006
#  2    -0.0103923          0  0.0103923

# The expected stresses are:
#  sigma11:
#   -474*t                             0 &lt; t &lt;= 0.201
#   -95.26                             0.201 &lt; t &lt;= 1
#   (189.4+0.1704*sqrt(a)-0.003242*a)
#   ---------------------------------  1 &lt; t &lt;= 2
#            1+0.00001712*a
#   -189.4                             t &gt; 2 (paper erroneously gives a positive value)
#
#  sigma22:
#   -474*t                             0 &lt; t &lt;= 0.201
#   -95.26                             0.201 &lt; t &lt;= 1
#   -(76.87+1.443*sqrt(a)-0.001316*a)
#   ---------------------------------  1 &lt; t &lt;= 2 (paper gives opposite sign)
#             1+0.00001712*a
#   76.87                              t &gt; 2
#
#  sigma33:
#   948*t                              0 &lt; t &lt;= 0.201
#   190.5                              0.201 &lt; t &lt;= 1
#   -(112.5-1.272*sqrt(a)-0.001926*a)
#   ---------------------------------  1 &lt; t &lt;= 2 (paper has two sign errors here)
#            1+0.00001712*a
#   112.5                              t &gt; 2
#
#  where a = exp(12.33*t).
#
# Note: If planning to run this case with strain type ComputeFiniteStrain, the
#   displacement function must be adjusted.  Instead of
#     strain = (l - l0)/l0 = (u+l0 - l0)/l0 = u/l0
#   with l0=1.0, we would have
#     strain = log(l/l0) = log((u+l0)/l0)
#   with l0=1.0.  So, for strain = -0.003,
#     -0.003 = log((u+l0)/l0) -&gt;
#     u = exp(-0.003)*l0 - l0 = -0.0029955044966269995.
#


[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  block = &#x27;0&#x27;
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  # This test uses ElementalVariableValue postprocessors on specific
  # elements, so element numbering needs to stay unchanged
  allow_renumbering = false
[]

[Functions]
  [./disp_x]
    type = PiecewiseLinear
    x = &#x27;0.  1.     2.&#x27;
    y = &#x27;0. -0.003 -0.0103923&#x27;
  [../]
  [./disp_y]
    type = PiecewiseLinear
    x = &#x27;0.  1.    2.&#x27;
    y = &#x27;0. -0.003 0.&#x27;
  [../]
  [./disp_z]
    type = PiecewiseLinear
    x = &#x27;0. 1.    2.&#x27;
    y = &#x27;0. 0.006 0.0103923&#x27;
  [../]
  [./stress_xx]
    type = ParsedFunction
    # The paper gives 0.201 as the time at initial yield, but 0.20097635952803425 is the exact value.
    # The paper gives -95.26 MPa as the stress at yield, but -95.26279441628823 is the exact value.
    # The paper gives 12.33 as the factor in the exponential, but 12.332921390339125 is the exact value.
    # 189.409039923814000, 0.170423791206825, -0.003242011311945, 1.711645501845780E-05 - exact values
    vars = &#x27;timeAtYield stressAtYield expFac a b c d&#x27;
    vals = &#x27;0.20097635952803425 -95.26279441628823 12.332921390339125 189.409039923814000 0.170423791206825 -0.003242011311945 1.711645501845780E-05&#x27;
    value = &#x27;1e6*
             if(t&lt;=timeAtYield, -474*t,
             if(t&lt;=1, stressAtYield,
             (a+b*sqrt(exp(expFac*t))+c*exp(expFac*t))/(1.0+d*exp(expFac*t))))&#x27; # tends to -a
  [../]
  [./stress_yy]
    type = ParsedFunction
    # The paper gives 0.201 as the time at initial yield, but 0.20097635952803425 is the exact value.
    # the paper gives -95.26 MPa as the stress at yield, but -95.26279441628823 is the exact value.
    # The paper gives 12.33 as the factor in the exponential, but 12.332921390339125 is the exact value.
    # -76.867432297315000, -1.442488120272900, 0.001315697947301, 1.711645501845780E-05 - exact values
    vars = &#x27;timeAtYield stressAtYield expFac a b c d&#x27;
    vals = &#x27;0.20097635952803425 -95.26279441628823 12.332921390339125 -76.867432297315000 -1.442488120272900 0.001315697947301 1.711645501845780E-05&#x27;
    value = &#x27;1e6*
             if(t&lt;=timeAtYield, -474*t,
             if(t&lt;=1, stressAtYield,
             (a+b*sqrt(exp(expFac*t))+c*exp(expFac*t))/(1.0+d*exp(expFac*t))))&#x27; # tends to -a
  [../]
  [./stress_zz]
    type = ParsedFunction
    # The paper gives 0.201 as the time at initial yield, but 0.20097635952803425 is the exact value.
    # the paper gives 190.5 MPa as the stress at yield, but 190.52558883257645 is the exact value.
    # The paper gives 12.33 as the factor in the exponential, but 12.332921390339125 is the exact value.
    # -112.541607626499000, 1.272064329066080, 0.001926313364644, 1.711645501845780E-05 - exact values
    vars = &#x27;timeAtYield stressAtYield expFac a b c d&#x27;
    vals = &#x27;0.20097635952803425 190.52558883257645 12.332921390339125 -112.541607626499000 1.272064329066080 0.001926313364644 1.711645501845780E-05&#x27;
    value = &#x27;1e6*
             if(t&lt;=timeAtYield, 948*t,
             if(t&lt;=1, stressAtYield,
             (a+b*sqrt(exp(expFac*t))+c*exp(expFac*t))/(1.0+d*exp(expFac*t))))&#x27; # tends to -a
  [../]
[]

[Variables]
  [./disp_x]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_y]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_z]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./vonmises]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./plastic_strain_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./plastic_strain_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./plastic_strain_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]

[]

[Kernels]
  [./TensorMechanics]
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./vonmises]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = vonmises
    scalar_type = vonmisesStress
    execute_on = &#x27;timestep_end&#x27;
  [../]

  [./plastic_strain_xx]
    type = RankTwoAux
    rank_two_tensor = plastic_strain
    variable = plastic_strain_xx
    index_i = 0
    index_j = 0
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./plastic_strain_yy]
    type = RankTwoAux
    rank_two_tensor = plastic_strain
    variable = plastic_strain_yy
    index_i = 1
    index_j = 1
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./plastic_strain_zz]
    type = RankTwoAux
    rank_two_tensor = plastic_strain
    variable = plastic_strain_zz
    index_i = 2
    index_j = 2
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[BCs]
  [./fixed_x]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./fixed_y]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
  [./fixed_z]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]

  [./disp_x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = right
    function = disp_x
  [../]
  [./disp_y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = top
    function = disp_y
  [../]
  [./disp_z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = front
    function = disp_z
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 210666666666.666667
    poissons_ratio = 0.3333333333333333
  [../]

  [./strain]
    type = ComputeIncrementalSmallStrain
  [../]

  [./isotropic_plasticity]
    type = IsotropicPlasticityStressUpdate
    yield_stress = 285788383.2488647 # = sqrt(3)*165e6 = sqrt(3) * yield in shear
    hardening_constant = 0.0
  [../]
  [./radial_return_stress]
    type = ComputeMultipleInelasticStress
    tangent_operator = elastic
    inelastic_models = &#x27;isotropic_plasticity&#x27;
  [../]
[]

[Executioner]

  type = Transient

  solve_type = &#x27;PJFNK&#x27;
  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;

  nl_abs_tol = 1e-10

  l_max_its = 20

  start_time = 0.0
  dt = 0.01 # use 0.0001 for a nearly exact match
  end_time = 2.0
[]

[Postprocessors]
  [./analytic_xx]
    type = FunctionValuePostprocessor
    function = stress_xx
  [../]
  [./analytic_yy]
    type = FunctionValuePostprocessor
    function = stress_yy
  [../]
  [./analytic_zz]
    type = FunctionValuePostprocessor
    function = stress_zz
  [../]

  [./stress_xx]
    type = ElementalVariableValue
    variable = stress_xx
    elementid = 0
  [../]
  [./stress_yy]
    type = ElementalVariableValue
    variable = stress_yy
    elementid = 0
  [../]
  [./stress_zz]
    type = ElementalVariableValue
    variable = stress_zz
    elementid = 0
  [../]

  [./stress_xx_l2_error]
    type = ElementL2Error
    variable = stress_xx
    function = stress_xx
  [../]
  [./stress_yy_l2_error]
    type = ElementL2Error
    variable = stress_yy
    function = stress_yy
  [../]
  [./stress_zz_l2_error]
    type = ElementL2Error
    variable = stress_zz
    function = stress_zz
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6fefd64c-84c3-46f9-a1c2-41570123f31a"><div class="modal-content"><h4>modules/combined/test/tests/poro_mechanics/terzaghi.i</h4><pre class="moose-pre"><code class="language-text"># Terzaghi&#x27;s problem of consolodation of a drained medium
#
# A saturated soil sample sits in a bath of water.
# It is constrained on its sides, and bottom.
# Its sides and bottom are also impermeable.
# Initially it is unstressed.
# A normal stress, q, is applied to the soil&#x27;s top.
# The soil then slowly compresses as water is squeezed
# out from the sample from its top (the top BC for
# the porepressure is porepressure = 0).
#
# See, for example.  Section 2.2 of the online manuscript
# Arnold Verruijt &quot;Theory and Problems of Poroelasticity&quot; Delft University of Technology 2013
# but note that the &quot;sigma&quot; in that paper is the negative
# of the stress in TensorMechanics
#
# Here are the problem&#x27;s parameters, and their values:
# Soil height.  h = 10
# Soil&#x27;s Lame lambda.  la = 2
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = 3
# Soil bulk modulus.  K = la + 2*mu/3 = 4
# Soil confined compressibility.  m = 1/(K + 4mu/3) = 0.125
# Soil bulk compliance.  1/K = 0.25
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Soil initial storativity, which is the reciprocal of the initial Biot modulus.  S = phi0/Kf + (alpha - phi0)(1 - alpha)/K = 0.0625
# Consolidation coefficient.  c = k/(S + alpha^2 m) = 13.95348837
# Normal stress on top.  q = 1
# Initial porepressure, resulting from instantaneous application of q, assuming corresponding instantaneous increase of porepressure (Note that this is calculated by MOOSE: we only need it for the analytical solution).  p0 = alpha*m*q/(S + alpha^2 m) = 0.69767442
# Initial vertical displacement (down is positive), resulting from instantaneous application of q (Note this is calculated by MOOSE: we only need it for the analytical solution).  uz0 = q*m*h*S/(S + alpha^2 m)
# Final vertical displacement (down in positive) (Note this is calculated by MOOSE: we only need it for the analytical solution).  uzinf = q*m*h
#
# The solution for porepressure is
# P = 4*p0/\pi \sum_{k=1}^{\infty} \frac{(-1)^{k-1}}{2k-1} \cos ((2k-1)\pi z/(2h)) \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))
# This series converges very slowly for ct/h^2 small, so in that domain
# P = p0 erf( (1-(z/h))/(2 \sqrt(ct/h^2)) )
#
# The degree of consolidation is defined as
# U = (uz - uz0)/(uzinf - uz0)
# where uz0 and uzinf are defined above, and
# uz = the vertical displacement of the top (down is positive)
# U = 1 - (8/\pi^2)\sum_{k=1}^{\infty} \frac{1}{(2k-1)^2} \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 10
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = 0
  zmax = 10
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  porepressure = porepressure
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./basefixed]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = back
  [../]
  [./topdrained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = front
  [../]
  [./topload]
    type = NeumannBC
    variable = disp_z
    value = -1
    boundary = front
  [../]
[]


[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
    [./poro_x]
    type = PoroMechanicsCoupling
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PoroMechanicsCoupling
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PoroMechanicsCoupling
    variable = disp_z
    component = 2
  [../]
  [./poro_timederiv]
    type = PoroFullSatTimeDerivative
    variable = porepressure
  [../]
  [./darcy_flow]
    type = CoefDiffusion
    variable = porepressure
    coef = 1.5
  [../]
[]


[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;2 3&#x27;
    # bulk modulus is lambda + 2*mu/3 = 2 + 2*3/3 = 4
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./poro_material]
    type = PoroFullSatMaterial
    porosity0 = 0.1
    biot_coefficient = 0.6
    solid_bulk_compliance = 0.25
    fluid_bulk_compliance = 0.125
    constant_porosity = true
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 1&#x27;
    variable = porepressure
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 2&#x27;
    variable = porepressure
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 3&#x27;
    variable = porepressure
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 4&#x27;
    variable = porepressure
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 5&#x27;
    variable = porepressure
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 6&#x27;
    variable = porepressure
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 7&#x27;
    variable = porepressure
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 8&#x27;
    variable = porepressure
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 9&#x27;
    variable = porepressure
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = porepressure
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = disp_z
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.5*t&lt;0.1,0.5*t,0.1)
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.0001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = terzaghi
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a4acdbc8-0d72-46cb-bfb0-68dbce205279"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/capped_mohr_coulomb/random2.i</h4><pre class="moose-pre"><code class="language-text"># Using CappedMohrCoulomb with compressive failure only
# Plasticity models:
# Compressive strength = 1 MPa
#
# Lame lambda = 1GPa.  Lame mu = 1.3GPa
#
# A line of elements is perturbed randomly, and return to the yield surface at each quadpoint is checked

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1234
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1234
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Modules/TensorMechanics/Master]
  [./all]
    add_variables = true
    incremental = true
    generate_output = &#x27;stress_xx stress_xy stress_xz stress_yy stress_yz stress_zz&#x27;
  [../]
[]

[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./f0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./f0]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = f0
  [../]
  [./f1]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 1
    variable = f1
  [../]
  [./f2]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 2
    variable = f2
  [../]
  [./int0]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    factor = 1E6
    index = 0
    variable = int0
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./tot_iters]
    type = ElementIntegralMaterialProperty
    mat_prop = plastic_NR_iterations
    outputs = console
  [../]
  [./raw_f0]
    type = ElementExtremeValue
    variable = f0
    outputs = console
  [../]
  [./raw_f1]
    type = ElementExtremeValue
    variable = f1
    outputs = console
  [../]
  [./raw_f2]
    type = ElementExtremeValue
    variable = f2
    outputs = console
  [../]
  [./iter]
    type = ElementExtremeValue
    variable = iter
    outputs = console
  [../]
  [./f0]
    type = FunctionValuePostprocessor
    function = should_be_zero0_fcn
  [../]
  [./f1]
    type = FunctionValuePostprocessor
    function = should_be_zero1_fcn
  [../]
  [./f2]
    type = FunctionValuePostprocessor
    function = should_be_zero2_fcn
  [../]
[]

[Functions]
  [./should_be_zero0_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f0&#x27;
  [../]
  [./should_be_zero1_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f1&#x27;
  [../]
  [./should_be_zero2_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f2&#x27;
  [../]
[]

[UserObjects]
  [./ts]
    type = TensorMechanicsHardeningConstant
    value = 1E12
  [../]
  [./cs]
    type = TensorMechanicsHardeningCubic
    value_0 = 1E6
    value_residual = 0
    internal_limit = 1
  [../]
  [./coh]
    type = TensorMechanicsHardeningConstant
    value = 1E12
  [../]
  [./ang]
    type = TensorMechanicsHardeningConstant
    value = 0.5
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;1E9 1.3E9&#x27;
  [../]
  [./tensile]
    type = CappedMohrCoulombStressUpdate
    tensile_strength = ts
    compressive_strength = cs
    cohesion = coh
    friction_angle = ang
    dilation_angle = ang
    smoothing_tol = 1E5
    max_NR_iterations = 100
    yield_function_tol = 1.0E-1
  [../]
  [./stress]
    type = ComputeMultipleInelasticStress
    inelastic_models = tensile
    perform_finite_strain_rotations = false
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random2
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3e9bca02-1f2c-470a-b967-3149a60ae2bb"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/ad_viscoplasticity_stress_update/lps_dual.i</h4><pre class="moose-pre"><code class="language-text"># This test provides an example of combining two LPS viscoplasticity models with different stress
# exponents.

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmax = 0.002
  ymax = 0.002
[]

[Variables]
  [./temp]
    initial_condition = 1000
  [../]
[]

[Kernels]
  [./dt]
    type = ADTimeDerivative
    variable = temp
  [../]
  [./diff]
    type = ADDiffusion
    variable = temp
  [../]
[]

[Modules/TensorMechanics/Master/All]
  strain = FINITE
  add_variables = true
  generate_output = &#x27;strain_xx strain_yy strain_xy hydrostatic_stress vonmises_stress&#x27;
  use_automatic_differentiation = true
[]

[Functions]
  [./pull]
    type = PiecewiseLinear
    x = &#x27;0 0.1&#x27;
    y = &#x27;0 1e-5&#x27;
  [../]
  [./tot_effective_viscoplasticity]
    type = ParsedFunction
    vals = &#x27;lps_1_eff_creep_strain lps_3_eff_creep_strain&#x27;
    vars = &#x27;lps_1_eff_creep_strain lps_3_eff_creep_strain&#x27;
    value = &#x27;lps_1_eff_creep_strain+lps_3_eff_creep_strain&#x27;
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 1e10
    poissons_ratio = 0.3
  [../]
  [./stress]
    type = ADComputeMultiplePorousInelasticStress
    inelastic_models = &#x27;one two&#x27;
    initial_porosity = 0.1
    outputs = all
  [../]

  [./one]
    type = ADViscoplasticityStressUpdate
    coefficient = &#x27;coef_3&#x27;
    power = 3
    base_name = &#x27;lps_1&#x27;
    outputs = all
    relative_tolerance = 1e-11
  [../]
  [./two]
    type = ADViscoplasticityStressUpdate
    coefficient = 1e-10
    power = 1
    base_name = &#x27;lps_3&#x27;
    outputs = all
    relative_tolerance = 1e-11
  [../]
  [./coef]
    type = ADParsedMaterial
    f_name = coef_3
    # Example of creep power law
    args = temp
    function = &#x27;0.5e-18 * exp(-4e4 / 1.987 / temp)&#x27;
  [../]
[]

[BCs]
  [./no_disp_x]
    type = ADDirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./no_disp_y]
    type = ADDirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
  [./pull_disp_y]
    type = ADFunctionDirichletBC
    variable = disp_y
    boundary = top
    function = pull
  [../]
  [./temp_ramp]
    type = ADFunctionDirichletBC
    boundary = right
    function = &#x27;1000 + 400 * t / 0.12&#x27;
    variable = temp
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  dt = 0.01
  end_time = 0.12
[]

[Postprocessors]
  [./disp_x]
    type = SideAverageValue
    variable = disp_x
    boundary = right
  [../]
  [./disp_y]
    type = SideAverageValue
    variable = disp_y
    boundary = top
  [../]
  [./avg_hydro]
    type = ElementAverageValue
    variable = hydrostatic_stress
  [../]
  [./avg_vonmises]
    type = ElementAverageValue
    variable = vonmises_stress
  [../]
  [./dt]
    type = TimestepSize
  [../]
  [./num_lin]
    type = NumLinearIterations
    outputs = console
  [../]
  [./num_nonlin]
    type = NumNonlinearIterations
    outputs = console
  [../]
  [./lps_1_eff_creep_strain]
    type = ElementAverageValue
    variable = lps_1_effective_viscoplasticity
  [../]
  [./lps_3_eff_creep_strain]
    type = ElementAverageValue
    variable = lps_3_effective_viscoplasticity
  [../]
  [./lps_1_gauge_stress]
    type = ElementAverageValue
    variable = lps_1_gauge_stress
  [../]
  [./lps_3_gauge_stress]
    type = ElementAverageValue
    variable = lps_3_gauge_stress
  [../]
  [./eff_creep_strain_tot]
    type = FunctionValuePostprocessor
    function = tot_effective_viscoplasticity
  [../]
  [./porosity]
    type = ElementAverageValue
    variable = porosity
  [../]
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ade07661-1b10-497e-9955-34caf4e6c4e0"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/drucker_prager/random_hyperbolic.i</h4><pre class="moose-pre"><code class="language-text"># drucker-prager hyperbolic.
# apply many random large deformations, checking that the algorithm returns correctly to
# the yield surface each time.


[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 100
  ny = 125
  nz = 1
  xmin = 0
  xmax = 100
  ymin = 0
  ymax = 125
  zmin = 0
  zmax = 1
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./yield_fcn_at_zero]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./av_iter]
    type = ElementAverageValue
    variable = iter
    outputs = &#x27;console&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;yield_fcn_at_zero&#x27;
  [../]
[]

[UserObjects]
  [./mc_coh]
    type = TensorMechanicsHardeningConstant
    value = 1E3
  [../]
  [./mc_phi]
    type = TensorMechanicsHardeningConstant
    value = 30
    convert_to_radians = true
  [../]
  [./mc_psi]
    type = TensorMechanicsHardeningConstant
    value = 5
    convert_to_radians = true
  [../]
  [./dp]
    type = TensorMechanicsPlasticDruckerPragerHyperbolic
    mc_cohesion = mc_coh
    mc_friction_angle = mc_phi
    mc_dilation_angle = mc_psi
    smoother = 0.1E3
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-6
    use_custom_returnMap = true
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0.7E7 1E7&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./dp]
    type = ComputeMultiPlasticityStress
    block = 0
    max_NR_iterations = 1000
    ep_plastic_tolerance = 1E-6
    min_stepsize = 1E-3
    plastic_models = dp
    debug_fspb = crash
    deactivation_scheme = safe
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random_hyperbolic
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="07840637-d01d-4b26-871a-2befc5e296d0"><div class="modal-content"><h4>test/tests/kernels/ode/parsedode_sys_impl_test.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  nx = 2
  ny = 2
  elem_type = QUAD4
[]

[Functions]
  [./f_fn]
    type = ParsedFunction
    value = -4
  [../]
  [./bc_all_fn]
    type = ParsedFunction
    value = x*x+y*y
  [../]

  # ODEs
  [./exact_x_fn]
    type = ParsedFunction
    value = (-1/3)*exp(-t)+(4/3)*exp(5*t)
  [../]
[]

# NL

[Variables]
  [./u]
    family = LAGRANGE
    order = FIRST
  [../]

  # ODE variables
  [./x]
    family = SCALAR
    order = FIRST
    initial_condition = 1
  [../]
  [./y]
    family = SCALAR
    order = FIRST
    initial_condition = 2
  [../]
[]

[Kernels]
  [./td]
    type = TimeDerivative
    variable = u
  [../]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./uff]
    type = BodyForce
    variable = u
    function = f_fn
  [../]
[]

[ScalarKernels]
  [./td1]
    type = ODETimeDerivative
    variable = x
  [../]
  [./ode1]
    type = ParsedODEKernel
    function = &#x27;-3*x - 2*y&#x27;
    variable = x
    args = y
  [../]

  [./td2]
    type = ODETimeDerivative
    variable = y
  [../]
  [./ode2]
    type = ParsedODEKernel
    function = &#x27;-4*x - y&#x27;
    variable = y
    args = x
  [../]
[]

[BCs]
  [./all]
    type = FunctionDirichletBC
    variable = u
    boundary = &#x27;0 1 2 3&#x27;
    function = bc_all_fn
  [../]
[]

[Postprocessors]
  active = &#x27;exact_x l2err_x x y&#x27;

  [./x]
    type = ScalarVariable
    variable = x
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./y]
    type = ScalarVariable
    variable = y
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./exact_x]
    type = FunctionValuePostprocessor
    function = exact_x_fn
    execute_on = &#x27;initial timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
  [../]

  [./l2err_x]
    type = ScalarL2Error
    variable = x
    function = exact_x_fn
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Executioner]
  type = Transient
  start_time = 0
  dt = 0.01
  num_steps = 100

  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  file_base = ode_sys_impl_test_out
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="59ff4659-fda6-4189-97c6-36b943e5e2a7"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = false
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.2
    max = 0.8
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.2
    max = 1.8
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_fu_05
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="571c7deb-b110-43aa-a065-6c802ad4a010"><div class="modal-content"><h4>test/tests/postprocessors/geometry/3d_geometry.i</h4><pre class="moose-pre"><code class="language-text">radius = 0.5
inner_box_length = 2.2
outer_box_length = 3
depth = 0.4
sides = 28
alpha = ${fparse 2 * pi / ${sides}}
perimeter_correction = ${fparse ${alpha} / 2 / sin(alpha / 2)}
area_correction = ${fparse alpha / sin(alpha)}

[Mesh]
  file = 3d.e
  construct_side_list_from_node_list = true
[]

[Problem]
  solve = false
[]

[Executioner]
  type = Steady
[]

[Postprocessors]
  [./circle_side_area]
    type = AreaPostprocessor
    boundary = circle_side
  [../]
  [./inside_side_area]
    type = AreaPostprocessor
    boundary = inside_side
  [../]
  [./outside_side_area]
    type = AreaPostprocessor
    boundary = outside_side
  [../]
  [./circle_volume]
    type = VolumePostprocessor
    block = circle
  [../]
  [./inside_volume]
    type = VolumePostprocessor
    block = inside
  [../]
  [./outside_volume]
    type = VolumePostprocessor
    block = outside
  [../]
  [./total_volume]
    type = VolumePostprocessor
    block = &#x27;circle inside outside&#x27;
  [../]

  [./circle_side_area_exact]
    type = FunctionValuePostprocessor
    function = &#x27;circle_side_area_exact&#x27;
  [../]
  [./inside_side_area_exact]
    type = FunctionValuePostprocessor
    function = &#x27;inside_side_area_exact&#x27;
  [../]
  [./outside_side_area_exact]
    type = FunctionValuePostprocessor
    function = &#x27;outside_side_area_exact&#x27;
  [../]
  [./circle_volume_exact]
    type = FunctionValuePostprocessor
    function = &#x27;circle_volume_exact&#x27;
  [../]
  [./inside_volume_exact]
    type = FunctionValuePostprocessor
    function = &#x27;inside_volume_exact&#x27;
  [../]
  [./outside_volume_exact]
    type = FunctionValuePostprocessor
    function = &#x27;outside_volume_exact&#x27;
  [../]
  [./total_volume_exact]
    type = FunctionValuePostprocessor
    function = &#x27;total_volume_exact&#x27;
  [../]
[]

[Functions]
  [./circle_side_area_exact]
    type = ParsedFunction
    value = &#x27;2 * pi * ${radius} / ${perimeter_correction} * ${depth}&#x27;
  [../]
  [./inside_side_area_exact]
    type = ParsedFunction
    value = &#x27;${inner_box_length} * ${depth} * 4&#x27;
  [../]
  [./outside_side_area_exact]
    type = ParsedFunction
    value = &#x27;${outer_box_length} * ${depth} * 4&#x27;
  [../]
  [./circle_volume_exact]
    type = ParsedFunction
    value = &#x27;pi * ${radius}^2 * ${depth} / ${area_correction}&#x27;
  [../]
  [./inside_volume_exact]
    type = ParsedFunction
    value = &#x27;${inner_box_length}^2 * ${depth} - pi * ${radius}^2 * ${depth} / ${area_correction}&#x27;
  [../]
  [./outside_volume_exact]
    type = ParsedFunction
    value = &#x27;${outer_box_length}^2 * ${depth} - ${inner_box_length}^2 * ${depth}&#x27;
  [../]
  [./total_volume_exact]
    type = ParsedFunction
    value = &#x27;${outer_box_length}^2 * ${depth}&#x27;
  [../]

[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="92a06a7c-c2dd-47a7-b79c-b248ffbe4342"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh07.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.2
    max = 0.8
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.2
    max = 1.8
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh07
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1125896e-1246-4f22-947e-4b173cce3512"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mohr_coulomb/planar_hard4.i</h4><pre class="moose-pre"><code class="language-text"># apply repeated stretches in x direction, and smaller stretches along the y and z directions,
# so that sigma_II = sigma_III,
# which means that lode angle = -30deg.
# Both return to the edge (at lode_angle=-30deg, ie 000101) and tip are experienced.
#
# It is checked that the yield functions are less than their tolerance values
# It is checked that the cohesion hardens correctly

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0.05E-6*x*t&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0.05E-6*y*t&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;1E-6*z*t&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if((a&lt;1E-5)&amp;(b&lt;1E-5)&amp;(c&lt;1E-5)&amp;(d&lt;1E-5)&amp;(g&lt;1E-5)&amp;(h&lt;1E-5),0,abs(a)+abs(b)+abs(c)+abs(d)+abs(g)+abs(h))&#x27;
    vars = &#x27;a b c d g h&#x27;
    vals = &#x27;f0 f1 f2 f3 f4 f5&#x27;
  [../]
  [./coh_analytic]
    type = ParsedFunction
    value = &#x27;20-10*exp(-1E5*intnl)&#x27;
    vars = intnl
    vals = internal
  [../]
  [./coh_from_yieldfcns]
    type = ParsedFunction
    value = &#x27;(f0+f1-(sxx+syy)*sin(phi))/(-2)/cos(phi)&#x27;
    vars = &#x27;f0 f1 sxx syy phi&#x27;
    vals = &#x27;f0 f1 s_xx s_yy 0.8726646&#x27;
  [../]
  [./should_be_zero_coh]
    type = ParsedFunction
    value = &#x27;if(abs(a-b)&lt;1E-6,0,1E6*abs(a-b))&#x27;
    vars = &#x27;a b&#x27;
    vals = &#x27;Coh_analytic Coh_moose&#x27;
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./mc_int]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn3]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn4]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn5]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./mc_int_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_internal_parameter
    variable = mc_int
  [../]
  [./yield_fcn0]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn0
  [../]
  [./yield_fcn1]
    type = MaterialStdVectorAux
    index = 1
    property = plastic_yield_function
    variable = yield_fcn1
  [../]
  [./yield_fcn2]
    type = MaterialStdVectorAux
    index = 2
    property = plastic_yield_function
    variable = yield_fcn2
  [../]
  [./yield_fcn3]
    type = MaterialStdVectorAux
    index = 3
    property = plastic_yield_function
    variable = yield_fcn3
  [../]
  [./yield_fcn4]
    type = MaterialStdVectorAux
    index = 4
    property = plastic_yield_function
    variable = yield_fcn4
  [../]
  [./yield_fcn5]
    type = MaterialStdVectorAux
    index = 5
    property = plastic_yield_function
    variable = yield_fcn5
  [../]
[]

[Postprocessors]
  [./s_xx]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./s_xy]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_xy
  [../]
  [./s_xz]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_xz
  [../]
  [./s_yy]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./s_yz]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_yz
  [../]
  [./s_zz]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./internal]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = mc_int
  [../]
  [./f0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn0
  [../]
  [./f1]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn1
  [../]
  [./f2]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn2
  [../]
  [./f3]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn3
  [../]
  [./f4]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn4
  [../]
  [./f5]
   type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn5
  [../]
  [./yfcns_should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./Coh_analytic]
    type = FunctionValuePostprocessor
    function = coh_analytic
  [../]
  [./Coh_moose]
    type = FunctionValuePostprocessor
    function = coh_from_yieldfcns
  [../]
  [./cohesion_difference_should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_coh
  [../]
[]

[UserObjects]
  [./mc_coh]
    type = TensorMechanicsHardeningExponential
    value_0 = 10
    value_residual = 20
    rate = 1E5
  [../]
  [./mc_phi]
    type = TensorMechanicsHardeningConstant
    value = 0.8726646
  [../]
  [./mc_psi]
    type = TensorMechanicsHardeningConstant
    value = 1 #0.8726646 # 50deg
  [../]
  [./mc]
    type = TensorMechanicsPlasticMohrCoulombMulti
    cohesion = mc_coh
    friction_angle = mc_phi
    dilation_angle = mc_psi
    use_custom_returnMap = true
    yield_function_tolerance = 1E-5
    internal_constraint_tolerance = 1E-9
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0 1E7&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    ep_plastic_tolerance = 1E-12
    plastic_models = mc
  [../]
[]


[Executioner]
  end_time = 10
  dt = 2
  type = Transient
[]


[Outputs]
  file_base = planar_hard4
  exodus = false
  [./csv]
    type = CSV
    hide = &#x27;f0 f1 f2 f3 f4 f5 s_xy s_xz s_yz Coh_analytic Coh_moose&#x27;
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="94ed6e2a-ed33-4ecf-8a8d-b42fbbcbcd8b"><div class="modal-content"><h4>test/tests/functions/parsed/combined.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 1
  xmin = -1
  xmax = 1
  nx = 20
[]

[AuxVariables]
  [./f]
  [../]

  [./sv]
    family = SCALAR
    order = FIRST
    initial_condition = 100
  [../]
[]

[AuxKernels]
  [./function_aux]
    type = FunctionAux
    variable = f
    function = fn
  [../]
[]

[Functions]
  [./pp_fn]
    type = ParsedFunction
    value = &#x27;2*(t+1)&#x27;
  [../]
  [./cos_fn]
    type = ParsedFunction
    value = &#x27;cos(pi*x)&#x27;
  [../]
  [./fn]
    type = ParsedFunction
    value = &#x27;scalar_value * func / pp&#x27;
    vars = &#x27;scalar_value func   pp&#x27;
    vals = &#x27;sv           cos_fn pp&#x27;
  [../]
[]

[Postprocessors]
  [./pp]
    type = FunctionValuePostprocessor
    function = pp_fn
    execute_on = initial
  [../]
[]

[Problem]
  solve = false
[]

[Executioner]
  type = Steady
[]

[Outputs]
  show = f
  exodus = true
  execute_on = final
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="cba35934-87a0-457b-b435-02a3c116d583"><div class="modal-content"><h4>test/tests/kernels/ode/parsedode_pp_test.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  nx = 2
  ny = 2
  elem_type = QUAD4
[]

[Variables]
  [./x]
    family = SCALAR
    order = FIRST
    initial_condition = 0
  [../]
[]

[ScalarKernels]
  [./dt]
    type = ODETimeDerivative
    variable = x
  [../]
  [./ode1]
    type = ParsedODEKernel
    function = &#x27;-mytime&#x27;
    postprocessors = mytime
    variable = x
  [../]
[]

[Postprocessors]
  [./computed_x]
    type = ScalarVariable
    variable = x
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./mytime]
    type = FunctionValuePostprocessor
    function = t
    execute_on = &#x27;initial timestep_begin&#x27;
  [../]

  [./exact_x]
    type = FunctionValuePostprocessor
    function = &#x27;0.5*t^2&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./l2err_x]
    type = ScalarL2Error
    variable = x
    function = &#x27;0.5*t^2&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Executioner]
  type = Transient
  scheme = bdf2
  dt = 0.1
  num_steps = 10

  solve_type = &#x27;NEWTON&#x27;
[]

[Outputs]
  file_base = ode_pp_test_out
  hide = &#x27;x mytime&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f9f62c4b-8759-43cf-a48e-35445acba5af"><div class="modal-content"><h4>test/tests/controls/tag_based_naming_access/param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
    control_tags = &#x27;tag&#x27;
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;tag/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="badcd9fd-ed50-4500-ba59-c4e29381e8a4"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_lumped_17.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = false
# gravity = true
# supg = true
# transient = true
# lumped = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 0.5E-3&#x27;
  gravity = &#x27;-1 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 0.01
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 1
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-15 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_lumped_17
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="be00f3dc-7789-43ee-acb3-979c57ee7728"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# injection
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;500 500 1E1&#x27;
    x = &#x27;4000 5000 6500&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh03.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = -1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = -2E5
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 6500
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = bh05
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="98d2f0eb-5be4-433f-b518-21e588d83755"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav02d.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established in the transient situation when 0&lt;=saturation&lt;=1 (note the less-than-or-equal-to).
# 2phase (PP), 2components, vanGenuchten, constant fluid bulk-moduli for each phase, constant viscosity, constant permeability, Corey relative perm.
# A boundary condition enforces porepressures at the right boundary
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    x = &#x27;1E-3 1E-2 1E-1 2E-1&#x27;
    y = &#x27;1E-3 1E-2 0.2E-1 1E-1&#x27;
  [../]
[]

[Variables]
  [./ppwater]
    initial_condition = 0
  [../]
  [./ppgas]
    initial_condition = 0.5
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]

[BCs]
  [./ppwater]
    type = DirichletBC
    boundary = right
    variable = ppwater
    value = 0
  [../]
  [./ppgas]
    type = DirichletBC
    boundary = right
    variable = ppgas
    value = 0.5
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = ppwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = ppwater
    gravity = &#x27;-1 0 0&#x27;
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = ppgas
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = ppgas
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_ppwater]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 2 pp_water_top 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater ppgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 1.2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 1
      density0 = 0.1
      viscosity = 0.5
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = ppwater
    phase1_porepressure = ppgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[Postprocessors]
  [./pp_water_top]
    type = PointValue
    variable = ppwater
    point = &#x27;0 0 0&#x27;
  [../]
  [./pp_water_base]
    type = PointValue
    variable = ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_water_analytical]
    type = FunctionValuePostprocessor
    function = ana_ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./ppwater_00]
    type = PointValue
    variable = ppwater
    point = &#x27;0 0 0&#x27;
  [../]
  [./ppwater_01]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.1 0 0&#x27;
  [../]
  [./ppwater_02]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.2 0 0&#x27;
  [../]
  [./ppwater_03]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.3 0 0&#x27;
  [../]
  [./ppwater_04]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.4 0 0&#x27;
  [../]
  [./ppwater_05]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.5 0 0&#x27;
  [../]
  [./ppwater_06]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.6 0 0&#x27;
  [../]
  [./ppwater_07]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.7 0 0&#x27;
  [../]
  [./ppwater_08]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.8 0 0&#x27;
  [../]
  [./ppwater_09]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.9 0 0&#x27;
  [../]
  [./ppwater_10]
    type = PointValue
    variable = ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./ppgas_00]
    type = PointValue
    variable = ppgas
    point = &#x27;0 0 0&#x27;
  [../]
  [./ppgas_01]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.1 0 0&#x27;
  [../]
  [./ppgas_02]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.2 0 0&#x27;
  [../]
  [./ppgas_03]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.3 0 0&#x27;
  [../]
  [./ppgas_04]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.4 0 0&#x27;
  [../]
  [./ppgas_05]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.5 0 0&#x27;
  [../]
  [./ppgas_06]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.6 0 0&#x27;
  [../]
  [./ppgas_07]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.7 0 0&#x27;
  [../]
  [./ppgas_08]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.8 0 0&#x27;
  [../]
  [./ppgas_09]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.9 0 0&#x27;
  [../]
  [./ppgas_10]
    type = PointValue
    variable = ppgas
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  active = andy
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000&#x27;
  [../]
  [./check]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -snes_type&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000 test&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
  end_time = 1.0
[]

[Outputs]
  [./csv]
    type = CSV
    execute_on = &#x27;initial final&#x27;
    file_base = grav02d
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4d7ede17-dcc2-4345-a56e-f02de8efe456"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/tensile/random_planar.i</h4><pre class="moose-pre"><code class="language-text"># Plasticity models:
# Planar tensile with strength = 1MPa
#
# Lame lambda = 1GPa.  Lame mu = 1.3GPa
#
# A line of elements is perturbed randomly, and return to the yield surface at each quadpoint is checked

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 1250
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 1250
  zmin = 0
  zmax = 1
[]
[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Modules/TensorMechanics/Master]
  [./all]
    add_variables = true
    incremental = true
    strain = finite
    generate_output = &#x27;stress_xx stress_xy stress_xz stress_yy stress_yz stress_zz&#x27;
  [../]
[]

[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./f0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./f0]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = f0
  [../]
  [./f1]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 1
    variable = f1
  [../]
  [./f2]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 2
    variable = f2
  [../]
  [./int0]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    factor = 1E6
    index = 0
    variable = int0
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./tot_iters]
    type = ElementIntegralMaterialProperty
    mat_prop = plastic_NR_iterations
    outputs = console
  [../]
  [./raw_f0]
    type = ElementExtremeValue
    variable = f0
    outputs = console
  [../]
  [./raw_f1]
    type = ElementExtremeValue
    variable = f1
    outputs = console
  [../]
  [./raw_f2]
    type = ElementExtremeValue
    variable = f2
    outputs = console
  [../]
  [./iter]
    type = ElementExtremeValue
    variable = iter
    outputs = console
  [../]
  [./f0]
    type = FunctionValuePostprocessor
    function = should_be_zero0_fcn
  [../]
  [./f1]
    type = FunctionValuePostprocessor
    function = should_be_zero1_fcn
  [../]
  [./f2]
    type = FunctionValuePostprocessor
    function = should_be_zero2_fcn
  [../]
[]

[Functions]
  [./should_be_zero0_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f0&#x27;
  [../]
  [./should_be_zero1_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f1&#x27;
  [../]
  [./should_be_zero2_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f2&#x27;
  [../]
[]

[UserObjects]
  [./hard]
    type = TensorMechanicsHardeningCubic
    value_0 = 1E6
    value_residual = 0
    internal_limit = 1
  [../]
  [./tensile]
    type = TensorMechanicsPlasticTensileMulti
    tensile_strength = hard
    yield_function_tolerance = 1.0E-1
    shift = 1.0E-1
    internal_constraint_tolerance = 1.0E-7
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;1E9 1.3E9&#x27;
  [../]
  [./multi]
    type = ComputeMultiPlasticityStress
    block = 0
    deactivation_scheme = &#x27;safe_to_dumb&#x27;
    ep_plastic_tolerance = 1E-7
    plastic_models = &#x27;tensile&#x27;
    max_NR_iterations = 5
    min_stepsize = 1E-3
    max_stepsize_for_dumb = 1
    debug_fspb = crash
    debug_jac_at_stress = &#x27;10 0 0 0 10 0 0 0 10&#x27;
    debug_jac_at_pm = &#x27;1 1 1&#x27;
    debug_jac_at_intnl = &#x27;1 1 1&#x27;
    debug_stress_change = 1E1
    debug_pm_change = &#x27;1E-6 1E-6 1E-6&#x27;
    debug_intnl_change = &#x27;1E-6 1E-6 1E-6&#x27;
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random_planar
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2f9a2bc6-358b-4bd9-82e1-042e361d0b9a"><div class="modal-content"><h4>modules/porous_flow/test/tests/energy_conservation/heat04_action.i</h4><pre class="moose-pre"><code class="language-text"># heat04, but using an action
#
# The sample is a single unit element, with fixed displacements on
# all sides.  A heat source of strength S (J/m^3/s) is applied into
# the element.  There is no fluid flow or heat flow.  The rise
# in temperature, porepressure and stress, and the change in porosity is
# matched with theory.
#
# In this case, fluid mass must be conserved, and there is no
# volumetric strain, so
# porosity * fluid_density = constant
# Also, the energy-density in the rock-fluid system increases with S:
# d/dt [(1 - porosity) * rock_density * rock_heat_cap * T + porosity * fluid_density * fluid_heat_cap * T] = S
# Also, the porosity evolves according to THM as
# porosity = biot + (porosity0 - biot) * exp( (biot - 1) * P / fluid_bulk + rock_thermal_exp * T)
# Finally, the effective stress must be exactly zero (as there is
# no strain).
#
# Let us assume that
# fluid_density = dens0 * exp(P / fluid_bulk - fluid_thermal_exp * T)
# Then the conservation of fluid mass means
# porosity = por0 * exp(- P / fluid_bulk + fluid_thermal_exp * T)
# where dens0 * por0 = the initial fluid mass.
# The last expression for porosity, combined with the THM one,
# and assuming that biot = 1 for simplicity, gives
# porosity = 1 + (porosity0 - 1) * exp(rock_thermal_exp * T) = por0 * exp(- P / fluid_bulk + fluid_thermal_exp * T) .... (A)
#
# This stuff may be substituted into the heat energy-density equation:
# S = d/dt [(1 - porosity0) * exp(rock_thermal_exp * T) * rock_density * rock_heat_cap * T + porosity * fluid_density * fluid_heat_cap * T]
#
# If S is constant then
# S * t = (1 - porosity0) * exp(rock_thermal_exp * T) * rock_density * rock_heat_cap * T + porosity * fluid_density * fluid_heat_cap * T
# with T(t=0) = 0 then Eqn(A) implies that por0 = porosity0 and
# P / fluid_bulk = fluid_thermal_exp * T - log(1 + (por0 - 1) * exp(rock_thermal_exp * T)) + log(por0)
#
# Parameters:
# A = 2
# fluid_bulk = 2.0
# dens0 = 3.0
# fluid_thermal_exp = 0.5
# fluid_heat_cap = 2
# por0 = 0.5
# rock_thermal_exp = 0.25
# rock_density = 5
# rock_heat_capacity = 0.2

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.5
      cv = 2
      cp = 2
      bulk_modulus = 2.0
      density0 = 3.0
    [../]
  [../]
[]

[PorousFlowUnsaturated]
  coupling_type = ThermoHydroMechanical
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  porepressure = pp
  temperature = temp
  dictator_name = Sir
  biot_coefficient = 1.0
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  van_genuchten_alpha = 1.0E-12
  van_genuchten_m = 0.5
  relative_permeability_type = Corey
  relative_permeability_exponent = 0.0
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = Sir
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./pp]
  [../]
  [./temp]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
[]

[Kernels]
  [./heat_source]
    type = BodyForce
    function = 1
    variable = temp
  [../]
[]

[Functions]
  [./err_T_fcn]
    type = ParsedFunction
    vars = &#x27;por0 rte temp rd rhc m0 fhc source&#x27;
    vals = &#x27;0.5 0.25 t0   5  0.2 1.5 2  1&#x27;
    value = &#x27;((1-por0)*exp(rte*temp)*rd*rhc*temp+m0*fhc*temp-source*t)/(source*t)&#x27;
  [../]
  [./err_pp_fcn]
    type = ParsedFunction
    vars = &#x27;por0 rte temp rd rhc m0 fhc source bulk pp fte&#x27;
    vals = &#x27;0.5 0.25 t0   5  0.2 1.5 2  1      2    p0 0.5&#x27;
    value = &#x27;(bulk*(fte*temp-log(1+(por0-1)*exp(rte*temp))+log(por0))-pp)/pp&#x27;
  [../]
[]

[AuxVariables]
  [./porosity]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./porosity]
    type = PorousFlowPropertyAux
    property = porosity
    variable = porosity
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosity
    thermal = true
    fluid = true
    mechanical = true
    ensure_positive = false
    biot_coefficient = 1.0
    porosity_zero = 0.5
    thermal_expansion_coeff = 0.25
    solid_bulk = 2
  [../]
  [./rock_heat]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 0.2
    density = 5.0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0 0 0 0 0 0 0 0 0&#x27;
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;0 0 0  0 0 0  0 0 0&#x27;
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = pp
  [../]
  [./t0]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = temp
  [../]
  [./porosity]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = porosity
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./fluid_mass]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;timestep_end&#x27;
    use_displaced_mesh = true
    outputs = &#x27;console csv&#x27;
  [../]
  [./total_heat]
    type = PorousFlowHeatEnergy
    phase = 0
    execute_on = &#x27;timestep_end&#x27;
    use_displaced_mesh = true
    outputs = &#x27;console csv&#x27;
  [../]
  [./err_T]
    type = FunctionValuePostprocessor
    function = err_T_fcn
  [../]
  [./err_P]
    type = FunctionValuePostprocessor
    function = err_pp_fcn
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1
  end_time = 5
[]

[Outputs]
  execute_on = &#x27;initial timestep_end&#x27;
  file_base = heat04_action
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1d93b59b-3167-4bdc-9409-04df0636f448"><div class="modal-content"><h4>modules/richards/test/tests/sinks/s_fu_01.i</h4><pre class="moose-pre"><code class="language-text"># with fully_upwind sink
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  SUPG_UO = SUPGstandard
  sat_UO = Saturation
  seff_UO = SeffVG
  fully_upwind = true
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.5
    al = 1 # same deal with PETSc constant state
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = initial_pressure
    [../]
  [../]
[]

[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 2
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((mi-lfout-rfout-mf)/2/(mi+mf))
    vars = &#x27;mi mf lfout rfout&#x27;
    vals = &#x27;mass_init mass_fin left_flux_out right_flux_out&#x27;
  [../]
[]

[Postprocessors]
  [./mass_init]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]
  [./mass_fin]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]
  [./left_flux_out]
    type = RichardsPiecewiseLinearSinkFlux
    boundary = left
    variable = pressure
    pressures = &#x27;0 1&#x27;
    bare_fluxes = &#x27;1 2&#x27;
    use_mobility = false
    use_relperm = false
  [../]
  [./right_flux_out]
    type = RichardsPiecewiseLinearSinkFlux
    boundary = right
    variable = pressure
    pressures = &#x27;0 1&#x27;
    bare_fluxes = &#x27;1 2&#x27;
    use_mobility = false
    use_relperm = false
  [../]
  [./p0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
  [./mass_bal]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
  [../]
[]

[BCs]
  [./left_flux]
    type = RichardsPiecewiseLinearSink
    boundary = left
    pressures = &#x27;0 1&#x27;
    bare_fluxes = &#x27;1 2&#x27;
    variable = pressure
    use_mobility = false
    use_relperm = false
  [../]
  [./right_flux]
    type = RichardsPiecewiseLinearSink
    boundary = right
    pressures = &#x27;0 1&#x27;
    bare_fluxes = &#x27;1 2&#x27;
    variable = pressure
    use_mobility = false
    use_relperm = false
  [../]
[]

[Kernels]
  active = &#x27;richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  active = &#x27;andy&#x27;
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 2E-3
  end_time = 0.2
  nl_abs_tol = 1E-12
  nl_rel_tol = 1E-10
[]

[Outputs]
  file_base = s_fu_01
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8324ea6e-2630-4b1a-994f-7e37e9df990a"><div class="modal-content"><h4>modules/porous_flow/examples/tutorial/11_2D.i</h4><pre class="moose-pre"><code class="language-text"># Two-phase borehole injection problem in RZ coordinates
[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 10
    xmin = 1.0
    xmax = 10
    bias_x = 1.4
    ny = 3
    ymin = -6
    ymax = 6
  []
  [./aquifer]
    input = gen
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 -2 0&#x27;
    top_right = &#x27;10 2 0&#x27;
  [../]
  [./injection_area]
    type = ParsedGenerateSideset
    combinatorial_geometry = &#x27;x&lt;1.0001&#x27;
    included_subdomain_ids = 1
    new_sideset_name = &#x27;injection_area&#x27;
    input = &#x27;aquifer&#x27;
  [../]
  [./rename]
    type = RenameBlockGenerator
    old_block_id = &#x27;0 1&#x27;
    new_block_name = &#x27;caps aquifer&#x27;
    input = &#x27;injection_area&#x27;
  [../]
[]

[Problem]
  coord_type = RZ
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pwater pgas T disp_r&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    alpha = 1E-6
    m = 0.6
  [../]
[]

[GlobalParams]
  displacements = &#x27;disp_r disp_z&#x27;
  gravity = &#x27;0 0 0&#x27;
  biot_coefficient = 1.0
  PorousFlowDictator = dictator
[]

[Variables]
  [./pwater]
    initial_condition = 20E6
  [../]
  [./pgas]
    initial_condition = 20.1E6
  [../]
  [./T]
    initial_condition = 330
    scaling = 1E-5
  [../]
  [./disp_r]
    scaling = 1E-5
  [../]
[]

[Kernels]
  [./mass_water_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./flux_water]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./vol_strain_rate_water]
    type = PorousFlowMassVolumetricExpansion
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./mass_co2_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    use_displaced_mesh = false
    variable = pgas
  [../]
  [./flux_co2]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    use_displaced_mesh = false
    variable = pgas
  [../]
  [./vol_strain_rate_co2]
    type = PorousFlowMassVolumetricExpansion
    fluid_component = 1
    use_displaced_mesh = false
    variable = pgas
  [../]
  [./energy_dot]
    type = PorousFlowEnergyTimeDerivative
    use_displaced_mesh = false
    variable = T
  [../]
  [./advection]
    type = PorousFlowHeatAdvection
    use_displaced_mesh = false
    variable = T
  [../]
  [./conduction]
    type = PorousFlowHeatConduction
    use_displaced_mesh = false
    variable = T
  [../]
  [./vol_strain_rate_heat]
    type = PorousFlowHeatVolumetricExpansion
    use_displaced_mesh = false
    variable = T
  [../]
  [./grad_stress_r]
    type = StressDivergenceRZTensors
    temperature = T
    variable = disp_r
    eigenstrain_names = thermal_contribution
    use_displaced_mesh = false
    component = 0
  [../]
  [./poro_r]
    type = PorousFlowEffectiveStressCoupling
    variable = disp_r
    use_displaced_mesh = false
    component = 0
  [../]
[]

[AuxVariables]
  [./disp_z]
  [../]
  [./effective_fluid_pressure]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./mass_frac_phase0_species0]
    initial_condition = 1 # all water in phase=0
  [../]
  [./mass_frac_phase1_species0]
    initial_condition = 0 # no water in phase=1
  [../]
  [./sgas]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./swater]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_rr]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_tt]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./porosity]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./effective_fluid_pressure]
    type = ParsedAux
    args = &#x27;pwater pgas swater sgas&#x27;
    function = &#x27;pwater * swater + pgas * sgas&#x27;
    variable = effective_fluid_pressure
  [../]
  [./swater]
    type = PorousFlowPropertyAux
    variable = swater
    property = saturation
    phase = 0
    execute_on = timestep_end
  [../]
  [./sgas]
    type = PorousFlowPropertyAux
    variable = sgas
    property = saturation
    phase = 1
    execute_on = timestep_end
  [../]
  [./stress_rr_aux]
    type = RankTwoAux
    variable = stress_rr
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
  [../]
  [./stress_tt]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_tt
    index_i = 2
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 1
    index_j = 1
  [../]
  [./porosity]
    type = PorousFlowPropertyAux
    variable = porosity
    property = porosity
    execute_on = timestep_end
  [../]
[]


[BCs]
  [./pinned_top_bottom_r]
    type = DirichletBC
    variable = disp_r
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./cavity_pressure_r]
    type = Pressure
    boundary = injection_area
    variable = disp_r
    component = 0
    postprocessor = constrained_effective_fluid_pressure_at_wellbore
    use_displaced_mesh = false
  [../]

  [./cold_co2]
    type = DirichletBC
    boundary = injection_area
    variable = T
    value = 290  # injection temperature
    use_displaced_mesh = false
  [../]
  [./constant_co2_injection]
    type = PorousFlowSink
    boundary = injection_area
    variable = pgas
    fluid_phase = 1
    flux_function = -1E-4
    use_displaced_mesh = false
  [../]

  [./outer_water_removal]
    type = PorousFlowPiecewiseLinearSink
    boundary = right
    variable = pwater
    fluid_phase = 0
    pt_vals = &#x27;0 1E9&#x27;
    multipliers = &#x27;0 1E8&#x27;
    PT_shift = 20E6
    use_mobility = true
    use_relperm = true
    use_displaced_mesh = false
  [../]
  [./outer_co2_removal]
    type = PorousFlowPiecewiseLinearSink
    boundary = right
    variable = pgas
    fluid_phase = 1
    pt_vals = &#x27;0 1E9&#x27;
    multipliers = &#x27;0 1E8&#x27;
    PT_shift = 20.1E6
    use_mobility = true
    use_relperm = true
    use_displaced_mesh = false
  [../]
[]

[Modules]
  [./FluidProperties]
    [./true_water]
      type = Water97FluidProperties
    [../]
    [./tabulated_water]
      type = TabulatedFluidProperties
      fp = true_water
      temperature_min = 275
      pressure_max = 1E8
      fluid_property_file = water97_tabulated_11.csv
    [../]
    [./true_co2]
      type = CO2FluidProperties
    [../]
    [./tabulated_co2]
      type = TabulatedFluidProperties
      fp = true_co2
      temperature_min = 275
      pressure_max = 1E8
      fluid_property_file = co2_tabulated_11.csv
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = T
  [../]
  [./saturation_calculator]
    type = PorousFlow2PhasePP
    phase0_porepressure = pwater
    phase1_porepressure = pgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;mass_frac_phase0_species0 mass_frac_phase1_species0&#x27;
  [../]
  [./water]
    type = PorousFlowSingleComponentFluid
    fp = tabulated_water
    phase = 0
  [../]
  [./co2]
    type = PorousFlowSingleComponentFluid
    fp = tabulated_co2
    phase = 1
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 4
    s_res = 0.1
    sum_s_res = 0.2
    phase = 0
  [../]
  [./relperm_co2]
    type = PorousFlowRelativePermeabilityBC
    nw_phase = true
    lambda = 2
    s_res = 0.1
    sum_s_res = 0.2
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosity
    fluid = true
    mechanical = true
    thermal = true
    porosity_zero = 0.1
    reference_temperature = 330
    reference_porepressure = 20E6
    thermal_expansion_coeff = 15E-6 # volumetric
    solid_bulk = 8E9 # unimportant since biot = 1
  [../]
  [./permeability_aquifer]
    type = PorousFlowPermeabilityKozenyCarman
    block = aquifer
    poroperm_function = kozeny_carman_phi0
    phi0 = 0.1
    n = 2
    m = 2
    k0 = 1E-12
  [../]
  [./permeability_caps]
    type = PorousFlowPermeabilityKozenyCarman
    block = caps
    poroperm_function = kozeny_carman_phi0
    phi0 = 0.1
    n = 2
    m = 2
    k0 = 1E-15
    k_anisotropy = &#x27;1 0 0  0 1 0  0 0 0.1&#x27;
  [../]
  [./rock_thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;2 0 0  0 2 0  0 0 2&#x27;
  [../]
  [./rock_internal_energy]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 1100
    density = 2300
  [../]

  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 5E9
    poissons_ratio = 0.0
  [../]
  [./strain]
    type = ComputeAxisymmetricRZSmallStrain
    eigenstrain_names = &#x27;thermal_contribution initial_stress&#x27;
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = T
    thermal_expansion_coeff = 5E-6 # this is the linear thermal expansion coefficient
    eigenstrain_name = thermal_contribution
    stress_free_temperature = 330
  [../]
  [./initial_strain]
    type = ComputeEigenstrainFromInitialStress
    initial_stress = &#x27;20E6 0 0  0 20E6 0  0 0 20E6&#x27;
    eigenstrain_name = initial_stress
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]

  [./effective_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./volumetric_strain]
    type = PorousFlowVolumetricStrain
  [../]
[]

[Postprocessors]
  [./effective_fluid_pressure_at_wellbore]
    type = PointValue
    variable = effective_fluid_pressure
    point = &#x27;1 0 0&#x27;
    execute_on = timestep_begin
    use_displaced_mesh = false
  [../]
  [./constrained_effective_fluid_pressure_at_wellbore]
    type = FunctionValuePostprocessor
    function = constrain_effective_fluid_pressure
    execute_on = timestep_begin
  [../]
[]

[Functions]
  [./constrain_effective_fluid_pressure]
    type = ParsedFunction
    vars = effective_fluid_pressure_at_wellbore
    vals = effective_fluid_pressure_at_wellbore
    value = &#x27;max(effective_fluid_pressure_at_wellbore, 20E6)&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1E3
    growth_factor = 1.2
    optimal_iterations = 10
  [../]
  nl_abs_tol = 1E-7
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2b6f1b03-ceb9-4e2a-86f6-45207dc5469d"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/pp_generation_fullysat_action.i</h4><pre class="moose-pre"><code class="language-text"># Same as pp_generation.i, but using an Action
#
# A sample is constrained on all sides and its boundaries are
# also impermeable.  Fluid is pumped into the sample via a
# volumetric source (ie kg/second per cubic meter), and the
# rise in porepressure is observed.
#
# Source = s  (units = kg/m^3/second)
#
# Expect:
# fluid_mass = mass0 + s*t
# stress = 0 (remember this is effective stress)
# Porepressure = fluid_bulk*log(fluid_mass_density/density_P0), where fluid_mass_density = fluid_mass*porosity
# porosity = biot+(phi0-biot)*exp(pp(biot-1)/solid_bulk)
#
# Parameters:
# Biot coefficient = 0.3
# Phi0 = 0.1
# Solid Bulk modulus = 2
# fluid_bulk = 13
# density_P0 = 1

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]
[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 13.0
      viscosity = 1.0
      density0 = 1.0
    [../]
  [../]
[]

[PorousFlowFullySaturated]
  coupling_type = HydroMechanical
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  porepressure = porepressure
  biot_coefficient = 0.3
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
[]


[Kernels]
  [./source]
    type = BodyForce
    function = 0.1
    variable = porepressure
  [../]
[]

[AuxVariables]
  [./porosity]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./porosity]
    type = PorousFlowPropertyAux
    variable = porosity
    property = porosity
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosity
    fluid = true
    mechanical = true
    porosity_zero = 0.1
    biot_coefficient = 0.3
    solid_bulk = 2
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0   0 1 0   0 0 1&#x27; # unimportant
  [../]
[]

[Functions]
  [./porosity_analytic]
    type = ParsedFunction
    value = &#x27;biot+(phi0-biot)*exp(pp*(biot-1)/bulk)&#x27;
    vars = &#x27;biot phi0 pp bulk&#x27;
    vals = &#x27;0.3 0.1 p0 2&#x27;
  [../]
[]

[Postprocessors]
  [./fluid_mass]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;initial timestep_end&#x27;
    use_displaced_mesh = true
  [../]
  [./porosity]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    point = &#x27;0 0 0&#x27;
    variable = porosity
  [../]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
  [../]
  [./porosity_analytic]
    type = FunctionValuePostprocessor
    function = porosity_analytic
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0.5&#x27;
    variable = disp_z
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]

[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  dt = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = pp_generation_fullysat_action
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d7044ebf-eafa-45c8-af89-8d4d6c94e516"><div class="modal-content"><h4>test/tests/postprocessors/change_over_time/change_over_time.i</h4><pre class="moose-pre"><code class="language-text"># This test tests the ChangeOverTimePostprocessor, which computes the change
# in a postprocessor value with respect to the previous value or with respect to
# the initial value. This test creates a time-dependent function postprocessor
# and then computes its change over a timestep. The FE problem used here is a
# dummy problem and has no effect on the test.

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 5
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./time_derivative]
    type = TimeDerivative
    variable = u
  [../]
  [./diff]
    type = Diffusion
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient

  start_time = 0.0
  dt = 1.0
  num_steps = 2
[]

[Functions]
  [./my_function]
    type = ParsedFunction
    value = &#x27;1 + t * t&#x27;
  [../]
[]

[Postprocessors]
  [./my_postprocessor]
    type = FunctionValuePostprocessor
    function = my_function
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./change_over_time]
    type = ChangeOverTimePostprocessor
    postprocessor = my_postprocessor
    change_with_respect_to_initial = false
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Outputs]
  file_base = &#x27;change_over_time_previous&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="334d96b3-bae0-484d-a766-acf6d44f1276"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/mandel_fully_saturated.i</h4><pre class="moose-pre"><code class="language-text"># Mandel&#x27;s problem of consolodation of a drained medium
# Using the FullySaturatedDarcyBase and FullySaturatedMassTimeDerivative kernels
# Note the use of consistent_with_displaced_mesh = false in the calculation of volumetric strain
#
# A sample is in plane strain.
# -a &lt;= x &lt;= a
# -b &lt;= y &lt;= b
# It is squashed with constant force by impermeable, frictionless plattens on its top and bottom surfaces (at y=+/-b)
# Fluid is allowed to leak out from its sides (at x=+/-a)
# The porepressure within the sample is monitored.
#
# As is common in the literature, this is simulated by
# considering the quarter-sample, 0&lt;=x&lt;=a and 0&lt;=y&lt;=b, with
# impermeable, roller BCs at x=0 and y=0 and y=b.
# Porepressure is fixed at zero on x=a.
# Porepressure and displacement are initialised to zero.
# Then the top (y=b) is moved downwards with prescribed velocity,
# so that the total force that is inducing this downwards velocity
# is fixed.  The velocity is worked out by solving Mandel&#x27;s problem
# analytically, and the total force is monitored in the simulation
# to check that it indeed remains constant.
#
# Here are the problem&#x27;s parameters, and their values:
# Soil width.  a = 1
# Soil height.  b = 0.1
# Soil&#x27;s Lame lambda.  la = 0.5
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = G = 0.75
# Soil bulk modulus.  K = la + 2*mu/3 = 1
# Drained Poisson ratio.  nu = (3K - 2G)/(6K + 2G) = 0.2
# Soil bulk compliance.  1/K = 1
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Biot modulus.  M = 1/(phi0/Kf + (alpha - phi0)(1 - alpha)/K) = 4.705882
# Undrained bulk modulus. Ku = K + alpha^2*M = 2.694118
# Undrained Poisson ratio.  nuu = (3Ku - 2G)/(6Ku + 2G) = 0.372627
# Skempton coefficient.  B = alpha*M/Ku = 1.048035
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Consolidation coefficient.  c = 2*k*B^2*G*(1-nu)*(1+nuu)^2/9/(1-nuu)/(nuu-nu) = 3.821656
# Normal stress on top.  F = 1
#
# The solution for porepressure and displacements is given in
# AHD Cheng and E Detournay &quot;A direct boundary element method for plane strain poroelasticity&quot; International Journal of Numerical and Analytical Methods in Geomechanics 12 (1988) 551-572.
# The solution involves complicated infinite series, so I shall not write it here

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 10
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 0.1
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./roller_xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left&#x27;
  [../]
  [./roller_ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom&#x27;
  [../]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
  [./xmax_drained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = right
  [../]
  [./top_velocity]
    type = FunctionDirichletBC
    variable = disp_y
    function = top_velocity
    boundary = top
  [../]
[]

[Functions]
  [./top_velocity]
    type = PiecewiseLinear
    x = &#x27;0 0.002 0.006   0.014   0.03    0.046   0.062   0.078   0.094   0.11    0.126   0.142   0.158   0.174   0.19 0.206 0.222 0.238 0.254 0.27 0.286 0.302 0.318 0.334 0.35 0.366 0.382 0.398 0.414 0.43 0.446 0.462 0.478 0.494 0.51 0.526 0.542 0.558 0.574 0.59 0.606 0.622 0.638 0.654 0.67 0.686 0.702&#x27;
    y = &#x27;-0.041824842    -0.042730269    -0.043412712    -0.04428867     -0.045509181    -0.04645965     -0.047268246 -0.047974749      -0.048597109     -0.0491467  -0.049632388     -0.050061697      -0.050441198     -0.050776675     -0.051073238      -0.0513354 -0.051567152      -0.051772022     -0.051953128 -0.052113227 -0.052254754 -0.052379865 -0.052490464 -0.052588233 -0.052674662 -0.052751065 -0.052818606 -0.052878312 -0.052931093 -0.052977751 -0.053018997 -0.053055459 -0.053087691 -0.053116185 -0.053141373 -0.05316364 -0.053183324 -0.053200724 -0.053216106 -0.053229704 -0.053241725 -0.053252351 -0.053261745 -0.053270049 -0.053277389 -0.053283879 -0.053289615&#x27;
  [../]
[]

[AuxVariables]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./tot_force]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./tot_force]
    type = ParsedAux
    args = &#x27;stress_yy porepressure&#x27;
    execute_on = timestep_end
    variable = tot_force
    function = &#x27;-stress_yy+0.6*porepressure&#x27;
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    component = 2
    variable = disp_z
  [../]
  [./mass0]
    type = PorousFlowFullySaturatedMassTimeDerivative
    biot_coefficient = 0.6
    coupling_type = HydroMechanical
    variable = porepressure
  [../]
  [./flux]
    type = PorousFlowFullySaturatedDarcyBase
    variable = porepressure
    gravity = &#x27;0 0 0&#x27;
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 8
      density0 = 1
      thermal_expansion = 0
      viscosity = 1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0.5 0.75&#x27;
    # bulk modulus is lambda + 2*mu/3 = 0.5 + 2*0.75/3 = 1
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure_qp]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
    consistent_with_displaced_mesh = false
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = porepressure
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid_qp]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is ever used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.6
    solid_bulk_compliance = 1
    fluid_bulk_modulus = 8
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0.0 0 0&#x27;
    variable = porepressure
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0.1 0 0&#x27;
    variable = porepressure
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0.2 0 0&#x27;
    variable = porepressure
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0.3 0 0&#x27;
    variable = porepressure
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0.4 0 0&#x27;
    variable = porepressure
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0.5 0 0&#x27;
    variable = porepressure
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0.6 0 0&#x27;
    variable = porepressure
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0.7 0 0&#x27;
    variable = porepressure
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0.8 0 0&#x27;
    variable = porepressure
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0.9 0 0&#x27;
    variable = porepressure
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;1 0 0&#x27;
    variable = porepressure
  [../]
  [./xdisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_x
  [../]
  [./ydisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_y
  [../]
  [./total_downwards_force]
     type = ElementAverageValue
     outputs = csv
     variable = tot_force
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.15*t&lt;0.01,0.15*t,0.01)
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 0.7
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = mandel_fully_saturated
  [./csv]
    interval = 3
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="15f743bb-9edb-4186-abad-049bc2107d91"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/pp_generation_action.i</h4><pre class="moose-pre"><code class="language-text"># Same as pp_generation.i, but using an Action
#
# A sample is constrained on all sides and its boundaries are
# also impermeable.  Fluid is pumped into the sample via a
# volumetric source (ie kg/second per cubic meter), and the
# rise in porepressure is observed.
#
# Source = s  (units = kg/m^3/second)
#
# Expect:
# fluid_mass = mass0 + s*t
# stress = 0 (remember this is effective stress)
# Porepressure = fluid_bulk*log(fluid_mass_density/density_P0), where fluid_mass_density = fluid_mass*porosity
# porosity = biot+(phi0-biot)*exp(pp(biot-1)/solid_bulk)
#
# Parameters:
# Biot coefficient = 0.3
# Phi0 = 0.1
# Solid Bulk modulus = 2
# fluid_bulk = 13
# density_P0 = 1

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]
[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 13.0
      viscosity = 1.0
      density0 = 1.0
    [../]
  [../]
[]

[PorousFlowUnsaturated]
  coupling_type = HydroMechanical
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  porepressure = porepressure
  biot_coefficient = 0.3
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  van_genuchten_alpha = 1.0
  van_genuchten_m = 0.8
  relative_permeability_type = Corey
  relative_permeability_exponent = 0.0
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
[]

[Kernels]
  [./source]
    type = BodyForce
    function = 0.1
    variable = porepressure
  [../]
[]

[AuxVariables]
  [./porosity]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./porosity]
    type = PorousFlowPropertyAux
    variable = porosity
    property = porosity
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosity
    fluid = true
    mechanical = true
    porosity_zero = 0.1
    biot_coefficient = 0.3
    solid_bulk = 2
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0   0 1 0   0 0 1&#x27; # unimportant
  [../]
[]

[Functions]
  [./porosity_analytic]
    type = ParsedFunction
    value = &#x27;biot+(phi0-biot)*exp(pp*(biot-1)/bulk)&#x27;
    vars = &#x27;biot phi0 pp bulk&#x27;
    vals = &#x27;0.3 0.1 p0 2&#x27;
  [../]
[]

[Postprocessors]
  [./fluid_mass]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;initial timestep_end&#x27;
    use_displaced_mesh = true
  [../]
  [./porosity]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    point = &#x27;0 0 0&#x27;
    variable = porosity
  [../]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
  [../]
  [./porosity_analytic]
    type = FunctionValuePostprocessor
    function = porosity_analytic
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0.5&#x27;
    variable = disp_z
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]

[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  dt = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = pp_generation_action
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7dc45f54-b47d-418b-a43f-d0cecedf81fc"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh03.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = true
# transient = false

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.4
    max = 0.6
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.4
    max = 1.6
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardsfgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
    outputs = none # no reason why mass should be conserved
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
    outputs = none # no reason why mass should be conserved
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;nonzero&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh03
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="103cac5e-6a0f-4921-b611-bf705015fe08"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/pls03_action.i</h4><pre class="moose-pre"><code class="language-text"># Test that the upwinding works correctly.
#
# A poly-line sink sits at the centre of the element.
# It has length=4 and weight=0.5, and extracts fluid
# at a constant rate of
# (1 * relative_permeability) kg.m^-1.s^-1
# Since it sits at the centre of the element, it extracts
# equally from each node, so the rate of extraction from
# each node is
# (0.5 * relative_permeability) kg.s^-1
# including the length and weight effects.
#
# There is no fluid flow.
#
# The initial conditions are such that all nodes have
# relative_permeability=0, except for one which has
# relative_permeaility = 1.  Therefore, all nodes should
# remain at their initial porepressure, except the one.
#
# The porosity is 0.1, and the elemental volume is 2,
# so the fluid mass at the node in question = 0.2 * density / 4,
# where the 4 is the number of nodes in the element.
# In this simulation density = dens0 * exp(P / bulk), with
# dens0 = 100, and bulk = 20 MPa.
# The initial porepressure P0 = 10 MPa, so the final (after
# 1 second of simulation) is
# P(t=1) = 8.748592 MPa
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmin = 0
  xmax = 2
  ymin = 0
  ymax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 2.0E7
      viscosity = 1.0
      density0 = 100.0
    [../]
  [../]
[]

[PorousFlowUnsaturated]
  porepressure = pp
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  van_genuchten_alpha = 1.0E-7
  van_genuchten_m = 0.5
  relative_permeability_exponent = 2
  residual_saturation = 0.99
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    #function = if((x&lt;1)&amp;(y&lt;0.5),1E7,-1E7)
    function = if((x&lt;1)&amp;(y&gt;0.5),1E7,-1E7)
    #function = if((x&gt;1)&amp;(y&lt;0.5),1E7,-1E7)
    #function = if((x&gt;1)&amp;(y&gt;0.5),1E7,-1E7)
  [../]
[]

[UserObjects]
  [./pls_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
[]

[Materials]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0 0 0  0 0 0  0 0 0&#x27;
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
[]


[DiracKernels]
  [./pls]
    type = PorousFlowPolyLineSink
    fluid_phase = 0
    point_file = pls03.bh
    use_relative_permeability = true
    line_length = 4
    SumQuantityUO = pls_total_outflow_mass
    variable = pp
    p_or_t_vals = &#x27;0 1E7&#x27;
    fluxes = &#x27;1 1&#x27;
  [../]
[]


[Postprocessors]
  [./pls_report]
    type = PorousFlowPlotQuantity
    uo = pls_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p00]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
  [./p01]
    type = PointValue
    variable = pp
    point = &#x27;0 1 0&#x27;
    execute_on = timestep_end
  [../]
  [./p20]
    type = PointValue
    variable = pp
    point = &#x27;2 0 0&#x27;
    execute_on = timestep_end
  [../]
  [./p21]
    type = PointValue
    variable = pp
    point = &#x27;2 1 0&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 pls_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1
  dt = 1
  solve_type = NEWTON
[]

[Outputs]
  file_base = pls03_action
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c527e744-509d-4002-95c8-876f77cff2af"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh02.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = false
# transient = false

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  # get nonconvergence if initial condition is too crazy
  [./water_ic]
    type = FunctionIC
    function = pwater_initial
    variable = pwater
  [../]
  [./gas_ic]
    type = FunctionIC
    function = pgas_initial
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardsfgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
    outputs = none # no reason why mass should be conserved
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
    outputs = none # no reason why mass should be conserved
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./pwater_initial]
    type = ParsedFunction
    value = 1-x/2
  [../]
  [./pgas_initial]
    type = ParsedFunction
    value = 2-x/5
  [../]

  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres asm lu NONZERO 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh02
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6e9ca874-77bf-4108-b7df-6f5a3e9a6fb3"><div class="modal-content"><h4>modules/combined/examples/phase_field-mechanics/kks_mechanics_VTS.i</h4><pre class="moose-pre"><code class="language-text"># KKS phase-field model coupled with elasticity using the Voigt-Taylor scheme as
# described in L.K. Aagesen et al., Computational Materials Science, 140, 10-21 (2017)
# Original run #170329e

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 640
  ny = 1
  nz = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.03125
  zmin = 0
  zmax = 0.03125
  elem_type = HEX8
[]


[Variables]
  # order parameter
  [./eta]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute concentration
  [./c]
    order = FIRST
    family = LAGRANGE
  [../]

  # chemical potential
  [./w]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute phase concentration (matrix)
  [./cm]
    order = FIRST
    family = LAGRANGE
  [../]
  # solute phase concentration (precipitate)
  [./cp]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_x]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_y]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_z]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./eta_ic]
    variable = eta
    type = FunctionIC
    function = ic_func_eta
    block = 0
  [../]
  [./c_ic]
    variable = c
    type = FunctionIC
    function = ic_func_c
    block = 0
  [../]
  [./w_ic]
    variable = w
    type = ConstantIC
    value = 0.00991
    block = 0
  [../]
  [./cm_ic]
    variable = cm
    type = ConstantIC
    value = 0.131
    block = 0
  [../]
  [./cp_ic]
    variable = cp
    type = ConstantIC
    value = 0.236
    block = 0
  [../]
[]

[Functions]
  [./ic_func_eta]
    type = ParsedFunction
    value = &#x27;0.5*(1.0+tanh((x)/delta_eta/sqrt(2.0)))&#x27;
    vars = &#x27;delta_eta&#x27;
    vals = &#x27;0.8034&#x27;
  [../]
  [./ic_func_c]
    type = ParsedFunction
    value = &#x27;0.2388*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^3*(6*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^2-15*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))+10)+0.1338*(1-(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^3*(6*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^2-15*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))+10))&#x27;
    vars = &#x27;delta&#x27;
    vals = &#x27;0.8034&#x27;
  [../]
  [./psi_eq_int]
    type = ParsedFunction
    value = &#x27;volume*psi_alpha&#x27;
    vars = &#x27;volume psi_alpha&#x27;
    vals = &#x27;volume psi_alpha&#x27;
  [../]
  [./gamma]
    type = ParsedFunction
    value = &#x27;(psi_int - psi_eq_int) / dy / dz&#x27;
    vars = &#x27;psi_int psi_eq_int dy       dz&#x27;
    vals = &#x27;psi_int psi_eq_int 0.03125  0.03125&#x27;
  [../]
[]

[AuxVariables]
  [./sigma11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./sigma22]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./sigma33]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e12]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e22]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e33]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e_el11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e_el12]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e_el22]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f_el]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./eigen_strain00]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./Fglobal]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./psi]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./matl_sigma11]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
    variable = sigma11
  [../]
  [./matl_sigma22]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 1
    index_j = 1
    variable = sigma22
  [../]
  [./matl_sigma33]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    variable = sigma33
  [../]
  [./matl_e11]
    type = RankTwoAux
    rank_two_tensor = total_strain
    index_i = 0
    index_j = 0
    variable = e11
  [../]
  [./matl_e12]
    type = RankTwoAux
    rank_two_tensor = total_strain
    index_i = 0
    index_j = 1
    variable = e12
  [../]
  [./matl_e22]
    type = RankTwoAux
    rank_two_tensor = total_strain
    index_i = 1
    index_j = 1
    variable = e22
  [../]
  [./matl_e33]
    type = RankTwoAux
    rank_two_tensor = total_strain
    index_i = 2
    index_j = 2
    variable = e33
  [../]
  [./f_el]
    type = MaterialRealAux
    variable = f_el
    property = f_el_mat
    execute_on = timestep_end
  [../]
  [./GlobalFreeEnergy]
    variable = Fglobal
    type = KKSGlobalFreeEnergy
    fa_name = fm
    fb_name = fp
    w = 0.0264
    kappa_names = kappa
    interfacial_vars = eta
  [../]
  [./psi_potential]
    variable = psi
    type = ParsedAux
    args = &#x27;Fglobal w c f_el sigma11 e11&#x27;
    function = &#x27;Fglobal - w*c + f_el - sigma11*e11&#x27;
  [../]
[]


[BCs]
  [./left_x]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0
  [../]
  [./right_x]
    type = DirichletBC
    variable = disp_x
    boundary = right
    value = 0
  [../]
  [./front_y]
    type = DirichletBC
    variable = disp_y
    boundary = front
    value = 0
  [../]
  [./back_y]
    type = DirichletBC
    variable = disp_y
    boundary = back
    value = 0
  [../]
  [./top_z]
    type = DirichletBC
    variable = disp_z
    boundary = top
    value = 0
  [../]
  [./bottom_z]
    type = DirichletBC
    variable = disp_z
    boundary = bottom
    value = 0
  [../]
[]

[Materials]
  # Chemical free energy of the matrix
  [./fm]
    type = DerivativeParsedMaterial
    f_name = fm
    args = &#x27;cm&#x27;
    function = &#x27;6.55*(cm-0.13)^2&#x27;
  [../]
# Elastic energy of the matrix
  [./elastic_free_energy_m]
    type = ElasticEnergyMaterial
    base_name = matrix
    f_name = fe_m
    args = &#x27; &#x27;
    outputs = exodus
  [../]
# Total free energy of the matrix
  [./Total_energy_matrix]
    type = DerivativeSumMaterial
    f_name = f_total_matrix
    sum_materials = &#x27;fm fe_m&#x27;
    args = &#x27;cm&#x27;
  [../]

  # Free energy of the precipitate phase
  [./fp]
    type = DerivativeParsedMaterial
    f_name = fp
    args = &#x27;cp&#x27;
    function = &#x27;6.55*(cp-0.235)^2&#x27;
  [../]

# Elastic energy of the precipitate
  [./elastic_free_energy_p]
    type = ElasticEnergyMaterial
    base_name = ppt
    f_name = fe_p
    args = &#x27; &#x27;
    outputs = exodus
  [../]

# Total free energy of the precipitate
  [./Total_energy_ppt]
    type = DerivativeSumMaterial
    f_name = f_total_ppt
    sum_materials = &#x27;fp fe_p&#x27;
    args = &#x27;cp&#x27;
  [../]

  # Total elastic energy
    [./Total_elastic_energy]
      type = DerivativeTwoPhaseMaterial
      eta = eta
      f_name = f_el_mat
      fa_name = fe_m
      fb_name = fe_p
      outputs = exodus
      W = 0
    [../]

  # h(eta)
  [./h_eta]
    type = SwitchingFunctionMaterial
    h_order = HIGH
    eta = eta
  [../]

  # g(eta)
  [./g_eta]
    type = BarrierFunctionMaterial
    g_order = SIMPLE
    eta = eta
  [../]

  # constant properties
  [./constants]
    type = GenericConstantMaterial
    prop_names  = &#x27;M   L   kappa     misfit&#x27;
    prop_values = &#x27;0.7 0.7 0.01704   0.00377&#x27;
  [../]

  #Mechanical properties
  [./Stiffness_matrix]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;103.3 74.25 74.25 103.3 74.25 103.3 46.75 46.75 46.75&#x27;
    base_name = matrix
    fill_method = symmetric9
  [../]
  [./Stiffness_ppt]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;100.7 71.45 71.45 100.7 71.45 100.7 50.10 50.10 50.10&#x27;
    base_name = ppt
    fill_method = symmetric9
  [../]
  [./stress_matrix]
    type = ComputeLinearElasticStress
    base_name = matrix
  [../]
  [./stress_ppt]
    type = ComputeLinearElasticStress
    base_name = ppt
  [../]
  [./strain_matrix]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    base_name = matrix
  [../]
  [./strain_ppt]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    base_name = ppt
    eigenstrain_names = &#x27;eigenstrain_ppt&#x27;
  [../]
  [./eigen_strain]
    type = ComputeEigenstrain
    base_name = ppt
    eigen_base = &#x27;1 1 1 0 0 0&#x27;
    prefactor = misfit
    eigenstrain_name = &#x27;eigenstrain_ppt&#x27;
  [../]
  [./global_stress]
    type = TwoPhaseStressMaterial
    base_A = matrix
    base_B = ppt
  [../]
  [./global_strain]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]

  # enforce c = (1-h(eta))*cm + h(eta)*cp
  [./PhaseConc]
    type = KKSPhaseConcentration
    ca       = cm
    variable = cp
    c        = c
    eta      = eta
  [../]

  # enforce pointwise equality of chemical potentials
  [./ChemPotVacancies]
    type = KKSPhaseChemicalPotential
    variable = cm
    cb       = cp
    fa_name  = f_total_matrix
    fb_name  = f_total_ppt
  [../]

  #
  # Cahn-Hilliard Equation
  #
  [./CHBulk]
    type = KKSSplitCHCRes
    variable = c
    ca       = cm
    fa_name  = f_total_matrix
    w        = w
  [../]

  [./dcdt]
    type = CoupledTimeDerivative
    variable = w
    v = c
  [../]
  [./ckernel]
    type = SplitCHWRes
    mob_name = M
    variable = w
  [../]

  #
  # Allen-Cahn Equation
  #
  [./ACBulkF]
    type = KKSACBulkF
    variable = eta
    fa_name  = f_total_matrix
    fb_name  = f_total_ppt
    w        = 0.0264
    args = &#x27;cp cm&#x27;
  [../]
  [./ACBulkC]
    type = KKSACBulkC
    variable = eta
    ca       = cm
    cb       = cp
    fa_name  = f_total_matrix
  [../]
  [./ACInterface]
    type = ACInterface
    variable = eta
    kappa_name = kappa
  [../]
  [./detadt]
    type = TimeDerivative
    variable = eta
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -sub_pc_type   -sub_pc_factor_shift_type&#x27;
  petsc_options_value = &#x27;asm       ilu            nonzero&#x27;

  l_max_its = 30
  nl_max_its = 10
  l_tol = 1.0e-4
  nl_rel_tol = 1.0e-8
  nl_abs_tol = 1.0e-11
  num_steps = 200

  [./TimeStepper]
    type = SolutionTimeAdaptiveDT
    dt = 0.5
  [../]
[]

[VectorPostprocessors]
  #[./eta]
  #  type =  LineValueSampler
  #  start_point = &#x27;-10 0 0&#x27;
  #  end_point = &#x27;10 0 0&#x27;
  #  variable = eta
  #  num_points = 321
  #  sort_by =  id
  #[../]
  #[./eta_position]
  #  type = FindValueOnLineSample
  #  vectorpostprocessor = eta
  #  variable_name = eta
  #  search_value = 0.5
  #[../]
#  [./f_el]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = f_el
#  [../]
#  [./f_el_a]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = fe_m
#  [../]
#  [./f_el_b]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = fe_p
#  [../]
#  [./h_out]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = h
#  [../]
#  [./fm_out]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = fm
#  [../]
[]

[Postprocessors]
  [./f_el_int]
    type = ElementIntegralMaterialProperty
    mat_prop = f_el_mat
  [../]
  [./c_alpha]
    type =  SideAverageValue
    boundary = left
    variable = c
  [../]
  [./c_beta]
    type =  SideAverageValue
    boundary = right
    variable = c
  [../]
  [./e11_alpha]
    type =  SideAverageValue
    boundary = left
    variable = e11
  [../]
  [./e11_beta]
    type =  SideAverageValue
    boundary = right
    variable = e11
  [../]
  [./s11_alpha]
    type =  SideAverageValue
    boundary = left
    variable = sigma11
  [../]
  [./s22_alpha]
    type =  SideAverageValue
    boundary = left
    variable = sigma22
  [../]
  [./s33_alpha]
    type =  SideAverageValue
    boundary = left
    variable = sigma33
  [../]
  [./s11_beta]
    type =  SideAverageValue
    boundary = right
    variable = sigma11
  [../]
  [./s22_beta]
    type =  SideAverageValue
    boundary = right
    variable = sigma22
  [../]
  [./s33_beta]
    type =  SideAverageValue
    boundary = right
    variable = sigma33
  [../]
  [./f_el_alpha]
    type =  SideAverageValue
    boundary = left
    variable = f_el
  [../]
  [./f_el_beta]
    type =  SideAverageValue
    boundary = right
    variable = f_el
  [../]
  [./f_c_alpha]
    type =  SideAverageValue
    boundary = left
    variable = Fglobal
  [../]
  [./f_c_beta]
    type =  SideAverageValue
    boundary = right
    variable = Fglobal
  [../]
  [./chem_pot_alpha]
    type =  SideAverageValue
    boundary = left
    variable = w
  [../]
  [./chem_pot_beta]
    type =  SideAverageValue
    boundary = right
    variable = w
  [../]
  [./psi_alpha]
    type =  SideAverageValue
    boundary = left
    variable = psi
  [../]
  [./psi_beta]
    type =  SideAverageValue
    boundary = right
    variable = psi
  [../]
  [./total_energy]
    type = ElementIntegralVariablePostprocessor
    variable = Fglobal
  [../]
  # Get simulation cell size from postprocessor
  [./volume]
    type = ElementIntegralMaterialProperty
    mat_prop = 1
  [../]
  [./psi_eq_int]
    type = FunctionValuePostprocessor
    function = psi_eq_int
  [../]
  [./psi_int]
    type = ElementIntegralVariablePostprocessor
    variable = psi
  [../]
  [./gamma]
    type = FunctionValuePostprocessor
    function = gamma
  [../]
[]

#
# Precondition using handcoded off-diagonal terms
#
[Preconditioning]
  [./full]
    type = SMP
    full = true
  [../]
[]


[Outputs]
  [./exodus]
    type = Exodus
    interval = 20
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;final&#x27;
  [../]
#[./console]
#    type = Console
#    output_file = true
#  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="62c38fd1-757e-4dcf-ae97-2e48fed2b6a3"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mohr_coulomb/planar_hard5.i</h4><pre class="moose-pre"><code class="language-text"># apply repeated stretches in z direction, and smaller stretches along the y direction, and compression along x direction
# Both return to the plane and edge (lode angle = 30deg, ie 010100) are experienced.
#
# It is checked that the yield functions are less than their tolerance values
# It is checked that the cohesion hardens correctly

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;-1E-6*x*t&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0.05E-6*y*t&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;1E-6*z*t&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if((a&lt;1E-5)&amp;(b&lt;1E-5)&amp;(c&lt;1E-5)&amp;(d&lt;1E-5)&amp;(g&lt;1E-5)&amp;(h&lt;1E-5),0,abs(a)+abs(b)+abs(c)+abs(d)+abs(g)+abs(h))&#x27;
    vars = &#x27;a b c d g h&#x27;
    vals = &#x27;f0 f1 f2 f3 f4 f5&#x27;
  [../]
  [./coh_analytic]
    type = ParsedFunction
    value = &#x27;20-10*exp(-1E6*intnl)&#x27;
    vars = intnl
    vals = internal
  [../]
  [./coh_from_yieldfcns]
    type = ParsedFunction
    value = &#x27;(f0+f1-(sxx+syy)*sin(phi))/(-2)/cos(phi)&#x27;
    vars = &#x27;f0 f1 sxx syy phi&#x27;
    vals = &#x27;f0 f1 s_xx s_yy 0.8726646&#x27;
  [../]
  [./should_be_zero_coh]
    type = ParsedFunction
    value = &#x27;if(abs(a-b)&lt;1E-6,0,1E6*abs(a-b))&#x27;
    vars = &#x27;a b&#x27;
    vals = &#x27;Coh_analytic Coh_moose&#x27;
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./mc_int]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn3]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn4]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn5]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./mc_int_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_internal_parameter
    variable = mc_int
  [../]
  [./yield_fcn0]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn0
  [../]
  [./yield_fcn1]
    type = MaterialStdVectorAux
    index = 1
    property = plastic_yield_function
    variable = yield_fcn1
  [../]
  [./yield_fcn2]
    type = MaterialStdVectorAux
    index = 2
    property = plastic_yield_function
    variable = yield_fcn2
  [../]
  [./yield_fcn3]
    type = MaterialStdVectorAux
    index = 3
    property = plastic_yield_function
    variable = yield_fcn3
  [../]
  [./yield_fcn4]
    type = MaterialStdVectorAux
    index = 4
    property = plastic_yield_function
    variable = yield_fcn4
  [../]
  [./yield_fcn5]
    type = MaterialStdVectorAux
    index = 5
    property = plastic_yield_function
    variable = yield_fcn5
  [../]
[]

[Postprocessors]
  [./s_xx]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./s_xy]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_xy
  [../]
  [./s_xz]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_xz
  [../]
  [./s_yy]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./s_yz]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_yz
  [../]
  [./s_zz]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./internal]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = mc_int
  [../]
  [./f0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn0
  [../]
  [./f1]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn1
  [../]
  [./f2]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn2
  [../]
  [./f3]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn3
  [../]
  [./f4]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn4
  [../]
  [./f5]
   type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn5
  [../]
  [./yfcns_should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./Coh_analytic]
    type = FunctionValuePostprocessor
    function = coh_analytic
  [../]
  [./Coh_moose]
    type = FunctionValuePostprocessor
    function = coh_from_yieldfcns
  [../]
  [./cohesion_difference_should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_coh
  [../]
[]

[UserObjects]
  [./mc_coh]
    type = TensorMechanicsHardeningExponential
    value_0 = 10
    value_residual = 20
    rate = 1E6
  [../]
  [./mc_phi]
    type = TensorMechanicsHardeningConstant
    value = 0.8726646
  [../]
  [./mc_psi]
    type = TensorMechanicsHardeningConstant
    value = 1 #0.8726646 # 50deg
  [../]
  [./mc]
    type = TensorMechanicsPlasticMohrCoulombMulti
    cohesion = mc_coh
    friction_angle = mc_phi
    dilation_angle = mc_psi
    use_custom_returnMap = true
    yield_function_tolerance = 1E-5
    internal_constraint_tolerance = 1E-9
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0 1E7&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    ep_plastic_tolerance = 1E-12
    plastic_models = mc
  [../]
[]


[Executioner]
  end_time = 5
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = planar_hard5
  exodus = false
  [./csv]
    type = CSV
    hide = &#x27;f0 f1 f2 f3 f4 f5 s_xy s_xz s_yz Coh_analytic Coh_moose&#x27;
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="489fe9e4-49d4-4e11-8776-f62b8942320f"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav02a.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established in the transient situation when 0&lt;saturation&lt;1 (note the strictly less-than).
# 2phase (PP), 2components, vanGenuchten, constant fluid bulk-moduli for each phase, constant viscosity, constant permeability, Corey relative perm
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./ppwater]
    initial_condition = -1.0
  [../]
  [./ppgas]
    initial_condition = 0
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]


[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = ppwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = ppwater
    gravity = &#x27;-1 0 0&#x27;
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = ppgas
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = ppgas
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]


[Functions]
  [./ana_ppwater]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 2 pp_water_top 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
  [./ana_ppgas]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 1 pp_gas_top 0.1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater ppgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 1
      density0 = 0.1
      viscosity = 0.5
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = ppwater
    phase1_porepressure = ppgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[Postprocessors]
  [./pp_water_top]
    type = PointValue
    variable = ppwater
    point = &#x27;0 0 0&#x27;
  [../]
  [./pp_water_base]
    type = PointValue
    variable = ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_water_analytical]
    type = FunctionValuePostprocessor
    function = ana_ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_gas_top]
    type = PointValue
    variable = ppgas
    point = &#x27;0 0 0&#x27;
  [../]
  [./pp_gas_base]
    type = PointValue
    variable = ppgas
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_gas_analytical]
    type = FunctionValuePostprocessor
    function = ana_ppgas
    point = &#x27;-1 0 0&#x27;
  [../]
  [./mass_ph0]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./mass_ph1]
    type = PorousFlowFluidMass
    fluid_component = 1
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 0.1
  end_time = 1.0
  nl_rel_tol = 1E-10
  nl_abs_tol = 1E-12
[]

[Outputs]
  [./csv]
    type = CSV
    file_base = grav02a
    execute_on = &#x27;initial final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4a1574a6-a49d-4c26-b365-7be4f98caac3"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_06.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = false
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_fu_06
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="885158df-ed05-4142-a942-cd44b1ced8bd"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh10.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
# with anisotropic and nonsymmetric (!) permeability
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;2E-12 0 0  1E-12 3E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON

[]

[Outputs]
  file_base = bh10
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="457c11dd-ad05-413d-8245-6ed9676c6e03"><div class="modal-content"><h4>modules/combined/doc/richards/user/excav/ex01.i</h4><pre class="moose-pre"><code class="language-text">###########################################
#                                         #
#   THIS EXAMPLE CONTAINS AN EXCAVATION   #
#                                         #
###########################################


# Easiest way of figuring out what&#x27;s happening:
# Run this example, load into paraview, take
# a slice through (0,0,0) with normal (0,0,1),
# colour by pressure and play the animation.


# This mesh has an interior sideset called excav_bdy
[Mesh]
  type = FileMesh
  file = ex01_input.e
[]



# This is a boundary condition acting on excav_bdy
# All it does is to set the pressure to p_excav=0
# at places on excav_bdy wherever excav_fcn tells it to.
[BCs]
  [./excav_bdy]
    type = RichardsExcav
    boundary = excav_bdy
    p_excav = 0.0
    variable = pressure
    excav_geom_function = excav_fcn
  [../]
[]



[Functions]
# excav_fcn controls where to set pressure=p_excav
# You supply start and end positions and times and
# by a linear interpolation these define the position
# of the coal face at all times
  [./excav_fcn]
    type = RichardsExcavGeom
    start_posn = &#x27;0 -500 0&#x27;
    start_time = 0
    end_posn = &#x27;0 500 0&#x27;
    end_time = 3E7
  [../]

# mass_bal_fcn calculates the mass balance
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((mi-fout-mf)/2/(mi+mf))
    vars = &#x27;mi mf fout&#x27;
    vals = &#x27;mass_init mass_final flux_out&#x27;
  [../]

# initial pressure - unimportant in this example
  [./initial_pressure]
    type = ParsedFunction
    value = -10000*(z-100)
  [../]
[]




# following is needed by postprocessors, kernels, etc
# unimportant in this example
[GlobalParams]
  porepressureNames_UO = PPNames
[]




# following does the calculation of relevant
# masses and mass-flux to the excavation
[Postprocessors]

# note that this is calculated at beginning of timestep
  [./mass_init]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

# note this is calculated at end of timestep
  [./mass_final]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

# this is what calculates the mass flux to the excavation
# it is calculating it for boundary=excav_bdy, and the
# excavation time-dependence is set through the excav_fcn
  [./flux_out]
    type = RichardsExcavFlow
    boundary = excav_bdy
    variable = pressure
    excav_geom_function = excav_fcn
  [../]

# mass_bal just outputs the result to screen
  [./mass_bal]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
  [../]
[]




######################################
#                                    #
#  THE FOLLOWING STUFF IS STANDARD   #
#                                    #
######################################


[UserObjects]
  [./PPNames]
    type = RichardsPorepressureNames
    porepressure_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E+2
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = &#x27;1 2 3 4&#x27;
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-15 0 0  0 1E-15 0  0 0 1E-15&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 -10&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 6E6
  dt = 3E6
  solve_type = NEWTON
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = ex01
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e55a90c6-2650-47d4-a617-30da5c7717d3"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mean_cap_TC/random01.i</h4><pre class="moose-pre"><code class="language-text"># apply many random large deformations, checking that the algorithm returns correctly to
# the yield surface each time.
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 125
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 125
  zmin = 0
  zmax = 1
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./max_yield_fcn]
    type = ElementExtremeValue
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./av_iter]
    type = ElementAverageValue
    variable = iter
    outputs = &#x27;console&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;max_yield_fcn&#x27;
  [../]
[]

[UserObjects]
  [./tensile_strength]
    type = TensorMechanicsHardeningConstant
    value = 1
  [../]
  [./compressive_strength]
    type = TensorMechanicsHardeningConstant
    value = -1.5
  [../]
  [./cap]
    type = TensorMechanicsPlasticMeanCapTC
    tensile_strength = tensile_strength
    compressive_strength = compressive_strength
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-9
    use_custom_returnMap = false
    use_custom_cto = false
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0.7E7 1E7&#x27;
  [../]
  [./strain]
    type = ComputeIncrementalSmallStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    max_NR_iterations = 2
    ep_plastic_tolerance = 1E-6
    plastic_models = cap
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random01
  exodus = false
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="62e4e418-3697-4aa2-a378-d1ae11402928"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/mandel_fully_saturated_volume.i</h4><pre class="moose-pre"><code class="language-text"># Mandel&#x27;s problem of consolodation of a drained medium
# Using the FullySaturatedDarcyBase and FullySaturatedFullySaturatedMassTimeDerivative kernels
# with multiply_by_density = false, so that this problem becomes linear
# Note the use of consistent_with_displaced_mesh = false in the calculation of volumetric strain
#
# A sample is in plane strain.
# -a &lt;= x &lt;= a
# -b &lt;= y &lt;= b
# It is squashed with constant force by impermeable, frictionless plattens on its top and bottom surfaces (at y=+/-b)
# Fluid is allowed to leak out from its sides (at x=+/-a)
# The porepressure within the sample is monitored.
#
# As is common in the literature, this is simulated by
# considering the quarter-sample, 0&lt;=x&lt;=a and 0&lt;=y&lt;=b, with
# impermeable, roller BCs at x=0 and y=0 and y=b.
# Porepressure is fixed at zero on x=a.
# Porepressure and displacement are initialised to zero.
# Then the top (y=b) is moved downwards with prescribed velocity,
# so that the total force that is inducing this downwards velocity
# is fixed.  The velocity is worked out by solving Mandel&#x27;s problem
# analytically, and the total force is monitored in the simulation
# to check that it indeed remains constant.
#
# Here are the problem&#x27;s parameters, and their values:
# Soil width.  a = 1
# Soil height.  b = 0.1
# Soil&#x27;s Lame lambda.  la = 0.5
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = G = 0.75
# Soil bulk modulus.  K = la + 2*mu/3 = 1
# Drained Poisson ratio.  nu = (3K - 2G)/(6K + 2G) = 0.2
# Soil bulk compliance.  1/K = 1
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Biot modulus.  M = 1/(phi0/Kf + (alpha - phi0)(1 - alpha)/K) = 4.705882
# Undrained bulk modulus. Ku = K + alpha^2*M = 2.694118
# Undrained Poisson ratio.  nuu = (3Ku - 2G)/(6Ku + 2G) = 0.372627
# Skempton coefficient.  B = alpha*M/Ku = 1.048035
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Consolidation coefficient.  c = 2*k*B^2*G*(1-nu)*(1+nuu)^2/9/(1-nuu)/(nuu-nu) = 3.821656
# Normal stress on top.  F = 1
#
# The solution for porepressure and displacements is given in
# AHD Cheng and E Detournay &quot;A direct boundary element method for plane strain poroelasticity&quot; International Journal of Numerical and Analytical Methods in Geomechanics 12 (1988) 551-572.
# The solution involves complicated infinite series, so I shall not write it here

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 10
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 0.1
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./roller_xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left&#x27;
  [../]
  [./roller_ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom&#x27;
  [../]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
  [./xmax_drained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = right
  [../]
  [./top_velocity]
    type = FunctionDirichletBC
    variable = disp_y
    function = top_velocity
    boundary = top
  [../]
[]

[Functions]
  [./top_velocity]
    type = PiecewiseLinear
    x = &#x27;0 0.002 0.006   0.014   0.03    0.046   0.062   0.078   0.094   0.11    0.126   0.142   0.158   0.174   0.19 0.206 0.222 0.238 0.254 0.27 0.286 0.302 0.318 0.334 0.35 0.366 0.382 0.398 0.414 0.43 0.446 0.462 0.478 0.494 0.51 0.526 0.542 0.558 0.574 0.59 0.606 0.622 0.638 0.654 0.67 0.686 0.702&#x27;
    y = &#x27;-0.041824842    -0.042730269    -0.043412712    -0.04428867     -0.045509181    -0.04645965     -0.047268246 -0.047974749      -0.048597109     -0.0491467  -0.049632388     -0.050061697      -0.050441198     -0.050776675     -0.051073238      -0.0513354 -0.051567152      -0.051772022     -0.051953128 -0.052113227 -0.052254754 -0.052379865 -0.052490464 -0.052588233 -0.052674662 -0.052751065 -0.052818606 -0.052878312 -0.052931093 -0.052977751 -0.053018997 -0.053055459 -0.053087691 -0.053116185 -0.053141373 -0.05316364 -0.053183324 -0.053200724 -0.053216106 -0.053229704 -0.053241725 -0.053252351 -0.053261745 -0.053270049 -0.053277389 -0.053283879 -0.053289615&#x27;
  [../]
[]

[AuxVariables]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./tot_force]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./tot_force]
    type = ParsedAux
    args = &#x27;stress_yy porepressure&#x27;
    execute_on = timestep_end
    variable = tot_force
    function = &#x27;-stress_yy+0.6*porepressure&#x27;
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    component = 2
    variable = disp_z
  [../]
  [./mass0]
    type = PorousFlowFullySaturatedMassTimeDerivative
    biot_coefficient = 0.6
    multiply_by_density = false
    coupling_type = HydroMechanical
    variable = porepressure
  [../]
  [./flux]
    type = PorousFlowFullySaturatedDarcyBase
    multiply_by_density = false
    variable = porepressure
    gravity = &#x27;0 0 0&#x27;
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 8
      density0 = 1
      thermal_expansion = 0
      viscosity = 1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0.5 0.75&#x27;
    # bulk modulus is lambda + 2*mu/3 = 0.5 + 2*0.75/3 = 1
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure_qp]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
    consistent_with_displaced_mesh = false
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = porepressure
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid_qp]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is ever used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.6
    solid_bulk_compliance = 1
    fluid_bulk_modulus = 8
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0.0 0 0&#x27;
    variable = porepressure
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0.1 0 0&#x27;
    variable = porepressure
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0.2 0 0&#x27;
    variable = porepressure
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0.3 0 0&#x27;
    variable = porepressure
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0.4 0 0&#x27;
    variable = porepressure
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0.5 0 0&#x27;
    variable = porepressure
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0.6 0 0&#x27;
    variable = porepressure
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0.7 0 0&#x27;
    variable = porepressure
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0.8 0 0&#x27;
    variable = porepressure
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0.9 0 0&#x27;
    variable = porepressure
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;1 0 0&#x27;
    variable = porepressure
  [../]
  [./xdisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_x
  [../]
  [./ydisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_y
  [../]
  [./total_downwards_force]
     type = ElementAverageValue
     outputs = csv
     variable = tot_force
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.15*t&lt;0.01,0.15*t,0.01)
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 0.7
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = mandel_fully_saturated_volume
  [./csv]
    interval = 3
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b3fdeb80-6338-4489-a7b9-b18e3fb9bf0a"><div class="modal-content"><h4>modules/combined/test/tests/poro_mechanics/borehole_highres.i</h4><pre class="moose-pre"><code class="language-text"># Poroelastic response of a borehole.
#
# HIGHRES VERSION: this version gives good agreement with the analytical solution, but it takes a while so is a &quot;heavy&quot; test
#
# A fully-saturated medium contains a fluid with a homogeneous porepressure,
# but an anisitropic insitu stress.  A infinitely-long borehole aligned with
# the $$z$$ axis is instanteously excavated.  The borehole boundary is
# stress-free and allowed to freely drain.  This problem is analysed using
# plane-strain conditions (no $$z$$ displacement).
#
# The solution in Laplace space is found in E Detournay and AHD Cheng &quot;Poroelastic response of a borehole in a non-hydrostatic stress field&quot;.  International Journal of Rock Mechanics and Mining Sciences and Geomechanics Abstracts 25 (1988) 171-182.  In the small-time limit, the Laplace transforms may be performed.  There is one typo in the paper.  Equation (A4)&#x27;s final term should be -(a/r)\sqrt(4ct/(a^2\pi)), and not +(a/r)\sqrt(4ct/(a^2\pi)).
#
# Because realistic parameters are chosen (below),
# the residual for porepressure is much smaller than
# the residuals for the displacements.  Therefore the
# scaling parameter is chosen.  Also note that the
# insitu stresses are effective stresses, not total
# stresses, but the solution in the above paper is
# expressed in terms of total stresses.
#
# Here are the problem&#x27;s parameters, and their values:
# Borehole radius.  a = 1
# Rock&#x27;s Lame lambda.  la = 0.5E9
# Rock&#x27;s Lame mu, which is also the Rock&#x27;s shear modulus.  mu = G = 1.5E9
# Rock bulk modulus.  K = la + 2*mu/3 = 1.5E9
# Drained Poisson ratio.  nu = (3K - 2G)/(6K + 2G) = 0.125
# Rock bulk compliance.  1/K = 0.66666666E-9
# Fluid bulk modulus.  Kf = 0.7171315E9
# Fluid bulk compliance.  1/Kf = 1.39444444E-9
# Rock initial porosity.  phi0 = 0.3
# Biot coefficient.  alpha = 0.65
# Biot modulus.  M = 1/(phi0/Kf + (alpha - phi0)(1 - alpha)/K) = 2E9
# Undrained bulk modulus. Ku = K + alpha^2*M = 2.345E9
# Undrained Poisson ratio.  nuu = (3Ku - 2G)/(6Ku + 2G) = 0.2364
# Skempton coefficient.  B = alpha*M/Ku = 0.554
# Fluid mobility (rock permeability/fluid viscosity).  k = 1E-12

[Mesh]
  type = FileMesh
  file = borehole_highres_input.e
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  porepressure = porepressure
  block = 1
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
    scaling = 1E9  # Notice the scaling, to make porepressure&#x27;s kernels roughly of same magnitude as disp&#x27;s kernels
  [../]
[]

[GlobalParams]
  volumetric_locking_correction=true
[]

[ICs]
  [./initial_p]
    type = ConstantIC
    variable = porepressure
    value = 1E6
  [../]
[]

[BCs]
  [./fixed_outer_x]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = outer
  [../]
  [./fixed_outer_y]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = outer
  [../]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;zmin zmax&#x27;
  [../]
  [./borehole_wall]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = bh_wall
  [../]
[]



[AuxVariables]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./tot_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./tot_yy]
    type = ParsedAux
    args = &#x27;stress_yy porepressure&#x27;
    execute_on = timestep_end
    variable = tot_yy
    function = &#x27;stress_yy-0.65*porepressure&#x27;
  [../]
[]



[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PoroMechanicsCoupling
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PoroMechanicsCoupling
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PoroMechanicsCoupling
    variable = disp_z
    component = 2
  [../]
  [./poro_timederiv]
    type = PoroFullSatTimeDerivative
    variable = porepressure
  [../]
  [./darcy_flow]
    type = CoefDiffusion
    variable = porepressure
    coef = 1E-12
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0.5E9 1.5E9&#x27;
    # bulk modulus is lambda + 2*mu/3 = 0.5 + 2*1.5/3 = 1.5E9
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeFiniteStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    eigenstrain_names = ini_stress
  [../]
  [./ini_stress]
    type = ComputeEigenstrainFromInitialStress
    initial_stress = &#x27;-1.35E6 0 0  0 -3.35E6 0  0 0 0&#x27; # remember this is the effective stress
    eigenstrain_name = ini_stress
  [../]
  [./no_plasticity]
    type = ComputeFiniteStrainElasticStress
  [../]
  [./poro_material]
    type = PoroFullSatMaterial
    porosity0 = 0.3
    biot_coefficient = 0.65
    solid_bulk_compliance = 0.6666666666667E-9
    fluid_bulk_compliance = 1.3944444444444E-9
    constant_porosity = false
  [../]
[]

[Postprocessors]
  [./p00]
    type = PointValue
    variable = porepressure
    point = &#x27;1.00 0 0&#x27;
    outputs = csv_p
  [../]
  [./p01]
    type = PointValue
    variable = porepressure
    point = &#x27;1.01 0 0&#x27;
    outputs = csv_p
  [../]
  [./p02]
    type = PointValue
    variable = porepressure
    point = &#x27;1.02 0 0&#x27;
    outputs = csv_p
  [../]
  [./p03]
    type = PointValue
    variable = porepressure
    point = &#x27;1.03 0 0&#x27;
    outputs = csv_p
  [../]
  [./p04]
    type = PointValue
    variable = porepressure
    point = &#x27;1.04 0 0&#x27;
    outputs = csv_p
  [../]
  [./p05]
    type = PointValue
    variable = porepressure
    point = &#x27;1.05 0 0&#x27;
    outputs = csv_p
  [../]
  [./p06]
    type = PointValue
    variable = porepressure
    point = &#x27;1.06 0 0&#x27;
    outputs = csv_p
  [../]
  [./p07]
    type = PointValue
    variable = porepressure
    point = &#x27;1.07 0 0&#x27;
    outputs = csv_p
  [../]
  [./p08]
    type = PointValue
    variable = porepressure
    point = &#x27;1.08 0 0&#x27;
    outputs = csv_p
  [../]
  [./p09]
    type = PointValue
    variable = porepressure
    point = &#x27;1.09 0 0&#x27;
    outputs = csv_p
  [../]
  [./p10]
    type = PointValue
    variable = porepressure
    point = &#x27;1.10 0 0&#x27;
    outputs = csv_p
  [../]
  [./p11]
    type = PointValue
    variable = porepressure
    point = &#x27;1.11 0 0&#x27;
    outputs = csv_p
  [../]
  [./p12]
    type = PointValue
    variable = porepressure
    point = &#x27;1.12 0 0&#x27;
    outputs = csv_p
  [../]
  [./p13]
    type = PointValue
    variable = porepressure
    point = &#x27;1.13 0 0&#x27;
    outputs = csv_p
  [../]
  [./p14]
    type = PointValue
    variable = porepressure
    point = &#x27;1.14 0 0&#x27;
    outputs = csv_p
  [../]
  [./p15]
    type = PointValue
    variable = porepressure
    point = &#x27;1.15 0 0&#x27;
    outputs = csv_p
  [../]
  [./p16]
    type = PointValue
    variable = porepressure
    point = &#x27;1.16 0 0&#x27;
    outputs = csv_p
  [../]
  [./p17]
    type = PointValue
    variable = porepressure
    point = &#x27;1.17 0 0&#x27;
    outputs = csv_p
  [../]
  [./p18]
    type = PointValue
    variable = porepressure
    point = &#x27;1.18 0 0&#x27;
    outputs = csv_p
  [../]
  [./p19]
    type = PointValue
    variable = porepressure
    point = &#x27;1.19 0 0&#x27;
    outputs = csv_p
  [../]
  [./p20]
    type = PointValue
    variable = porepressure
    point = &#x27;1.20 0 0&#x27;
    outputs = csv_p
  [../]
  [./p21]
    type = PointValue
    variable = porepressure
    point = &#x27;1.21 0 0&#x27;
    outputs = csv_p
  [../]
  [./p22]
    type = PointValue
    variable = porepressure
    point = &#x27;1.22 0 0&#x27;
    outputs = csv_p
  [../]
  [./p23]
    type = PointValue
    variable = porepressure
    point = &#x27;1.23 0 0&#x27;
    outputs = csv_p
  [../]
  [./p24]
    type = PointValue
    variable = porepressure
    point = &#x27;1.24 0 0&#x27;
    outputs = csv_p
  [../]
  [./p25]
    type = PointValue
    variable = porepressure
    point = &#x27;1.25 0 0&#x27;
    outputs = csv_p
  [../]

  [./s00]
    type = PointValue
    variable = disp_x
    point = &#x27;1.00 0 0&#x27;
    outputs = csv_s
  [../]
  [./s01]
    type = PointValue
    variable = disp_x
    point = &#x27;1.01 0 0&#x27;
    outputs = csv_s
  [../]
  [./s02]
    type = PointValue
    variable = disp_x
    point = &#x27;1.02 0 0&#x27;
    outputs = csv_s
  [../]
  [./s03]
    type = PointValue
    variable = disp_x
    point = &#x27;1.03 0 0&#x27;
    outputs = csv_s
  [../]
  [./s04]
    type = PointValue
    variable = disp_x
    point = &#x27;1.04 0 0&#x27;
    outputs = csv_s
  [../]
  [./s05]
    type = PointValue
    variable = disp_x
    point = &#x27;1.05 0 0&#x27;
    outputs = csv_s
  [../]
  [./s06]
    type = PointValue
    variable = disp_x
    point = &#x27;1.06 0 0&#x27;
    outputs = csv_s
  [../]
  [./s07]
    type = PointValue
    variable = disp_x
    point = &#x27;1.07 0 0&#x27;
    outputs = csv_s
  [../]
  [./s08]
    type = PointValue
    variable = disp_x
    point = &#x27;1.08 0 0&#x27;
    outputs = csv_s
  [../]
  [./s09]
    type = PointValue
    variable = disp_x
    point = &#x27;1.09 0 0&#x27;
    outputs = csv_s
  [../]
  [./s10]
    type = PointValue
    variable = disp_x
    point = &#x27;1.10 0 0&#x27;
    outputs = csv_s
  [../]
  [./s11]
    type = PointValue
    variable = disp_x
    point = &#x27;1.11 0 0&#x27;
    outputs = csv_s
  [../]
  [./s12]
    type = PointValue
    variable = disp_x
    point = &#x27;1.12 0 0&#x27;
    outputs = csv_s
  [../]
  [./s13]
    type = PointValue
    variable = disp_x
    point = &#x27;1.13 0 0&#x27;
    outputs = csv_s
  [../]
  [./s14]
    type = PointValue
    variable = disp_x
    point = &#x27;1.14 0 0&#x27;
    outputs = csv_s
  [../]
  [./s15]
    type = PointValue
    variable = disp_x
    point = &#x27;1.15 0 0&#x27;
    outputs = csv_s
  [../]
  [./s16]
    type = PointValue
    variable = disp_x
    point = &#x27;1.16 0 0&#x27;
    outputs = csv_s
  [../]
  [./s17]
    type = PointValue
    variable = disp_x
    point = &#x27;1.17 0 0&#x27;
    outputs = csv_s
  [../]
  [./s18]
    type = PointValue
    variable = disp_x
    point = &#x27;1.18 0 0&#x27;
    outputs = csv_s
  [../]
  [./s19]
    type = PointValue
    variable = disp_x
    point = &#x27;1.19 0 0&#x27;
    outputs = csv_s
  [../]
  [./s20]
    type = PointValue
    variable = disp_x
    point = &#x27;1.20 0 0&#x27;
    outputs = csv_s
  [../]
  [./s21]
    type = PointValue
    variable = disp_x
    point = &#x27;1.21 0 0&#x27;
    outputs = csv_s
  [../]
  [./s22]
    type = PointValue
    variable = disp_x
    point = &#x27;1.22 0 0&#x27;
    outputs = csv_s
  [../]
  [./s23]
    type = PointValue
    variable = disp_x
    point = &#x27;1.23 0 0&#x27;
    outputs = csv_s
  [../]
  [./s24]
    type = PointValue
    variable = disp_x
    point = &#x27;1.24 0 0&#x27;
    outputs = csv_s
  [../]
  [./s25]
    type = PointValue
    variable = disp_x
    point = &#x27;1.25 0 0&#x27;
    outputs = csv_s
  [../]

  [./t00]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.00 0 0&#x27;
    outputs = csv_t
  [../]
  [./t01]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.01 0 0&#x27;
    outputs = csv_t
  [../]
  [./t02]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.02 0 0&#x27;
    outputs = csv_t
  [../]
  [./t03]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.03 0 0&#x27;
    outputs = csv_t
  [../]
  [./t04]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.04 0 0&#x27;
    outputs = csv_t
  [../]
  [./t05]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.05 0 0&#x27;
    outputs = csv_t
  [../]
  [./t06]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.06 0 0&#x27;
    outputs = csv_t
  [../]
  [./t07]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.07 0 0&#x27;
    outputs = csv_t
  [../]
  [./t08]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.08 0 0&#x27;
    outputs = csv_t
  [../]
  [./t09]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.09 0 0&#x27;
    outputs = csv_t
  [../]
  [./t10]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.10 0 0&#x27;
    outputs = csv_t
  [../]
  [./t11]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.11 0 0&#x27;
    outputs = csv_t
  [../]
  [./t12]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.12 0 0&#x27;
    outputs = csv_t
  [../]
  [./t13]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.13 0 0&#x27;
    outputs = csv_t
  [../]
  [./t14]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.14 0 0&#x27;
    outputs = csv_t
  [../]
  [./t15]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.15 0 0&#x27;
    outputs = csv_t
  [../]
  [./t16]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.16 0 0&#x27;
    outputs = csv_t
  [../]
  [./t17]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.17 0 0&#x27;
    outputs = csv_t
  [../]
  [./t18]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.18 0 0&#x27;
    outputs = csv_t
  [../]
  [./t19]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.19 0 0&#x27;
    outputs = csv_t
  [../]
  [./t20]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.20 0 0&#x27;
    outputs = csv_t
  [../]
  [./t21]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.21 0 0&#x27;
    outputs = csv_t
  [../]
  [./t22]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.22 0 0&#x27;
    outputs = csv_t
  [../]
  [./t23]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.23 0 0&#x27;
    outputs = csv_t
  [../]
  [./t24]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.24 0 0&#x27;
    outputs = csv_t
  [../]
  [./t25]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.25 0 0&#x27;
    outputs = csv_t
  [../]

  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = 2*t
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_monitor -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it -sub_pc_type -sub_pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;gmres asm 1E0 1E-10 200 500 lu NONZERO&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 0.3
  dt = 0.1
  #[./TimeStepper]
  #  type = PostprocessorDT
  #  postprocessor = dt
  #  dt = 0.003
  #[../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = borehole_highres
  exodus = true
  sync_times = &#x27;0.003 0.3&#x27;
  [./csv_p]
    file_base = borehole_highres_p
    type = CSV
  [../]
  [./csv_s]
    file_base = borehole_highres_s
    type = CSV
  [../]
  [./csv_t]
    file_base = borehole_highres_t
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="fb97734f-d026-40bb-b6b2-13d7e32c5501"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/terzaghi_basicthm.i</h4><pre class="moose-pre"><code class="language-text"># Using a BasicTHM action
# Terzaghi&#x27;s problem of consolodation of a drained medium
# The FullySaturated Kernels are used, with multiply_by_density = false
# so that this becomes a linear problem with constant Biot Modulus
# Also, since the FullySaturated Kernels are used, we have to
# use consistent_with_displaced_mesh = false in the calculation of volumetric strain
#
# A saturated soil sample sits in a bath of water.
# It is constrained on its sides, and bottom.
# Its sides and bottom are also impermeable.
# Initially it is unstressed.
# A normal stress, q, is applied to the soil&#x27;s top.
# The soil then slowly compresses as water is squeezed
# out from the sample from its top (the top BC for
# the porepressure is porepressure = 0).
#
# See, for example.  Section 2.2 of the online manuscript
# Arnold Verruijt &quot;Theory and Problems of Poroelasticity&quot; Delft University of Technology 2013
# but note that the &quot;sigma&quot; in that paper is the negative
# of the stress in TensorMechanics
#
# Here are the problem&#x27;s parameters, and their values:
# Soil height.  h = 10
# Soil&#x27;s Lame lambda.  la = 2
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = 3
# Soil bulk modulus.  K = la + 2*mu/3 = 4
# Soil confined compressibility.  m = 1/(K + 4mu/3) = 0.125
# Soil bulk compliance.  1/K = 0.25
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Soil initial storativity, which is the reciprocal of the initial Biot modulus.  S = phi0/Kf + (alpha - phi0)(1 - alpha)/K = 0.0625
# Consolidation coefficient.  c = k/(S + alpha^2 m) = 13.95348837
# Normal stress on top.  q = 1
# Initial porepressure, resulting from instantaneous application of q, assuming corresponding instantaneous increase of porepressure (Note that this is calculated by MOOSE: we only need it for the analytical solution).  p0 = alpha*m*q/(S + alpha^2 m) = 0.69767442
# Initial vertical displacement (down is positive), resulting from instantaneous application of q (Note this is calculated by MOOSE: we only need it for the analytical solution).  uz0 = q*m*h*S/(S + alpha^2 m)
# Final vertical displacement (down in positive) (Note this is calculated by MOOSE: we only need it for the analytical solution).  uzinf = q*m*h
#
# The solution for porepressure is
# P = 4*p0/\pi \sum_{k=1}^{\infty} \frac{(-1)^{k-1}}{2k-1} \cos ((2k-1)\pi z/(2h)) \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))
# This series converges very slowly for ct/h^2 small, so in that domain
# P = p0 erf( (1-(z/h))/(2 \sqrt(ct/h^2)) )
#
# The degree of consolidation is defined as
# U = (uz - uz0)/(uzinf - uz0)
# where uz0 and uzinf are defined above, and
# uz = the vertical displacement of the top (down is positive)
# U = 1 - (8/\pi^2)\sum_{k=1}^{\infty} \frac{1}{(2k-1)^2} \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 10
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = 0
  zmax = 10
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./basefixed]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = back
  [../]
  [./topdrained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = front
  [../]
  [./topload]
    type = NeumannBC
    variable = disp_z
    value = -1
    boundary = front
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 8.0
      viscosity = 0.96
      density0 = 1.0
    [../]
  [../]
[]

[PorousFlowBasicTHM]
  coupling_type = HydroMechanical
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  multiply_by_density = false
  porepressure = porepressure
  biot_coefficient = 0.6
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]


[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;2 3&#x27;
    # bulk modulus is lambda + 2*mu/3 = 2 + 2*3/3 = 4
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.6
    fluid_bulk_modulus = 8
    solid_bulk_compliance = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 1&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 2&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 3&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 4&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 5&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 6&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 7&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 8&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 9&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = disp_z
    use_displaced_mesh = false
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.5*t&lt;0.1,0.5*t,0.1)
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.0001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = terzaghi_basicthm
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c78a29ac-ad52-4bb2-94d4-7cb252c50357"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav01a.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established
# 1phase, vanGenuchten, constant fluid-bulk, constant viscosity, constant permeability, Corey relative perm
# fully saturated
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = RandomIC
      min = 0
      max = 1
    [../]
  [../]
[]

[Kernels]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_pp]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 1.2 0 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[BCs]
  [./z]
    type = DirichletBC
    variable = pp
    boundary = right
    value = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
[]

[Postprocessors]
  [./pp_base]
    type = PointValue
    variable = pp
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_analytical]
    type = FunctionValuePostprocessor
    function = ana_pp
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_00]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
  [../]
  [./pp_01]
    type = PointValue
    variable = pp
    point = &#x27;-0.1 0 0&#x27;
  [../]
  [./pp_02]
    type = PointValue
    variable = pp
    point = &#x27;-0.2 0 0&#x27;
  [../]
  [./pp_03]
    type = PointValue
    variable = pp
    point = &#x27;-0.3 0 0&#x27;
  [../]
  [./pp_04]
    type = PointValue
    variable = pp
    point = &#x27;-0.4 0 0&#x27;
  [../]
  [./pp_05]
    type = PointValue
    variable = pp
    point = &#x27;-0.5 0 0&#x27;
  [../]
  [./pp_06]
    type = PointValue
    variable = pp
    point = &#x27;-0.6 0 0&#x27;
  [../]
  [./pp_07]
    type = PointValue
    variable = pp
    point = &#x27;-0.7 0 0&#x27;
  [../]
  [./pp_08]
    type = PointValue
    variable = pp
    point = &#x27;-0.8 0 0&#x27;
  [../]
  [./pp_09]
    type = PointValue
    variable = pp
    point = &#x27;-0.9 0 0&#x27;
  [../]
  [./pp_10]
    type = PointValue
    variable = pp
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = grav01a
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0e4d6956-42f7-4848-82bd-45f3174c6b71"><div class="modal-content"><h4>modules/heat_conduction/test/tests/heat_conduction_ortho/heat_conduction_ortho.i</h4><pre class="moose-pre"><code class="language-text">#
# Three independent cubes are thermally loaded, one in x, one in y, and one in z.
# Each direction has a different thermal conductivity, resulting in a different
#   temperature at the side with the Neumann bc.
#
# For x: 100/1000 = 1e-1
# For y: 100/100  = 1e+0
# for z: 100/10   = 1e+1
#

[Mesh]
  file = heat_conduction_ortho.e
[]

[Variables]
  [./temp]
  [../]
[]

[Kernels]
  [./heat]
    type = AnisoHeatConduction
    variable = temp
  [../]
[]

[BCs]
  [./temps]
    type = DirichletBC
    variable = temp
    boundary = 1
    value = 0
  [../]
  [./neum]
    type = NeumannBC
    variable = temp
    boundary = 2
    value = 100
  [../]
[]

[Materials]
  [./heat]
    type = AnisoHeatConductionMaterial
    block = 1
    specific_heat = 0.116
    thermal_conductivity_x_pp = tcx
    thermal_conductivity_y_pp = tcy
    thermal_conductivity_z_pp = tcz
  [../]
  [./density]
    type = GenericConstantMaterial
    block = 1
    prop_names = &#x27;density&#x27;
    prop_values = 0.283
  [../]
[]

[Executioner]
  type = Steady

  petsc_options_iname = &#x27;-pc_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;lu       101&#x27;
  line_search = &#x27;none&#x27;

  nl_abs_tol = 1e-11
  nl_rel_tol = 1e-10
  l_max_its = 20
[]

[Outputs]
  exodus = true
  hide = &#x27;tcx tcy tcz&#x27;
[]

[Postprocessors]
  [./tcx]
    type = FunctionValuePostprocessor
    function = 1000
    outputs = none
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./tcy]
    type = FunctionValuePostprocessor
    function = 100
    outputs = none
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./tcz]
    type = FunctionValuePostprocessor
    function = 10
    outputs = none
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="32ebe994-6517-466c-8b28-8e63d1e64dee"><div class="modal-content"><h4>test/tests/controls/moose_base_naming_access/base_object_param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;DiracKernel::test_object/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="fe9f3ea5-7119-44c5-b01b-ef06a3a08bc5"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mohr_coulomb/random.i</h4><pre class="moose-pre"><code class="language-text"># apply many random large deformations, checking that the algorithm returns correctly to
# the yield surface each time.


[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 125
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 125
  zmin = 0
  zmax = 1
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./yield_fcn_at_zero]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./av_iter]
    type = ElementAverageValue
    variable = iter
    outputs = &#x27;console&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;yield_fcn_at_zero&#x27;
  [../]
[]

[UserObjects]
  [./mc_coh]
    type = TensorMechanicsHardeningConstant
    value = 1E3
  [../]
  [./mc_phi]
    type = TensorMechanicsHardeningConstant
    value = 30
    convert_to_radians = true
  [../]
  [./mc_psi]
    type = TensorMechanicsHardeningConstant
    value = 5
    convert_to_radians = true
  [../]
  [./mc]
    type = TensorMechanicsPlasticMohrCoulomb
    cohesion = mc_coh
    friction_angle = mc_phi
    dilation_angle = mc_psi
    mc_tip_smoother = 0.1E3
    mc_edge_smoother = 25
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-6
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0.7E7 1E7&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    max_NR_iterations = 1000
    ep_plastic_tolerance = 1E-6
    min_stepsize = 1E-3
    plastic_models = mc
    debug_fspb = crash
    deactivation_scheme = safe
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="951da0b7-d5a3-4902-b6a9-31cce8b4f32c"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mean_cap_TC/random02.i</h4><pre class="moose-pre"><code class="language-text"># apply many random large deformations, checking that the algorithm returns correctly to
# the yield surface each time.
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 125
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 125
  zmin = 0
  zmax = 1
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./max_yield_fcn]
    type = ElementExtremeValue
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./av_iter]
    type = ElementAverageValue
    variable = iter
    outputs = &#x27;console&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;max_yield_fcn&#x27;
  [../]
[]

[UserObjects]
  [./tensile_strength]
    type = TensorMechanicsHardeningConstant
    value = 1
  [../]
  [./compressive_strength]
    type = TensorMechanicsHardeningConstant
    value = -1.5
  [../]
  [./cap]
    type = TensorMechanicsPlasticMeanCapTC
    tensile_strength = tensile_strength
    compressive_strength = compressive_strength
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-9
    use_custom_returnMap = true
    use_custom_cto = true
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0.7E7 1E7&#x27;
  [../]
  [./strain]
    type = ComputeIncrementalSmallStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    max_NR_iterations = 2
    ep_plastic_tolerance = 1E-6
    plastic_models = cap
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random02
  exodus = false
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ca77ee9b-7139-49d5-ad5f-3b76fef88c6a"><div class="modal-content"><h4>test/tests/controls/moose_base_naming_access/base_param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;Postprocessor::*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="85fef5cf-7cd7-4aa8-a8f6-f5f1ab69a97d"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_17.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = false
# gravity = true
# full upwinding = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 0.01
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 1
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-15 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_fu_17
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="564a6e6b-3626-41f8-8727-e43dc0b0c26f"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/weak_plane_shear/large_deform4.i</h4><pre class="moose-pre"><code class="language-text"># apply a number of &quot;random&quot; configurations and
# check that the algorithm returns to the yield surface
# using the &#x27;cap&#x27; tip_scheme
#
# must be careful here - we cannot put in arbitrary values of C_ijkl, otherwise the condition
# df/dsigma * C * flow_dirn &lt; 0 for some stresses
# The important features that must be obeyed are:
# 0 = C_0222 = C_1222  (holds for transversely isotropic, for instance)
# C_0212 &lt; C_0202 = C_1212 (holds for transversely isotropic)

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[BCs]
  [./bottomx]
    type = DirichletBC
    variable = disp_x
    boundary = back
    value = 0.0
  [../]
  [./bottomy]
    type = DirichletBC
    variable = disp_y
    boundary = back
    value = 0.0
  [../]
  [./bottomz]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]

  # the following are &quot;random&quot; deformations
  # each is O(1E-1) to provide large deformations
  [./topx]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = front
    function = &#x27;(sin(0.1*t)+x)/1E1&#x27;
  [../]
  [./topy]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = front
    function = &#x27;(cos(t)+x*y)/1E1&#x27;
  [../]
  [./topz]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = front
    function = &#x27;sin(0.4321*t)*x*y*z/1E1&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = yield_fcn
  [../]
[]

[Postprocessors]
  [./yield_fcn_at_zero]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;yield_fcn_at_zero&#x27;
  [../]
[]

[UserObjects]
  [./coh]
    type = TensorMechanicsHardeningConstant
    value = 1E3
  [../]
  [./tanphi]
    type = TensorMechanicsHardeningConstant
    value = 0.577350269
  [../]
  [./tanpsi]
    type = TensorMechanicsHardeningConstant
    value = 0.08748866
  [../]
  [./wps]
    type = TensorMechanicsPlasticWeakPlaneShear
    cohesion = coh
    tan_friction_angle = tanphi
    tan_dilation_angle = tanpsi
    tip_scheme = cap
    smoother = 100
    cap_rate = 0.001
    cap_start = 0.0
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-3
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    # the following is transversely isotropic, i think.
    fill_method = symmetric9
    C_ijkl = &#x27;3E9 1E9 3E9 3E9 3E9 6E9 1E9 1E9 9E9&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    plastic_models = wps
    transverse_direction = &#x27;0 0 1&#x27;
    max_NR_iterations = 100
    ep_plastic_tolerance = 1E-3
    debug_fspb = crash
  [../]
[]


[Executioner]
  end_time = 1E4
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = large_deform4
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="65607b9d-ed3e-4999-97a4-ba74df463050"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except06.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02.bh
    use_mobility = true
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="869f3028-90ab-4ca8-854c-812d357d5b3d"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/pls02.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated situation with a poly-line sink with use_mobility=true
# The poly-line consists of 2 points, and has a length
# of 0.5.  Each point is weighted with a weight of 0.1
# The PorousFlowPolyLineSink has
# p_or_t_vals = 0 1E7
# fluxes = 0 1
# so that for 0&lt;=porepressure&lt;=1E7
# base flux = porepressure * 1E-6 * mobility  (measured in kg.m^-1.s^-1),
# and when multiplied by the poly-line length, and
# the weighting of each point, the mass flux is
# flux = porepressure * 0.5*E-8 * mobility (kg.s^-1).
#
# The fluid and matrix properties are:
# porosity = 0.1
# element volume = 8 m^3
# density = dens0 * exp(P / bulk), with bulk = 2E7
# initial porepressure P0 = 1E7
# viscosity = 0.2
# So, fluid mass = 0.8 * density (kg)
#
# The equation to solve is
# d(Mass)/dt = - porepressure * 0.5*E-8 * density / viscosity
#
# PorousFlow discretises time to conserve mass, so to march
# forward in time, we must solve
# Mass(dt) = Mass(0) - P * 0.5E-8 * density / viscosity * dt
# or
# 0.8 * dens0 * exp(P/bulk) = 0.8 * dens0 * exp(P0/bulk) - P * 0.5E-8 * density / viscosity * dt
# For the numbers written above this gives
# P(t=1) = 6.36947 MPa
# which is given precisely by MOOSE
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./pls_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      viscosity = 0.2
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./pls]
    # This defines a sink that has strength
    # f = L(P) * relperm * L_seg
    # where
    #    L(P) is a piecewise-linear function of porepressure
    #      that is zero at pp=0 and 1 at pp=1E7
    #    relperm is the relative permeability of the fluid
    #    L_seg is the line-segment length associated with
    #      the Dirac points defined in the file pls02.bh
    type = PorousFlowPolyLineSink

    # Because the Variable for this Sink is pp, and pp is associated
    # with the fluid-mass conservation equation, this sink is extracting
    # fluid mass (and not heat energy or something else)
    variable = pp

    # The following specfies that the total fluid mass coming out of
    # the porespace via this sink in this timestep should be recorded
    # in the pls_total_outflow_mass UserObject
    SumQuantityUO = pls_total_outflow_mass

    # The following file defines the polyline geometry
    # which is just two points in this particular example
    point_file = pls02.bh

    # Now define the piecewise-linear function, L

    # First, we want L to be a function of porepressure (and not
    # temperature or something else).  The following means that
    # p_or_t_vals should be intepreted by MOOSE as the zeroth-phase
    # porepressure
    function_of = pressure
    fluid_phase = 0

    # Second, define the piecewise-linear function, L
    # The following means
    #    flux=0 when pp=0  (and also pp&lt;0)
    #    flux=1 when pp=1E7  (and also pp&gt;1E7)
    #    flux=linearly intepolated between pp=0 and pp=1E7
    # When flux&gt;0 this means a sink, while flux&lt;0 means a source
    p_or_t_vals = &#x27;0 1E7&#x27;
    fluxes = &#x27;0 1&#x27;

    # Finally, in this case we want to always multiply
    # L by the fluid mobility (of the zeroth phase) and
    # use that in the sink strength instead of the bare L
    # computed above
    use_mobility = true
  [../]
[]

[Postprocessors]
  [./pls_report]
    type = PorousFlowPlotQuantity
    uo = pls_total_outflow_mass
  [../]
  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 pls_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1
  dt = 1
  solve_type = NEWTON
[]

[Outputs]
  file_base = pls02
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c5f4d651-f905-47ed-a2e2-d26bac138ea6"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/fully_saturated_grav01a.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established
# 1phase, constant fluid-bulk, constant viscosity, constant permeability
# fully saturated
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = RandomIC
      min = 0
      max = 1
    [../]
  [../]
[]

[Kernels]
  [./flux0]
    type = PorousFlowFullySaturatedDarcyBase
    variable = pp
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_pp]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 1.2 0 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[BCs]
  [./z]
    type = DirichletBC
    variable = pp
    boundary = right
    value = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
[]

[Postprocessors]
  [./pp_base]
    type = PointValue
    variable = pp
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_analytical]
    type = FunctionValuePostprocessor
    function = ana_pp
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = fully_saturated_grav01a
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6e8ea869-6f7b-4eae-949e-20bc23d3738c"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/ad_viscoplasticity_stress_update/exact.i</h4><pre class="moose-pre"><code class="language-text"># This test provides comparison to calculated values from Leblond:1994kl

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  pore_shape_model = spherical
[]

[Mesh]
  [./msh]
    type = CartesianMeshGenerator
    dim = 3
    dx = 0.01
    dy = 0.01
    dz = 0.01
    iz = 1
    ix = 1
    iy = 1
  [../]
  [./extra_nodeset]
    type = ExtraNodesetGenerator
    input = msh
    new_boundary = &#x27;origin&#x27;
    coord = &#x27;0 0 0&#x27;
  []
[]

[Modules/TensorMechanics/Master/All]
  strain = FINITE
  add_variables = true
  generate_output = &#x27;strain_xx strain_yy strain_xy hydrostatic_stress vonmises_stress&#x27;
  use_automatic_differentiation = true
[]

[Functions]
  [./Q_gtn]
    type = ParsedFunction
    vars = &#x27;avg_vonmises gtn_gauge_stress&#x27;
    vals = &#x27;avg_vonmises gtn_gauge_stress&#x27;
    value = &#x27;avg_vonmises/gtn_gauge_stress&#x27;
  [../]
  [./M_gtn]
    type = ParsedFunction
    vars = &#x27;avg_hydro gtn_gauge_stress&#x27;
    vals = &#x27;avg_hydro gtn_gauge_stress&#x27;
    value = &#x27;abs(avg_hydro) / gtn_gauge_stress&#x27;
  [../]
  [./Q_ten]
    type = ParsedFunction
    vars = &#x27;avg_vonmises ten_gauge_stress&#x27;
    vals = &#x27;avg_vonmises ten_gauge_stress&#x27;
    value = &#x27;avg_vonmises/ten_gauge_stress&#x27;
  [../]
  [./M_ten]
    type = ParsedFunction
    vars = &#x27;avg_hydro ten_gauge_stress&#x27;
    vals = &#x27;avg_hydro ten_gauge_stress&#x27;
    value = &#x27;abs(avg_hydro) / ten_gauge_stress&#x27;
  [../]
  [./Q_five]
    type = ParsedFunction
    vars = &#x27;avg_vonmises five_gauge_stress&#x27;
    vals = &#x27;avg_vonmises five_gauge_stress&#x27;
    value = &#x27;avg_vonmises/five_gauge_stress&#x27;
  [../]
  [./M_five]
    type = ParsedFunction
    vars = &#x27;avg_hydro five_gauge_stress&#x27;
    vals = &#x27;avg_hydro five_gauge_stress&#x27;
    value = &#x27;abs(avg_hydro) / five_gauge_stress&#x27;
  [../]
  [./Q_three]
    type = ParsedFunction
    vars = &#x27;avg_vonmises three_gauge_stress&#x27;
    vals = &#x27;avg_vonmises three_gauge_stress&#x27;
    value = &#x27;avg_vonmises / three_gauge_stress&#x27;
  [../]
  [./M_three]
    type = ParsedFunction
    vars = &#x27;avg_hydro three_gauge_stress&#x27;
    vals = &#x27;avg_hydro three_gauge_stress&#x27;
    value = &#x27;abs(avg_hydro) / three_gauge_stress&#x27;
  [../]
  [./Q_two]
    type = ParsedFunction
    vars = &#x27;avg_vonmises two_gauge_stress&#x27;
    vals = &#x27;avg_vonmises two_gauge_stress&#x27;
    value = &#x27;avg_vonmises/two_gauge_stress&#x27;
  [../]
  [./M_two]
    type = ParsedFunction
    vars = &#x27;avg_hydro two_gauge_stress&#x27;
    vals = &#x27;avg_hydro two_gauge_stress&#x27;
    value = &#x27;abs(avg_hydro) / two_gauge_stress&#x27;
  [../]
  [./Q_onepointfive]
    type = ParsedFunction
    vars = &#x27;avg_vonmises onepointfive_gauge_stress&#x27;
    vals = &#x27;avg_vonmises onepointfive_gauge_stress&#x27;
    value = &#x27;avg_vonmises / onepointfive_gauge_stress&#x27;
  [../]
  [./M_onepointfive]
    type = ParsedFunction
    vars = &#x27;avg_hydro onepointfive_gauge_stress&#x27;
    vals = &#x27;avg_hydro onepointfive_gauge_stress&#x27;
    value = &#x27;abs(avg_hydro) / onepointfive_gauge_stress&#x27;
  [../]
  [./Q_one]
    type = ParsedFunction
    vars = &#x27;avg_vonmises one_gauge_stress&#x27;
    vals = &#x27;avg_vonmises one_gauge_stress&#x27;
    value = &#x27;avg_vonmises / one_gauge_stress&#x27;
  [../]
  [./M_one]
    type = ParsedFunction
    vars = &#x27;avg_hydro one_gauge_stress&#x27;
    vals = &#x27;avg_hydro one_gauge_stress&#x27;
    value = &#x27;abs(avg_hydro) / one_gauge_stress&#x27;
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 1e10
    poissons_ratio = 0.3
  [../]
  [./stress]
    type = ADComputeMultiplePorousInelasticStress
    inelastic_models = &#x27;gtn lps_ten lps_five lps_three lps_two lps_onepointfive lps_one&#x27;
    initial_porosity = 1e-3
    outputs = all
    extra_stress_names = extra_stress
  [../]

  [./gtn]
    type = ADViscoplasticityStressUpdate
    coefficient = 0
    power = 1 # arbitrary
    viscoplasticity_model = GTN
    base_name = gtn
    outputs = all
    relative_tolerance = 1e-30
  [../]
  [./lps_ten]
    type = ADViscoplasticityStressUpdate
    coefficient = 0
    power = 10
    base_name = ten
    outputs = all
    relative_tolerance = 1e-30
  [../]
  [./lps_five]
    type = ADViscoplasticityStressUpdate
    coefficient = 0
    power = 5
    base_name = five
    outputs = all
    relative_tolerance = 1e-30
  [../]
  [./lps_three]
    type = ADViscoplasticityStressUpdate
    coefficient = 0
    power = 3
    base_name = three
    outputs = all
    relative_tolerance = 1e-30
  [../]
  [./lps_two]
    type = ADViscoplasticityStressUpdate
    coefficient = 0
    power = 2
    base_name = two
    outputs = all
    relative_tolerance = 1e-30
  [../]
  [./lps_onepointfive]
    type = ADViscoplasticityStressUpdate
    coefficient = 0
    power = 1.5
    base_name = onepointfive
    outputs = all
    relative_tolerance = 1e-30
  [../]
  [./lps_one]
    type = ADViscoplasticityStressUpdate
    coefficient = 0
    power = 1
    base_name = one
    outputs = all
    relative_tolerance = 1e-30
  [../]

  [./const_stress]
    type = ComputeExtraStressConstant
    extra_stress_tensor = &#x27;1 1 1 1 1 1 1 1 1&#x27;
    outputs = all
  [../]
[]

[BCs]
  [./no_disp_x]
    type = ADDirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./no_disp_y]
    type = ADDirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
  [./no_disp_z]
    type = ADDirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]
  [./Pressure]
    [./bcs]
      boundary = &#x27;top right front&#x27;
      function = &#x27;10^(t/4.5)&#x27;
      use_automatic_differentiation = true
    [../]
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  num_steps = 10
  nl_abs_tol = 1e-8
[]

[Postprocessors]
  [./avg_hydro]
    type = ElementAverageValue
    variable = hydrostatic_stress
  [../]
  [./avg_vonmises]
    type = ElementAverageValue
    variable = vonmises_stress
  [../]
  [./gtn_gauge_stress]
    type = ElementAverageValue
    variable = gtn_gauge_stress
    outputs = none
  [../]
  [./0Q_gtn]
    type = FunctionValuePostprocessor
    function = Q_gtn
  [../]
  [./0M_gtn]
    type = FunctionValuePostprocessor
    function = M_gtn
  [../]
  [./ten_gauge_stress]
    type = ElementAverageValue
    variable = ten_gauge_stress
    outputs = none
  [../]
  [./1Q_ten]
    type = FunctionValuePostprocessor
    function = Q_ten
  [../]
  [./1M_ten]
    type = FunctionValuePostprocessor
    function = M_ten
  [../]
  [./five_gauge_stress]
    type = ElementAverageValue
    variable = five_gauge_stress
    outputs = none
  [../]
  [./2Q_five]
    type = FunctionValuePostprocessor
    function = Q_five
  [../]
  [./2M_five]
    type = FunctionValuePostprocessor
    function = M_five
  [../]
  [./three_gauge_stress]
    type = ElementAverageValue
    variable = three_gauge_stress
    outputs = none
  [../]
  [./3Q_three]
    type = FunctionValuePostprocessor
    function = Q_three
  [../]
  [./3M_three]
    type = FunctionValuePostprocessor
    function = M_three
  [../]
  [./two_gauge_stress]
    type = ElementAverageValue
    variable = two_gauge_stress
    outputs = none
  [../]
  [./4Q_two]
    type = FunctionValuePostprocessor
    function = Q_two
  [../]
  [./4M_two]
    type = FunctionValuePostprocessor
    function = M_two
  [../]
  [./onepointfive_gauge_stress]
    type = ElementAverageValue
    variable = onepointfive_gauge_stress
    outputs = none
  [../]
  [./5Q_onepointfive]
    type = FunctionValuePostprocessor
    function = Q_onepointfive
  [../]
  [./5M_onepointfive]
    type = FunctionValuePostprocessor
    function = M_onepointfive
  [../]
  [./one_gauge_stress]
    type = ElementAverageValue
    variable = one_gauge_stress
    outputs = none
  [../]
  [./6Q_one]
    type = FunctionValuePostprocessor
    function = Q_one
  [../]
  [./6M_one]
    type = FunctionValuePostprocessor
    function = M_one
  [../]
[]

[Outputs]
  csv = true
  file_base = exact_spherical_out
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8b75669e-e934-48a9-8771-03ec47cef4fc"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/capped_mohr_coulomb/random4.i</h4><pre class="moose-pre"><code class="language-text"># Using CappedMohrCoulomb
# Plasticity models:
# Tensile strength = 0.1MPa
# Compressive strength = 1.0MPa
# Cohesion = 1MPa
# Friction angle = dilation angle = 0.5
#
# Lame lambda = 1GPa.  Lame mu = 1.3GPa
#
# A line of elements is perturbed randomly, and return to the yield surface at each quadpoint is checked

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 100
  ny = 12
  nz = 1
  xmin = 0
  xmax = 100
  ymin = 0
  ymax = 12
  zmin = 0
  zmax = 1
[]
[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Modules/TensorMechanics/Master]
  [./all]
    add_variables = true
    incremental = true
    generate_output = &#x27;stress_xx stress_xy stress_xz stress_yy stress_yz stress_zz&#x27;
  [../]
[]

[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./f0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f3]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f4]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f5]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f6]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f7]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f8]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f9]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f10]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./f0]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = f0
  [../]
  [./f1]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 1
    variable = f1
  [../]
  [./f2]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 2
    variable = f2
  [../]
  [./f3]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 3
    variable = f3
  [../]
  [./f4]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 4
    variable = f4
  [../]
  [./f5]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 5
    variable = f5
  [../]
  [./f6]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 6
    variable = f6
  [../]
  [./f7]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 7
    variable = f7
  [../]
  [./f8]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 8
    variable = f8
  [../]
  [./f9]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 9
    variable = f9
  [../]
  [./f10]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 10
    variable = f10
  [../]
  [./f11]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 11
    variable = f11
  [../]
  [./int0]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    index = 0
    variable = int0
  [../]
  [./int1]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    index = 1
    variable = int1
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./tot_iters]
    type = ElementIntegralMaterialProperty
    mat_prop = plastic_NR_iterations
    outputs = console
  [../]
  [./intnl0_max]
    type = ElementExtremeValue
    variable = int0
    outputs = console
  [../]
  [./intnl1_max]
    type = ElementExtremeValue
    variable = int1
    outputs = console
  [../]
  [./raw_f0]
    type = ElementExtremeValue
    variable = f0
    outputs = console
  [../]
  [./raw_f1]
    type = ElementExtremeValue
    variable = f1
    outputs = console
  [../]
  [./raw_f2]
    type = ElementExtremeValue
    variable = f2
    outputs = console
  [../]
  [./raw_f3]
    type = ElementExtremeValue
    variable = f3
    outputs = console
  [../]
  [./raw_f4]
    type = ElementExtremeValue
    variable = f4
    outputs = console
  [../]
  [./raw_f5]
    type = ElementExtremeValue
    variable = f5
    outputs = console
  [../]
  [./raw_f6]
    type = ElementExtremeValue
    variable = f6
    outputs = console
  [../]
  [./raw_f7]
    type = ElementExtremeValue
    variable = f7
    outputs = console
  [../]
  [./raw_f8]
    type = ElementExtremeValue
    variable = f8
    outputs = console
  [../]
  [./raw_f9]
    type = ElementExtremeValue
    variable = f9
    outputs = console
  [../]
  [./raw_f10]
    type = ElementExtremeValue
    variable = f10
    outputs = console
  [../]
  [./raw_f11]
    type = ElementExtremeValue
    variable = f11
    outputs = console
  [../]
  [./iter]
    type = ElementExtremeValue
    variable = iter
    outputs = console
  [../]
  [./f0]
    type = FunctionValuePostprocessor
    function = should_be_zero0_fcn
  [../]
  [./f1]
    type = FunctionValuePostprocessor
    function = should_be_zero1_fcn
  [../]
  [./f2]
    type = FunctionValuePostprocessor
    function = should_be_zero2_fcn
  [../]
  [./f3]
    type = FunctionValuePostprocessor
    function = should_be_zero3_fcn
  [../]
  [./f4]
    type = FunctionValuePostprocessor
    function = should_be_zero4_fcn
  [../]
  [./f5]
    type = FunctionValuePostprocessor
    function = should_be_zero5_fcn
  [../]
  [./f6]
    type = FunctionValuePostprocessor
    function = should_be_zero6_fcn
  [../]
  [./f7]
    type = FunctionValuePostprocessor
    function = should_be_zero7_fcn
  [../]
  [./f8]
    type = FunctionValuePostprocessor
    function = should_be_zero8_fcn
  [../]
  [./f9]
    type = FunctionValuePostprocessor
    function = should_be_zero9_fcn
  [../]
  [./f10]
    type = FunctionValuePostprocessor
    function = should_be_zero10_fcn
  [../]
  [./f11]
    type = FunctionValuePostprocessor
    function = should_be_zero11_fcn
  [../]
[]

[Functions]
  [./should_be_zero0_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f0&#x27;
  [../]
  [./should_be_zero1_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f1&#x27;
  [../]
  [./should_be_zero2_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f2&#x27;
  [../]
  [./should_be_zero3_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f3&#x27;
  [../]
  [./should_be_zero4_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f4&#x27;
  [../]
  [./should_be_zero5_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f5&#x27;
  [../]
  [./should_be_zero6_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f6&#x27;
  [../]
  [./should_be_zero7_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f7&#x27;
  [../]
  [./should_be_zero8_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f8&#x27;
  [../]
  [./should_be_zero9_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f9&#x27;
  [../]
  [./should_be_zero10_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f10&#x27;
  [../]
  [./should_be_zero11_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f11&#x27;
  [../]
[]

[UserObjects]
  [./ts]
    type = TensorMechanicsHardeningCubic
    value_0 = 1E6
    value_residual = 2E6
    internal_limit = 1
  [../]
  [./cs]
    type = TensorMechanicsHardeningCubic
    value_0 = 1E7
    value_residual = 0.5E7
    internal_limit = 1
  [../]
  [./coh]
    type = TensorMechanicsHardeningCubic
    value_0 = 2E6
    value_residual = 1E6
    internal_limit = 1
  [../]
  [./phi]
    type = TensorMechanicsHardeningCubic
    value_0 = 0.6
    value_residual = 0.2
    internal_limit = 1
  [../]
  [./psi]
    type = TensorMechanicsHardeningCubic
    value_0 = 0.5
    value_residual = 0.1
    internal_limit = 1
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;1E9 1.3E9&#x27;
  [../]
  [./tensile]
    type = CappedMohrCoulombStressUpdate
    tensile_strength = ts
    compressive_strength = cs
    cohesion = coh
    friction_angle = phi
    dilation_angle = psi
    smoothing_tol = 1E5
    max_NR_iterations = 1000
    yield_function_tol = 1.0E-1
  [../]
  [./stress]
    type = ComputeMultipleInelasticStress
    inelastic_models = tensile
    perform_finite_strain_rotations = false
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  dtmin = 1
  type = Transient
[]


[Outputs]
  file_base = random4
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="dc4a319b-d097-4642-b099-bdb63e35b126"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/capped_mohr_coulomb/random1.i</h4><pre class="moose-pre"><code class="language-text"># Using CappedMohrCoulomb with tensile failure only
# Plasticity models:
# Tensile strength = 1MPa
#
# Lame lambda = 1GPa.  Lame mu = 1.3GPa
#
# A line of elements is perturbed randomly, and return to the yield surface at each quadpoint is checked

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 1234
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 1234
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Modules/TensorMechanics/Master]
  [./all]
    add_variables = true
    incremental = true
    generate_output = &#x27;stress_xx stress_xy stress_xz stress_yy stress_yz stress_zz&#x27;
  [../]
[]

[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./f0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./f0]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = f0
  [../]
  [./f1]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 1
    variable = f1
  [../]
  [./f2]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 2
    variable = f2
  [../]
  [./int0]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    factor = 1E6
    index = 0
    variable = int0
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./tot_iters]
    type = ElementIntegralMaterialProperty
    mat_prop = plastic_NR_iterations
    outputs = console
  [../]
  [./raw_f0]
    type = ElementExtremeValue
    variable = f0
    outputs = console
  [../]
  [./raw_f1]
    type = ElementExtremeValue
    variable = f1
    outputs = console
  [../]
  [./raw_f2]
    type = ElementExtremeValue
    variable = f2
    outputs = console
  [../]
  [./iter]
    type = ElementExtremeValue
    variable = iter
    outputs = console
  [../]
  [./f0]
    type = FunctionValuePostprocessor
    function = should_be_zero0_fcn
  [../]
  [./f1]
    type = FunctionValuePostprocessor
    function = should_be_zero1_fcn
  [../]
  [./f2]
    type = FunctionValuePostprocessor
    function = should_be_zero2_fcn
  [../]
[]

[Functions]
  [./should_be_zero0_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f0&#x27;
  [../]
  [./should_be_zero1_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f1&#x27;
  [../]
  [./should_be_zero2_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f2&#x27;
  [../]
[]

[UserObjects]
  [./ts]
    type = TensorMechanicsHardeningCubic
    value_0 = 1E6
    value_residual = 0
    internal_limit = 1
  [../]
  [./cs]
    type = TensorMechanicsHardeningConstant
    value = 1E12
  [../]
  [./coh]
    type = TensorMechanicsHardeningConstant
    value = 1E12
  [../]
  [./ang]
    type = TensorMechanicsHardeningConstant
    value = 0.5
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;1E9 1.3E9&#x27;
  [../]
  [./tensile]
    type = CappedMohrCoulombStressUpdate
    tensile_strength = ts
    compressive_strength = cs
    cohesion = coh
    friction_angle = ang
    dilation_angle = ang
    smoothing_tol = 1E5
    max_NR_iterations = 100
    yield_function_tol = 1.0E-1
  [../]
  [./stress]
    type = ComputeMultipleInelasticStress
    inelastic_models = tensile
    perform_finite_strain_rotations = false
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random1
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6f36f147-0458-456f-823e-a2cefd36b722"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh03.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# injection
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    variable = pp
    SumQuantityUO = borehole_total_outflow_mass
    point_file = bh03.bh
    function_of = pressure
    fluid_phase = 0
    bottom_p_or_t = 1E7
    unit_weight = &#x27;0 0 0&#x27;
    use_mobility = true
    character = -1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]

[Outputs]
  file_base = bh03
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="58d10b6b-a944-4391-9e29-6c1140479f58"><div class="modal-content"><h4>test/tests/kernels/2d_diffusion/2d_diffusion_bodyforce_test.i</h4><pre class="moose-pre"><code class="language-text">###########################################################
# This is a simple test of the Kernel System.
# It solves the Laplacian equation on a small 2x2 grid.
# The &quot;Diffusion&quot; kernel is used to calculate the
# residuals of the weak form of this operator. The
# &quot;BodyForce&quot; kernel is used to apply a time-dependent
# volumetric source.
###########################################################

[Mesh]
  [./square]
    type = GeneratedMeshGenerator
    nx = 2
    ny = 2
    dim = 2
  [../]
[]

[Variables]
  active = &#x27;u&#x27;

  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./bf]
    type = BodyForce
    variable = u
    postprocessor = ramp
  [../]
[]

[Functions]
  [./ramp]
    type = ParsedFunction
    value = &#x27;t&#x27;
  [../]
[]

[Postprocessors]
  [./ramp]
    type = FunctionValuePostprocessor
    function = ramp
    execute_on = linear
  [../]
[]

[BCs]
  active = &#x27;left right&#x27;

  [./left]
    type = DirichletBC
    variable = u
    boundary = 3
    value = 0
  [../]

  [./right]
    type = DirichletBC
    variable = u
    boundary = 1
    value = 0
  [../]
[]

[Executioner]
  type = Transient
  dt = 1.0
  end_time = 1.0

  solve_type = &#x27;NEWTON&#x27;
[]

[Outputs]
  file_base = bodyforce_out
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3d7e4015-f169-4924-9b8a-8ddb43177460"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/mandel_basicthm.i</h4><pre class="moose-pre"><code class="language-text"># using a BasicTHM Action
#
# Mandel&#x27;s problem of consolodation of a drained medium
# Using the FullySaturatedDarcyBase and FullySaturatedFullySaturatedMassTimeDerivative kernels
# with multiply_by_density = false, so that this problem becomes linear
# Note the use of consistent_with_displaced_mesh = false in the calculation of volumetric strain
#
# A sample is in plane strain.
# -a &lt;= x &lt;= a
# -b &lt;= y &lt;= b
# It is squashed with constant force by impermeable, frictionless plattens on its top and bottom surfaces (at y=+/-b)
# Fluid is allowed to leak out from its sides (at x=+/-a)
# The porepressure within the sample is monitored.
#
# As is common in the literature, this is simulated by
# considering the quarter-sample, 0&lt;=x&lt;=a and 0&lt;=y&lt;=b, with
# impermeable, roller BCs at x=0 and y=0 and y=b.
# Porepressure is fixed at zero on x=a.
# Porepressure and displacement are initialised to zero.
# Then the top (y=b) is moved downwards with prescribed velocity,
# so that the total force that is inducing this downwards velocity
# is fixed.  The velocity is worked out by solving Mandel&#x27;s problem
# analytically, and the total force is monitored in the simulation
# to check that it indeed remains constant.
#
# Here are the problem&#x27;s parameters, and their values:
# Soil width.  a = 1
# Soil height.  b = 0.1
# Soil&#x27;s Lame lambda.  la = 0.5
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = G = 0.75
# Soil bulk modulus.  K = la + 2*mu/3 = 1
# Drained Poisson ratio.  nu = (3K - 2G)/(6K + 2G) = 0.2
# Soil bulk compliance.  1/K = 1
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Biot modulus.  M = 1/(phi0/Kf + (alpha - phi0)(1 - alpha)/K) = 4.705882
# Undrained bulk modulus. Ku = K + alpha^2*M = 2.694118
# Undrained Poisson ratio.  nuu = (3Ku - 2G)/(6Ku + 2G) = 0.372627
# Skempton coefficient.  B = alpha*M/Ku = 1.048035
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Consolidation coefficient.  c = 2*k*B^2*G*(1-nu)*(1+nuu)^2/9/(1-nuu)/(nuu-nu) = 3.821656
# Normal stress on top.  F = 1
#
# The solution for porepressure and displacements is given in
# AHD Cheng and E Detournay &quot;A direct boundary element method for plane strain poroelasticity&quot; International Journal of Numerical and Analytical Methods in Geomechanics 12 (1988) 551-572.
# The solution involves complicated infinite series, so I shall not write it here

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 10
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 0.1
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./roller_xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left&#x27;
  [../]
  [./roller_ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom&#x27;
  [../]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
  [./xmax_drained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = right
  [../]
  [./top_velocity]
    type = FunctionDirichletBC
    variable = disp_y
    function = top_velocity
    boundary = top
  [../]
[]

[Functions]
  [./top_velocity]
    type = PiecewiseLinear
    x = &#x27;0 0.002 0.006   0.014   0.03    0.046   0.062   0.078   0.094   0.11    0.126   0.142   0.158   0.174   0.19 0.206 0.222 0.238 0.254 0.27 0.286 0.302 0.318 0.334 0.35 0.366 0.382 0.398 0.414 0.43 0.446 0.462 0.478 0.494 0.51 0.526 0.542 0.558 0.574 0.59 0.606 0.622 0.638 0.654 0.67 0.686 0.702&#x27;
    y = &#x27;-0.041824842    -0.042730269    -0.043412712    -0.04428867     -0.045509181    -0.04645965     -0.047268246 -0.047974749      -0.048597109     -0.0491467  -0.049632388     -0.050061697      -0.050441198     -0.050776675     -0.051073238      -0.0513354 -0.051567152      -0.051772022     -0.051953128 -0.052113227 -0.052254754 -0.052379865 -0.052490464 -0.052588233 -0.052674662 -0.052751065 -0.052818606 -0.052878312 -0.052931093 -0.052977751 -0.053018997 -0.053055459 -0.053087691 -0.053116185 -0.053141373 -0.05316364 -0.053183324 -0.053200724 -0.053216106 -0.053229704 -0.053241725 -0.053252351 -0.053261745 -0.053270049 -0.053277389 -0.053283879 -0.053289615&#x27;
  [../]
[]

[AuxVariables]
  [./tot_force]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./tot_force]
    type = ParsedAux
    args = &#x27;stress_yy porepressure&#x27;
    execute_on = timestep_end
    variable = tot_force
    function = &#x27;-stress_yy+0.6*porepressure&#x27;
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 8.0
      viscosity = 1.0
      density0 = 1.0
    [../]
  [../]
[]

[PorousFlowBasicTHM]
  coupling_type = HydroMechanical
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  multiply_by_density = false
  porepressure = porepressure
  biot_coefficient = 0.6
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0.5 0.75&#x27;
    # bulk modulus is lambda + 2*mu/3 = 0.5 + 2*0.75/3 = 1
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is ever used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.6
    solid_bulk_compliance = 1
    fluid_bulk_modulus = 8
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0.0 0 0&#x27;
    variable = porepressure
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0.1 0 0&#x27;
    variable = porepressure
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0.2 0 0&#x27;
    variable = porepressure
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0.3 0 0&#x27;
    variable = porepressure
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0.4 0 0&#x27;
    variable = porepressure
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0.5 0 0&#x27;
    variable = porepressure
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0.6 0 0&#x27;
    variable = porepressure
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0.7 0 0&#x27;
    variable = porepressure
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0.8 0 0&#x27;
    variable = porepressure
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0.9 0 0&#x27;
    variable = porepressure
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;1 0 0&#x27;
    variable = porepressure
  [../]
  [./xdisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_x
  [../]
  [./ydisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_y
  [../]
  [./total_downwards_force]
     type = ElementAverageValue
     outputs = csv
     variable = tot_force
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.15*t&lt;0.01,0.15*t,0.01)
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 0.7
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = mandel_basicthm
  [./csv]
    interval = 3
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="614cfea5-36ed-42cd-a8ae-3e761959d890"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except08.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
    at_nodes = false # Needed to force expected error
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02.bh
    use_mobility = true
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="52091371-da31-4e98-a3ec-6ef994961758"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/pls01.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated situation with a poly-line sink at one
# of the nodes.  Because there is no fluid flow, the
# other nodes should not experience any change in
# porepressure.
# The poly-line sink has length=2 and weight=0.1, and
# extracts fluid at a constant rate of 1 kg.m^-1.s^-1.
# Therefore, in 1 second it will have extracted a total
# of 0.2 kg.
# The porosity is 0.1, and the elemental volume is 2,
# so the fluid mass at the node in question = 0.2 * density / 4,
# where the 4 is the number of nodes in the element.
# In this simulation density = dens0 * exp(P / bulk), with
# dens0 = 100, and bulk = 20 MPa.
# The initial porepressure P0 = 10 MPa, so the final (after
# 1 second of simulation) is
# P(t=1) = 0.950879 MPa
#
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmin = 0
  xmax = 2
  ymin = 0
  ymax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pls_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      density0 = 100
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
[]

[DiracKernels]
  [./pls]
    type = PorousFlowPolyLineSink
    fluid_phase = 0
    point_file = pls01_21.bh
    line_length = 2
    SumQuantityUO = pls_total_outflow_mass
    variable = pp
    p_or_t_vals = &#x27;0 1E7&#x27;
    fluxes = &#x27;1 1&#x27;
  [../]
[]

[Postprocessors]
  [./pls_report]
    type = PorousFlowPlotQuantity
    uo = pls_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p00]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
  [./p01]
    type = PointValue
    variable = pp
    point = &#x27;0 1 0&#x27;
    execute_on = timestep_end
  [../]
  [./p20]
    type = PointValue
    variable = pp
    point = &#x27;2 0 0&#x27;
    execute_on = timestep_end
  [../]
  [./p21]
    type = PointValue
    variable = pp
    point = &#x27;2 1 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 pls_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1
  dt = 1
  solve_type = NEWTON
[]

[Outputs]
  file_base = pls01
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4cb23507-9036-41af-8995-177cdefe8ef9"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh18.i</h4><pre class="moose-pre"><code class="language-text"># with immobile saturation
# unsaturated = true
# gravity = true
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 0.5E1 0.5E2 0.4E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.4
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh18
  execute_on = &#x27;timestep_end final&#x27;
  interval = 100000
  exodus = true
  [./console]
    type = Console
    interval = 1
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="66e950bc-17f8-4433-b5d9-636caa44357c"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s06.i</h4><pre class="moose-pre"><code class="language-text"># apply a half-cubic sink flux and observe the correct behavior
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  zmin = 0
  zmax = 2
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1.1
  [../]
[]

[Variables]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = x*(y+1)
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.3
      density0 = 1.1
      thermal_expansion = 0
      viscosity = 1.1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-5 0 0 0 1E-5 0 0 0 1E-5&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[AuxVariables]
  [./flux_out]
  [../]
[]

[Functions]
  [./mass10]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)*if(pp&gt;=0,1,pow(1+pow(-al*pp,1.0/(1-m)),-m))&#x27;
    vars = &#x27;vol por dens0 pp bulk al m&#x27;
    vals = &#x27;0.25 0.1 1.1 p10 1.3 1.1 0.5&#x27;
  [../]
  [./rate10]
    type = ParsedFunction
    value = &#x27;fcn*if(pp&gt;center,m,if(pp&lt;themin,0,m/c/c/c*(2*(pp-center)+c)*((pp-center)-c)*((pp-center)-c)))&#x27;
    vars = &#x27;m fcn pp  center sd  themin c&#x27;
    vals = &#x27;2 3   p10 0.9    0.5 0.1   -0.8&#x27;
  [../]
  [./mass10_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-rate*area*dt&#x27;
    vars = &#x27;mass_prev rate     area dt&#x27;
    vals = &#x27;m10_prev  m10_rate 0.5 2E-3&#x27;
  [../]
  [./mass11]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)*if(pp&gt;=0,1,pow(1+pow(-al*pp,1.0/(1-m)),-m))&#x27;
    vars = &#x27;vol por dens0 pp bulk al m&#x27;
    vals = &#x27;0.25 0.1 1.1 p11 1.3 1.1 0.5&#x27;
  [../]
  [./rate11]
    type = ParsedFunction
    value = &#x27;fcn*if(pp&gt;center,m,if(pp&lt;themin,0,m/c/c/c*(2*(pp-center)+c)*((pp-center)-c)*((pp-center)-c)))&#x27;
    vars = &#x27;m fcn pp  center sd  themin c&#x27;
    vals = &#x27;2 3   p11 0.9    0.5 0.1   -0.8&#x27;
  [../]
  [./mass11_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-rate*area*dt&#x27;
    vars = &#x27;mass_prev rate     area dt&#x27;
    vals = &#x27;m11_prev  m11_rate 0.5 2E-3&#x27;
  [../]
[]

[Postprocessors]
  [./flux00]
    type = PointValue
    variable = flux_out
    point = &#x27;0 0 0&#x27;
  [../]
  [./flux01]
    type = PointValue
    variable = flux_out
    point = &#x27;0 1 0&#x27;
  [../]
  [./flux10]
    type = PointValue
    variable = flux_out
    point = &#x27;1 0 0&#x27;
  [../]
  [./flux11]
    type = PointValue
    variable = flux_out
    point = &#x27;1 1 0&#x27;
  [../]
  [./p00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p10]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m10]
    type = FunctionValuePostprocessor
    function = mass10
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m10_prev]
    type = FunctionValuePostprocessor
    function = mass10
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m10_rate]
    type = FunctionValuePostprocessor
    function = rate10
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./m10_expect]
    type = FunctionValuePostprocessor
    function = mass10_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./p01]
    type = PointValue
    point = &#x27;0 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p11]
    type = PointValue
    point = &#x27;1 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m11]
    type = FunctionValuePostprocessor
    function = mass11
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m11_prev]
    type = FunctionValuePostprocessor
    function = mass11
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m11_rate]
    type = FunctionValuePostprocessor
    function = rate11
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./m11_expect]
    type = FunctionValuePostprocessor
    function = mass11_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[BCs]
  [./flux]
    type = PorousFlowHalfCubicSink
    boundary = &#x27;left right&#x27;
    max = 2
    cutoff = -0.8
    center = 0.9
    variable = pp
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 3
    save_in = flux_out
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 10000 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 2E-3
  end_time = 6E-2
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[Outputs]
  file_base = s06
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
    interval = 5
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;timestep_end&#x27;
    interval = 3
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8428c049-17ab-41bd-be3c-00b0164259fc"><div class="modal-content"><h4>modules/richards/test/tests/sinks/s01.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.5
    al = 1 # same deal with PETScs constant state
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = initial_pressure
    [../]
  [../]
[]

[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 2
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((mi-lfout-rfout-mf)/2/(mi+mf))
    vars = &#x27;mi mf lfout rfout&#x27;
    vals = &#x27;mass_init mass_fin left_flux_out right_flux_out&#x27;
  [../]
[]

[Postprocessors]
  [./mass_init]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]
  [./mass_fin]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]
  [./left_flux_out]
    type = RichardsPiecewiseLinearSinkFlux
    boundary = left
    variable = pressure
    pressures = &#x27;0 1&#x27;
    bare_fluxes = &#x27;1 2&#x27;
    use_mobility = false
    use_relperm = false
  [../]
  [./right_flux_out]
    type = RichardsPiecewiseLinearSinkFlux
    boundary = right
    variable = pressure
    pressures = &#x27;0 1&#x27;
    bare_fluxes = &#x27;1 2&#x27;
    use_mobility = false
    use_relperm = false
  [../]
  [./p0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
  [./mass_bal]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
  [../]
[]

[BCs]
  [./left_flux]
    type = RichardsPiecewiseLinearSink
    boundary = left
    pressures = &#x27;0 1&#x27;
    bare_fluxes = &#x27;1 2&#x27;
    variable = pressure
    use_mobility = false
    use_relperm = false
  [../]
  [./right_flux]
    type = RichardsPiecewiseLinearSink
    boundary = right
    pressures = &#x27;0 1&#x27;
    bare_fluxes = &#x27;1 2&#x27;
    variable = pressure
    use_mobility = false
    use_relperm = false
  [../]
[]

[Kernels]
  active = &#x27;richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
[]

[AuxVariables]
  [./one]
    initial_condition = 1
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  dt = 2E-3
  end_time = 0.2
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[Outputs]
  file_base = s01
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="967a684f-7c53-4d9f-8371-37a54b21b0a9"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh08.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
# with anisotropic, but diagonal, permeability
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 2E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON

[]

[Outputs]
  file_base = bh08
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="11fa38d7-fd6f-448c-856c-97494d34efa7"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/weak_plane_shear/large_deform_harden3.i</h4><pre class="moose-pre"><code class="language-text"># apply a number of &quot;random&quot; configurations and
# check that the algorithm returns to the yield surface
#
# must be careful here - we cannot put in arbitrary values of C_ijkl, otherwise the condition
# df/dsigma * C * flow_dirn &lt; 0 for some stresses
# The important features that must be obeyed are:
# 0 = C_0222 = C_1222  (holds for transversely isotropic, for instance)
# C_0212 &lt; C_0202 = C_1212 (holds for transversely isotropic)

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[BCs]
  [./bottomx]
    type = DirichletBC
    variable = disp_x
    boundary = back
    value = 0.0
  [../]
  [./bottomy]
    type = DirichletBC
    variable = disp_y
    boundary = back
    value = 0.0
  [../]
  [./bottomz]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]

  # the following are &quot;random&quot; deformations
  # each is O(1E-5) to keep deformations small
  [./topx]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = front
    function = &#x27;(sin(0.1*t)+x)/1E1&#x27;
  [../]
  [./topy]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = front
    function = &#x27;(cos(t)+x*y)/1E1&#x27;
  [../]
  [./topz]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = front
    function = &#x27;sin(0.4321*t)*x*y*z/1E1&#x27;
  [../]
[]

[AuxVariables]
  [./wps_internal]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./wps_internal_auxk]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    index = 0
    variable = wps_internal
  [../]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = yield_fcn
  [../]
[]

[Postprocessors]
  [./int]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = wps_internal
    outputs = &#x27;console&#x27;
  [../]
  [./yield_fcn_at_zero]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;yield_fcn_at_zero&#x27;
  [../]
[]

[UserObjects]
  [./coh]
    type = TensorMechanicsHardeningExponential
    value_0 = 1E3
    value_residual = 0
    rate = 0.01
  [../]
  [./tanphi]
    type = TensorMechanicsHardeningExponential
    value_0 = 1
    value_residual = 0.577350269
    rate = 0.01
  [../]
  [./tanpsi]
    type = TensorMechanicsHardeningExponential
    value_0 = 0.08748866
    value_residual = 0.03492077
    rate = 0.01
  [../]
  [./wps]
    type = TensorMechanicsPlasticWeakPlaneShear
    cohesion = coh
    tan_friction_angle = tanphi
    tan_dilation_angle = tanpsi
    smoother = 100
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-3
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    # the following is transversely isotropic, i think.
    fill_method = symmetric9
    C_ijkl = &#x27;3E9 1E9 3E9 3E9 3E9 6E9 1E9 1E9 9E9&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    plastic_models = wps
    transverse_direction = &#x27;0 0 1&#x27;
    max_NR_iterations = 1000
    ep_plastic_tolerance = 1E-3
    debug_fspb = crash
  [../]
[]


[Executioner]
  end_time = 1E4
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = large_deform_harden3
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="929e5a9f-fbbd-440b-97e8-ea6c19f54bfe"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_18.i</h4><pre class="moose-pre"><code class="language-text"># with immobile saturation - this illustrates a perfect case of fullyupwind working very well
# unsaturated = true
# gravity = true
# full upwinding = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 0.5E1 0.5E2 0.4E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.4
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh_fu_18
  execute_on = &#x27;timestep_end final&#x27;
  interval = 100000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9eced40d-76dc-48f5-b801-a09b7a91c4b7"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh02.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON

[]

[Outputs]
  file_base = bh02
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0fd4eb2c-8c0a-41cd-b047-4076ebf39011"><div class="modal-content"><h4>test/tests/controls/output/controllable.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 2
  elem_type = QUAD4
  uniform_refine = 4
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 3
  dt = 0.1
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = u
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Outputs]
  [./controls]
    type = ControlOutput
    clear_after_output = false
  [../]
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;*/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="44ec1c57-96e6-4bf0-8f2e-20267703576b"><div class="modal-content"><h4>modules/porous_flow/test/tests/energy_conservation/heat04_fullysat_action.i</h4><pre class="moose-pre"><code class="language-text"># heat04, but using an action
#
# The sample is a single unit element, with fixed displacements on
# all sides.  A heat source of strength S (J/m^3/s) is applied into
# the element.  There is no fluid flow or heat flow.  The rise
# in temperature, porepressure and stress, and the change in porosity is
# matched with theory.
#
# In this case, fluid mass must be conserved, and there is no
# volumetric strain, so
# porosity * fluid_density = constant
# Also, the energy-density in the rock-fluid system increases with S:
# d/dt [(1 - porosity) * rock_density * rock_heat_cap * T + porosity * fluid_density * fluid_heat_cap * T] = S
# Also, the porosity evolves according to THM as
# porosity = biot + (porosity0 - biot) * exp( (biot - 1) * P / fluid_bulk + rock_thermal_exp * T)
# Finally, the effective stress must be exactly zero (as there is
# no strain).
#
# Let us assume that
# fluid_density = dens0 * exp(P / fluid_bulk - fluid_thermal_exp * T)
# Then the conservation of fluid mass means
# porosity = por0 * exp(- P / fluid_bulk + fluid_thermal_exp * T)
# where dens0 * por0 = the initial fluid mass.
# The last expression for porosity, combined with the THM one,
# and assuming that biot = 1 for simplicity, gives
# porosity = 1 + (porosity0 - 1) * exp(rock_thermal_exp * T) = por0 * exp(- P / fluid_bulk + fluid_thermal_exp * T) .... (A)
#
# This stuff may be substituted into the heat energy-density equation:
# S = d/dt [(1 - porosity0) * exp(rock_thermal_exp * T) * rock_density * rock_heat_cap * T + porosity * fluid_density * fluid_heat_cap * T]
#
# If S is constant then
# S * t = (1 - porosity0) * exp(rock_thermal_exp * T) * rock_density * rock_heat_cap * T + porosity * fluid_density * fluid_heat_cap * T
# with T(t=0) = 0 then Eqn(A) implies that por0 = porosity0 and
# P / fluid_bulk = fluid_thermal_exp * T - log(1 + (por0 - 1) * exp(rock_thermal_exp * T)) + log(por0)
#
# Parameters:
# A = 2
# fluid_bulk = 2.0
# dens0 = 3.0
# fluid_thermal_exp = 0.5
# fluid_heat_cap = 2
# por0 = 0.5
# rock_thermal_exp = 0.25
# rock_density = 5
# rock_heat_capacity = 0.2

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.5
      cv = 2
      cp = 2
      bulk_modulus = 2.0
      density0 = 3.0
    [../]
  [../]
[]

[PorousFlowFullySaturated]
  coupling_type = ThermoHydroMechanical
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  porepressure = pp
  temperature = temp
  dictator_name = Sir
  biot_coefficient = 1.0
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = Sir
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./pp]
  [../]
  [./temp]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
[]

[Kernels]
  [./heat_source]
    type = BodyForce
    function = 1
    variable = temp
  [../]
[]

[Functions]
  [./err_T_fcn]
    type = ParsedFunction
    vars = &#x27;por0 rte temp rd rhc m0 fhc source&#x27;
    vals = &#x27;0.5 0.25 t0   5  0.2 1.5 2  1&#x27;
    value = &#x27;((1-por0)*exp(rte*temp)*rd*rhc*temp+m0*fhc*temp-source*t)/(source*t)&#x27;
  [../]
  [./err_pp_fcn]
    type = ParsedFunction
    vars = &#x27;por0 rte temp rd rhc m0 fhc source bulk pp fte&#x27;
    vals = &#x27;0.5 0.25 t0   5  0.2 1.5 2  1      2    p0 0.5&#x27;
    value = &#x27;(bulk*(fte*temp-log(1+(por0-1)*exp(rte*temp))+log(por0))-pp)/pp&#x27;
  [../]
[]

[AuxVariables]
  [./porosity]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./porosity]
    type = PorousFlowPropertyAux
    property = porosity
    variable = porosity
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosity
    thermal = true
    fluid = true
    mechanical = true
    ensure_positive = false
    biot_coefficient = 1.0
    porosity_zero = 0.5
    thermal_expansion_coeff = 0.25
    solid_bulk = 2
  [../]
  [./rock_heat]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 0.2
    density = 5.0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0 0 0 0 0 0 0 0 0&#x27;
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;0 0 0  0 0 0  0 0 0&#x27;
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = pp
  [../]
  [./t0]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = temp
  [../]
  [./porosity]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = porosity
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./fluid_mass]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;timestep_end&#x27;
    use_displaced_mesh = true
    outputs = &#x27;console csv&#x27;
  [../]
  [./total_heat]
    type = PorousFlowHeatEnergy
    phase = 0
    execute_on = &#x27;timestep_end&#x27;
    use_displaced_mesh = true
    outputs = &#x27;console csv&#x27;
  [../]
  [./err_T]
    type = FunctionValuePostprocessor
    function = err_T_fcn
  [../]
  [./err_P]
    type = FunctionValuePostprocessor
    function = err_pp_fcn
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1
  end_time = 5
[]

[Outputs]
  execute_on = &#x27;initial timestep_end&#x27;
  file_base = heat04_fullysat_action
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="33930eb2-22d6-44a9-8303-b39954f6de2c"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except09.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
    compute_enthalpy = false
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02.bh
    use_mobility = true
    use_enthalpy = true
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="fdb396c1-41a8-466b-a7c4-dffa7d6cdb08"><div class="modal-content"><h4>test/tests/controls/syntax_based_naming_access/system_asterisk_param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;Postprocessors/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7e051b28-dbc4-49f8-8997-9a5ffff4f4f1"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh_fu_05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# injection
# fullyupwind
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;500 500 1E1&#x27;
    x = &#x27;4000 5000 6500&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh03.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = -1
    fully_upwind = true
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = -2E5
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 6500
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = bh_fu_05
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="465f50bb-6665-4b74-aee4-d90d425f65f1"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except03.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
    at_nodes = true # Needed to force expected error
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="54450029-04b9-454e-af2e-c94426264d6c"><div class="modal-content"><h4>modules/porous_flow/test/tests/energy_conservation/heat04_action_KT.i</h4><pre class="moose-pre"><code class="language-text"># heat04, but using an action with KT stabilization.
# See heat04.i for a full discussion of the results.
# The KT stabilization should have no impact as there is no flow, but this input file checks that MOOSE runs.
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.5
      cv = 2
      cp = 2
      bulk_modulus = 2.0
      density0 = 3.0
    [../]
  [../]
[]

[PorousFlowUnsaturated]
  coupling_type = ThermoHydroMechanical
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  porepressure = pp
  temperature = temp
  dictator_name = Sir
  biot_coefficient = 1.0
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  van_genuchten_alpha = 1.0E-12
  van_genuchten_m = 0.5
  relative_permeability_type = Corey
  relative_permeability_exponent = 0.0
  stabilization = KT
  flux_limiter_type = superbee
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = Sir
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./pp]
  [../]
  [./temp]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
[]

[Kernels]
  [./heat_source]
    type = BodyForce
    function = 1
    variable = temp
  [../]
[]

[Functions]
  [./err_T_fcn]
    type = ParsedFunction
    vars = &#x27;por0 rte temp rd rhc m0 fhc source&#x27;
    vals = &#x27;0.5 0.25 t0   5  0.2 1.5 2  1&#x27;
    value = &#x27;((1-por0)*exp(rte*temp)*rd*rhc*temp+m0*fhc*temp-source*t)/(source*t)&#x27;
  [../]
  [./err_pp_fcn]
    type = ParsedFunction
    vars = &#x27;por0 rte temp rd rhc m0 fhc source bulk pp fte&#x27;
    vals = &#x27;0.5 0.25 t0   5  0.2 1.5 2  1      2    p0 0.5&#x27;
    value = &#x27;(bulk*(fte*temp-log(1+(por0-1)*exp(rte*temp))+log(por0))-pp)/pp&#x27;
  [../]
[]

[AuxVariables]
  [./porosity]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./porosity]
    type = PorousFlowPropertyAux
    property = porosity
    variable = porosity
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosity
    thermal = true
    fluid = true
    mechanical = true
    ensure_positive = false
    biot_coefficient = 1.0
    porosity_zero = 0.5
    thermal_expansion_coeff = 0.25
    solid_bulk = 2
  [../]
  [./rock_heat]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 0.2
    density = 5.0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0 0 0 0 0 0 0 0 0&#x27;
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;0 0 0  0 0 0  0 0 0&#x27;
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = pp
  [../]
  [./t0]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = temp
  [../]
  [./porosity]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = porosity
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./fluid_mass]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;timestep_end&#x27;
    use_displaced_mesh = true
    outputs = &#x27;console csv&#x27;
  [../]
  [./total_heat]
    type = PorousFlowHeatEnergy
    phase = 0
    execute_on = &#x27;timestep_end&#x27;
    use_displaced_mesh = true
    outputs = &#x27;console csv&#x27;
  [../]
  [./err_T]
    type = FunctionValuePostprocessor
    function = err_T_fcn
  [../]
  [./err_P]
    type = FunctionValuePostprocessor
    function = err_pp_fcn
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1
  end_time = 5
[]

[Outputs]
  execute_on = &#x27;initial timestep_end&#x27;
  file_base = heat04_action
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e8311200-af79-42ac-9ee0-8cf02815a220"><div class="modal-content"><h4>modules/richards/test/tests/excav/ex02.i</h4><pre class="moose-pre"><code class="language-text">###########################################
#                                         #
#   THIS EXAMPLE CONTAINS AN EXCAVATION   #
#                                         #
###########################################


# Easiest way of figuring out what&#x27;s happening:
# Run this example, load into paraview, take
# a slice through (0,0,0) with normal (0,0,1),
# colour by pressure and play the animation.


# This mesh has an interior sideset called excav_bdy
[Mesh]
  type = FileMesh
  file = ex01_input.e
[]



# This is a boundary condition acting on excav_bdy
# All it does is to set the pressure to p_excav=0
# at places on excav_bdy wherever excav_fcn tells it to.
[BCs]
  [./excav_bdy]
    type = RichardsExcav
    boundary = excav_bdy
    p_excav = 0.0
    variable = pressure
    excav_geom_function = excav_fcn
  [../]
[]



[Functions]
# excav_fcn controls where to set pressure=p_excav
# You supply start and end positions and times and
# by a linear interpolation these define the position
# of the coal face at all times
  [./excav_fcn]
    type = RichardsExcavGeom
    start_posn = &#x27;0 -500 0&#x27;
    start_time = 0
    end_posn = &#x27;0 500 0&#x27;
    end_time = 3E7
    active_length = 1E4
  [../]

# mass_bal_fcn calculates the mass balance
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((mi-fout-mf)/2/(mi+mf))
    vars = &#x27;mi mf fout&#x27;
    vals = &#x27;mass_init mass_final flux_out&#x27;
  [../]

# initial pressure - unimportant in this example
  [./initial_pressure]
    type = ParsedFunction
    value = -10000*(z-100)
  [../]
[]




# following is needed by postprocessors, kernels, etc
# unimportant in this example
[GlobalParams]
  richardsVarNames_UO = PPNames
[]




# following does the calculation of relevant
# masses and mass-flux to the excavation
[Postprocessors]

# note that this is calculated at beginning of timestep
  [./mass_init]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

# note this is calculated at end of timestep
  [./mass_final]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

# this is what calculates the mass flux to the excavation
# it is calculating it for boundary=excav_bdy, and the
# excavation time-dependence is set through the excav_fcn
  [./flux_out]
    type = RichardsExcavFlow
    boundary = excav_bdy
    variable = pressure
    excav_geom_function = excav_fcn
  [../]

# mass_bal just outputs the result to screen
  [./mass_bal]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
  [../]
[]




######################################
#                                    #
#  THE FOLLOWING STUFF IS STANDARD   #
#                                    #
######################################


[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E+2
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = &#x27;1 2 3 4&#x27;
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-15 0 0  0 1E-15 0  0 0 1E-15&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 -10&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 3E7
  dt = 1E6
  solve_type = NEWTON
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = ex02
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7d4af12a-1f40-4fb6-bee6-a9bb3c9c1236"><div class="modal-content"><h4>python/chigger/tests/input/mug_blocks.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = FileMesh
  file = mug.e
[]

[MeshModifiers]
  [./subdomains]
    type = SubdomainBoundingBox
    top_right = &#x27;3 3 3&#x27;
    bottom_left = &#x27;0 -3 -2.1&#x27;
    block_id = &#x27;76&#x27;
  [../]
[]

[Variables]
  [./convected]
    order = FIRST
    family = LAGRANGE
  [../]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./aux_elem]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[Kernels]
  [./diff_convected]
    type = Diffusion
    variable = convected
  [../]
  [./conv]
    # Couple a variable into the convection kernel using local_name = simulationg_name syntax
    type = Convection
    variable = convected
    velocity = &#x27;1 1 1&#x27;
  [../]
  [./diff_diffused]
    type = Diffusion
    variable = diffused
  [../]
  [./diff_t]
    type = TimeDerivative
    variable = diffused
  [../]
  [./conv_t]
    type = TimeDerivative
    variable = convected
    block = &#x27;76&#x27;
  [../]
[]

[BCs]
  [./bottom_convected]
    type = DirichletBC
    variable = convected
    boundary = bottom
    value = 1
  [../]
  [./top_convected]
    type = DirichletBC
    variable = convected
    boundary = top
    value = 0
  [../]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = bottom
    value = 2
  [../]
  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = top
    value = 0
  [../]
[]

[Postprocessors]
  [./func_pp]
    type = FunctionValuePostprocessor
    function = 2*t
  [../]
[]

[Executioner]
  # Preconditioned JFNK (default)
  type = Transient
  num_steps = 20
  solve_type = PJFNK
  dt = 0.1
[]

[Outputs]
  exodus = true
[]

[ICs]
  [./aux_ic]
    variable = aux_elem
    max = 10
    seed = 2
    type = RandomIC
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0c81381a-4195-4741-a7a0-b3bc012ca4e4"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mohr_coulomb/planar_hard3.i</h4><pre class="moose-pre"><code class="language-text"># apply repeated stretches in x z directions, and smaller stretches along the y direction,
# so that sigma_I = sigma_II,
# which means that lode angle = 30deg.
# Both return to the edge (lode angle = 30deg, ie 010100) and tip are experienced.
#
# It is checked that the yield functions are less than their tolerance values
# It is checked that the cohesion hardens correctly

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;1E-6*x*t&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0.05E-6*y*t&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;1E-6*z*t&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if((a&lt;1E-5)&amp;(b&lt;1E-5)&amp;(c&lt;1E-5)&amp;(d&lt;1E-5)&amp;(g&lt;1E-5)&amp;(h&lt;1E-5),0,abs(a)+abs(b)+abs(c)+abs(d)+abs(g)+abs(h))&#x27;
    vars = &#x27;a b c d g h&#x27;
    vals = &#x27;f0 f1 f2 f3 f4 f5&#x27;
  [../]
  [./coh_analytic]
    type = ParsedFunction
    value = &#x27;20-10*exp(-1E5*intnl)&#x27;
    vars = intnl
    vals = internal
  [../]
  [./coh_from_yieldfcns]
    type = ParsedFunction
    value = &#x27;(f0+f1-(sxx+syy)*sin(phi))/(-2)/cos(phi)&#x27;
    vars = &#x27;f0 f1 sxx syy phi&#x27;
    vals = &#x27;f0 f1 s_xx s_yy 0.8726646&#x27;
  [../]
  [./should_be_zero_coh]
    type = ParsedFunction
    value = &#x27;if(abs(a-b)&lt;1E-6,0,1E6*abs(a-b))&#x27;
    vars = &#x27;a b&#x27;
    vals = &#x27;Coh_analytic Coh_moose&#x27;
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./mc_int]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn3]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn4]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./yield_fcn5]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./mc_int_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_internal_parameter
    variable = mc_int
  [../]
  [./yield_fcn0]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn0
  [../]
  [./yield_fcn1]
    type = MaterialStdVectorAux
    index = 1
    property = plastic_yield_function
    variable = yield_fcn1
  [../]
  [./yield_fcn2]
    type = MaterialStdVectorAux
    index = 2
    property = plastic_yield_function
    variable = yield_fcn2
  [../]
  [./yield_fcn3]
    type = MaterialStdVectorAux
    index = 3
    property = plastic_yield_function
    variable = yield_fcn3
  [../]
  [./yield_fcn4]
    type = MaterialStdVectorAux
    index = 4
    property = plastic_yield_function
    variable = yield_fcn4
  [../]
  [./yield_fcn5]
    type = MaterialStdVectorAux
    index = 5
    property = plastic_yield_function
    variable = yield_fcn5
  [../]
[]

[Postprocessors]
  [./s_xx]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./s_xy]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_xy
  [../]
  [./s_xz]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_xz
  [../]
  [./s_yy]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./s_yz]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_yz
  [../]
  [./s_zz]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./internal]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = mc_int
  [../]
  [./f0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn0
  [../]
  [./f1]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn1
  [../]
  [./f2]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn2
  [../]
  [./f3]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn3
  [../]
  [./f4]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn4
  [../]
  [./f5]
   type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn5
  [../]
  [./yfcns_should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./Coh_analytic]
    type = FunctionValuePostprocessor
    function = coh_analytic
  [../]
  [./Coh_moose]
    type = FunctionValuePostprocessor
    function = coh_from_yieldfcns
  [../]
  [./cohesion_difference_should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_coh
  [../]
[]

[UserObjects]
  [./mc_coh]
    type = TensorMechanicsHardeningExponential
    value_0 = 10
    value_residual = 20
    rate = 1E5
  [../]
  [./mc_phi]
    type = TensorMechanicsHardeningConstant
    value = 0.8726646
  [../]
  [./mc_psi]
    type = TensorMechanicsHardeningConstant
    value = 1 #0.8726646 # 50deg
  [../]
  [./mc]
    type = TensorMechanicsPlasticMohrCoulombMulti
    cohesion = mc_coh
    friction_angle = mc_phi
    dilation_angle = mc_psi
    yield_function_tolerance = 1E-5
    use_custom_returnMap = true
    internal_constraint_tolerance = 1E-9
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0 1E7&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    ep_plastic_tolerance = 1E-12
    plastic_models = mc
  [../]
[]


[Executioner]
  end_time = 5
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = planar_hard3
  exodus = false
  [./csv]
    type = CSV
    hide = &#x27;f0 f1 f2 f3 f4 f5 s_xy s_xz s_yz Coh_analytic Coh_moose&#x27;
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7173df4e-ac4d-4be7-9df6-c7a02e2efcc8"><div class="modal-content"><h4>modules/richards/test/tests/sinks/s03.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.5
    al = 1
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = initial_pressure
    [../]
  [../]
[]

[AuxVariables]
  [./seff]
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 2
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((mi-lfout-rfout-mf)/2/(mi+mf))
    vars = &#x27;mi mf lfout rfout&#x27;
    vals = &#x27;mass_init mass_fin left_flux_out right_flux_out&#x27;
  [../]
[]

[Postprocessors]
  [./mass_init]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]
  [./mass_fin]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]
  [./left_flux_out]
    type = RichardsPiecewiseLinearSinkFlux
    boundary = left
    variable = pressure
    pressures = &#x27;-1 1&#x27;
    bare_fluxes = &#x27;1E2 2E2&#x27;
    use_mobility = true
    use_relperm = true
  [../]
  [./right_flux_out]
    type = RichardsPiecewiseLinearSinkFlux
    boundary = right
    variable = pressure
    pressures = &#x27;-1 1&#x27;
    bare_fluxes = &#x27;1E2 2E2&#x27;
    use_mobility = true
    use_relperm = true
  [../]
  [./p0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
  [./s0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = seff
  [../]
  [./mass_bal]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
  [../]
[]

[BCs]
  [./left_flux]
    type = RichardsPiecewiseLinearSink
    boundary = left
    pressures = &#x27;-1 1&#x27;
    bare_fluxes = &#x27;1E2 2E2&#x27;
    variable = pressure
    use_mobility = true
    use_relperm = true
  [../]
  [./right_flux]
    type = RichardsPiecewiseLinearSink
    boundary = right
    pressures = &#x27;-1 1&#x27;
    bare_fluxes = &#x27;1E2 2E2&#x27;
    variable = pressure
    use_mobility = true
    use_relperm = true
  [../]
[]

[Kernels]
  active = &#x27;richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
[]

[AuxKernels]
  [./seff_auxk]
    type = RichardsSeffAux
    variable = seff
    seff_UO = SeffVG
    pressure_vars = &#x27;pressure&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 2.1E-5 2.2E-5  2.1E-5 0.1E-5 3.3E-5  2.2E-5 3.3E-5 2E-5&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 2E-3
  end_time = 0.2
[]

[Outputs]
  file_base = s03
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6dd0cc7b-6071-42f8-b761-ca0040de9afc"><div class="modal-content"><h4>modules/combined/test/tests/ad_cavity_pressure/additional_volume.i</h4><pre class="moose-pre"><code class="language-text">#
# Cavity Pressure Test using using automatic differentiation
#
# This test is designed to compute an internal pressure based on
# p = n * R * / (V_cavity / T_cavity + V_add / T_add)
# where
#  p is the pressure
#  n is the amount of material in the volume (moles)
#  R is the universal gas constant
#  T_cavity is the temperature in the cavity
#  T_add is the temperature of the additional volume
#
# The mesh is composed of one block (1) with an interior cavity of volume 8.
#   Block 2 sits in the cavity and has a volume of 1.  Thus, the total
#   initial volume is 7. An additional volume of 2 is added.
#
# The test adjusts n, T, and V in the following way:
#   n =&gt; n0 + alpha * t
#   T =&gt; T0 + beta * t
#   V =&gt; V_cavity0 + gamma * t + V_add
# with
#   alpha = n0
#   beta = T0 / 2
#   gamma = -(0.003322259...) * V0
#   T0 = 240.54443866068704
#   V_cavity0 = 7
#   V_add = 2
#   T_add = 100
#   n0 = f(p0)
#   p0 = 100
#   R = 8.314472 J * K^(-1) * mol^(-1)
#
#  An additional volume of 2 with a temperature of 100.0 is included.
#
# So, n0 = p0 * (V_cavity / T_cavity + V_add / T_add) / R
#        = 100 * (7 / 240.544439 + 2 / 100) / 8.314472
#        = 0.59054
#
# The parameters combined at t = 1 gives p = 249.647.
#
# This test sets the initial temperature to 500, but the CavityPressure
#   is told that that initial temperature is T0.  Thus, the final solution
#   is unchanged.

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Mesh]
  file = 3d.e
[]

[GlobalParams]
  volumetric_locking_correction = true
[]

[Functions]
  [./displ_positive]
    type = PiecewiseLinear
    x = &#x27;0 1&#x27;
    y = &#x27;0 0.0029069767441859684&#x27;
  [../]
  [./displ_negative]
    type = PiecewiseLinear
    x = &#x27;0 1&#x27;
    y = &#x27;0 -0.0029069767441859684&#x27;
  [../]
  [./temp1]
    type = PiecewiseLinear
    x = &#x27;0 1&#x27;
    y = &#x27;1 1.5&#x27;
    scale_factor = 240.54443866068704
  [../]
  [./material_input_function]
    type = PiecewiseLinear
    x = &#x27;0    1&#x27;
    y = &#x27;0 0.59054&#x27;
  [../]
  [./additional_volume]
    type = ConstantFunction
    value = 2
  [../]
  [./temperature_of_additional_volume]
    type = ConstantFunction
    value = 100
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./temp]
    initial_condition = 500
  [../]
  [./material_input]
  [../]
[]

[AuxVariables]
  [./pressure_residual_x]
  [../]
  [./pressure_residual_y]
  [../]
  [./pressure_residual_z]
  [../]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zx]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[Kernels]
  [./TensorMechanics]
    use_displaced_mesh = true
    use_automatic_differentiation = true
  [../]
  [./heat]
    type = ADDiffusion
    variable = temp
    use_displaced_mesh = true
  [../]
  [./material_input_dummy]
    type = ADDiffusion
    variable = material_input
    use_displaced_mesh = true
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = ADRankTwoAux
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
    variable = stress_xx
  [../]
  [./stress_yy]
    type = ADRankTwoAux
    rank_two_tensor = stress
    index_i = 1
    index_j = 1
    variable = stress_yy
  [../]
  [./stress_zz]
    type = ADRankTwoAux
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    variable = stress_zz
  [../]
  [./stress_xy]
    type = ADRankTwoAux
    rank_two_tensor = stress
    index_i = 0
    index_j = 1
    variable = stress_xy
  [../]
  [./stress_yz]
    type = ADRankTwoAux
    rank_two_tensor = stress
    index_i = 1
    index_j = 2
    variable = stress_yz
  [../]
  [./stress_zx]
    type = ADRankTwoAux
    rank_two_tensor = stress
    index_i = 2
    index_j = 0
    variable = stress_zx
  [../]
[]

[BCs]
  [./no_x_exterior]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;7 8&#x27;
    value = 0.0
  [../]
  [./no_y_exterior]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;9 10&#x27;
    value = 0.0
  [../]
  [./no_z_exterior]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;11 12&#x27;
    value = 0.0
  [../]
  [./prescribed_left]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = 13
    function = displ_positive
  [../]
  [./prescribed_right]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = 14
    function = displ_negative
  [../]
  [./no_y]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;15 16&#x27;
    value = 0.0
  [../]
  [./no_z]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;17 18&#x27;
    value = 0.0
  [../]
  [./no_x_interior]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;1 2&#x27;
    value = 0.0
  [../]
  [./no_y_interior]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;3 4&#x27;
    value = 0.0
  [../]
  [./no_z_interior]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;5 6&#x27;
    value = 0.0
  [../]
  [./temperatureInterior]
    type = ADFunctionDirichletBC
    boundary = 100
    function = temp1
    variable = temp
  [../]
  [./MaterialInput]
    type = ADFunctionDirichletBC
    boundary = &#x27;100 13 14 15 16&#x27;
    function = material_input_function
    variable = material_input
  [../]
  [./CavityPressure]
    [./1]
      boundary = 100
      initial_pressure = 100
      material_input = materialInput
      R = 8.314472
      temperature = aveTempInterior
      initial_temperature = 240.54443866068704
      volume = internalVolume
      startup_time = 0.5
      output = ppress
      save_in = &#x27;pressure_residual_x pressure_residual_y pressure_residual_z&#x27;
      additional_volumes = volume1
      temperature_of_additional_volumes = temperature1
      use_automatic_differentiation = true
    [../]
  [../]
[]

[Materials]
  [./elast_tensor1]
    type = ADComputeElasticityTensor
    C_ijkl = &#x27;0 5&#x27;
    fill_method = symmetric_isotropic
    block = 1
  [../]
  [./strain1]
    type = ADComputeFiniteStrain
    block = 1
  [../]
  [./stress1]
    type = ADComputeFiniteStrainElasticStress
    block = 1
  [../]
  [./elast_tensor2]
    type = ADComputeElasticityTensor
    C_ijkl = &#x27;0 5&#x27;
    fill_method = symmetric_isotropic
    block = 2
  [../]
  [./strain2]
    type = ADComputeFiniteStrain
    block = 2
  [../]
  [./stress2]
    type = ADComputeFiniteStrainElasticStress
    block = 2
  [../]
[]

[Executioner]
  type = Transient

  solve_type = &#x27;NEWTON&#x27;

  petsc_options_iname = &#x27;-pc_type -sub_pc_type&#x27;
  petsc_options_value = &#x27;asm       lu&#x27;

  nl_rel_tol = 1e-12
  l_tol = 1e-12

  l_max_its = 20

  dt = 0.5
  end_time = 1.0
[]

[Postprocessors]
  [./internalVolume]
    type = InternalVolume
    boundary = 100
    execute_on = &#x27;initial linear&#x27;
  [../]
  [./aveTempInterior]
    type = SideAverageValue
    boundary = 100
    variable = temp
    execute_on = &#x27;initial linear&#x27;
  [../]
  [./materialInput]
    type = SideAverageValue
    boundary = &#x27;7 8 9 10 11 12&#x27;
    variable = material_input
    execute_on = linear
  [../]
  [./volume1]
    type = FunctionValuePostprocessor
    function = additional_volume
    execute_on = &#x27;initial linear&#x27;
  [../]
  [./temperature1]
    type = FunctionValuePostprocessor
    function = temperature_of_additional_volume
    execute_on = &#x27;initial linear&#x27;
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="dbc672eb-0b93-43c1-bbbd-333d95beb617"><div class="modal-content"><h4>test/tests/controls/syntax_based_naming_access/object_param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;*/test_object/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f2063a9a-b124-4286-9d2a-472928404537"><div class="modal-content"><h4>modules/richards/test/tests/sinks/s02.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.5
    al = 1 # same deal with PETSc constant state
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = initial_pressure
    [../]
  [../]
[]

[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 2
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((mi-lfout-rfout-mf)/2/(mi+mf))
    vars = &#x27;mi mf lfout rfout&#x27;
    vals = &#x27;mass_init mass_fin left_flux_out right_flux_out&#x27;
  [../]
[]

[Postprocessors]
  [./mass_init]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]
  [./mass_fin]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]
  [./left_flux_out]
    type = RichardsHalfGaussianSinkFlux
    boundary = left
    variable = pressure
    centre = 1
    max = 2
    sd = 1
  [../]
  [./right_flux_out]
    type = RichardsHalfGaussianSinkFlux
    boundary = right
    variable = pressure
    centre = 1
    max = 2
    sd = 1
  [../]
  [./p0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
  [./mass_bal]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
  [../]
[]

[BCs]
  [./left_flux]
    type = RichardsHalfGaussianSink
    boundary = left
    variable = pressure
    centre = 1
    max = 2
    sd = 1
  [../]
  [./right_flux]
    type = RichardsHalfGaussianSink
    boundary = right
    variable = pressure
    centre = 1
    max = 2
    sd = 1
  [../]
[]

[Kernels]
  active = &#x27;richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 4E-3
  end_time = 0.4
[]

[Outputs]
  file_base = s02
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="61901f19-7edf-439d-a40d-bf346d1a8d21"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/pp_generation_unconfined_fully_saturated_volume.i</h4><pre class="moose-pre"><code class="language-text"># A sample is constrained on all sides, except its top
# and its boundaries are
# also impermeable.  Fluid is pumped into the sample via a
# volumetric source (ie m^3/second per cubic meter), and the
# rise in the top surface, porepressure, and stress are observed.
#
# In the standard poromechanics scenario, the Biot Modulus is held
# fixed and the source has units 1/s.  Then the expected result
# is
# strain_zz = disp_z = BiotCoefficient*BiotModulus*s*t/((bulk + 4*shear/3) + BiotCoefficient^2*BiotModulus)
# porepressure = BiotModulus*(s*t - BiotCoefficient*strain_zz)
# stress_xx = (bulk - 2*shear/3)*strain_zz   (remember this is effective stress)
# stress_zz = (bulk + 4*shear/3)*strain_zz   (remember this is effective stress)
#
# In standard porous_flow, everything is based on mass, eg the source has
# units kg/s/m^3.  This is discussed in the other pp_generation_unconfined
# models.  In this test, we use the FullySaturated Kernel and set
# multiply_by_density = false
# meaning the fluid Kernel has units of volume, and the source, s, has units 1/time
#
# The ratios are:
# stress_xx/strain_zz = (bulk - 2*shear/3) = 1 (for the parameters used here)
# stress_zz/strain_zz = (bulk + 4*shear/3) = 4 (for the parameters used here)
# porepressure/strain_zz = 13.3333333 (for the parameters used here)
#
# Expect
# disp_z = 0.3*10*s*t/((2 + 4*1.5/3) + 0.3^2*10) = 0.612245*s*t
# porepressure = 10*(s*t - 0.3*0.612245*s*t) = 8.163265*s*t
# stress_xx = (2 - 2*1.5/3)*0.612245*s*t = 0.612245*s*t
# stress_zz = (2 + 4*shear/3)*0.612245*s*t = 2.44898*s*t
#
# Finally, note that the volumetric strain has
# consistent_with_displaced_mesh = false
# which is needed when using the FullySaturated version of the Kernels
# in order to generate the above results

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back&#x27;
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    component = 2
    variable = disp_z
  [../]
  [./mass0]
    type = PorousFlowFullySaturatedMassTimeDerivative
    variable = porepressure
    multiply_by_density = false
    coupling_type = HydroMechanical
    biot_coefficient = 0.3
  [../]
  [./source]
    type = BodyForce
    function = 0.1
    variable = porepressure
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 3.3333333333
      density0 = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature_qp]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
    consistent_with_displaced_mesh = false
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = porepressure
  [../]
  [./simple_fluid_qp]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # the &quot;const&quot; is irrelevant here: all that uses Porosity is the BiotModulus, which just uses the initial value of porosity
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.3
    fluid_bulk_modulus = 3.3333333333
    solid_bulk_compliance = 0.5
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0.5&#x27;
    variable = disp_z
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./stress_xx_over_strain]
    type = FunctionValuePostprocessor
    function = stress_xx_over_strain_fcn
    outputs = csv
  [../]
  [./stress_zz_over_strain]
    type = FunctionValuePostprocessor
    function = stress_zz_over_strain_fcn
    outputs = csv
  [../]
  [./p_over_strain]
    type = FunctionValuePostprocessor
    function = p_over_strain_fcn
    outputs = csv
  [../]
[]

[Functions]
  [./stress_xx_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;stress_xx zdisp&#x27;
  [../]
  [./stress_zz_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;stress_zz zdisp&#x27;
  [../]
  [./p_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;p0 zdisp&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  dt = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = pp_generation_unconfined_fully_saturated_volume
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3d34048d-2738-4196-916c-bd167c9719b5"><div class="modal-content"><h4>modules/combined/examples/stochastic/graphite_ring_thermomechanics.i</h4><pre class="moose-pre"><code class="language-text"># Generate 1/4 of a 2-ring disk and extrude it by half to obtain
# 1/8 of a 3D tube.  Mirror boundary conditions will exist on the
# cut portions.

[Mesh]
  [disk]
    type = ConcentricCircleMeshGenerator
    num_sectors = 10
    radii = &#x27;1.0 1.1 1.2&#x27;
    rings = &#x27;1 1 1&#x27;
    has_outer_square = false
    preserve_volumes = false
    portion = top_right
  []
  [ring]
    type = BlockDeletionGenerator
    input = disk
    block_id = 1
    new_boundary = &#x27;inner&#x27;
  []
  [cylinder]
    type = MeshExtruderGenerator
    input = ring
    extrusion_vector = &#x27;0 0 1.5&#x27;
    num_layers = 15
    bottom_sideset = &#x27;back&#x27;
    top_sideset = &#x27;front&#x27;
  []
[]

[Variables]
  [T]
    initial_condition = 300
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[Kernels]
  [hc]
    type = HeatConduction
    variable = T
  []
  [TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  []
[]

[BCs]
  [temp_inner]
    type = FunctionNeumannBC
    variable = T
    boundary = &#x27;inner&#x27;
    function = surface_source
  []
  [temp_front]
    type = ConvectiveHeatFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    T_infinity = 300
    heat_transfer_coefficient = 10
  []
  [temp_outer]
    type = ConvectiveHeatFluxBC
    variable = T
    boundary = &#x27;outer&#x27;
    T_infinity = 300
    heat_transfer_coefficient = 10
  []
  # mirror boundary conditions.
  [disp_x]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;left&#x27;
    value = 0.0
  []
  [disp_y]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;bottom&#x27;
    value = 0.0
  []
  [disp_z]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0.0
  []
[]

[Materials]
  [cond_inner]
    type = GenericConstantMaterial
    block = 2
    prop_names = thermal_conductivity
    prop_values = 25
  []
  [cond_outer]
    type = GenericConstantMaterial
    block = 3
    prop_names = thermal_conductivity
    prop_values = 100
  []
  [elasticity_tensor_inner]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
    block = 2
  []
  [elasticity_tensor_outer]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 3.1e5
    poissons_ratio = 0.2
    block = 3
  []
  [thermal_strain_inner]
    type = ComputeThermalExpansionEigenstrain
    thermal_expansion_coeff = 2e-6
    temperature = T
    stress_free_temperature = 300
    eigenstrain_name = eigenstrain_inner
    block = 2
  []
  [thermal_strain_outer]
    type = ComputeThermalExpansionEigenstrain
    thermal_expansion_coeff = 1e-6
    temperature = T
    stress_free_temperature = 300
    eigenstrain_name = eigenstrain_outer
    block = 3
  []
  [strain_inner] #We use small deformation mechanics
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    eigenstrain_names = &#x27;eigenstrain_inner&#x27;
    block = 2
  []
  [strain_outer] #We use small deformation mechanics
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    eigenstrain_names = &#x27;eigenstrain_outer&#x27;
    block = 3
  []
  [stress] #We use linear elasticity
    type = ComputeLinearElasticStress
  []
[]

[Functions]
  [surface_source]
    type = ParsedFunction
    value = &#x27;Q_t*pi/2.0/3.0 * cos(pi/3.0*z)&#x27;
    vars = &#x27;Q_t&#x27;
    vals = heat_source
  []
[]

[Executioner]
  type = Steady

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;hypre boomeramg 101&#x27;

  l_max_its = 30
  nl_max_its = 100
  nl_abs_tol = 1e-9
  l_tol = 1e-04
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
  []
[]

[Controls]
  [stochastic]
    type = SamplerReceiver
  []
[]

[VectorPostprocessors]
  [temp_center]
    type = LineValueSampler
    variable = T
    start_point = &#x27;1 0 0&#x27;
    end_point = &#x27;1.2 0 0&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [temp_end]
    type = LineValueSampler
    variable = T
    start_point = &#x27;1 0 1.5&#x27;
    end_point = &#x27;1.2 0 1.5&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [dispx_center]
    type = LineValueSampler
    variable = disp_x
    start_point = &#x27;1 0 0&#x27;
    end_point = &#x27;1.2 0 0&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [dispx_end]
    type = LineValueSampler
    variable = disp_x
    start_point = &#x27;1 0 1.5&#x27;
    end_point = &#x27;1.2 0 1.5&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [dispz_end]
    type = LineValueSampler
    variable = disp_z
    start_point = &#x27;1 0 1.5&#x27;
    end_point = &#x27;1.2 0 1.5&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
[]

[Postprocessors]
  [heat_source]
    type = FunctionValuePostprocessor
    function = 1
    scale_factor = 10000
    execute_on = linear
  []
  [temp_center_inner]
    type = PointValue
    variable = T
    point = &#x27;1 0 0&#x27;
  []
  [temp_center_outer]
    type = PointValue
    variable = T
    point = &#x27;1.2 0 0&#x27;
  []
  [temp_end_inner]
    type = PointValue
    variable = T
    point = &#x27;1 0 1.5&#x27;
  []
  [temp_end_outer]
    type = PointValue
    variable = T
    point = &#x27;1.2 0 1.5&#x27;
  []
  [dispx_center_inner]
    type = PointValue
    variable = disp_x
    point = &#x27;1 0 0&#x27;
  []
  [dispx_center_outer]
    type = PointValue
    variable = disp_x
    point = &#x27;1.2 0 0&#x27;
  []
  [dispx_end_inner]
    type = PointValue
    variable = disp_x
    point = &#x27;1 0 1.5&#x27;
  []
  [dispx_end_outer]
    type = PointValue
    variable = disp_x
    point = &#x27;1.2 0 1.5&#x27;
  []
  [dispz_inner]
    type = PointValue
    variable = disp_z
    point = &#x27;1 0 1.5&#x27;
  []
  [dispz_outer]
    type = PointValue
    variable = disp_z
    point = &#x27;1.2 0 1.5&#x27;
  []
[]

[Outputs]
  exodus = false
  csv = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="96493817-b812-4d6a-a09c-e5c4eb304e1a"><div class="modal-content"><h4>test/tests/functions/vector_postprocessor_function/vector_postprocessor_function.i</h4><pre class="moose-pre"><code class="language-text">#This function linearly interpolates the data generated by a vector post
#processor. The purpose is to have a function take points and a field variable
#(aux or primary) as arguments.
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 4
  xmin = 0.0
  xmax = 0.004
  ymin = 0.0
  ymax = 0.008
[]

[Variables]
  [./u]
    initial_condition = 0
  [../]
[]

[AuxVariables]
  [./v]
    initial_condition = 1
  [../]
[]

[Functions]
  [./ramp_u]
    type = ParsedFunction
    value = &#x27;t&#x27;
  [../]
  [./point_value_function_u]
    type = VectorPostprocessorFunction
    component = y
    argument_column = y
    value_column = u
    vectorpostprocessor_name = point_value_vector_postprocessor_u
  [../]
  [./line_value_function_v]
    type = VectorPostprocessorFunction
    component = y
    argument_column = y
    value_column = v
    vectorpostprocessor_name = line_value_vector_postprocessor_v
  [../]
  [./function_v]
    type = PiecewiseLinear
    x = &#x27;0 0.008&#x27;
    y = &#x27;1 2&#x27;
    axis = y
  [../]
[]

[Kernels]
  [./diffusion_u]
    type = Diffusion
    variable = u
  [../]
[]

[AuxKernels]
[./aux_v]
  type = FunctionAux
  variable = v
  function = function_v
[../]
[]

[BCs]
  [./top_u]
    type = FunctionDirichletBC
    boundary = top
    variable = u
    function = ramp_u
  [../]
  [./bottom_u]
    type = DirichletBC
    boundary = bottom
    variable = u
    value = 0
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;
  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; lu       superlu_dist                 51&#x27;
  line_search = &#x27;none&#x27;
  l_max_its = 50
  l_tol = 1e-3
  nl_max_its = 20
  nl_rel_tol = 1e-4
  nl_abs_tol = 1e-6
  start_time = 0
  num_steps = 1
  dt = 1
[]
[Postprocessors]
  [./point_value_postprocessor_u]
    type = FunctionValuePostprocessor
    function = point_value_function_u
    point = &#x27;0.002 0.004 0&#x27;
  [../]
  [./line_value_postprocessor_v]
    type = FunctionValuePostprocessor
    function = line_value_function_v
    point = &#x27;0.002 0.004 0&#x27;
  [../]
  [./postprocessor_average_u]
    type = ElementAverageValue
    variable = u
  [../]
  [./postprocessor_average_v]
    type = ElementAverageValue
    variable = v
  [../]
[]
[VectorPostprocessors]
  [./point_value_vector_postprocessor_u]
    type = PointValueSampler
    variable = u
    points = &#x27;0 0.001 0 0 0.004 0 0 0.008 0&#x27;
    #points = &#x27;0.001 0 0 0.002 0 0&#x27;
    sort_by = y
    execute_on = linear
  [../]
  [./line_value_vector_postprocessor_v]
    type = LineValueSampler
    variable = v
    start_point = &#x27;0 0.001 0&#x27;
    end_point = &#x27;0 0.008 0&#x27;
    num_points = 5
    sort_by = y
    execute_on = linear
  [../]
[]
[Outputs]
  interval = 1
  csv = false
  exodus = true
  file_base = out
  [./console]
    type = Console
    output_linear = true
    max_rows = 10
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7db93e65-4617-40e7-9ca8-2fde2730f46f"><div class="modal-content"><h4>modules/richards/test/tests/dirac/st01.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./stream_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./stream]
    type = RichardsPolyLineSink
    pressures = &#x27;0.2E7 0.8E7&#x27;
    fluxes = &#x27;1 2&#x27;
    point_file = st01.stream
    SumQuantityUO = stream_total_outflow_mass
    variable = pressure
  [../]
[]


[Postprocessors]
  [./stream_report]
    type = RichardsPlotQuantity
    uo = stream_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
 active = &#x27;mass_bal_fcn initial_pressure&#x27;

  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 stream_report&#x27;
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 2.5
  dt = 0.1
  solve_type = NEWTON

[]

[Outputs]
  file_base = st01
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="54c7ad3e-cf98-4dd6-8949-0e3789a1e4b8"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s05.i</h4><pre class="moose-pre"><code class="language-text"># apply a half-gaussian sink flux and observe the correct behavior
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  zmin = 0
  zmax = 2
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1.1
  [../]
[]

[Variables]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = y+1.4
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.3
      density0 = 1.1
      thermal_expansion = 0
      viscosity = 1.1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-5 0 0 0 1E-5 0 0 0 1E-5&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[AuxVariables]
  [./flux_out]
  [../]
[]

[Functions]
  [./mass10]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)*if(pp&gt;=0,1,pow(1+pow(-al*pp,1.0/(1-m)),-m))&#x27;
    vars = &#x27;vol por dens0 pp bulk al m&#x27;
    vals = &#x27;0.25 0.1 1.1 p10 1.3 1.1 0.5&#x27;
  [../]
  [./rate10]
    type = ParsedFunction
    value = &#x27;if(pp&gt;center,fcn,fcn*exp(-0.5*(pp-center)*(pp-center)/sd/sd))&#x27;
    vars = &#x27;fcn pp  center sd&#x27;
    vals = &#x27;6   p10 0.9    0.5&#x27;
  [../]
  [./mass10_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-rate*area*dt&#x27;
    vars = &#x27;mass_prev rate     area dt&#x27;
    vals = &#x27;m10_prev  m10_rate 0.5 2E-3&#x27;
  [../]
  [./mass11]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)*if(pp&gt;=0,1,pow(1+pow(-al*pp,1.0/(1-m)),-m))&#x27;
    vars = &#x27;vol por dens0 pp bulk al m&#x27;
    vals = &#x27;0.25 0.1 1.1 p11 1.3 1.1 0.5&#x27;
  [../]
  [./rate11]
    type = ParsedFunction
    value = &#x27;if(pp&gt;center,fcn,fcn*exp(-0.5*(pp-center)*(pp-center)/sd/sd))&#x27;
    vars = &#x27;fcn pp  center sd&#x27;
    vals = &#x27;6   p11 0.9    0.5&#x27;
  [../]
  [./mass11_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-rate*area*dt&#x27;
    vars = &#x27;mass_prev rate     area dt&#x27;
    vals = &#x27;m11_prev  m11_rate 0.5 2E-3&#x27;
  [../]
[]

[Postprocessors]
  [./flux10]
    type = PointValue
    variable = flux_out
    point = &#x27;1 0 0&#x27;
  [../]
  [./p00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p10]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m10]
    type = FunctionValuePostprocessor
    function = mass10
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m10_prev]
    type = FunctionValuePostprocessor
    function = mass10
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m10_rate]
    type = FunctionValuePostprocessor
    function = rate10
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./m10_expect]
    type = FunctionValuePostprocessor
    function = mass10_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./p01]
    type = PointValue
    point = &#x27;0 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p11]
    type = PointValue
    point = &#x27;1 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m11]
    type = FunctionValuePostprocessor
    function = mass11
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m11_prev]
    type = FunctionValuePostprocessor
    function = mass11
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m11_rate]
    type = FunctionValuePostprocessor
    function = rate11
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./m11_expect]
    type = FunctionValuePostprocessor
    function = mass11_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[BCs]
  [./flux]
    type = PorousFlowHalfGaussianSink
    boundary = &#x27;right&#x27;
    max = 6
    sd = 0.5
    center = 0.9
    variable = pp
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 1
    save_in = flux_out
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 10000 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 2E-3
  end_time = 6E-2
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[Outputs]
  file_base = s05
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
    interval = 5
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;timestep_end&#x27;
    interval = 3
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c1ff8e67-037c-47de-a152-1a32db2c3d46"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s03.i</h4><pre class="moose-pre"><code class="language-text"># apply a sink flux with use_relperm=true and observe the correct behavior
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  zmin = 0
  zmax = 2
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1.1
  [../]
[]

[Variables]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = -y
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.3
      density0 = 1.1
      thermal_expansion = 0
      viscosity = 1.1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.2 0 0 0 0.1 0 0 0 0.1&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[AuxVariables]
  [./flux_out]
  [../]
  [./xval]
  [../]
  [./yval]
  [../]
[]

[ICs]
  [./xval]
    type = FunctionIC
    variable = xval
    function = x
  [../]
  [./yval]
    type = FunctionIC
    variable = yval
    function = y
  [../]
[]

[Functions]
  [./mass00]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)*pow(1+pow(-al*pp,1.0/(1-m)),-m)&#x27;
    vars = &#x27;vol por dens0 pp bulk al m&#x27;
    vals = &#x27;0.25 0.1 1.1 p00 1.3 1.1 0.5&#x27;
  [../]
  [./sat00]
    type = ParsedFunction
    value = &#x27;pow(1+pow(-al*pp,1.0/(1-m)),-m)&#x27;
    vars = &#x27;pp al m&#x27;
    vals = &#x27;p00 1.1 0.5&#x27;
  [../]
  [./mass01]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)*pow(1+pow(-al*pp,1.0/(1-m)),-m)&#x27;
    vars = &#x27;vol por dens0 pp bulk al m&#x27;
    vals = &#x27;0.25 0.1 1.1 p01 1.3 1.1 0.5&#x27;
  [../]
  [./expected_mass_change00]
    type = ParsedFunction
    value = &#x27;fcn*pow(pow(1+pow(-al*pp,1.0/(1-m)),-m),2)*area*dt&#x27;
    vars = &#x27;fcn perm dens0 pp bulk visc area dt   al  m&#x27;
    vals = &#x27;6   0.2  1.1  p00 1.3  1.1  0.5  1E-3 1.1 0.5&#x27;
  [../]
  [./expected_mass_change01]
    type = ParsedFunction
    value = &#x27;fcn*pow(pow(1+pow(-al*pp,1.0/(1-m)),-m),2)*area*dt&#x27;
    vars = &#x27;fcn perm dens0 pp bulk visc area dt   al  m&#x27;
    vals = &#x27;6   0.2  1.1  p01 1.3  1.1  0.5  1E-3 1.1 0.5&#x27;
  [../]
  [./mass00_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-mass_change&#x27;
    vars = &#x27;mass_prev mass_change&#x27;
    vals = &#x27;m00_prev  del_m00&#x27;
  [../]
  [./mass01_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-mass_change&#x27;
    vars = &#x27;mass_prev mass_change&#x27;
    vals = &#x27;m01_prev  del_m01&#x27;
  [../]
  [./sat01]
    type = ParsedFunction
    value = &#x27;pow(1+pow(-al*pp,1.0/(1-m)),-m)&#x27;
    vars = &#x27;pp al m&#x27;
    vals = &#x27;p01 1.1 0.5&#x27;
  [../]
  [./expected_mass_change_rate]
    type = ParsedFunction
    value = &#x27;fcn*pow(pow(1+pow(-al*pp,1.0/(1-m)),-m),2)*area&#x27;
    vars = &#x27;fcn perm dens0 pp bulk visc area dt   al  m&#x27;
    vals = &#x27;6   0.2  1.1  p00 1.3  1.1  0.5  1E-3 1.1 0.5&#x27;
  [../]
[]

[Postprocessors]
  [./p00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m00]
    type = FunctionValuePostprocessor
    function = mass00
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m00_prev]
    type = FunctionValuePostprocessor
    function = mass00
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./del_m00]
    type = FunctionValuePostprocessor
    function = expected_mass_change00
    execute_on = &#x27;timestep_end&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m00_expect]
    type = FunctionValuePostprocessor
    function = mass00_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./p10]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p01]
    type = PointValue
    point = &#x27;0 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m01]
    type = FunctionValuePostprocessor
    function = mass01
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m01_prev]
    type = FunctionValuePostprocessor
    function = mass01
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./del_m01]
    type = FunctionValuePostprocessor
    function = expected_mass_change01
    execute_on = &#x27;timestep_end&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m01_expect]
    type = FunctionValuePostprocessor
    function = mass01_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./p11]
    type = PointValue
    point = &#x27;1 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./s00]
    type = FunctionValuePostprocessor
    function = sat00
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./mass00_rate]
    type = FunctionValuePostprocessor
    function = expected_mass_change_rate
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[BCs]
  [./flux]
    type = PorousFlowSink
    boundary = &#x27;left&#x27;
    variable = pp
    use_mobility = false
    use_relperm = true
    fluid_phase = 0
    flux_function = 6
    save_in = flux_out
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 10 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E-3
  end_time = 0.018
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[Outputs]
  file_base = s03
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
    interval = 5
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;timestep_end&#x27;
    interval = 2
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ce78c6a0-dbdf-4fee-a176-2ec7802f171a"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_lumped_07.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = true
# transient = true
# lumped = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 0.5E-3&#x27;
  gravity = &#x27;0 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.2
    max = 0.8
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.2
    max = 1.8
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_lumped_07
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="961a8008-dd02-447f-b90a-1544f5adeffa"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except01.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 1
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="15458957-9030-4c56-b413-391cc96c8d25"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# injection
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;500 500 1E1&#x27;
    x = &#x27;4000 5000 6500&#x27;
  [../]
[]

[Variables]
  [./pp]
    initial_condition = -2E5
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityFLAC
    m = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    variable = pp
    SumQuantityUO = borehole_total_outflow_mass
    point_file = bh03.bh
    fluid_phase = 0
    bottom_p_or_t = 0
    unit_weight = &#x27;0 0 0&#x27;
    use_mobility = true
    character = -1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 6500
  solve_type = NEWTON
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bh05
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f4fcf122-59cf-49b2-9973-df4e860c90b5"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/multi/rock1.i</h4><pre class="moose-pre"><code class="language-text"># Plasticity models:
# Mohr-Coulomb with cohesion = 40MPa, friction angle = 35deg, dilation angle = 10deg
# Tensile with strength = 1MPa
# WeakPlaneShear with cohesion = 1MPa, friction angle = 25deg, dilation angle = 25deg
# WeakPlaneTensile with strength = 0.01MPa
#
# Lame lambda = 1GPa.  Lame mu = 1.3GPa
#
# A line of elements is perturbed randomly, and return to the yield surface at each quadpoint is checked

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 1234
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 1234
  zmin = 0
  zmax = 1
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f3]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int3]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./f0]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = f0
  [../]
  [./f1]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 1
    variable = f1
  [../]
  [./f2]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 2
    variable = f2
  [../]
  [./f3]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 3
    variable = f3
  [../]
  [./int0]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    factor = 1E6
    index = 0
    variable = int0
  [../]
  [./int1]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    factor = 1E6
    index = 1
    variable = int1
  [../]
  [./int2]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    factor = 1E6
    index = 2
    variable = int2
  [../]
  [./int3]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    factor = 1E6
    index = 3
    variable = int3
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./raw_f0]
    type = ElementExtremeValue
    variable = f0
    outputs = console
  [../]
  [./raw_f1]
    type = ElementExtremeValue
    variable = f1
    outputs = console
  [../]
  [./raw_f2]
    type = ElementExtremeValue
    variable = f2
    outputs = console
  [../]
  [./raw_f3]
    type = ElementExtremeValue
    variable = f3
    outputs = console
  [../]
  [./iter]
    type = ElementExtremeValue
    variable = iter
    outputs = console
  [../]
  [./f0]
    type = FunctionValuePostprocessor
    function = should_be_zero0_fcn
  [../]
  [./f1]
    type = FunctionValuePostprocessor
    function = should_be_zero1_fcn
  [../]
  [./f2]
    type = FunctionValuePostprocessor
    function = should_be_zero2_fcn
  [../]
  [./f3]
    type = FunctionValuePostprocessor
    function = should_be_zero3_fcn
  [../]
[]

[Functions]
  [./should_be_zero0_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f0&#x27;
  [../]
  [./should_be_zero1_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f1&#x27;
  [../]
  [./should_be_zero2_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f2&#x27;
  [../]
  [./should_be_zero3_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f3&#x27;
  [../]
[]

[UserObjects]
  [./mc_coh]
    type = TensorMechanicsHardeningConstant
    value = 4E7
  [../]
  [./mc_phi]
    type = TensorMechanicsHardeningConstant
    value = 35
    convert_to_radians = true
  [../]
  [./mc_psi]
    type = TensorMechanicsHardeningConstant
    value = 10
    convert_to_radians = true
  [../]
  [./mc]
    type = TensorMechanicsPlasticMohrCoulomb
    cohesion = mc_coh
    friction_angle = mc_phi
    dilation_angle = mc_psi
    mc_tip_smoother = 4E6
    yield_function_tolerance = 1.0E-1
    internal_constraint_tolerance = 1.0E-7
  [../]

  [./ts]
    type = TensorMechanicsHardeningConstant
    value = 1E6
  [../]
  [./tensile]
    type = TensorMechanicsPlasticTensile
    tensile_strength = ts
    tensile_tip_smoother = 1E5
    yield_function_tolerance = 1.0E-1
    internal_constraint_tolerance = 1.0E-7
  [../]
  [./coh]
    type = TensorMechanicsHardeningConstant
    value = 1E6
  [../]
  [./tanphi]
    type = TensorMechanicsHardeningConstant
    value = 0.46630766
  [../]
  [./tanpsi]
    type = TensorMechanicsHardeningConstant
    value = 0.46630766
  [../]
  [./wps]
    type = TensorMechanicsPlasticWeakPlaneShear
    cohesion = coh
    tan_friction_angle = tanphi
    tan_dilation_angle = tanpsi
    smoother = 1E5
    yield_function_tolerance = 1.0E-1
    internal_constraint_tolerance = 1.0E-7
  [../]
  [./str]
    type = TensorMechanicsHardeningConstant
    value = 0.01E6
  [../]
  [./wpt]
    type = TensorMechanicsPlasticWeakPlaneTensile
    tensile_strength = str
    yield_function_tolerance = 1.0E-1
    internal_constraint_tolerance = 1.0E-7
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;1E9 1.3E9&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./multi]
    type = ComputeMultiPlasticityStress
    block = 0
    ep_plastic_tolerance = 1E-7
    plastic_models = &#x27;mc tensile wps wpt&#x27;
    deactivation_scheme = &#x27;optimized_to_safe_to_dumb&#x27;
    max_NR_iterations = 20
    min_stepsize = 1E-4
    max_stepsize_for_dumb = 1E-3
    debug_fspb = crash
    debug_jac_at_stress = &#x27;10 0 0 0 10 0 0 0 10&#x27;
    debug_jac_at_pm = &#x27;1 1 1 1&#x27;
    debug_jac_at_intnl = &#x27;1 1 1 1&#x27;
    debug_stress_change = 1E1
    debug_pm_change = &#x27;1E-6 1E-6 1E-6 1E-6&#x27;
    debug_intnl_change = &#x27;1E-6 1E-6 1E-6 1E-6&#x27;
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = rock1
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="61a9a7f6-c592-4529-a486-23639a2ba0df"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except05.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    mass_fraction_component = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c80581a1-2895-43b0-8ebb-be0141da7bac"><div class="modal-content"><h4>test/tests/controls/output/controllable_clear.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 2
  elem_type = QUAD4
  uniform_refine = 4
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 3
  dt = 0.1
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = u
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Outputs]
  controls = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;*/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1c9c65ce-36a0-4c0e-b0fa-10b34ff75dfa"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except16.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    function_of = temperature
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="bb115f4b-58e7-43b9-b78f-63f4f1dbe228"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except02.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    mass_fraction_component = 1
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="23b3101d-3be0-4bbd-b095-c5ba4d8b06cd"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_bounded_17.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = false
# gravity = true
# supg = true
# transient = true
# using RichardsMultiphaseProblem to bound pgas.  i take big timesteps to illustrate that the bounding works.  Note that s_res for gas = 0, in order to prevent the simulation from trying to reduce pgas at small x in order to conserve fluid mass by decreasing the density.  Because there is zero gas to begin with, but due to numerical inprecisions there is some gas at the end, the mass error for the gas is 0.5.

[Problem]
  type = RichardsMultiphaseProblem
  bounded_var = pgas
  lower_var = pwater
[]

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 0.5E-3&#x27;
  gravity = &#x27;-1 0 0&#x27;
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.1
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.00
    sum_s_res = 0.1
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 0.01
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 1
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]

  # the following &quot;dummy&quot; variable is simply used for exception testing RichardsMultiphaseProblem
  # It is not part of the &quot;gravity head&quot; simulation
  [./dummy_var]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;nonzero&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6
  dt = 1E6
  dtmin = 1E6
  line_search = bt

  nl_rel_tol = 1.e-6
  nl_max_its = 10
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_bounded_17
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5aa2a9ff-3c17-412f-abb1-f5fc0e39dfaa"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/capped_mohr_coulomb/random3.i</h4><pre class="moose-pre"><code class="language-text"># Using CappedMohrCoulomb with Mohr-Coulomb failure only
# Plasticity models:
# Cohesion = 1MPa
# Friction angle = dilation angle = 0.5
#
# Lame lambda = 1GPa.  Lame mu = 1.3GPa
#
# A line of elements is perturbed randomly, and return to the yield surface at each quadpoint is checked

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 1234
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 1234
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Modules/TensorMechanics/Master]
  [./all]
    add_variables = true
    incremental = true
    generate_output = &#x27;stress_xx stress_xy stress_xz stress_yy stress_yz stress_zz&#x27;
  [../]
[]

[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./f0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f3]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f4]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f5]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./f0]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 6
    variable = f0
  [../]
  [./f1]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 7
    variable = f1
  [../]
  [./f2]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 8
    variable = f2
  [../]
  [./f3]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 9
    variable = f3
  [../]
  [./f4]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 10
    variable = f4
  [../]
  [./f5]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 11
    variable = f5
  [../]
  [./int0]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    index = 0
    variable = int0
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./tot_iters]
    type = ElementIntegralMaterialProperty
    mat_prop = plastic_NR_iterations
    outputs = console
  [../]
  [./intnl_max]
    type = ElementExtremeValue
    variable = int0
    outputs = console
  [../]
  [./raw_f0]
    type = ElementExtremeValue
    variable = f0
    outputs = console
  [../]
  [./raw_f1]
    type = ElementExtremeValue
    variable = f1
    outputs = console
  [../]
  [./raw_f2]
    type = ElementExtremeValue
    variable = f2
    outputs = console
  [../]
  [./raw_f3]
    type = ElementExtremeValue
    variable = f3
    outputs = console
  [../]
  [./raw_f4]
    type = ElementExtremeValue
    variable = f4
    outputs = console
  [../]
  [./raw_f5]
    type = ElementExtremeValue
    variable = f5
    outputs = console
  [../]
  [./iter]
    type = ElementExtremeValue
    variable = iter
    outputs = console
  [../]
  [./f0]
    type = FunctionValuePostprocessor
    function = should_be_zero0_fcn
  [../]
  [./f1]
    type = FunctionValuePostprocessor
    function = should_be_zero1_fcn
  [../]
  [./f2]
    type = FunctionValuePostprocessor
    function = should_be_zero2_fcn
  [../]
  [./f3]
    type = FunctionValuePostprocessor
    function = should_be_zero3_fcn
  [../]
  [./f4]
    type = FunctionValuePostprocessor
    function = should_be_zero4_fcn
  [../]
  [./f5]
    type = FunctionValuePostprocessor
    function = should_be_zero5_fcn
  [../]
[]

[Functions]
  [./should_be_zero0_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f0&#x27;
  [../]
  [./should_be_zero1_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f1&#x27;
  [../]
  [./should_be_zero2_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f2&#x27;
  [../]
  [./should_be_zero3_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f3&#x27;
  [../]
  [./should_be_zero4_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f4&#x27;
  [../]
  [./should_be_zero5_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f5&#x27;
  [../]
[]

[UserObjects]
  [./ts]
    type = TensorMechanicsHardeningConstant
    value = 1E12
  [../]
  [./cs]
    type = TensorMechanicsHardeningConstant
    value = 1E12
  [../]
  [./coh]
    type = TensorMechanicsHardeningCubic
    value_0 = 1E6
    value_residual = 0
    internal_limit = 1
  [../]
  [./ang]
    type = TensorMechanicsHardeningCubic
    value_0 = 0.9
    value_residual = 0.2
    internal_limit = 1
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;1E9 1.3E9&#x27;
  [../]
  [./tensile]
    type = CappedMohrCoulombStressUpdate
    tensile_strength = ts
    compressive_strength = cs
    cohesion = coh
    friction_angle = ang
    dilation_angle = ang
    smoothing_tol = 1E5
    max_NR_iterations = 100
    yield_function_tol = 1.0E-1
  [../]
  [./stress]
    type = ComputeMultipleInelasticStress
    inelastic_models = tensile
    perform_finite_strain_rotations = false
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random3
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0aa41d74-0a65-4d12-a477-7a55d0923e79"><div class="modal-content"><h4>test/tests/controls/syntax_based_naming_access/param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;*/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5652c841-b64b-434c-b08e-f261bad67dd9"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = false
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.2
    max = 0.8
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.2
    max = 1.8
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh05
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8462bd99-208b-4de3-8d20-5da1c1b18f6e"><div class="modal-content"><h4>test/tests/controls/syntax_based_naming_access/system_object_param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;DiracKernels/test_object/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="cbb98e39-ce4e-4239-93a9-c9f86af4ba6b"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh_fu_03.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# injection
# fullyupwind
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 1E7
    point_file = bh03.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = -1
    fully_upwind = true
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 0
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON

[]

[Outputs]
  file_base = bh_fu_03
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d85f1dd6-18ec-4269-83c5-8ecc17214313"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/mandel.i</h4><pre class="moose-pre"><code class="language-text"># Mandel&#x27;s problem of consolodation of a drained medium
#
# A sample is in plane strain.
# -a &lt;= x &lt;= a
# -b &lt;= y &lt;= b
# It is squashed with constant force by impermeable, frictionless plattens on its top and bottom surfaces (at y=+/-b)
# Fluid is allowed to leak out from its sides (at x=+/-a)
# The porepressure within the sample is monitored.
#
# As is common in the literature, this is simulated by
# considering the quarter-sample, 0&lt;=x&lt;=a and 0&lt;=y&lt;=b, with
# impermeable, roller BCs at x=0 and y=0 and y=b.
# Porepressure is fixed at zero on x=a.
# Porepressure and displacement are initialised to zero.
# Then the top (y=b) is moved downwards with prescribed velocity,
# so that the total force that is inducing this downwards velocity
# is fixed.  The velocity is worked out by solving Mandel&#x27;s problem
# analytically, and the total force is monitored in the simulation
# to check that it indeed remains constant.
#
# Here are the problem&#x27;s parameters, and their values:
# Soil width.  a = 1
# Soil height.  b = 0.1
# Soil&#x27;s Lame lambda.  la = 0.5
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = G = 0.75
# Soil bulk modulus.  K = la + 2*mu/3 = 1
# Drained Poisson ratio.  nu = (3K - 2G)/(6K + 2G) = 0.2
# Soil bulk compliance.  1/K = 1
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Biot modulus.  M = 1/(phi0/Kf + (alpha - phi0)(1 - alpha)/K) = 4.705882
# Undrained bulk modulus. Ku = K + alpha^2*M = 2.694118
# Undrained Poisson ratio.  nuu = (3Ku - 2G)/(6Ku + 2G) = 0.372627
# Skempton coefficient.  B = alpha*M/Ku = 1.048035
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Consolidation coefficient.  c = 2*k*B^2*G*(1-nu)*(1+nuu)^2/9/(1-nuu)/(nuu-nu) = 3.821656
# Normal stress on top.  F = 1
#
# The solution for porepressure and displacements is given in
# AHD Cheng and E Detournay &quot;A direct boundary element method for plane strain poroelasticity&quot; International Journal of Numerical and Analytical Methods in Geomechanics 12 (1988) 551-572.
# The solution involves complicated infinite series, so I shall not write it here
#
# FINAL NOTE: The above solution assumes constant Biot Modulus.
# In porous_flow this is not true.  Therefore the solution is
# a little different than in the paper.  This test was therefore
# validated against MOOSE&#x27;s poromechanics, which can choose either
# a constant Biot Modulus (which has been shown to agree with
# the analytic solution), or a non-constant Biot Modulus (which
# gives the same results as porous_flow).

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 10
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 0.1
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./roller_xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left&#x27;
  [../]
  [./roller_ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom&#x27;
  [../]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
  [./xmax_drained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = right
  [../]
  [./top_velocity]
    type = FunctionDirichletBC
    variable = disp_y
    function = top_velocity
    boundary = top
  [../]
[]

[Functions]
  [./top_velocity]
    type = PiecewiseLinear
    x = &#x27;0 0.002 0.006   0.014   0.03    0.046   0.062   0.078   0.094   0.11    0.126   0.142   0.158   0.174   0.19 0.206 0.222 0.238 0.254 0.27 0.286 0.302 0.318 0.334 0.35 0.366 0.382 0.398 0.414 0.43 0.446 0.462 0.478 0.494 0.51 0.526 0.542 0.558 0.574 0.59 0.606 0.622 0.638 0.654 0.67 0.686 0.702&#x27;
    y = &#x27;-0.041824842    -0.042730269    -0.043412712    -0.04428867     -0.045509181    -0.04645965     -0.047268246 -0.047974749      -0.048597109     -0.0491467  -0.049632388     -0.050061697      -0.050441198     -0.050776675     -0.051073238      -0.0513354 -0.051567152      -0.051772022     -0.051953128 -0.052113227 -0.052254754 -0.052379865 -0.052490464 -0.052588233 -0.052674662 -0.052751065 -0.052818606 -0.052878312 -0.052931093 -0.052977751 -0.053018997 -0.053055459 -0.053087691 -0.053116185 -0.053141373 -0.05316364 -0.053183324 -0.053200724 -0.053216106 -0.053229704 -0.053241725 -0.053252351 -0.053261745 -0.053270049 -0.053277389 -0.053283879 -0.053289615&#x27;
  [../]
[]

[AuxVariables]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./tot_force]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./tot_force]
    type = ParsedAux
    args = &#x27;stress_yy porepressure&#x27;
    execute_on = timestep_end
    variable = tot_force
    function = &#x27;-stress_yy+0.6*porepressure&#x27;
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    component = 2
    variable = disp_z
  [../]
  [./poro_vol_exp]
    type = PorousFlowMassVolumetricExpansion
    variable = porepressure
    fluid_component = 0
  [../]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = porepressure
  [../]
  [./flux]
    type = PorousFlowAdvectiveFlux
    variable = porepressure
    gravity = &#x27;0 0 0&#x27;
    fluid_component = 0
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 8
      density0 = 1
      thermal_expansion = 0
      viscosity = 1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0.5 0.75&#x27;
    # bulk modulus is lambda + 2*mu/3 = 0.5 + 2*0.75/3 = 1
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    fluid = true
    mechanical = true
    ensure_positive = false
    porosity_zero = 0.1
    biot_coefficient = 0.6
    solid_bulk = 1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 0 # unimportant in this fully-saturated situation
    phase = 0
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0.0 0 0&#x27;
    variable = porepressure
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0.1 0 0&#x27;
    variable = porepressure
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0.2 0 0&#x27;
    variable = porepressure
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0.3 0 0&#x27;
    variable = porepressure
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0.4 0 0&#x27;
    variable = porepressure
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0.5 0 0&#x27;
    variable = porepressure
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0.6 0 0&#x27;
    variable = porepressure
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0.7 0 0&#x27;
    variable = porepressure
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0.8 0 0&#x27;
    variable = porepressure
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0.9 0 0&#x27;
    variable = porepressure
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;1 0 0&#x27;
    variable = porepressure
  [../]
  [./xdisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_x
  [../]
  [./ydisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_y
  [../]
  [./total_downwards_force]
     type = ElementAverageValue
     outputs = csv
     variable = tot_force
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.15*t&lt;0.01,0.15*t,0.01)
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 0.7
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = mandel
  [./csv]
    interval = 3
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8d0aa926-6ffc-40d7-82e7-9f56a034b56d"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh_fu_04.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# production
# fullyupwind
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1 1E1 1E2 1E3&#x27;
    x = &#x27;0 1E-1 1 1E1 1E2 1E3&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = -1E6
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
    fully_upwind = true
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 0
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1E3
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = bh_fu_04
  exodus = false
  execute_on = timestep_end
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5fec2da5-e574-400a-ab43-b2de4a4d7ac4"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav01d.i</h4><pre class="moose-pre"><code class="language-text"># Test illustrating that PorousFlow allows block-restricted relative permeabilities and capillarities
# and automatically adds appropriate Joiners.
# Physically, this test is checking that gravity head is established
# for 1phase, vanGenuchten, constant fluid-bulk, constant viscosity, constant permeability, Corey relative perm
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 1
    nx = 100
    xmin = -1
    xmax = 0
  []
  [./define_block1]
    input = gen
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;-1 -1 -1&#x27;
    top_right = &#x27;-0.5 1 1&#x27;
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = RandomIC
      min = -1
      max = 1
    [../]
  [../]
[]

[Kernels]
  [./dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_pp]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 2 -1 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[BCs]
  [./z]
    type = DirichletBC
    variable = pp
    boundary = right
    value = -1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc_0]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
  [./pc_1]
    type = PorousFlowCapillaryPressureVG
    m = 0.6
    alpha = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss_0]
    type = PorousFlow1PhaseP
    block = 0
    porepressure = pp
    capillary_pressure = pc_0
  [../]
  [./ppss_1]
    type = PorousFlow1PhaseP
    block = 1
    porepressure = pp
    capillary_pressure = pc_1
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm_0]
    type = PorousFlowRelativePermeabilityCorey
    block = 0
    n = 1
    phase = 0
  [../]
  [./relperm_1]
    type = PorousFlowRelativePermeabilityCorey
    block = 1
    n = 2
    phase = 0
  [../]
[]

[Postprocessors]
  [./pp_base]
    type = PointValue
    variable = pp
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_analytical]
    type = FunctionValuePostprocessor
    function = ana_pp
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  active = andy
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E6
  end_time = 1E6
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = grav01d
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="88cdeb58-4362-4458-87e9-27a81130f32c"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav01c.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established
# 1phase, vanGenuchten, constant fluid-bulk, constant viscosity, constant permeability, Corey relative perm
# unsaturated
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = RandomIC
      min = -1
      max = 1
    [../]
  [../]
[]

[Kernels]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_pp]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 2 -1 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[BCs]
  [./z]
    type = DirichletBC
    variable = pp
    boundary = right
    value = -1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
[]

[Postprocessors]
  [./pp_base]
    type = PointValue
    variable = pp
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_analytical]
    type = FunctionValuePostprocessor
    function = ana_pp
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = grav01c
  exodus = true
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5adf82a2-df7d-49ba-a867-c1425c3aab30"><div class="modal-content"><h4>modules/porous_flow/test/tests/radioactive_decay/radioactive_decay01.i</h4><pre class="moose-pre"><code class="language-text"># checking radioactive decay
# 1phase, 1component, constant porosity
#
# Note that we don&#x27;t get mass = mass0 * exp(-Lambda * t)
# because of the time discretisation.  We are solving
# the equation
# (mass - mass0)/dt = -Lambda * mass
# which has the solution
# mass = mass0/(1 + Lambda * dt)
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 3
  xmin = -1
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
  [../]
[]

[ICs]
  [./pinit]
    type = FunctionIC
    function = 10
    variable = pp
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./decay]
    type = PorousFlowMassRadioactiveDecay
    fluid_component = 0
    variable = pp
    decay_rate = 2.0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1
      density0 = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
[]

[Postprocessors]
  [./total_mass]
    type = PorousFlowFluidMass
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./total_mass0]
    type = PorousFlowFluidMass
    execute_on = &#x27;timestep_begin&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_0
  [../]
[]

[Functions]
  [./should_be_0]
    type = ParsedFunction
    vars = &#x27;m0 m rate dt&#x27;
    vals = &#x27;total_mass0 total_mass 2.0 1&#x27;
    value = &#x27;m-m0/(1.0+rate*dt)&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1
  num_steps = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = radioactive_decay01
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f3c5bc4e-9998-453e-98b4-d9d642a34eca"><div class="modal-content"><h4>modules/richards/test/tests/sinks/s05.i</h4><pre class="moose-pre"><code class="language-text"># checking the multiplying_fcn of RichardsPiecewiseLinearSinkFlux.
# This test is constructed so it should produce exactly the same answer as s02.i
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.5
    al = 1 # same deal with PETScs constant state
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = initial_pressure
    [../]
  [../]
[]

[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 2
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((mi-lfout-rfout-mf)/2/(mi+mf))
    vars = &#x27;mi mf lfout rfout&#x27;
    vals = &#x27;mass_init mass_fin left_flux_out right_flux_out&#x27;
  [../]
[]

[Postprocessors]
  [./mass_init]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]
  [./mass_fin]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]
  [./left_flux_out]
    type = RichardsHalfGaussianSinkFlux
    boundary = left
    variable = pressure
    centre = 1
    max = 4
    multiplying_fcn = 0.5
    sd = 1
  [../]
  [./right_flux_out]
    type = RichardsHalfGaussianSinkFlux
    boundary = right
    variable = pressure
    centre = 1
    max = 1
    multiplying_fcn = 2
    sd = 1
  [../]
  [./p0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
  [./mass_bal]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
  [../]
[]

[BCs]
  [./left_flux]
    type = RichardsHalfGaussianSink
    boundary = left
    variable = pressure
    centre = 1
    max = 2
    sd = 1
  [../]
  [./right_flux]
    type = RichardsHalfGaussianSink
    boundary = right
    variable = pressure
    centre = 1
    max = 2
    sd = 1
  [../]
[]

[Kernels]
  active = &#x27;richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 4E-3
  end_time = 0.4
[]

[Outputs]
  file_base = s05
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="bca39eda-5b73-4b43-8d98-23754ff63686"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/mandel_constM.i</h4><pre class="moose-pre"><code class="language-text"># Mandel&#x27;s problem of consolodation of a drained medium
#
# A sample is in plane strain.
# -a &lt;= x &lt;= a
# -b &lt;= y &lt;= b
# It is squashed with constant force by impermeable, frictionless plattens on its top and bottom surfaces (at y=+/-b)
# Fluid is allowed to leak out from its sides (at x=+/-a)
# The porepressure within the sample is monitored.
#
# As is common in the literature, this is simulated by
# considering the quarter-sample, 0&lt;=x&lt;=a and 0&lt;=y&lt;=b, with
# impermeable, roller BCs at x=0 and y=0 and y=b.
# Porepressure is fixed at zero on x=a.
# Porepressure and displacement are initialised to zero.
# Then the top (y=b) is moved downwards with prescribed velocity,
# so that the total force that is inducing this downwards velocity
# is fixed.  The velocity is worked out by solving Mandel&#x27;s problem
# analytically, and the total force is monitored in the simulation
# to check that it indeed remains constant.
#
# Here are the problem&#x27;s parameters, and their values:
# Soil width.  a = 1
# Soil height.  b = 0.1
# Soil&#x27;s Lame lambda.  la = 0.5
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = G = 0.75
# Soil bulk modulus.  K = la + 2*mu/3 = 1
# Drained Poisson ratio.  nu = (3K - 2G)/(6K + 2G) = 0.2
# Soil bulk compliance.  1/K = 1
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Biot modulus.  M = 1/(phi0/Kf + (alpha - phi0)(1 - alpha)/K) = 4.705882
# Undrained bulk modulus. Ku = K + alpha^2*M = 2.694118
# Undrained Poisson ratio.  nuu = (3Ku - 2G)/(6Ku + 2G) = 0.372627
# Skempton coefficient.  B = alpha*M/Ku = 1.048035
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Consolidation coefficient.  c = 2*k*B^2*G*(1-nu)*(1+nuu)^2/9/(1-nuu)/(nuu-nu) = 3.821656
# Normal stress on top.  F = 1
#
# The solution for porepressure and displacements is given in
# AHD Cheng and E Detournay &quot;A direct boundary element method for plane strain poroelasticity&quot; International Journal of Numerical and Analytical Methods in Geomechanics 12 (1988) 551-572.
# The solution involves complicated infinite series, so I shall not write it here

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 10
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 0.1
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./roller_xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left&#x27;
  [../]
  [./roller_ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom&#x27;
  [../]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
  [./xmax_drained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = right
  [../]
  [./top_velocity]
    type = FunctionDirichletBC
    variable = disp_y
    function = top_velocity
    boundary = top
  [../]
[]

[Functions]
  [./top_velocity]
    type = PiecewiseLinear
    x = &#x27;0 0.002 0.006   0.014   0.03    0.046   0.062   0.078   0.094   0.11    0.126   0.142   0.158   0.174   0.19 0.206 0.222 0.238 0.254 0.27 0.286 0.302 0.318 0.334 0.35 0.366 0.382 0.398 0.414 0.43 0.446 0.462 0.478 0.494 0.51 0.526 0.542 0.558 0.574 0.59 0.606 0.622 0.638 0.654 0.67 0.686 0.702&#x27;
    y = &#x27;-0.041824842    -0.042730269    -0.043412712    -0.04428867     -0.045509181    -0.04645965     -0.047268246 -0.047974749      -0.048597109     -0.0491467  -0.049632388     -0.050061697      -0.050441198     -0.050776675     -0.051073238      -0.0513354 -0.051567152      -0.051772022     -0.051953128 -0.052113227 -0.052254754 -0.052379865 -0.052490464 -0.052588233 -0.052674662 -0.052751065 -0.052818606 -0.052878312 -0.052931093 -0.052977751 -0.053018997 -0.053055459 -0.053087691 -0.053116185 -0.053141373 -0.05316364 -0.053183324 -0.053200724 -0.053216106 -0.053229704 -0.053241725 -0.053252351 -0.053261745 -0.053270049 -0.053277389 -0.053283879 -0.053289615&#x27;
  [../]
[]

[AuxVariables]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./tot_force]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./tot_force]
    type = ParsedAux
    args = &#x27;stress_yy porepressure&#x27;
    execute_on = timestep_end
    variable = tot_force
    function = &#x27;-stress_yy+0.6*porepressure&#x27;
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    component = 2
    variable = disp_z
  [../]
  [./poro_vol_exp]
    type = PorousFlowMassVolumetricExpansion
    variable = porepressure
    fluid_component = 0
  [../]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = porepressure
  [../]
  [./flux]
    type = PorousFlowAdvectiveFlux
    variable = porepressure
    gravity = &#x27;0 0 0&#x27;
    fluid_component = 0
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 8
      density0 = 1
      thermal_expansion = 0
      viscosity = 1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0.5 0.75&#x27;
    # bulk modulus is lambda + 2*mu/3 = 0.5 + 2*0.75/3 = 1
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityHMBiotModulus
    porosity_zero = 0.1
    biot_coefficient = 0.6
    solid_bulk = 1
    constant_fluid_bulk_modulus = 8
    constant_biot_modulus = 4.7058823529
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 0 # unimportant in this fully-saturated situation
    phase = 0
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0.0 0 0&#x27;
    variable = porepressure
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0.1 0 0&#x27;
    variable = porepressure
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0.2 0 0&#x27;
    variable = porepressure
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0.3 0 0&#x27;
    variable = porepressure
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0.4 0 0&#x27;
    variable = porepressure
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0.5 0 0&#x27;
    variable = porepressure
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0.6 0 0&#x27;
    variable = porepressure
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0.7 0 0&#x27;
    variable = porepressure
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0.8 0 0&#x27;
    variable = porepressure
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0.9 0 0&#x27;
    variable = porepressure
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;1 0 0&#x27;
    variable = porepressure
  [../]
  [./xdisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_x
  [../]
  [./ydisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_y
  [../]
  [./total_downwards_force]
     type = ElementAverageValue
     outputs = csv
     variable = tot_force
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.15*t&lt;0.01,0.15*t,0.01)
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 0.7
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = mandel_constM
  [./csv]
    interval = 3
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="31e74016-5f84-4e0f-a192-90f6c1e43363"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s08.i</h4><pre class="moose-pre"><code class="language-text"># apply a sink flux on just one component of a 3-component, 2-phase system and observe the correct behavior
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  zmin = 0
  zmax = 2
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pwater frac_ph0_c0 pgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 3
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1.1
  [../]
[]

[Variables]
  [./pwater]
  [../]
  [./frac_ph0_c0]
    initial_condition = 0.3
  [../]
  [./pgas]
  [../]
[]

[ICs]
  [./pwater]
    type = FunctionIC
    variable = pwater
    function = y
  [../]
  [./pgas]
    type = FunctionIC
    variable = pgas
    function = y+3
  [../]
[]

[Kernels]
  [./mass_c0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = frac_ph0_c0
  [../]
  [./mass_c1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = pwater
  [../]
  [./mass_c2]
    type = PorousFlowMassTimeDerivative
    fluid_component = 2
    variable = pgas
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 2.3
      density0 = 1.5
      thermal_expansion = 0
      viscosity = 2.1
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 1.3
      density0 = 1.1
      thermal_expansion = 0
      viscosity = 1.1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = pwater
    phase1_porepressure = pgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;frac_ph0_c0 frac_ph0_c1 frac_ph1_c0 frac_ph1_c1&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.2 0 0 0 0.1 0 0 0 0.1&#x27;
  [../]
  [./relperm0]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm1]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 1
  [../]
[]

[AuxVariables]
  [./flux_out]
  [../]
  [./frac_ph0_c1]
    initial_condition = 0.35
  [../]
  [./frac_ph1_c0]
    initial_condition = 0.1
  [../]
  [./frac_ph1_c1]
    initial_condition = 0.8
  [../]
[]

[Functions]
  [./mass1_00]
    type = ParsedFunction
    value = &#x27;fgas*vol*por*dens0gas*exp(pgas/bulkgas)*(1-pow(1+pow(al*(pgas-pwater),1.0/(1-m)),-m))+fwater*vol*por*dens0water*exp(pwater/bulkwater)*(pow(1+pow(al*(pgas-pwater),1.0/(1-m)),-m))&#x27;
    vars = &#x27;vol  por dens0gas pgas    pwater    bulkgas al  m   dens0water bulkwater fgas           fwater&#x27;
    vals = &#x27;0.25 0.1 1.1      pgas_00 pwater_00 1.3     1.1 0.5 1.5        2.3       frac_ph1_c1_00 frac_ph0_c1_00&#x27;
  [../]
  [./expected_mass_change1_00]
    type = ParsedFunction
    value = &#x27;frac*fcn*area*dt*pow(1-pow(1+pow(al*(pgas-pwater),1.0/(1-m)),-m), 2)&#x27;
    vars = &#x27;frac           fcn area dt  pgas    pwater    al m&#x27;
    vals = &#x27;frac_ph1_c1_00 100 0.5 1E-3 pgas_00 pwater_00 1.1 0.5&#x27;
  [../]
  [./mass1_00_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-mass_change&#x27;
    vars = &#x27;mass_prev mass_change&#x27;
    vals = &#x27;m1_00_prev  del_m1_00&#x27;
  [../]
[]

[Postprocessors]
  [./total_mass_comp0]
    type = PorousFlowFluidMass
    fluid_component = 0
  [../]
  [./total_mass_comp1]
    type = PorousFlowFluidMass
    fluid_component = 1
  [../]
  [./total_mass_comp2]
    type = PorousFlowFluidMass
    fluid_component = 2
  [../]
  [./frac_ph1_c1_00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = frac_ph1_c1
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./frac_ph0_c1_00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = frac_ph0_c1
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./flux_00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = flux_out
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./pgas_00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./pwater_00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m1_00]
    type = FunctionValuePostprocessor
    function = mass1_00
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m1_00_prev]
    type = FunctionValuePostprocessor
    function = mass1_00
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./del_m1_00]
    type = FunctionValuePostprocessor
    function = expected_mass_change1_00
    execute_on = &#x27;timestep_end&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m1_00_expect]
    type = FunctionValuePostprocessor
    function = mass1_00_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[BCs]
  [./flux_ph1_c1]
    type = PorousFlowSink
    boundary = &#x27;left&#x27;
    variable = pwater # sink applied to the mass_c1 Kernel
    use_mobility = false
    use_relperm = true
    mass_fraction_component = 1
    fluid_phase = 1
    flux_function = 100
    save_in = flux_out
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 100 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E-3
  end_time = 0.01
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[Outputs]
  file_base = s08
  exodus = true
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8367a690-fc4b-422a-b3a5-d54d1e73bd7c"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh16.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 0.01
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    output = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    output = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    output = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    output = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh16
  execute_on = &#x27;timestep_end final&#x27;
  interval = 100000
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7ea47746-d1fc-4fcf-97a8-8d1011e543bd"><div class="modal-content"><h4>modules/fluid_properties/test/tests/sodium/exact.i</h4><pre class="moose-pre"><code class="language-text"># Test implementation of sodium properties by comparison to analytical functions.

[Mesh]
  type = GeneratedMesh
  dim = 1
[]

[Problem]
  solve = false
[]

[AuxVariables]
  [./temperature]
  [../]
[]

[AuxKernels]
  [./temperature_aux]
    type = FunctionAux
    variable = temperature
    function = &#x27;400 + 200 * t&#x27;
  [../]
[]

[Functions]
  [./k]
    type = ParsedFunction
    vars = &#x27;T&#x27;
    vals = &#x27;temperature&#x27;
    value = &#x27;124.67 - 0.11381 * T + 5.5226e-5 * T^2 - 1.1842e-8 * T^3&#x27;
  [../]
  [./h]
    type = ParsedFunction
    vars = &#x27;T&#x27;
    vals = &#x27;temperature&#x27;
    value = &#x27;1.0e3 * (-365.77 + 1.6582 * T - 4.2395e-4 * T^2 + 1.4847e-7 * T^3 + 2992.6 / T)&#x27;
  [../]
  [./cp]
    type = ParsedFunction
    vars = &#x27;T&#x27;
    vals = &#x27;temperature&#x27;
    value = &#x27;1.0e3 * (1.6582 - 8.4790e-4 * T + 4.4541e-7 * T^2 - 2992.6 / T^2)&#x27;
  [../]
  [./rho]
    type = ParsedFunction
    vars = &#x27;T&#x27;
    vals = &#x27;temperature&#x27;
    value = &#x27;219.0 + 275.32 * (1.0 - T / 2503.7) + 511.58 * (1.0 - T / 2503.7)^(0.5)&#x27;
  [../]
  [./drho_dT]
    type = ParsedFunction
    vars = &#x27;T&#x27;
    vals = &#x27;temperature&#x27;
    value = &#x27;-(2.0 * 275.32 + 511.58 / (1.0 - T / 2503.7)^(0.5)) / 2.0 / 2503.7&#x27;
  [../]
  [./drho_dh]
    type = ParsedFunction
    vars = &#x27;drho_dT_exact cp_exact&#x27;
    vals = &#x27;drho_dT_exact cp_exact&#x27;
    value = &#x27;drho_dT_exact/cp_exact&#x27;
  [../]
[]

[Modules/FluidProperties/sodium]
  type = SodiumProperties
[]

[Materials]
  [./fp_mat]
    type = SodiumPropertiesMaterial
    temperature = temperature
    outputs = all
  [../]
[]


[Executioner]
  type = Transient

  num_steps = 10
[]

[Postprocessors]
  [./temperature]
    type = ElementAverageValue
    variable = temperature
    outputs = none
  [../]
  [./k_exact]
    type = FunctionValuePostprocessor
    function = k
    outputs = none
  [../]
  [./h_exact]
    type = FunctionValuePostprocessor
    function = h
    outputs = none
  [../]
  [./cp_exact]
    type = FunctionValuePostprocessor
    function = cp
    outputs = none
  [../]
  [./rho_exact]
    type = FunctionValuePostprocessor
    function = rho
    outputs = none
  [../]
  [./drho_dT_exact]
    type = FunctionValuePostprocessor
    function = drho_dT
    outputs = none
  [../]
  [./drho_dh_exact]
    type = FunctionValuePostprocessor
    function = drho_dh
    outputs = none
  [../]
  [./k_avg]
    type = ElementAverageValue
    variable = k
    outputs = none
  [../]
  [./h_avg]
    type = ElementAverageValue
    variable = h
    outputs = none
  [../]
  [./cp_avg]
    type = ElementAverageValue
    variable = cp
    outputs = none
  [../]
  [./t_from_h_avg]
    type = ElementAverageValue
    variable = temperature
    outputs = none
  [../]
  [./rho_avg]
    type = ElementAverageValue
    variable = rho
    outputs = none
  [../]
  [./drho_dT_avg]
    type = ElementAverageValue
    variable = drho_dT
    outputs = none
  [../]
  [./drho_dh_avg]
    type = ElementAverageValue
    variable = drho_dh
    outputs = none
  [../]
  [./k_diff]
    type = DifferencePostprocessor
    value1 = k_exact
    value2 = k_avg
  [../]
  [./h_diff]
    type = DifferencePostprocessor
    value1 = h_exact
    value2 = h_avg
  [../]
  [./cp_diff]
    type = DifferencePostprocessor
    value1 = cp_exact
    value2 = cp_avg
  [../]
  [./t_from_h_diff]
    type = DifferencePostprocessor
    value1 = temperature
    value2 = t_from_h_avg
  [../]
  [./rho_avg_diff]
    type = DifferencePostprocessor
    value1 = rho_exact
    value2 = rho_avg
  [../]
  [./drho_dT_avg_diff]
    type = DifferencePostprocessor
    value1 = drho_dT_exact
    value2 = drho_dT_avg
  [../]
  [./drho_dh_avg_diff]
    type = DifferencePostprocessor
    value1 = drho_dh_exact
    value2 = drho_dh_avg
  [../]
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a3f8d540-7fb3-4cd7-921b-aec8d7ec2c79"><div class="modal-content"><h4>modules/porous_flow/test/tests/energy_conservation/heat04.i</h4><pre class="moose-pre"><code class="language-text"># The sample is a single unit element, with fixed displacements on
# all sides.  A heat source of strength S (J/m^3/s) is applied into
# the element.  There is no fluid flow or heat flow.  The rise
# in temperature, porepressure and stress, and the change in porosity is
# matched with theory.
#
# In this case, fluid mass must be conserved, and there is no
# volumetric strain, so
# porosity * fluid_density = constant
# Also, the energy-density in the rock-fluid system increases with S:
# d/dt [(1 - porosity) * rock_density * rock_heat_cap * T + porosity * fluid_density * fluid_heat_cap * T] = S
# Also, the porosity evolves according to THM as
# porosity = biot + (porosity0 - biot) * exp( (biot - 1) * P / fluid_bulk + rock_thermal_exp * T)
# Finally, the effective stress must be exactly zero (as there is
# no strain).
#
# Let us assume that
# fluid_density = dens0 * exp(P / fluid_bulk - fluid_thermal_exp * T)
# Then the conservation of fluid mass means
# porosity = por0 * exp(- P / fluid_bulk + fluid_thermal_exp * T)
# where dens0 * por0 = the initial fluid mass.
# The last expression for porosity, combined with the THM one,
# and assuming that biot = 1 for simplicity, gives
# porosity = 1 + (porosity0 - 1) * exp(rock_thermal_exp * T) = por0 * exp(- P / fluid_bulk + fluid_thermal_exp * T) .... (A)
#
# This stuff may be substituted into the heat energy-density equation:
# S = d/dt [(1 - porosity0) * exp(rock_thermal_exp * T) * rock_density * rock_heat_cap * T + porosity * fluid_density * fluid_heat_cap * T]
#
# If S is constant then
# S * t = (1 - porosity0) * exp(rock_thermal_exp * T) * rock_density * rock_heat_cap * T + porosity * fluid_density * fluid_heat_cap * T
# with T(t=0) = 0 then Eqn(A) implies that por0 = porosity0 and
# P / fluid_bulk = fluid_thermal_exp * T - log(1 + (por0 - 1) * exp(rock_thermal_exp * T)) + log(por0)
#
# Parameters:
# A = 2
# fluid_bulk = 2.0
# dens0 = 3.0
# fluid_thermal_exp = 0.5
# fluid_heat_cap = 2
# por0 = 0.5
# rock_thermal_exp = 0.25
# rock_density = 5
# rock_heat_capacity = 0.2

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.5
      cv = 2
      cp = 2
      bulk_modulus = 2.0
      density0 = 3.0
    [../]
  [../]
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./pp]
  [../]
  [./temp]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 1.0
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 1.0
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 1.0
    component = 2
    variable = disp_z
  [../]
  [./poro_vol_exp]
    type = PorousFlowMassVolumetricExpansion
    variable = pp
    fluid_component = 0
  [../]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./temp]
    type = PorousFlowEnergyTimeDerivative
    variable = temp
  [../]
  [./poro_vol_exp_temp]
    type = PorousFlowHeatVolumetricExpansion
    variable = temp
  [../]
  [./heat_source]
    type = BodyForce
    function = 1
    variable = temp
  [../]
[]

[Functions]
  [./err_T_fcn]
    type = ParsedFunction
    vars = &#x27;por0 rte temp rd rhc m0 fhc source&#x27;
    vals = &#x27;0.5 0.25 t0   5  0.2 1.5 2  1&#x27;
    value = &#x27;((1-por0)*exp(rte*temp)*rd*rhc*temp+m0*fhc*temp-source*t)/(source*t)&#x27;
  [../]
  [./err_pp_fcn]
    type = ParsedFunction
    vars = &#x27;por0 rte temp rd rhc m0 fhc source bulk pp fte&#x27;
    vals = &#x27;0.5 0.25 t0   5  0.2 1.5 2  1      2    p0 0.5&#x27;
    value = &#x27;(bulk*(fte*temp-log(1+(por0-1)*exp(rte*temp))+log(por0))-pp)/pp&#x27;
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./porosity]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./porosity]
    type = PorousFlowPropertyAux
    property = porosity
    variable = porosity
  [../]
[]


[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;temp pp disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = temp
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
  [../]
  [./eff_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./porosity]
    type = PorousFlowPorosity
    thermal = true
    fluid = true
    mechanical = true
    ensure_positive = false
    biot_coefficient = 1.0
    porosity_zero = 0.5
    thermal_expansion_coeff = 0.25
    solid_bulk = 2
  [../]
  [./rock_heat]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 0.2
    density = 5.0
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    temperature_unit = Kelvin
    fp = the_simple_fluid
    phase = 0
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = pp
  [../]
  [./t0]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = temp
  [../]
  [./porosity]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    execute_on = &#x27;timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
    variable = porosity
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./fluid_mass]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;timestep_end&#x27;
    use_displaced_mesh = true
    outputs = &#x27;console csv&#x27;
  [../]
  [./total_heat]
    type = PorousFlowHeatEnergy
    phase = 0
    execute_on = &#x27;timestep_end&#x27;
    use_displaced_mesh = true
    outputs = &#x27;console csv&#x27;
  [../]
  [./err_T]
    type = FunctionValuePostprocessor
    function = err_T_fcn
  [../]
  [./err_P]
    type = FunctionValuePostprocessor
    function = err_pp_fcn
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1
  end_time = 5
[]

[Outputs]
  execute_on = &#x27;initial timestep_end&#x27;
  file_base = heat04
  exodus = true
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="420ec901-d48b-4885-bca6-9a899d873901"><div class="modal-content"><h4>modules/richards/test/tests/sinks/s_fu_03.i</h4><pre class="moose-pre"><code class="language-text"># with fully_upwind = true
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  SUPG_UO = SUPGstandard
  sat_UO = Saturation
  seff_UO = SeffVG
  fully_upwind = true
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.5
    al = 1
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = initial_pressure
    [../]
  [../]
[]

[AuxVariables]
  [./seff]
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 2
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((mi-lfout-rfout-mf)/2/(mi+mf))
    vars = &#x27;mi mf lfout rfout&#x27;
    vals = &#x27;mass_init mass_fin left_flux_out right_flux_out&#x27;
  [../]
[]

[Postprocessors]
  [./mass_init]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]
  [./mass_fin]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]
  [./left_flux_out]
    type = RichardsPiecewiseLinearSinkFlux
    boundary = left
    variable = pressure
    pressures = &#x27;-1 1&#x27;
    bare_fluxes = &#x27;1E2 2E2&#x27;
    use_mobility = true
    use_relperm = true
  [../]
  [./right_flux_out]
    type = RichardsPiecewiseLinearSinkFlux
    boundary = right
    variable = pressure
    pressures = &#x27;-1 1&#x27;
    bare_fluxes = &#x27;1E2 2E2&#x27;
    use_mobility = true
    use_relperm = true
  [../]
  [./p0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
  [./s0]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = seff
  [../]
  [./mass_bal]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
  [../]
[]

[BCs]
  [./left_flux]
    type = RichardsPiecewiseLinearSink
    boundary = left
    pressures = &#x27;-1 1&#x27;
    bare_fluxes = &#x27;1E2 2E2&#x27;
    variable = pressure
    use_mobility = true
    use_relperm = true
  [../]
  [./right_flux]
    type = RichardsPiecewiseLinearSink
    boundary = right
    pressures = &#x27;-1 1&#x27;
    bare_fluxes = &#x27;1E2 2E2&#x27;
    variable = pressure
    use_mobility = true
    use_relperm = true
  [../]
[]

[Kernels]
  active = &#x27;richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
[]

[AuxKernels]
  [./seff_auxk]
    type = RichardsSeffAux
    variable = seff
    seff_UO = SeffVG
    pressure_vars = &#x27;pressure&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 2.1E-5 2.2E-5  2.1E-5 0.1E-5 3.3E-5  2.2E-5 3.3E-5 2E-5&#x27;
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 2E-3
  end_time = 0.2
[]

[Outputs]
  file_base = s_fu_03
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="792693f2-e9fa-422c-87e8-4db363794d1d"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav01c_action.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established
# using the Unsaturated Action
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
  block = 0
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = RandomIC
      min = -1
      max = 1
    [../]
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 2.0
      viscosity = 1.0
      density0 = 1.0
    [../]
  [../]
[]

[PorousFlowUnsaturated]
  add_saturation_aux = false
  add_darcy_aux = false
  porepressure = pp
  gravity = &#x27;-1 0 0&#x27;
  fp = the_simple_fluid
  van_genuchten_alpha = 1.0
  van_genuchten_m = 0.5
  relative_permeability_type = Corey
  relative_permeability_exponent = 1.0
[]

[Functions]
  [./ana_pp]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 2 -1 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[BCs]
  [./z]
    type = DirichletBC
    variable = pp
    boundary = right
    value = -1
  [../]
[]

[Materials]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
[]

[Postprocessors]
  [./pp_base]
    type = PointValue
    variable = pp
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_analytical]
    type = FunctionValuePostprocessor
    function = ana_pp
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = grav01c_action
  exodus = true
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="60293b94-80ea-45d2-8e84-76917d4a3d60"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh08.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh08
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4412797b-5e13-43db-b02b-48c86aeb8c44"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/frompps.i</h4><pre class="moose-pre"><code class="language-text"># Test PorousFlowPointSourceFromPostprocessor DiracKernel

[Mesh]
  type = GeneratedMesh
  dim = 2
  bias_x = 1.1
  bias_y = 1.1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./mass_flux_fn]
    type = PiecewiseConstant
    direction = left
    xy_data = &#x27;
      0    0
      100  -0.1
      300  0
      600  -0.1
      1400 0
      1500 0.2
      2000 0.2&#x27;
  [../]
[]

[Variables]
  [./pp]
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pp
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.2
  [../]
[]

[Postprocessors]
  [./total_mass]
    type = PorousFlowFluidMass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./mass_flux_in]
    type = FunctionValuePostprocessor
    function = mass_flux_fn
    execute_on = &#x27;initial timestep_begin&#x27;
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  nl_abs_tol = 1e-14
  dt = 100
  end_time = 2000
[]

[Outputs]
  perf_graph = true
  csv = true
  execute_on = &#x27;initial timestep_end&#x27;
  file_base = frompps
[]

[ICs]
  [./PressureIC]
    variable = pp
    type = ConstantIC
    value = 20e6
  [../]
[]

[DiracKernels]
  [./source]
    type = PorousFlowPointSourceFromPostprocessor
    variable = pp
    mass_flux = mass_flux_in
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b91a9620-1f59-460e-8a31-b4e8ade25aa0"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_02.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = false
# transient = false

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  # get nonconvergence if initial condition is too crazy
  [./water_ic]
    type = FunctionIC
    function = pwater_initial
    variable = pwater
  [../]
  [./gas_ic]
    type = FunctionIC
    function = pgas_initial
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardsfgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
    outputs = none # no reason why mass should be conserved
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
    outputs = none # no reason why mass should be conserved
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./pwater_initial]
    type = ParsedFunction
    value = 1-x/2
  [../]
  [./pgas_initial]
    type = ParsedFunction
    value = 2-x/5
  [../]

  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres asm lu NONZERO 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_fu_02
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3f0e8c33-8a90-48b8-b06a-ac7709602ab4"><div class="modal-content"><h4>modules/porous_flow/examples/lava_lamp/1phase_convection.i</h4><pre class="moose-pre"><code class="language-text"># Two phase density-driven convection of dissolved CO2 in brine
#
# The model starts with CO2 in the liquid phase only.  The CO2 diffuses into the brine.
# As the density of the CO2-saturated brine is greater
# than the unsaturated brine, a gravitational instability arises and density-driven
# convection of CO2-rich fingers descend into the unsaturated brine.
#
# The instability is seeded by a random perturbation to the porosity field.
# Mesh adaptivity is used to refine the mesh as the fingers form.
#
# Note: this model is computationally expensive, so should be run with multiple cores.

[GlobalParams]
  PorousFlowDictator = &#x27;dictator&#x27;
  gravity = &#x27;0 -9.81 0&#x27;
[]

[Adaptivity]
  max_h_level = 2
  marker = marker
  initial_marker = initial
  initial_steps = 2
  [./Indicators]
    [./indicator]
      type = GradientJumpIndicator
      variable = zi
    [../]
  [../]
  [./Markers]
    [./marker]
      type = ErrorFractionMarker
      indicator = indicator
      refine = 0.8
    [../]
    [./initial]
      type = BoxMarker
      bottom_left = &#x27;0 1.95 0&#x27;
      top_right = &#x27;2 2 0&#x27;
      inside = REFINE
      outside = DO_NOTHING
    [../]
  [../]
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  ymin = 1.5
  ymax = 2
  xmax = 2
  ny = 20
  nx = 40
  bias_y = 0.95
[]

[AuxVariables]
  [./xnacl]
    initial_condition = 0.01
  [../]
  [./saturation_gas]
    order = FIRST
    family = MONOMIAL
  [../]
  [./xco2l]
    order = FIRST
    family = MONOMIAL
  [../]
  [./density_liquid]
    order = FIRST
    family = MONOMIAL
  [../]
  [./porosity]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./saturation_gas]
    type = PorousFlowPropertyAux
    variable = saturation_gas
    property = saturation
    phase = 1
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./xco2l]
    type = PorousFlowPropertyAux
    variable = xco2l
    property = mass_fraction
    phase = 0
    fluid_component = 1
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./density_liquid]
    type = PorousFlowPropertyAux
    variable = density_liquid
    property = density
    phase = 0
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[Variables]
  [./pgas]
  [../]
  [./zi]
    scaling = 1e4
  [../]
[]

[ICs]
  [./pressure]
    type = FunctionIC
    function = 10e6-9.81*1000*y
    variable = pgas
  [../]
  [./zi]
    type = ConstantIC
    value = 0
    variable = zi
  [../]
  [./porosity]
    type = RandomIC
    variable = porosity
    min = 0.25
    max = 0.275
    seed = 0
  [../]
[]

[BCs]
  [./top]
    type = DirichletBC
    value = 0.04
    variable = zi
    boundary = top
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pgas
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pgas
  [../]
  [./diff0]
    type = PorousFlowDispersiveFlux
    fluid_component = 0
    variable = pgas
    disp_long = &#x27;0 0&#x27;
    disp_trans = &#x27;0 0&#x27;
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = zi
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = zi
  [../]
  [./diff1]
    type = PorousFlowDispersiveFlux
    fluid_component = 1
    variable = zi
    disp_long = &#x27;0 0&#x27;
    disp_trans = &#x27;0 0&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pgas zi&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
  [./fs]
    type = PorousFlowBrineCO2
    brine_fp = brine
    co2_fp = co2
    capillary_pressure = pc
  [../]
[]

[Modules]
  [./FluidProperties]
    [./co2sw]
      type = CO2FluidProperties
    [../]
    [./co2]
      type = TabulatedFluidProperties
      fp = co2sw
    [../]
    [./brine]
      type = BrineFluidProperties
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = &#x27;45&#x27;
  [../]
  [./brineco2]
    type = PorousFlowFluidState
    gas_porepressure = &#x27;pgas&#x27;
    z = &#x27;zi&#x27;
    temperature_unit = Celsius
    xnacl = &#x27;xnacl&#x27;
    capillary_pressure = pc
    fluid_state = fs
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = porosity
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-11 0 0 0 1e-11 0 0 0 1e-11&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    phase = 0
    n = 2
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 2
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./diffusivity]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;2e-9 2e-9 2e-9 2e-9&#x27;
    tortuosity = &#x27;1 1&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./mumps_is_best_for_parallel_jobs]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
  [./basic]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2             &#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 1e6
  nl_max_its = 25
  l_max_its = 100
  dtmax = 1e4
  nl_abs_tol = 1e-6
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 100
    growth_factor = 2
    cutback_factor = 0.5
  [../]
[]

[Functions]
  [./flux]
    type = ParsedFunction
    vals = &#x27;delta_xco2 dt&#x27;
    vars = &#x27;dx dt&#x27;
    value = &#x27;dx/dt&#x27;
  [../]
[]

[Postprocessors]
  [./total_co2_in_gas]
    type = PorousFlowFluidMass
    phase = 1
    fluid_component = 1
  [../]
  [./total_co2_in_liquid]
    type = PorousFlowFluidMass
    phase = 0
    fluid_component = 1
  [../]
  [./numdofs]
    type = NumDOFs
  [../]
  [./delta_xco2]
    type = ChangeOverTimePostprocessor
    postprocessor = total_co2_in_liquid
  [../]
  [./dt]
    type = TimestepSize
  [../]
  [./flux]
    type = FunctionValuePostprocessor
    function = flux
  [../]
[]

[Outputs]
  print_linear_residuals = false
  perf_graph = true
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6260c296-20a4-4e1e-b67c-c2c889ba01ae"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/terzaghi_constM.i</h4><pre class="moose-pre"><code class="language-text"># Terzaghi&#x27;s problem of consolodation of a drained medium
#
# A saturated soil sample sits in a bath of water.
# It is constrained on its sides, and bottom.
# Its sides and bottom are also impermeable.
# Initially it is unstressed.
# A normal stress, q, is applied to the soil&#x27;s top.
# The soil then slowly compresses as water is squeezed
# out from the sample from its top (the top BC for
# the porepressure is porepressure = 0).
#
# See, for example.  Section 2.2 of the online manuscript
# Arnold Verruijt &quot;Theory and Problems of Poroelasticity&quot; Delft University of Technology 2013
# but note that the &quot;sigma&quot; in that paper is the negative
# of the stress in TensorMechanics
#
# Here are the problem&#x27;s parameters, and their values:
# Soil height.  h = 10
# Soil&#x27;s Lame lambda.  la = 2
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = 3
# Soil bulk modulus.  K = la + 2*mu/3 = 4
# Soil confined compressibility.  m = 1/(K + 4mu/3) = 0.125
# Soil bulk compliance.  1/K = 0.25
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Soil initial storativity, which is the reciprocal of the initial Biot modulus.  S = phi0/Kf + (alpha - phi0)(1 - alpha)/K = 0.0625
# Consolidation coefficient.  c = k/(S + alpha^2 m) = 13.95348837
# Normal stress on top.  q = 1
# Initial porepressure, resulting from instantaneous application of q, assuming corresponding instantaneous increase of porepressure (Note that this is calculated by MOOSE: we only need it for the analytical solution).  p0 = alpha*m*q/(S + alpha^2 m) = 0.69767442
# Initial vertical displacement (down is positive), resulting from instantaneous application of q (Note this is calculated by MOOSE: we only need it for the analytical solution).  uz0 = q*m*h*S/(S + alpha^2 m)
# Final vertical displacement (down in positive) (Note this is calculated by MOOSE: we only need it for the analytical solution).  uzinf = q*m*h
#
# The solution for porepressure is
# P = 4*p0/\pi \sum_{k=1}^{\infty} \frac{(-1)^{k-1}}{2k-1} \cos ((2k-1)\pi z/(2h)) \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))
# This series converges very slowly for ct/h^2 small, so in that domain
# P = p0 erf( (1-(z/h))/(2 \sqrt(ct/h^2)) )
#
# The degree of consolidation is defined as
# U = (uz - uz0)/(uzinf - uz0)
# where uz0 and uzinf are defined above, and
# uz = the vertical displacement of the top (down is positive)
# U = 1 - (8/\pi^2)\sum_{k=1}^{\infty} \frac{1}{(2k-1)^2} \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 10
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = 0
  zmax = 10
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./basefixed]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = back
  [../]
  [./topdrained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = front
  [../]
  [./topload]
    type = NeumannBC
    variable = disp_z
    value = -1
    boundary = front
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    component = 2
    variable = disp_z
  [../]
  [./poro_vol_exp]
    type = PorousFlowMassVolumetricExpansion
    variable = porepressure
    fluid_component = 0
  [../]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = porepressure
  [../]
  [./flux]
    type = PorousFlowAdvectiveFlux
    variable = porepressure
    gravity = &#x27;0 0 0&#x27;
    fluid_component = 0
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 8
      density0 = 1
      thermal_expansion = 0
      viscosity = 0.96
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;2 3&#x27;
    # bulk modulus is lambda + 2*mu/3 = 2 + 2*3/3 = 4
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityHMBiotModulus
    porosity_zero = 0.1
    biot_coefficient = 0.6
    solid_bulk = 4
    constant_fluid_bulk_modulus = 8
    constant_biot_modulus = 16
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 0 # unimportant in this fully-saturated situation
    phase = 0
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 1&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 2&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 3&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 4&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 5&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 6&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 7&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 8&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 9&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = disp_z
    use_displaced_mesh = false
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.5*t&lt;0.1,0.5*t,0.1)
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.0001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = terzaghi_constM
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="655c2a1c-6379-4e6c-a2fe-3c11ed838ee4"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh02.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole

    # Because the Variable for this Sink is pp, and pp is associated
    # with the fluid-mass conservation equation, this sink is extracting
    # fluid mass (and not heat energy or something else)
    variable = pp


    # The following specfies that the total fluid mass coming out of
    # the porespace via this sink in this timestep should be recorded
    # in the pls_total_outflow_mass UserObject
    SumQuantityUO = borehole_total_outflow_mass


    # The following file defines the polyline geometry
    # which is just two points in this particular example
    point_file = bh02.bh


    # First, we want Peacemans f to be a function of porepressure (and not
    # temperature or something else).  So bottom_p_or_t is actually porepressure
    function_of = pressure
    fluid_phase = 0

    # The bottomhole pressure
    bottom_p_or_t = 0

    # In this example there is no increase of the wellbore pressure
    # due to gravity:
    unit_weight = &#x27;0 0 0&#x27;

    # PeacemanBoreholes should almost always have use_mobility = true
    use_mobility = true

    # This is a production wellbore (a sink of fluid that removes fluid from porespace)
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]
  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]

[Outputs]
  file_base = bh02
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="394c4f2d-18c9-42c4-9050-5f3f22254364"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav02c.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established in the transient situation when 0&lt;=saturation&lt;=1 (note the less-than-or-equal-to).
# 2phase (PP), 2components, vanGenuchten, constant fluid bulk-moduli for each phase, constant viscosity, constant permeability, Corey relative perm
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-3 1E-2 1E-1&#x27;
    x = &#x27;1E-3 1E-2 1E-1&#x27;
  [../]
[]

[Variables]
  [./ppwater]
    initial_condition = -0.1
  [../]
  [./ppgas]
    initial_condition = 0
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = ppwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = ppwater
    gravity = &#x27;-1 0 0&#x27;
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = ppgas
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = ppgas
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_ppwater]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 2 pp_water_top 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater ppgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 1
      density0 = 0.1
      viscosity = 0.5
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = ppwater
    phase1_porepressure = ppgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[Postprocessors]
  [./pp_water_top]
    type = PointValue
    variable = ppwater
    point = &#x27;0 0 0&#x27;
  [../]
  [./pp_water_base]
    type = PointValue
    variable = ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_water_analytical]
    type = FunctionValuePostprocessor
    function = ana_ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./mass_ph0]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./mass_ph1]
    type = PorousFlowFluidMass
    fluid_component = 1
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

[]

[Preconditioning]
  active = andy
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000&#x27;
  [../]
  [./check]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -snes_type&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000 test&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
  end_time = 1.0
[]

[Outputs]
  execute_on = &#x27;initial timestep_end&#x27;
  file_base = grav02c
  [./csv]
    type = CSV
  [../]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7efb0f59-f6a6-4956-bb86-e47c99391ba4"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh_fu_02.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
# fullyupwind
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
    fully_upwind = true
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON

[]

[Outputs]
  file_base = bh_fu_02
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1c31fecc-87c1-4502-a0d3-ea54d8884447"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh03.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# injection
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 1E7
    point_file = bh03.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = -1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 0
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON

[]

[Outputs]
  file_base = bh03
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e83881a6-2d94-460d-9870-cb785c9d81d4"><div class="modal-content"><h4>modules/phase_field/examples/measure_interface_energy/1Dinterface_energy.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmax = 100
  xmin = 0
  elem_type = EDGE
[]

[AuxVariables]
  [./local_energy]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./local_free_energy]
    type = TotalFreeEnergy
    variable = local_energy
    kappa_names = kappa_c
    interfacial_vars = c
  [../]
[]

[Variables]
  [./c]
    order = FIRST
    family = LAGRANGE
    scaling = 1e1
    [./InitialCondition]
      type = RampIC
      variable = c
      value_left = 0
      value_right = 1
    [../]
  [../]
  [./w]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./c_res]
    type = SplitCHParsed
    variable = c
    f_name = F
    kappa_name = kappa_c
    w = w
  [../]
  [./w_res]
    type = SplitCHWRes
    variable = w
    mob_name = M
  [../]
  [./time]
    type = CoupledTimeDerivative
    variable = w
    v = c
  [../]

[]

[Functions]
  [./Int_energy]
    type = ParsedFunction
    vals = &#x27;total_solute Cleft Cright Fleft Fright volume&#x27;
    value = &#x27;((total_solute-Cleft*volume)/(Cright-Cleft))*Fright+(volume-(total_solute-Cleft*volume)/(Cright-Cleft))*Fleft&#x27;
    vars = &#x27;total_solute Cleft Cright Fleft Fright volume&#x27;
  [../]
  [./Diff]
    type = ParsedFunction
    vals = &#x27;total_free_energy total_no_int&#x27;
    vars = &#x27;total_free_energy total_no_int&#x27;
    value = total_free_energy-total_no_int
  [../]
[]

[Materials]
  [./consts]
    type = GenericConstantMaterial
    prop_names  = &#x27;kappa_c M&#x27;
    prop_values = &#x27;25      150&#x27;
  [../]
  [./Free_energy]
    type = DerivativeParsedMaterial
    f_name = F
    function = &#x27;c^2*(c-1)^2&#x27;
    args = c
    derivative_order = 2
  [../]
[]

[Postprocessors]
  # The total free energy of the simulation cell to observe the energy reduction.
  [./total_free_energy]
    type = ElementIntegralVariablePostprocessor
    variable = local_energy
  [../]

  # for testing we also monitor the total solute amount, which should be conserved,
  # gives Cavg in % for this problem.
  [./total_solute]
    type = ElementIntegralVariablePostprocessor
    variable = c
  [../]
  # Get simulation cell size (1D volume) from postprocessor
  [./volume]
    type = ElementIntegralMaterialProperty
    mat_prop = 1
  [../]
  # Find concentration in each phase using SideAverageValue
  [./Cleft]
    type = SideAverageValue
    boundary = left
    variable = c
  [../]
  [./Cright]
    type = SideAverageValue
    boundary = right
    variable = c
  [../]
  # Find local energy in each phase by checking boundaries
  [./Fleft]
    type = SideAverageValue
    boundary = left
    variable = local_energy
  [../]
  [./Fright]
    type = SideAverageValue
    boundary = right
    variable = local_energy
  [../]
  # Use concentrations and energies to find total free energy without any interface,
  # only applies once equilibrium is reached!!
  # Difference between energy with and without interface
  # gives interface energy per unit area.
  [./total_no_int]
    type = FunctionValuePostprocessor
    function = Int_energy
  [../]
  [./Energy_of_Interface]
    type = FunctionValuePostprocessor
    function = Diff
  [../]
[]

[Preconditioning]
  # This preconditioner makes sure the Jacobian Matrix is fully populated. Our
  # kernels compute all Jacobian matrix entries.
  # This allows us to use the Newton solver below.
  [./SMP]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  scheme = &#x27;bdf2&#x27;

  # Automatic differentiation provides a _full_ Jacobian in this example
  # so we can safely use NEWTON for a fast solve
  solve_type = &#x27;NEWTON&#x27;

  l_max_its = 15
  l_tol = 1.0e-6

  nl_max_its = 15
  nl_rel_tol = 1.0e-10
  nl_abs_tol = 1.0e-4

  start_time = 0.0
  # make sure that the result obtained for the interfacial free energy is fully converged
  end_time   = 40

  [./TimeStepper]
    type = SolutionTimeAdaptiveDT
    dt = 0.5
  [../]
[]

[Outputs]
  gnuplot = true
  csv = true
  [./exodus]
    type = Exodus
    show = &#x27;c local_energy&#x27;
    execute_on = &#x27;failed initial nonlinear timestep_end final&#x27;
  [../]
  [./console]
    type = Console
    execute_on = &#x27;FAILED INITIAL NONLINEAR TIMESTEP_END final&#x27;
  [../]
  perf_graph = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3f8cfe87-6e59-4224-aad3-fad8b9ef1d78"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav01b.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established
# 1phase, vanGenuchten, constant and large fluid-bulk, constant viscosity, constant permeability, Corey relperm
# fully saturated
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = RandomIC
      min = 0
      max = 1
    [../]
  [../]
[]

[Kernels]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_pp]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 1E3 0 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[BCs]
  [./z]
    type = DirichletBC
    variable = pp
    boundary = right
    value = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1e3
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
[]

[Postprocessors]
  [./pp_base]
    type = PointValue
    variable = pp
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_analytical]
    type = FunctionValuePostprocessor
    function = ana_pp
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = grav01b
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="432b5e1e-289d-4885-af55-6b48de0b2f85"><div class="modal-content"><h4>test/tests/kernels/ad_2d_diffusion/2d_diffusion_bodyforce_test.i</h4><pre class="moose-pre"><code class="language-text">###########################################################
# This is a simple test of the Kernel System.
# It solves the Laplacian equation on a small 2x2 grid.
# The &quot;Diffusion&quot; kernel is used to calculate the
# residuals of the weak form of this operator. The
# &quot;BodyForce&quot; kernel is used to apply a time-dependent
# volumetric source.
###########################################################

[Mesh]
  [./square]
    type = GeneratedMeshGenerator
    nx = 2
    ny = 2
    dim = 2
  [../]
[]

[Variables]
  active = &#x27;u&#x27;

  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = ADDiffusion
    variable = u
  [../]
  [./bf]
    type = ADBodyForce
    variable = u
    postprocessor = ramp
  [../]
[]

[Functions]
  [./ramp]
    type = ParsedFunction
    value = &#x27;t&#x27;
  [../]
[]

[Postprocessors]
  [./ramp]
    type = FunctionValuePostprocessor
    function = ramp
    execute_on = linear
  [../]
[]

[BCs]
  active = &#x27;left right&#x27;

  [./left]
    type = DirichletBC
    variable = u
    boundary = 3
    value = 0
  [../]

  [./right]
    type = DirichletBC
    variable = u
    boundary = 1
    value = 0
  [../]
[]

[Executioner]
  type = Transient
  dt = 1.0
  end_time = 1.0

  solve_type = &#x27;NEWTON&#x27;
[]

[Outputs]
  file_base = bodyforce_out
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="29a4c980-c952-4b4b-b27b-12f989629abb"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except12.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = does_not_exist
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ffa867cf-b236-4e0d-a63d-2a3478183cae"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except13.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = coincident_points.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e105d1bc-21b6-4bfd-bf3e-8c0f776e0411"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s07.i</h4><pre class="moose-pre"><code class="language-text"># apply a sink flux on just one component of a 3-component system and observe the correct behavior
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  zmin = 0
  zmax = 2
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp frac0 frac1&#x27;
    number_fluid_phases = 1
    number_fluid_components = 3
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1.1
  [../]
[]

[Variables]
  [./pp]
  [../]
  [./frac0]
    initial_condition = 0.1
  [../]
  [./frac1]
    initial_condition = 0.6
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = y
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = frac0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = frac1
  [../]
  [./mass2]
    type = PorousFlowMassTimeDerivative
    fluid_component = 2
    variable = pp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.3
      density0 = 1.1
      thermal_expansion = 0
      viscosity = 1.1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;frac0 frac1&#x27;
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.2 0 0 0 0.1 0 0 0 0.1&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[AuxVariables]
  [./flux_out]
  [../]
[]

[Functions]
  [./mass1_00]
    type = ParsedFunction
    value = &#x27;frac*vol*por*dens0*exp(pp/bulk)*pow(1+pow(-al*pp,1.0/(1-m)),-m)&#x27;
    vars = &#x27;frac  vol  por dens0 pp bulk al m&#x27;
    vals = &#x27;f1_00 0.25 0.1 1.1  p00 1.3 1.1 0.5&#x27;
  [../]
  [./expected_mass_change1_00]
    type = ParsedFunction
    value = &#x27;frac*fcn*area*dt&#x27;
    vars = &#x27;frac fcn area dt&#x27;
    vals = &#x27;f1_00 6  0.5  1E-3&#x27;
  [../]
  [./mass1_00_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-mass_change&#x27;
    vars = &#x27;mass_prev mass_change&#x27;
    vals = &#x27;m1_00_prev  del_m1_00&#x27;
  [../]
  [./mass1_01]
    type = ParsedFunction
    value = &#x27;frac*vol*por*dens0*exp(pp/bulk)*pow(1+pow(-al*pp,1.0/(1-m)),-m)&#x27;
    vars = &#x27;frac  vol  por dens0 pp bulk al m&#x27;
    vals = &#x27;f1_01 0.25 0.1 1.1  p01 1.3 1.1 0.5&#x27;
  [../]
  [./expected_mass_change1_01]
    type = ParsedFunction
    value = &#x27;frac*fcn*area*dt&#x27;
    vars = &#x27;frac fcn area dt&#x27;
    vals = &#x27;f1_01 6  0.5  1E-3&#x27;
  [../]
  [./mass1_01_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-mass_change&#x27;
    vars = &#x27;mass_prev mass_change&#x27;
    vals = &#x27;m1_01_prev  del_m1_01&#x27;
  [../]
[]

[Postprocessors]
  [./f1_00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = frac1
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./flux_00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = flux_out
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m1_00]
    type = FunctionValuePostprocessor
    function = mass1_00
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m1_00_prev]
    type = FunctionValuePostprocessor
    function = mass1_00
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./del_m1_00]
    type = FunctionValuePostprocessor
    function = expected_mass_change1_00
    execute_on = &#x27;timestep_end&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m1_00_expect]
    type = FunctionValuePostprocessor
    function = mass1_00_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./f1_01]
    type = PointValue
    point = &#x27;0 1 0&#x27;
    variable = frac1
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./flux_01]
    type = PointValue
    point = &#x27;0 1 0&#x27;
    variable = flux_out
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p01]
    type = PointValue
    point = &#x27;0 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m1_01]
    type = FunctionValuePostprocessor
    function = mass1_01
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m1_01_prev]
    type = FunctionValuePostprocessor
    function = mass1_01
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./del_m1_01]
    type = FunctionValuePostprocessor
    function = expected_mass_change1_01
    execute_on = &#x27;timestep_end&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m1_01_expect]
    type = FunctionValuePostprocessor
    function = mass1_01_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./f1_11]
    type = PointValue
    point = &#x27;1 1 0&#x27;
    variable = frac1
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./flux_11]
    type = PointValue
    point = &#x27;1 1 0&#x27;
    variable = flux_out
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p11]
    type = PointValue
    point = &#x27;1 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[BCs]
  [./flux]
    type = PorousFlowSink
    boundary = &#x27;left&#x27;
    variable = frac1
    use_mobility = false
    use_relperm = false
    mass_fraction_component = 1
    fluid_phase = 0
    flux_function = 6
    save_in = flux_out
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 10 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E-3
  end_time = 0.01
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[Outputs]
  file_base = s07
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d20059fe-bbcc-41f7-99ee-52dfcea4c730"><div class="modal-content"><h4>modules/chemical_reactions/test/tests/desorption/mollified_langmuir_desorption.i</h4><pre class="moose-pre"><code class="language-text"># testing the entire desorption DEs with mollification
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 1
  xmin = 0
  xmax = 1
[]

[Variables]
  [./pressure]
  [../]
  [./conc]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./p_ic]
    type = ConstantIC
    variable = pressure
    value = 1.0
  [../]
  [./conc_ic]
    type = ConstantIC
    variable = conc
    value = 1.0
  [../]
[]


[Kernels]
  [./c_dot]
    type = TimeDerivative
    variable = conc
  [../]
  [./flow_from_matrix]
    type = DesorptionFromMatrix
    variable = conc
    pressure_var = pressure
  [../]
  [./rho_dot]
    type = TimeDerivative
    variable = pressure
  [../]
  [./flux_to_porespace]
    type = DesorptionToPorespace
    variable = pressure
    conc_var = conc
  [../]
[]

[Postprocessors]
  [./mass_rho]
    type = ElementIntegralVariablePostprocessor
    block = 0
    variable = pressure
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./mass_conc]
    type = ElementIntegralVariablePostprocessor
    block = 0
    variable = conc
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./mass_tot]
    type = FunctionValuePostprocessor
    function = mass_fcn
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;0 0 0&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./c0]
    type = PointValue
    variable = conc
    point = &#x27;0 0 0&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Functions]
  [./mass_fcn]
    type = ParsedFunction
    value = a+b
    vars = &#x27;a b&#x27;
    vals = &#x27;mass_rho mass_conc&#x27;
  [../]
[]

[Materials]
  [./lang_stuff]
    type = MollifiedLangmuirMaterial
    block = 0
    one_over_desorption_time_const = 0.90909091
    one_over_adsorption_time_const = 0.90909091
    langmuir_density = 0.88
    langmuir_pressure = 1.23
    pressure_var = pressure
    conc_var = conc
    mollifier = 1E-4
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    #petsc_options = &#x27;-snes_test_display&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 0.01
  end_time = 2
[]
[Outputs]
  file_base = mollified_langmuir_desorption
  interval = 10
  exodus = true
  csv = 10
[] # Outputs
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="74a81db9-d169-42eb-818c-ed69045cac82"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mean_cap_TC/random03.i</h4><pre class="moose-pre"><code class="language-text"># apply many random large deformations, checking that the algorithm returns correctly to
# the yield surface each time.
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 125
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 125
  zmin = 0
  zmax = 1
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./max_yield_fcn]
    type = ElementExtremeValue
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./av_iter]
    type = ElementAverageValue
    variable = iter
    outputs = &#x27;console&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;max_yield_fcn&#x27;
  [../]
[]

[UserObjects]
  [./tensile_strength]
    type = TensorMechanicsHardeningCubic
    value_0 = 1
    value_residual = 0.1
    internal_limit = 0.1
  [../]
  [./compressive_strength]
    type = TensorMechanicsHardeningCubic
    value_0 = -1.5
    value_residual = 0
    internal_limit = 0.1
  [../]
  [./cap]
    type = TensorMechanicsPlasticMeanCapTC
    tensile_strength = tensile_strength
    compressive_strength = compressive_strength
    yield_function_tolerance = 1E-5
    internal_constraint_tolerance = 1E-11
    use_custom_returnMap = false
    use_custom_cto = false
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0.7E7 1E7&#x27;
  [../]
  [./strain]
    type = ComputeIncrementalSmallStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    max_NR_iterations = 2
    ep_plastic_tolerance = 1E-8
    plastic_models = cap
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random03
  exodus = false
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="10f4eac8-c3d6-496c-a301-2dac6930080f"><div class="modal-content"><h4>test/tests/postprocessors/geometry/2d_geometry.i</h4><pre class="moose-pre"><code class="language-text">radius = 0.5
inner_box_length = 2.2
outer_box_length = 3
sides = 16
alpha = ${fparse 2 * pi / ${sides}}
perimeter_correction = ${fparse alpha / 2 / sin(alpha / 2)}
area_correction = ${fparse alpha / sin(alpha)}

[Mesh]
  file = 2d.e
  construct_side_list_from_node_list = true
[]

[Variables]
  [./u]
    initial_condition = 1
    block = circle
  [../]
  [./v]
    initial_condition = 2
    block = &#x27;inside outside&#x27;
  [../]
[]

[Kernels]
  [./diff_u]
    type = Diffusion
    variable = u
  [../]
  [./diff_v]
    type = Diffusion
    variable = v
  [../]
[]

[BCs]
  [./circle]
    type = DirichletBC
    variable = u
    boundary = circle_side_wrt_inside
    value = 2
  [../]
  [./inner]
    type = DirichletBC
    variable = v
    boundary = circle_side_wrt_circle
    value = 4
  [../]
  [./outer]
    type = DirichletBC
    variable = v
    boundary = outside_side
    value = 6
  [../]
[]


[Executioner]
  type = Steady
[]

[Postprocessors]
  [./u_avg]
    type = ElementAverageValue
    variable = u
    block = circle
  [../]
  [./v_avg]
    type = ElementAverageValue
    variable = v
    block = &#x27;inside outside&#x27;
  [../]
  [./circle_perimeter_wrt_circle]
    type = AreaPostprocessor
    boundary = circle_side_wrt_circle
  [../]
  [./circle_perimeter_wrt_inside]
    type = AreaPostprocessor
    boundary = circle_side_wrt_inside
  [../]
  [./inside_perimeter_wrt_inside]
    type = AreaPostprocessor
    boundary = inside_side_wrt_inside
  [../]
  [./inside_perimeter_wrt_outside]
    type = AreaPostprocessor
    boundary = inside_side_wrt_outside
  [../]
  [./outside_perimeter]
    type = AreaPostprocessor
    boundary = outside_side
  [../]
  [./circle_area]
    type = VolumePostprocessor
    block = circle
  [../]
  [./inside_area]
    type = VolumePostprocessor
    block = inside
  [../]
  [./outside_area]
    type = VolumePostprocessor
    block = outside
  [../]
  [./total_area]
    type = VolumePostprocessor
    block = &#x27;circle inside outside&#x27;
  [../]

  [./circle_perimeter_exact]
    type = FunctionValuePostprocessor
    function = &#x27;circle_perimeter_exact&#x27;
  [../]
  [./inside_perimeter_exact]
    type = FunctionValuePostprocessor
    function = &#x27;inside_perimeter_exact&#x27;
  [../]
  [./outside_perimeter_exact]
    type = FunctionValuePostprocessor
    function = &#x27;outside_perimeter_exact&#x27;
  [../]
  [./circle_area_exact]
    type = FunctionValuePostprocessor
    function = &#x27;circle_area_exact&#x27;
  [../]
  [./inside_area_exact]
    type = FunctionValuePostprocessor
    function = &#x27;inside_area_exact&#x27;
  [../]
  [./outside_area_exact]
    type = FunctionValuePostprocessor
    function = &#x27;outside_area_exact&#x27;
  [../]
  [./total_area_exact]
    type = FunctionValuePostprocessor
    function = &#x27;total_area_exact&#x27;
  [../]
[]

[Functions]
  [./circle_perimeter_exact]
    type = ParsedFunction
    value = &#x27;2 * pi * ${radius} / ${perimeter_correction}&#x27;
  [../]
  [./inside_perimeter_exact]
    type = ParsedFunction
    value = &#x27;${inner_box_length} * 4&#x27;
  [../]
  [./outside_perimeter_exact]
    type = ParsedFunction
    value = &#x27;${outer_box_length} * 4&#x27;
  [../]
  [./circle_area_exact]
    type = ParsedFunction
    value = &#x27;pi * ${radius}^2 / ${area_correction}&#x27;
  [../]
  [./inside_area_exact]
    type = ParsedFunction
    value = &#x27;${inner_box_length}^2 - pi * ${radius}^2 / ${area_correction}&#x27;
  [../]
  [./outside_area_exact]
    type = ParsedFunction
    value = &#x27;${outer_box_length}^2 - ${inner_box_length}^2&#x27;
  [../]
  [./total_area_exact]
    type = ParsedFunction
    value = &#x27;${outer_box_length}^2&#x27;
  [../]

[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="68673489-7059-42d1-880c-7482a5c480bf"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh04.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1 1E1 1E2 1E3&#x27;
    x = &#x27;0 1E-1 1 1E1 1E2 1E3&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = -1E6
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 0
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1E3
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = bh04
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="87be9796-3655-4c1f-85a2-9fc0dc19ef17"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh01.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = false
# transient = false

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.4
    max = 0.6
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.4
    max = 1.6
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardsfgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
    outputs = none # no reason why mass should be conserved
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
    outputs = none # no reason why mass should be conserved
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres asm lu NONZERO 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh01
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ddf9700a-f648-4c14-9ebb-e3cb4d4da8d6"><div class="modal-content"><h4>test/tests/postprocessors/function_value_pps/function_value_pps.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  nx = 2
  ny = 2
[]

[AuxVariables]
  [./v]
  [../]
[]

[Variables]
  [./u]
  [../]
[]

[Functions]
  [./constant_func]
    type = ConstantFunction
    value = 2.798
  [../]
[]


[ICs]
  [./u_ic]
    type = ConstantIC
    variable = u
    value = 2
  [../]
[]

[AuxKernels]
  [./one]
    type = ConstantAux
    variable = v
    value = 1
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Postprocessors]
  [./value1]
    type = FunctionValuePostprocessor
    function = constant_func
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./value2]
    type = FunctionValuePostprocessor
    function = 2*t
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 5
[]

[Outputs]
  csv = true
[]

[Problem]
  solve = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="bf39309c-572f-419e-a8ee-fb58b37a4dfd"><div class="modal-content"><h4>modules/combined/test/tests/poro_mechanics/borehole_lowres.i</h4><pre class="moose-pre"><code class="language-text"># Poroelastic response of a borehole.
#
# LOWRES VERSION: this version does not give perfect agreement with the analytical solution
#
# A fully-saturated medium contains a fluid with a homogeneous porepressure,
# but an anisitropic insitu stress.  A infinitely-long borehole aligned with
# the $$z$$ axis is instanteously excavated.  The borehole boundary is
# stress-free and allowed to freely drain.  This problem is analysed using
# plane-strain conditions (no $$z$$ displacement).
#
# The solution in Laplace space is found in E Detournay and AHD Cheng &quot;Poroelastic response of a borehole in a non-hydrostatic stress field&quot;.  International Journal of Rock Mechanics and Mining Sciences and Geomechanics Abstracts 25 (1988) 171-182.  In the small-time limit, the Laplace transforms may be performed.  There is one typo in the paper.  Equation (A4)&#x27;s final term should be -(a/r)\sqrt(4ct/(a^2\pi)), and not +(a/r)\sqrt(4ct/(a^2\pi)).
#
# Because realistic parameters are chosen (below),
# the residual for porepressure is much smaller than
# the residuals for the displacements.  Therefore the
# scaling parameter is chosen.  Also note that the
# insitu stresses are effective stresses, not total
# stresses, but the solution in the above paper is
# expressed in terms of total stresses.
#
# Here are the problem&#x27;s parameters, and their values:
# Borehole radius.  a = 1
# Rock&#x27;s Lame lambda.  la = 0.5E9
# Rock&#x27;s Lame mu, which is also the Rock&#x27;s shear modulus.  mu = G = 1.5E9
# Rock bulk modulus.  K = la + 2*mu/3 = 1.5E9
# Drained Poisson ratio.  nu = (3K - 2G)/(6K + 2G) = 0.125
# Rock bulk compliance.  1/K = 0.66666666E-9
# Fluid bulk modulus.  Kf = 0.7171315E9
# Fluid bulk compliance.  1/Kf = 1.39444444E-9
# Rock initial porosity.  phi0 = 0.3
# Biot coefficient.  alpha = 0.65
# Biot modulus.  M = 1/(phi0/Kf + (alpha - phi0)(1 - alpha)/K) = 2E9
# Undrained bulk modulus. Ku = K + alpha^2*M = 2.345E9
# Undrained Poisson ratio.  nuu = (3Ku - 2G)/(6Ku + 2G) = 0.2364
# Skempton coefficient.  B = alpha*M/Ku = 0.554
# Fluid mobility (rock permeability/fluid viscosity).  k = 1E-12

[Mesh]
  type = FileMesh
  file = borehole_lowres_input.e
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  porepressure = porepressure
  block = 1
[]

[GlobalParams]
  volumetric_locking_correction=true
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
    scaling = 1E9  # Notice the scaling, to make porepressure&#x27;s kernels roughly of same magnitude as disp&#x27;s kernels
  [../]
[]

[ICs]
  [./initial_p]
    type = ConstantIC
    variable = porepressure
    value = 1E6
  [../]
[]

[BCs]
  [./fixed_outer_x]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = outer
  [../]
  [./fixed_outer_y]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = outer
  [../]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;zmin zmax&#x27;
  [../]
  [./borehole_wall]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = bh_wall
  [../]
[]



[AuxVariables]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./tot_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./tot_yy]
    type = ParsedAux
    args = &#x27;stress_yy porepressure&#x27;
    execute_on = timestep_end
    variable = tot_yy
    function = &#x27;stress_yy-0.65*porepressure&#x27;
  [../]
[]



[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PoroMechanicsCoupling
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PoroMechanicsCoupling
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PoroMechanicsCoupling
    variable = disp_z
    component = 2
  [../]
  [./poro_timederiv]
    type = PoroFullSatTimeDerivative
    variable = porepressure
  [../]
  [./darcy_flow]
    type = CoefDiffusion
    variable = porepressure
    coef = 1E-12
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0.5E9 1.5E9&#x27;
    # bulk modulus is lambda + 2*mu/3 = 0.5 + 2*1.5/3 = 1.5E9
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeFiniteStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    eigenstrain_names = ini_stress
  [../]
  [./ini_stress]
    type = ComputeEigenstrainFromInitialStress
    initial_stress = &#x27;-1.35E6 0 0  0 -3.35E6 0  0 0 0&#x27; # remember this is the effective stress
    eigenstrain_name = ini_stress
  [../]
  [./no_plasticity]
    type = ComputeFiniteStrainElasticStress
  [../]
  [./poro_material]
    type = PoroFullSatMaterial
    porosity0 = 0.3
    biot_coefficient = 0.65
    solid_bulk_compliance = 0.6666666666667E-9
    fluid_bulk_compliance = 1.3944444444444E-9
    constant_porosity = false
  [../]
[]

[Postprocessors]
  [./p00]
    type = PointValue
    variable = porepressure
    point = &#x27;1.00 0 0&#x27;
    outputs = csv_p
  [../]
  [./p01]
    type = PointValue
    variable = porepressure
    point = &#x27;1.01 0 0&#x27;
    outputs = csv_p
  [../]
  [./p02]
    type = PointValue
    variable = porepressure
    point = &#x27;1.02 0 0&#x27;
    outputs = csv_p
  [../]
  [./p03]
    type = PointValue
    variable = porepressure
    point = &#x27;1.03 0 0&#x27;
    outputs = csv_p
  [../]
  [./p04]
    type = PointValue
    variable = porepressure
    point = &#x27;1.04 0 0&#x27;
    outputs = csv_p
  [../]
  [./p05]
    type = PointValue
    variable = porepressure
    point = &#x27;1.05 0 0&#x27;
    outputs = csv_p
  [../]
  [./p06]
    type = PointValue
    variable = porepressure
    point = &#x27;1.06 0 0&#x27;
    outputs = csv_p
  [../]
  [./p07]
    type = PointValue
    variable = porepressure
    point = &#x27;1.07 0 0&#x27;
    outputs = csv_p
  [../]
  [./p08]
    type = PointValue
    variable = porepressure
    point = &#x27;1.08 0 0&#x27;
    outputs = csv_p
  [../]
  [./p09]
    type = PointValue
    variable = porepressure
    point = &#x27;1.09 0 0&#x27;
    outputs = csv_p
  [../]
  [./p10]
    type = PointValue
    variable = porepressure
    point = &#x27;1.10 0 0&#x27;
    outputs = csv_p
  [../]
  [./p11]
    type = PointValue
    variable = porepressure
    point = &#x27;1.11 0 0&#x27;
    outputs = csv_p
  [../]
  [./p12]
    type = PointValue
    variable = porepressure
    point = &#x27;1.12 0 0&#x27;
    outputs = csv_p
  [../]
  [./p13]
    type = PointValue
    variable = porepressure
    point = &#x27;1.13 0 0&#x27;
    outputs = csv_p
  [../]
  [./p14]
    type = PointValue
    variable = porepressure
    point = &#x27;1.14 0 0&#x27;
    outputs = csv_p
  [../]
  [./p15]
    type = PointValue
    variable = porepressure
    point = &#x27;1.15 0 0&#x27;
    outputs = csv_p
  [../]
  [./p16]
    type = PointValue
    variable = porepressure
    point = &#x27;1.16 0 0&#x27;
    outputs = csv_p
  [../]
  [./p17]
    type = PointValue
    variable = porepressure
    point = &#x27;1.17 0 0&#x27;
    outputs = csv_p
  [../]
  [./p18]
    type = PointValue
    variable = porepressure
    point = &#x27;1.18 0 0&#x27;
    outputs = csv_p
  [../]
  [./p19]
    type = PointValue
    variable = porepressure
    point = &#x27;1.19 0 0&#x27;
    outputs = csv_p
  [../]
  [./p20]
    type = PointValue
    variable = porepressure
    point = &#x27;1.20 0 0&#x27;
    outputs = csv_p
  [../]
  [./p21]
    type = PointValue
    variable = porepressure
    point = &#x27;1.21 0 0&#x27;
    outputs = csv_p
  [../]
  [./p22]
    type = PointValue
    variable = porepressure
    point = &#x27;1.22 0 0&#x27;
    outputs = csv_p
  [../]
  [./p23]
    type = PointValue
    variable = porepressure
    point = &#x27;1.23 0 0&#x27;
    outputs = csv_p
  [../]
  [./p24]
    type = PointValue
    variable = porepressure
    point = &#x27;1.24 0 0&#x27;
    outputs = csv_p
  [../]
  [./p25]
    type = PointValue
    variable = porepressure
    point = &#x27;1.25 0 0&#x27;
    outputs = csv_p
  [../]

  [./s00]
    type = PointValue
    variable = disp_x
    point = &#x27;1.00 0 0&#x27;
    outputs = csv_s
  [../]
  [./s01]
    type = PointValue
    variable = disp_x
    point = &#x27;1.01 0 0&#x27;
    outputs = csv_s
  [../]
  [./s02]
    type = PointValue
    variable = disp_x
    point = &#x27;1.02 0 0&#x27;
    outputs = csv_s
  [../]
  [./s03]
    type = PointValue
    variable = disp_x
    point = &#x27;1.03 0 0&#x27;
    outputs = csv_s
  [../]
  [./s04]
    type = PointValue
    variable = disp_x
    point = &#x27;1.04 0 0&#x27;
    outputs = csv_s
  [../]
  [./s05]
    type = PointValue
    variable = disp_x
    point = &#x27;1.05 0 0&#x27;
    outputs = csv_s
  [../]
  [./s06]
    type = PointValue
    variable = disp_x
    point = &#x27;1.06 0 0&#x27;
    outputs = csv_s
  [../]
  [./s07]
    type = PointValue
    variable = disp_x
    point = &#x27;1.07 0 0&#x27;
    outputs = csv_s
  [../]
  [./s08]
    type = PointValue
    variable = disp_x
    point = &#x27;1.08 0 0&#x27;
    outputs = csv_s
  [../]
  [./s09]
    type = PointValue
    variable = disp_x
    point = &#x27;1.09 0 0&#x27;
    outputs = csv_s
  [../]
  [./s10]
    type = PointValue
    variable = disp_x
    point = &#x27;1.10 0 0&#x27;
    outputs = csv_s
  [../]
  [./s11]
    type = PointValue
    variable = disp_x
    point = &#x27;1.11 0 0&#x27;
    outputs = csv_s
  [../]
  [./s12]
    type = PointValue
    variable = disp_x
    point = &#x27;1.12 0 0&#x27;
    outputs = csv_s
  [../]
  [./s13]
    type = PointValue
    variable = disp_x
    point = &#x27;1.13 0 0&#x27;
    outputs = csv_s
  [../]
  [./s14]
    type = PointValue
    variable = disp_x
    point = &#x27;1.14 0 0&#x27;
    outputs = csv_s
  [../]
  [./s15]
    type = PointValue
    variable = disp_x
    point = &#x27;1.15 0 0&#x27;
    outputs = csv_s
  [../]
  [./s16]
    type = PointValue
    variable = disp_x
    point = &#x27;1.16 0 0&#x27;
    outputs = csv_s
  [../]
  [./s17]
    type = PointValue
    variable = disp_x
    point = &#x27;1.17 0 0&#x27;
    outputs = csv_s
  [../]
  [./s18]
    type = PointValue
    variable = disp_x
    point = &#x27;1.18 0 0&#x27;
    outputs = csv_s
  [../]
  [./s19]
    type = PointValue
    variable = disp_x
    point = &#x27;1.19 0 0&#x27;
    outputs = csv_s
  [../]
  [./s20]
    type = PointValue
    variable = disp_x
    point = &#x27;1.20 0 0&#x27;
    outputs = csv_s
  [../]
  [./s21]
    type = PointValue
    variable = disp_x
    point = &#x27;1.21 0 0&#x27;
    outputs = csv_s
  [../]
  [./s22]
    type = PointValue
    variable = disp_x
    point = &#x27;1.22 0 0&#x27;
    outputs = csv_s
  [../]
  [./s23]
    type = PointValue
    variable = disp_x
    point = &#x27;1.23 0 0&#x27;
    outputs = csv_s
  [../]
  [./s24]
    type = PointValue
    variable = disp_x
    point = &#x27;1.24 0 0&#x27;
    outputs = csv_s
  [../]
  [./s25]
    type = PointValue
    variable = disp_x
    point = &#x27;1.25 0 0&#x27;
    outputs = csv_s
  [../]

  [./t00]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.00 0 0&#x27;
    outputs = csv_t
  [../]
  [./t01]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.01 0 0&#x27;
    outputs = csv_t
  [../]
  [./t02]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.02 0 0&#x27;
    outputs = csv_t
  [../]
  [./t03]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.03 0 0&#x27;
    outputs = csv_t
  [../]
  [./t04]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.04 0 0&#x27;
    outputs = csv_t
  [../]
  [./t05]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.05 0 0&#x27;
    outputs = csv_t
  [../]
  [./t06]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.06 0 0&#x27;
    outputs = csv_t
  [../]
  [./t07]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.07 0 0&#x27;
    outputs = csv_t
  [../]
  [./t08]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.08 0 0&#x27;
    outputs = csv_t
  [../]
  [./t09]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.09 0 0&#x27;
    outputs = csv_t
  [../]
  [./t10]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.10 0 0&#x27;
    outputs = csv_t
  [../]
  [./t11]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.11 0 0&#x27;
    outputs = csv_t
  [../]
  [./t12]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.12 0 0&#x27;
    outputs = csv_t
  [../]
  [./t13]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.13 0 0&#x27;
    outputs = csv_t
  [../]
  [./t14]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.14 0 0&#x27;
    outputs = csv_t
  [../]
  [./t15]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.15 0 0&#x27;
    outputs = csv_t
  [../]
  [./t16]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.16 0 0&#x27;
    outputs = csv_t
  [../]
  [./t17]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.17 0 0&#x27;
    outputs = csv_t
  [../]
  [./t18]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.18 0 0&#x27;
    outputs = csv_t
  [../]
  [./t19]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.19 0 0&#x27;
    outputs = csv_t
  [../]
  [./t20]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.20 0 0&#x27;
    outputs = csv_t
  [../]
  [./t21]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.21 0 0&#x27;
    outputs = csv_t
  [../]
  [./t22]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.22 0 0&#x27;
    outputs = csv_t
  [../]
  [./t23]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.23 0 0&#x27;
    outputs = csv_t
  [../]
  [./t24]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.24 0 0&#x27;
    outputs = csv_t
  [../]
  [./t25]
    type = PointValue
    variable = tot_yy
    point = &#x27;1.25 0 0&#x27;
    outputs = csv_t
  [../]

  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = 2*t
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_monitor -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it -sub_pc_type -sub_pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;gmres asm 1E0 1E-10 200 500 lu NONZERO&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 0.3
  dt = 0.3
  #[./TimeStepper]
  #  type = PostprocessorDT
  #  postprocessor = dt
  #  dt = 0.003
  #[../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = borehole_lowres
  exodus = true
  sync_times = &#x27;0.003 0.3&#x27;
  [./csv_p]
    file_base = borehole_lowres_p
    type = CSV
  [../]
  [./csv_s]
    file_base = borehole_lowres_s
    type = CSV
  [../]
  [./csv_t]
    file_base = borehole_lowres_t
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e1dbba57-82ff-4885-a3f7-eb5209f42652"><div class="modal-content"><h4>examples/ex18_scalar_kernel/ex18_parsed.i</h4><pre class="moose-pre"><code class="language-text">#
# Example 18 modified to use parsed ODE kernels.
#
# The ParsedODEKernel takes function expressions in the input file and computes
# Jacobian entries via automatic differentiation. It allows for rapid development
# of new models without the need for code recompilation.
#
# This input file should produce the exact same result as ex18.i
#

[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  nx = 10
  ny = 10
  elem_type = QUAD4
[]

[Functions]
  # ODEs
  [./exact_x_fn]
    type = ParsedFunction
    value = (-1/3)*exp(-t)+(4/3)*exp(5*t)
  [../]
  [./exact_y_fn]
    type = ParsedFunction
    value = (2/3)*exp(-t)+(4/3)*exp(5*t)
  [../]
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]

  # ODE variables
  [./x]
    family = SCALAR
    order = FIRST
    initial_condition = 1
  [../]
  [./y]
    family = SCALAR
    order = FIRST
    initial_condition = 2
  [../]

[]

[Kernels]
  [./td]
    type = TimeDerivative
    variable = diffused
  [../]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[ScalarKernels]
  [./td1]
    type = ODETimeDerivative
    variable = x
  [../]

  #
  # This parsed expression ODE Kernel behaves exactly as the ImplicitODEx kernel
  # in the main example. Checkout ImplicitODEx::computeQpResidual() in the
  # source code file ImplicitODEx.C to see the matching residual function.
  #
  # The ParsedODEKernel automaticaly generates the On- and Off-Diagonal Jacobian
  # entries.
  #
  [./ode1]
    type = ParsedODEKernel
    function = &#x27;-3*x - 2*y&#x27;
    variable = x
    args = y
  [../]

  [./td2]
    type = ODETimeDerivative
    variable = y
  [../]

  #
  # This parsed expression ODE Kernel behaves exactly as the ImplicitODEy Kernel
  # in the main example.
  #
  [./ode2]
    type = ParsedODEKernel
    function = &#x27;-4*x - y&#x27;
    variable = y
    args = x
  [../]
[]


[BCs]
  [./right]
    type = ScalarDirichletBC
    variable = diffused
    boundary = 1
    scalar_var = x
  [../]

  [./left]
    type = ScalarDirichletBC
    variable = diffused
    boundary = 3
    scalar_var = y
  [../]
[]

[Postprocessors]
  # to print the values of x, y into a file so we can plot it
  [./x]
    type = ScalarVariable
    variable = x
    execute_on = timestep_end
  [../]
  [./y]
    type = ScalarVariable
    variable = y
    execute_on = timestep_end
  [../]

  [./exact_x]
    type = FunctionValuePostprocessor
    function = exact_x_fn
    execute_on = timestep_end
  [../]

  [./exact_y]
    type = FunctionValuePostprocessor
    function = exact_y_fn
    execute_on = timestep_end
    point = &#x27;0 0 0&#x27;
  [../]

  # Measure the error in ODE solution for &#x27;x&#x27;.
  [./l2err_x]
    type = ScalarL2Error
    variable = x
    function = exact_x_fn
  [../]

  # Measure the error in ODE solution for &#x27;y&#x27;.
  [./l2err_y]
    type = ScalarL2Error
    variable = y
    function = exact_y_fn
  [../]
[]


[Executioner]
  type = Transient
  start_time = 0
  dt = 0.01
  num_steps = 10
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  file_base = &#x27;ex18_out&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="60b0703a-fe79-47f4-b53e-cc412345700b"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/rom_stress_update/verification.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 3
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[AuxVariables]
  [./temperature]
  [../]
[]

[AuxKernels]
  [./temp_aux]
    type = FunctionAux
    variable = temperature
    function = temp_fcn
    execute_on = &#x27;initial timestep_begin&#x27;
  [../]
[]

[Functions]
  [./rhom_fcn]
    type = PiecewiseConstant
    data_file = ss316_verification_data.csv
    x_index_in_file = 0
    y_index_in_file = 1
    format = columns
    xy_in_file_only = false
    direction = right
  [../]
  [./rhoi_fcn]
    type = PiecewiseConstant
    data_file = ss316_verification_data.csv
    x_index_in_file = 0
    y_index_in_file = 2
    format = columns
    xy_in_file_only = false
    direction = right
  [../]
  [./vmJ2_fcn]
    type = PiecewiseConstant
    data_file = ss316_verification_data.csv
    x_index_in_file = 0
    y_index_in_file = 3
    format = columns
    xy_in_file_only = false
    direction = right
  [../]
  [./evm_fcn]
    type = PiecewiseConstant
    data_file = ss316_verification_data.csv
    x_index_in_file = 0
    y_index_in_file = 4
    format = columns
    xy_in_file_only = false
    direction = right
  [../]
  [./temp_fcn]
    type = PiecewiseConstant
    data_file = ss316_verification_data.csv
    x_index_in_file = 0
    y_index_in_file = 5
    format = columns
    xy_in_file_only = false
    direction = right
  [../]

  [./rhom_soln_fcn]
    type = PiecewiseConstant
    data_file = ss316_verification_data.csv
    x_index_in_file = 0
    y_index_in_file = 7
    format = columns
    xy_in_file_only = false
    direction = right
  [../]
  [./rhoi_soln_fcn]
    type = PiecewiseConstant
    data_file = ss316_verification_data.csv
    x_index_in_file = 0
    y_index_in_file = 8
    format = columns
    xy_in_file_only = false
    direction = right
  [../]
  [./creep_rate_soln_fcn]
    type = PiecewiseConstant
    data_file = ss316_verification_data.csv
    x_index_in_file = 0
    y_index_in_file = 10
    format = columns
    xy_in_file_only = false
    direction = right
  [../]

  [./rhom_diff_fcn]
    type = ParsedFunction
    vars = &#x27;rhom_soln rhom&#x27;
    vals = &#x27;rhom_soln rhom&#x27;
    value = &#x27;abs(rhom_soln - rhom) / rhom_soln&#x27;
  [../]
  [./rhoi_diff_fcn]
    type = ParsedFunction
    vars = &#x27;rhoi_soln rhoi&#x27;
    vals = &#x27;rhoi_soln rhoi&#x27;
    value = &#x27;abs(rhoi_soln - rhoi) / rhoi_soln&#x27;
  [../]
  [./creep_rate_diff_fcn]
    type = ParsedFunction
    vars = &#x27;creep_rate_soln creep_rate&#x27;
    vals = &#x27;creep_rate_soln creep_rate&#x27;
    value = &#x27;abs(creep_rate_soln - creep_rate) / creep_rate_soln&#x27;
  [../]
[]


[Modules/TensorMechanics/Master]
  [./all]
    strain = FINITE
    add_variables = true
    generate_output = &#x27;vonmises_stress&#x27;
    use_automatic_differentiation = true
  [../]
[]

[BCs]
  [./symmx]
    type = ADDirichletBC
    variable = disp_x
    boundary = left
    value = 0
  [../]
  [./symmy]
    type = ADDirichletBC
    variable = disp_y
    boundary = bottom
    value = 0
  [../]
  [./symmz]
    type = ADDirichletBC
    variable = disp_z
    boundary = back
    value = 0
  [../]
  [./pressure_x]
    type = ADPressure
    variable = disp_x
    component = 0
    boundary = right
    function = vmJ2_fcn
    constant = 0.5e6
  [../]
  [./pressure_y]
    type = ADPressure
    variable = disp_y
    component = 1
    boundary = top
    function = vmJ2_fcn
    constant = -0.5e6
  [../]
  [./pressure_z]
    type = ADPressure
    variable = disp_z
    component = 2
    boundary = front
    function = vmJ2_fcn
    constant = -0.5e6
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 1e11
    poissons_ratio = 0.3
  [../]
  [./stress]
    type = ADComputeMultipleInelasticStress
    inelastic_models = rom_stress_prediction
  [../]
  [./rom_stress_prediction]
    type = SS316HLAROMANCEStressUpdateTest
    temperature = temperature
    effective_inelastic_strain_name = effective_creep_strain
    internal_solve_full_iteration_history = true
    outputs = all
    wall_dislocation_density_forcing_function = rhoi_fcn
    cell_dislocation_density_forcing_function = rhom_fcn
    old_creep_strain_forcing_function = evm_fcn
  [../]
[]

[Executioner]
  type = Transient

  solve_type = &#x27;NEWTON&#x27;

  petsc_options = &#x27;-snes_ksp_ew -snes_converged_reason -ksp_converged_reason&#x27;# -ksp_error_if_not_converged -snes_error_if_not_converged&#x27;
  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
  line_search = &#x27;none&#x27;
  automatic_scaling = true
  compute_scaling_once = false

  nl_abs_tol = 1e-10

  dt = 1e-3
  end_time = 1e-2
[]

[Postprocessors]
  [./effective_strain_avg]
    type = ElementAverageValue
    variable = effective_creep_strain
    outputs = console
  [../]
  [./temperature]
    type = ElementAverageValue
    variable = temperature
    outputs = console
  [../]
  [./rhom]
    type = ElementAverageValue
    variable = cell_dislocations
  [../]
  [./rhoi]
    type = ElementAverageValue
    variable = wall_dislocations
  [../]
  [./vonmises_stress]
    type = ElementAverageValue
    variable = vonmises_stress
    outputs = console
  [../]
  [./creep_rate]
    type = ElementAverageValue
    variable = creep_rate
  [../]
  [./rhom_in]
    type = FunctionValuePostprocessor
    function = rhom_fcn
    execute_on = &#x27;TIMESTEP_END initial&#x27;
    outputs = console
  [../]
  [./rhoi_in]
    type = FunctionValuePostprocessor
    function = rhoi_fcn
    execute_on = &#x27;TIMESTEP_END initial&#x27;
    outputs = console
  [../]
  [./vmJ2_in]
    type = FunctionValuePostprocessor
    function = vmJ2_fcn
    execute_on = &#x27;TIMESTEP_END initial&#x27;
    outputs = console
  [../]
  [./rhom_soln]
    type = FunctionValuePostprocessor
    function = rhom_soln_fcn
    outputs = console
  [../]
  [./rhoi_soln]
    type = FunctionValuePostprocessor
    function = rhoi_soln_fcn
    outputs = console
  [../]
  [./creep_rate_soln]
    type = FunctionValuePostprocessor
    function = creep_rate_soln_fcn
    outputs = console
  [../]

  [./rhom_diff]
    type = FunctionValuePostprocessor
    function = rhom_diff_fcn
    outputs = console
  [../]
  [./rhoi_diff]
    type = FunctionValuePostprocessor
    function = rhoi_diff_fcn
    outputs = console
  [../]
  [./creep_rate_diff]
    type = FunctionValuePostprocessor
    function = creep_rate_diff_fcn
    outputs = console
  [../]

  [./rhom_max_diff]
    type = TimeExtremeValue
    postprocessor = rhom_diff
    outputs = console
  [../]
  [./rhoi_max_diff]
    type = TimeExtremeValue
    postprocessor = rhoi_diff
    outputs = console
  [../]
  [./creep_rate_max_diff]
    type = TimeExtremeValue
    postprocessor = creep_rate_diff
    outputs = console
  [../]
[]

[Outputs]
  csv = true
  file_base = &#x27;verification_1e-3_out&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="86b8ffb9-ae37-4161-ae1c-bb691429ec0c"><div class="modal-content"><h4>examples/ex18_scalar_kernel/ex18.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  nx = 10
  ny = 10
  elem_type = QUAD4
[]

[Functions]
  # ODEs
  [./exact_x_fn]
    type = ParsedFunction
    value = (-1/3)*exp(-t)+(4/3)*exp(5*t)
  [../]
  [./exact_y_fn]
    type = ParsedFunction
    value = (2/3)*exp(-t)+(4/3)*exp(5*t)
  [../]
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]

  # ODE variables
  [./x]
    family = SCALAR
    order = FIRST
    initial_condition = 1
  [../]
  [./y]
    family = SCALAR
    order = FIRST
    initial_condition = 2
  [../]

[]

[Kernels]
  [./td]
    type = TimeDerivative
    variable = diffused
  [../]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[ScalarKernels]
  [./td1]
    type = ODETimeDerivative
    variable = x
  [../]
  [./ode1]
    type = ImplicitODEx
    variable = x
    y = y
  [../]

  [./td2]
    type = ODETimeDerivative
    variable = y
  [../]
  [./ode2]
    type = ImplicitODEy
    variable = y
    x = x
  [../]
[]


[BCs]
  [./right]
    type = ScalarDirichletBC
    variable = diffused
    boundary = 1
    scalar_var = x
  [../]

  [./left]
    type = ScalarDirichletBC
    variable = diffused
    boundary = 3
    scalar_var = y
  [../]
[]

[Postprocessors]
  # to print the values of x, y into a file so we can plot it
  [./x]
    type = ScalarVariable
    variable = x
    execute_on = timestep_end
  [../]

  [./y]
    type = ScalarVariable
    variable = y
    execute_on = timestep_end
  [../]

  [./exact_x]
    type = FunctionValuePostprocessor
    function = exact_x_fn
    execute_on = timestep_end
    point = &#x27;0 0 0&#x27;
  [../]

  [./exact_y]
    type = FunctionValuePostprocessor
    function = exact_y_fn
    execute_on = timestep_end
    point = &#x27;0 0 0&#x27;
  [../]

  # Measure the error in ODE solution for &#x27;x&#x27;.
  [./l2err_x]
    type = ScalarL2Error
    variable = x
    function = exact_x_fn
  [../]

  # Measure the error in ODE solution for &#x27;y&#x27;.
  [./l2err_y]
    type = ScalarL2Error
    variable = y
    function = exact_y_fn
  [../]
[]


[Executioner]
  type = Transient
  start_time = 0
  dt = 0.01
  num_steps = 10

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9c48a23d-53a9-48a5-a314-782cc3cd912f"><div class="modal-content"><h4>modules/combined/examples/phase_field-mechanics/kks_mechanics_KHS.i</h4><pre class="moose-pre"><code class="language-text"># KKS phase-field model coupled with elasticity using Khachaturyan&#x27;s scheme as
# described in L.K. Aagesen et al., Computational Materials Science, 140, 10-21 (2017)
# Original run #170403a

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 640
  ny = 1
  nz = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.03125
  zmin = 0
  zmax = 0.03125
  elem_type = HEX8
[]


[Variables]
  # order parameter
  [./eta]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute concentration
  [./c]
    order = FIRST
    family = LAGRANGE
  [../]

  # chemical potential
  [./w]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute phase concentration (matrix)
  [./cm]
    order = FIRST
    family = LAGRANGE
  [../]
  # solute phase concentration (precipitate)
  [./cp]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_x]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_y]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_z]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./eta_ic]
    variable = eta
    type = FunctionIC
    function = ic_func_eta
    block = 0
  [../]
  [./c_ic]
    variable = c
    type = FunctionIC
    function = ic_func_c
    block = 0
  [../]
  [./w_ic]
    variable = w
    type = ConstantIC
    value = 0.00991
    block = 0
  [../]
  [./cm_ic]
    variable = cm
    type = ConstantIC
    value = 0.131
    block = 0
  [../]
  [./cp_ic]
    variable = cp
    type = ConstantIC
    value = 0.236
    block = 0
  [../]
[]

[Functions]
  [./ic_func_eta]
    type = ParsedFunction
    value = &#x27;0.5*(1.0+tanh((x)/delta_eta/sqrt(2.0)))&#x27;
    vars = &#x27;delta_eta&#x27;
    vals = &#x27;0.8034&#x27;
  [../]
  [./ic_func_c]
    type = ParsedFunction
    value = &#x27;0.2389*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^3*(6*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^2-15*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))+10)+0.1339*(1-(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^3*(6*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^2-15*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))+10))&#x27;
    vars = &#x27;delta&#x27;
    vals = &#x27;0.8034&#x27;
  [../]
  [./psi_eq_int]
    type = ParsedFunction
    value = &#x27;volume*psi_alpha&#x27;
    vars = &#x27;volume psi_alpha&#x27;
    vals = &#x27;volume psi_alpha&#x27;
  [../]
  [./gamma]
    type = ParsedFunction
    value = &#x27;(psi_int - psi_eq_int) / dy / dz&#x27;
    vars = &#x27;psi_int psi_eq_int dy       dz&#x27;
    vals = &#x27;psi_int psi_eq_int 0.03125  0.03125&#x27;
  [../]
[]

[AuxVariables]
  [./sigma11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./sigma22]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./sigma33]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e12]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e22]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e33]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e_el11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e_el12]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e_el22]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f_el]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./eigen_strain00]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./Fglobal]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./psi]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./matl_sigma11]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
    variable = sigma11
  [../]
  [./matl_sigma22]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 1
    index_j = 1
    variable = sigma22
  [../]
  [./matl_sigma33]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    variable = sigma33
  [../]
  [./matl_e11]
    type = RankTwoAux
    rank_two_tensor = total_strain
    index_i = 0
    index_j = 0
    variable = e11
  [../]
  [./f_el]
    type = MaterialRealAux
    variable = f_el
    property = f_el_mat
    execute_on = timestep_end
  [../]
  [./GlobalFreeEnergy]
    variable = Fglobal
    type = KKSGlobalFreeEnergy
    fa_name = fm
    fb_name = fp
    w = 0.0264
    kappa_names = kappa
    interfacial_vars = eta
  [../]
  [./psi_potential]
    variable = psi
    type = ParsedAux
    args = &#x27;Fglobal w c f_el sigma11 e11&#x27;
    function = &#x27;Fglobal - w*c + f_el - sigma11*e11&#x27;
  [../]
[]


[BCs]
  [./left_x]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0
  [../]
  [./right_x]
    type = DirichletBC
    variable = disp_x
    boundary = right
    value = 0
  [../]
  [./front_y]
    type = DirichletBC
    variable = disp_y
    boundary = front
    value = 0
  [../]
  [./back_y]
    type = DirichletBC
    variable = disp_y
    boundary = back
    value = 0
  [../]
  [./top_z]
    type = DirichletBC
    variable = disp_z
    boundary = top
    value = 0
  [../]
  [./bottom_z]
    type = DirichletBC
    variable = disp_z
    boundary = bottom
    value = 0
  [../]
[]

[Materials]
  # Chemical free energy of the matrix
  [./fm]
    type = DerivativeParsedMaterial
    f_name = fm
    args = &#x27;cm&#x27;
    function = &#x27;6.55*(cm-0.13)^2&#x27;
  [../]

  # Chemical Free energy of the precipitate phase
  [./fp]
    type = DerivativeParsedMaterial
    f_name = fp
    args = &#x27;cp&#x27;
    function = &#x27;6.55*(cp-0.235)^2&#x27;
  [../]

# Elastic energy of the precipitate
  [./elastic_free_energy_p]
    type = ElasticEnergyMaterial
    f_name = f_el_mat
    args = &#x27;eta&#x27;
    outputs = exodus
  [../]


  # h(eta)
  [./h_eta]
    type = SwitchingFunctionMaterial
    h_order = HIGH
    eta = eta
  [../]

  # 1- h(eta), putting in function explicitly
  [./one_minus_h_eta_explicit]
    type = DerivativeParsedMaterial
    f_name = one_minus_h_explicit
    args = eta
    function = 1-eta^3*(6*eta^2-15*eta+10)
    outputs = exodus
  [../]

  # g(eta)
  [./g_eta]
    type = BarrierFunctionMaterial
    g_order = SIMPLE
    eta = eta
  [../]

  # constant properties
  [./constants]
    type = GenericConstantMaterial
    prop_names  = &#x27;M   L   kappa      misfit&#x27;
    prop_values = &#x27;0.7 0.7 0.01704    0.00377&#x27;
  [../]

  #Mechanical properties
  [./Stiffness_matrix]
    type = ComputeElasticityTensor
    base_name = C_matrix
    C_ijkl = &#x27;103.3 74.25 74.25 103.3 74.25 103.3 46.75 46.75 46.75&#x27;
    fill_method = symmetric9
  [../]
  [./Stiffness_ppt]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;100.7 71.45 71.45 100.7 71.45 100.7 50.10 50.10 50.10&#x27;
    base_name = C_ppt
    fill_method = symmetric9
  [../]
  [./C]
    type = CompositeElasticityTensor
    args = eta
    tensors = &#x27;C_matrix               C_ppt&#x27;
    weights = &#x27;one_minus_h_explicit   h&#x27;
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./strain]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    eigenstrain_names = &#x27;eigenstrain_ppt&#x27;
  [../]
  [./eigen_strain]
    type = ComputeVariableEigenstrain
    eigen_base = &#x27;0.00377 0.00377 0.00377 0 0 0&#x27;
    prefactor = h
    args = eta
    eigenstrain_name = &#x27;eigenstrain_ppt&#x27;
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]

  # enforce c = (1-h(eta))*cm + h(eta)*cp
  [./PhaseConc]
    type = KKSPhaseConcentration
    ca       = cm
    variable = cp
    c        = c
    eta      = eta
  [../]

  # enforce pointwise equality of chemical potentials
  [./ChemPotVacancies]
    type = KKSPhaseChemicalPotential
    variable = cm
    cb       = cp
    fa_name  = fm
    fb_name  = fp
  [../]

  #
  # Cahn-Hilliard Equation
  #
  [./CHBulk]
    type = KKSSplitCHCRes
    variable = c
    ca       = cm
    fa_name  = fm
    w        = w
  [../]

  [./dcdt]
    type = CoupledTimeDerivative
    variable = w
    v = c
  [../]
  [./ckernel]
    type = SplitCHWRes
    mob_name = M
    variable = w
  [../]

  #
  # Allen-Cahn Equation
  #
  [./ACBulkF]
    type = KKSACBulkF
    variable = eta
    fa_name  = fm
    fb_name  = fp
    w        = 0.0264
    args = &#x27;cp cm&#x27;
  [../]
  [./ACBulkC]
    type = KKSACBulkC
    variable = eta
    ca       = cm
    cb       = cp
    fa_name  = fm
  [../]
  [./ACBulk_el] #This adds df_el/deta for strain interpolation
    type = AllenCahn
    variable = eta
    f_name = f_el_mat
  [../]
  [./ACInterface]
    type = ACInterface
    variable = eta
    kappa_name = kappa
  [../]
  [./detadt]
    type = TimeDerivative
    variable = eta
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -sub_pc_type   -sub_pc_factor_shift_type&#x27;
  petsc_options_value = &#x27;asm       ilu            nonzero&#x27;

  l_max_its = 30
  nl_max_its = 10
  l_tol = 1.0e-4
  nl_rel_tol = 1.0e-8
  nl_abs_tol = 1.0e-11
  num_steps = 200

  [./TimeStepper]
    type = SolutionTimeAdaptiveDT
    dt = 0.5
  [../]
[]

[Postprocessors]
  [./f_el_int]
    type = ElementIntegralMaterialProperty
    mat_prop = f_el_mat
  [../]
  [./c_alpha]
    type =  SideAverageValue
    boundary = left
    variable = c
  [../]
  [./c_beta]
    type =  SideAverageValue
    boundary = right
    variable = c
  [../]
  [./e11_alpha]
    type =  SideAverageValue
    boundary = left
    variable = e11
  [../]
  [./e11_beta]
    type =  SideAverageValue
    boundary = right
    variable = e11
  [../]
  [./s11_alpha]
    type =  SideAverageValue
    boundary = left
    variable = sigma11
  [../]
  [./s22_alpha]
    type =  SideAverageValue
    boundary = left
    variable = sigma22
  [../]
  [./s33_alpha]
    type =  SideAverageValue
    boundary = left
    variable = sigma33
  [../]
  [./s11_beta]
    type =  SideAverageValue
    boundary = right
    variable = sigma11
  [../]
  [./s22_beta]
    type =  SideAverageValue
    boundary = right
    variable = sigma22
  [../]
  [./s33_beta]
    type =  SideAverageValue
    boundary = right
    variable = sigma33
  [../]
  [./f_el_alpha]
    type =  SideAverageValue
    boundary = left
    variable = f_el
  [../]
  [./f_el_beta]
    type =  SideAverageValue
    boundary = right
    variable = f_el
  [../]
  [./f_c_alpha]
    type =  SideAverageValue
    boundary = left
    variable = Fglobal
  [../]
  [./f_c_beta]
    type =  SideAverageValue
    boundary = right
    variable = Fglobal
  [../]
  [./chem_pot_alpha]
    type =  SideAverageValue
    boundary = left
    variable = w
  [../]
  [./chem_pot_beta]
    type =  SideAverageValue
    boundary = right
    variable = w
  [../]
  [./psi_alpha]
    type =  SideAverageValue
    boundary = left
    variable = psi
  [../]
  [./psi_beta]
    type =  SideAverageValue
    boundary = right
    variable = psi
  [../]
  [./total_energy]
    type = ElementIntegralVariablePostprocessor
    variable = Fglobal
  [../]
  # Get simulation cell size from postprocessor
  [./volume]
    type = ElementIntegralMaterialProperty
    mat_prop = 1
  [../]
  [./psi_eq_int]
    type = FunctionValuePostprocessor
    function = psi_eq_int
  [../]
  [./psi_int]
    type = ElementIntegralVariablePostprocessor
    variable = psi
  [../]
  [./gamma]
    type = FunctionValuePostprocessor
    function = gamma
  [../]
  [./int_position]
    type = FindValueOnLine
    start_point = &#x27;-10 0 0&#x27;
    end_point = &#x27;10 0 0&#x27;
    v = eta
    target = 0.5
  [../]
[]

#
# Precondition using handcoded off-diagonal terms
#
[Preconditioning]
  [./full]
    type = SMP
    full = true
  [../]
[]


[Outputs]
  [./exodus]
    type = Exodus
    interval = 20
  [../]
  checkpoint = true
  [./csv]
    type = CSV
    execute_on = &#x27;final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ff05e4d9-00bf-4964-a952-7eeb4d860eb0"><div class="modal-content"><h4>test/tests/time_steppers/iteration_adaptive/adapt_tstep_pps_lim.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 50
  ny = 2
  xmax = 5
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Functions]
  [./timestep_fn]
    type = PiecewiseLinear
    x = &#x27;0.  40.&#x27;
    y = &#x27;10. 1. &#x27;
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./dt]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 10
  [../]
  [./right]
    type = NeumannBC
    variable = u
    boundary = right
    value = -1
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  start_time = 0.0
  end_time = 40.0
  n_startup_steps = 2
  dtmax = 6.0
  [./TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 10
    timestep_limiting_postprocessor = timestep_pp
    dt = 1.0
  [../]
[]

[Postprocessors]
  [./_dt]
    type = TimestepSize
  [../]

# Just use a simple postprocessor to test capability to limit the time step length to the postprocessor value
  [./timestep_pp]
    type = FunctionValuePostprocessor
    function = timestep_fn
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
  checkpoint = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b67cf2e6-dfbb-4778-a933-611eae228ab6"><div class="modal-content"><h4>test/tests/functions/vector_postprocessor_function/vpp_time_interpolation.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 1
[]

[Problem]
  kernel_coverage_check = false
[]

[Variables][dummy][][]

[Functions]
  [./interpolate_vpp]
    type = VectorPostprocessorFunction
    vectorpostprocessor_name = read_data
    argument_column = time
    value_column = value
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 5
[]

[Postprocessors]
  [./check_value]
    type = FunctionValuePostprocessor
    function = interpolate_vpp
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  [../]
[]

[VectorPostprocessors]
  [./read_data]
    type = CSVReader
    csv_file = time_data.csv
    force_preaux = true # necessary so that vpp data exists to interpolate on step 0
    outputs = none
  [../]
[]

[Outputs]
  csv = true # write out FunctionValuePostprocessor results for comparison
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4ada25a0-4a95-4826-a8f3-37b6cd15e088"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/tensile/random_update.i</h4><pre class="moose-pre"><code class="language-text"># Plasticity models:
# Planar tensile with strength = 1MPa
#
# Lame lambda = 1GPa.  Lame mu = 1.3GPa
#
# A line of elements is perturbed randomly, and return to the yield surface at each quadpoint is checked

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 1234
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 1234
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Modules/TensorMechanics/Master]
  [./all]
    add_variables = true
    incremental = true
    strain = finite
    generate_output = &#x27;stress_xx stress_xy stress_xz stress_yy stress_yz stress_zz&#x27;
  [../]
[]

[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./f0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f2]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./int0]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./f0]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = f0
  [../]
  [./f1]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 1
    variable = f1
  [../]
  [./f2]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 2
    variable = f2
  [../]
  [./int0]
    type = MaterialStdVectorAux
    property = plastic_internal_parameter
    factor = 1E6
    index = 0
    variable = int0
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./tot_iters]
    type = ElementIntegralMaterialProperty
    mat_prop = plastic_NR_iterations
    outputs = console
  [../]
  [./raw_f0]
    type = ElementExtremeValue
    variable = f0
    outputs = console
  [../]
  [./raw_f1]
    type = ElementExtremeValue
    variable = f1
    outputs = console
  [../]
  [./raw_f2]
    type = ElementExtremeValue
    variable = f2
    outputs = console
  [../]
  [./iter]
    type = ElementExtremeValue
    variable = iter
    outputs = console
  [../]
  [./f0]
    type = FunctionValuePostprocessor
    function = should_be_zero0_fcn
  [../]
  [./f1]
    type = FunctionValuePostprocessor
    function = should_be_zero1_fcn
  [../]
  [./f2]
    type = FunctionValuePostprocessor
    function = should_be_zero2_fcn
  [../]
[]

[Functions]
  [./should_be_zero0_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f0&#x27;
  [../]
  [./should_be_zero1_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f1&#x27;
  [../]
  [./should_be_zero2_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-1,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;raw_f2&#x27;
  [../]
[]

[UserObjects]
  [./ts]
    type = TensorMechanicsHardeningCubic
    value_0 = 1E6
    value_residual = 0
    internal_limit = 1
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;1E9 1.3E9&#x27;
  [../]
  [./tensile]
    type = TensileStressUpdate
    tensile_strength = ts
    smoothing_tol = 1E5
    max_NR_iterations = 100
    yield_function_tol = 1.0E-1
  [../]
  [./stress]
    type = ComputeMultipleInelasticStress
    inelastic_models = tensile
    perform_finite_strain_rotations = false
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random_update
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1ecfb1c5-314b-43b7-b706-02fe4f4cf280"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh04.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = true
# transient = false

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  # get nonconvergence if initial condition is too crazy
  [./water_ic]
    type = FunctionIC
    function = &#x27;1-x/2&#x27;
    variable = pwater
  [../]
  [./gas_ic]
    type = FunctionIC
    function = &#x27;4-x/5&#x27;
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardsfgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres asm lu NONZERO 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh04
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3d9c24e3-8f5d-4d1b-b5b7-971b8ae62ff1"><div class="modal-content"><h4>test/tests/kernels/ode/ode_sys_impl_test.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  nx = 2
  ny = 2
  elem_type = QUAD4
[]

[Functions]
  [./f_fn]
    type = ParsedFunction
    value = -4
  [../]
  [./bc_all_fn]
    type = ParsedFunction
    value = x*x+y*y
  [../]

  # ODEs
  [./exact_x_fn]
    type = ParsedFunction
    value = (-1/3)*exp(-t)+(4/3)*exp(5*t)
  [../]
[]

# NL

[Variables]
  [./u]
    family = LAGRANGE
    order = FIRST
  [../]

  # ODE variables
  [./x]
    family = SCALAR
    order = FIRST
    initial_condition = 1
  [../]
  [./y]
    family = SCALAR
    order = FIRST
    initial_condition = 2
  [../]
[]

[Kernels]
  [./td]
    type = TimeDerivative
    variable = u
  [../]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./uff]
    type = BodyForce
    variable = u
    function = f_fn
  [../]
[]

[ScalarKernels]
  [./td1]
    type = ODETimeDerivative
    variable = x
  [../]
  [./ode1]
    type = ImplicitODEx
    variable = x
    y = y
  [../]

  [./td2]
    type = ODETimeDerivative
    variable = y
  [../]
  [./ode2]
    type = ImplicitODEy
    variable = y
    x = x
  [../]
[]

[BCs]
  [./all]
    type = FunctionDirichletBC
    variable = u
    boundary = &#x27;0 1 2 3&#x27;
    function = bc_all_fn
  [../]
[]

[Postprocessors]
  active = &#x27;exact_x l2err_x x y&#x27;

  [./x]
    type = ScalarVariable
    variable = x
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./y]
    type = ScalarVariable
    variable = y
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./exact_x]
    type = FunctionValuePostprocessor
    function = exact_x_fn
    execute_on = &#x27;initial timestep_end&#x27;
    point = &#x27;0 0 0&#x27;
  [../]

  [./l2err_x]
    type = ScalarL2Error
    variable = x
    function = exact_x_fn
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Executioner]
  type = Transient
  start_time = 0
  dt = 0.01
  num_steps = 100

  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b5c2b8eb-e53e-40be-9f11-1191898c318a"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/capped_drucker_prager/random.i</h4><pre class="moose-pre"><code class="language-text"># capped drucker-prager
# apply many random large deformations, checking that the algorithm returns correctly to
# the yield surface each time.


[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 125
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 125
  zmin = 0
  zmax = 1
[]
[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Modules/TensorMechanics/Master]
  [./all]
    add_variables = true
    incremental = true
    strain = finite
  [../]
[]

[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./shear_yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./tensile_yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./compressive_yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./shear_yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = shear_yield_fcn
  [../]
  [./tensile_fcn_auxk]
    type = MaterialStdVectorAux
    index = 1
    property = plastic_yield_function
    variable = tensile_yield_fcn
  [../]
  [./compressive_yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 2
    property = plastic_yield_function
    variable = compressive_yield_fcn
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./shear_max]
    type = ElementExtremeValue
    variable = shear_yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./tensile_max]
    type = ElementExtremeValue
    variable = tensile_yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./compressive_max]
    type = ElementExtremeValue
    variable = compressive_yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero_shear]
    type = FunctionValuePostprocessor
    function = shear_should_be_zero_fcn
  [../]
  [./should_be_zero_compressive]
    type = FunctionValuePostprocessor
    function = compressive_should_be_zero_fcn
  [../]
  [./should_be_zero_tensile]
    type = FunctionValuePostprocessor
    function = tensile_should_be_zero_fcn
  [../]
  [./av_iter]
    type = ElementAverageValue
    variable = iter
    outputs = &#x27;console&#x27;
  [../]
[]

[Functions]
  [./shear_should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;shear_max&#x27;
  [../]
  [./tensile_should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;tensile_max&#x27;
  [../]
  [./compressive_should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;compressive_max&#x27;
  [../]
[]

[UserObjects]
  [./ts]
    type = TensorMechanicsHardeningConstant
    value = 1000
  [../]
  [./cs]
    type = TensorMechanicsHardeningConstant
    value = 1000
  [../]
  [./mc_coh]
    type = TensorMechanicsHardeningConstant
    value = 1E3
  [../]
  [./mc_phi]
    type = TensorMechanicsHardeningConstant
    value = 30
    convert_to_radians = true
  [../]
  [./mc_psi]
    type = TensorMechanicsHardeningConstant
    value = 5
    convert_to_radians = true
  [../]
  [./dp]
    type = TensorMechanicsPlasticDruckerPrager
    mc_cohesion = mc_coh
    mc_friction_angle = mc_phi
    mc_dilation_angle = mc_psi
    yield_function_tolerance = 1      # irrelevant here
    internal_constraint_tolerance = 1 # irrelevant here
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0.7E7 1E7&#x27;
  [../]
  [./admissible]
    type = ComputeMultipleInelasticStress
    inelastic_models = dp
    perform_finite_strain_rotations = false
  [../]
  [./dp]
    type = CappedDruckerPragerStressUpdate
    DP_model = dp
    tensile_strength = ts
    compressive_strength = cs
    yield_function_tol = 1E-3
    tip_smoother = 0.1E3
    smoothing_tol = 0.1E3
    max_NR_iterations = 1000
    small_dilation = false
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random
  exodus = false
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9a3135fa-1c11-42f6-a42c-08441d437923"><div class="modal-content"><h4>modules/combined/test/tests/poro_mechanics/mandel.i</h4><pre class="moose-pre"><code class="language-text"># Mandel&#x27;s problem of consolodation of a drained medium
#
# A sample is in plane strain.
# -a &lt;= x &lt;= a
# -b &lt;= y &lt;= b
# It is squashed with constant force by impermeable, frictionless plattens on its top and bottom surfaces (at y=+/-b)
# Fluid is allowed to leak out from its sides (at x=+/-a)
# The porepressure within the sample is monitored.
#
# As is common in the literature, this is simulated by
# considering the quarter-sample, 0&lt;=x&lt;=a and 0&lt;=y&lt;=b, with
# impermeable, roller BCs at x=0 and y=0 and y=b.
# Porepressure is fixed at zero on x=a.
# Porepressure and displacement are initialised to zero.
# Then the top (y=b) is moved downwards with prescribed velocity,
# so that the total force that is inducing this downwards velocity
# is fixed.  The velocity is worked out by solving Mandel&#x27;s problem
# analytically, and the total force is monitored in the simulation
# to check that it indeed remains constant.
#
# Here are the problem&#x27;s parameters, and their values:
# Soil width.  a = 1
# Soil height.  b = 0.1
# Soil&#x27;s Lame lambda.  la = 0.5
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = G = 0.75
# Soil bulk modulus.  K = la + 2*mu/3 = 1
# Drained Poisson ratio.  nu = (3K - 2G)/(6K + 2G) = 0.2
# Soil bulk compliance.  1/K = 1
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Biot modulus.  M = 1/(phi0/Kf + (alpha - phi0)(1 - alpha)/K) = 4.705882
# Undrained bulk modulus. Ku = K + alpha^2*M = 2.694118
# Undrained Poisson ratio.  nuu = (3Ku - 2G)/(6Ku + 2G) = 0.372627
# Skempton coefficient.  B = alpha*M/Ku = 1.048035
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Consolidation coefficient.  c = 2*k*B^2*G*(1-nu)*(1+nuu)^2/9/(1-nuu)/(nuu-nu) = 3.821656
# Normal stress on top.  F = 1
#
# The solution for porepressure and displacements is given in
# AHD Cheng and E Detournay &quot;A direct boundary element method for plane strain poroelasticity&quot; International Journal of Numerical and Analytical Methods in Geomechanics 12 (1988) 551-572.
# The solution involves complicated infinite series, so I shall not write it here

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 10
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 0.1
  zmin = 0
  zmax = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  porepressure = porepressure
  block = 0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./roller_xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left&#x27;
  [../]
  [./roller_ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom&#x27;
  [../]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
  [./xmax_drained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = right
  [../]
  [./top_velocity]
    type = FunctionDirichletBC
    variable = disp_y
    function = top_velocity
    boundary = top
  [../]
[]

[Functions]
  [./top_velocity]
    type = PiecewiseLinear
    x = &#x27;0 0.002 0.006   0.014   0.03    0.046   0.062   0.078   0.094   0.11    0.126   0.142   0.158   0.174   0.19 0.206 0.222 0.238 0.254 0.27 0.286 0.302 0.318 0.334 0.35 0.366 0.382 0.398 0.414 0.43 0.446 0.462 0.478 0.494 0.51 0.526 0.542 0.558 0.574 0.59 0.606 0.622 0.638 0.654 0.67 0.686 0.702&#x27;
    y = &#x27;-0.041824842    -0.042730269    -0.043412712    -0.04428867     -0.045509181    -0.04645965     -0.047268246 -0.047974749      -0.048597109     -0.0491467  -0.049632388     -0.050061697      -0.050441198     -0.050776675     -0.051073238      -0.0513354 -0.051567152      -0.051772022     -0.051953128 -0.052113227 -0.052254754 -0.052379865 -0.052490464 -0.052588233 -0.052674662 -0.052751065 -0.052818606 -0.052878312 -0.052931093 -0.052977751 -0.053018997 -0.053055459 -0.053087691 -0.053116185 -0.053141373 -0.05316364 -0.053183324 -0.053200724 -0.053216106 -0.053229704 -0.053241725 -0.053252351 -0.053261745 -0.053270049 -0.053277389 -0.053283879 -0.053289615&#x27;
  [../]
[]


[AuxVariables]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./tot_force]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./tot_force]
    type = ParsedAux
    args = &#x27;stress_yy porepressure&#x27;
    execute_on = timestep_end
    variable = tot_force
    function = &#x27;-stress_yy+0.6*porepressure&#x27;
  [../]
[]



[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
    [./poro_x]
    type = PoroMechanicsCoupling
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PoroMechanicsCoupling
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PoroMechanicsCoupling
    variable = disp_z
    component = 2
  [../]
  [./poro_timederiv]
    type = PoroFullSatTimeDerivative
    variable = porepressure
  [../]
  [./darcy_flow]
    type = CoefDiffusion
    variable = porepressure
    coef = 1.5
  [../]
[]


[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;0.5 0.75&#x27;
    # bulk modulus is lambda + 2*mu/3 = 0.5 + 2*0.75/3 = 1
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./poro_material]
    type = PoroFullSatMaterial
    porosity0 = 0.1
    biot_coefficient = 0.6
    solid_bulk_compliance = 1
    fluid_bulk_compliance = 0.125
    constant_porosity = true
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0.0 0 0&#x27;
    variable = porepressure
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0.1 0 0&#x27;
    variable = porepressure
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0.2 0 0&#x27;
    variable = porepressure
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0.3 0 0&#x27;
    variable = porepressure
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0.4 0 0&#x27;
    variable = porepressure
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0.5 0 0&#x27;
    variable = porepressure
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0.6 0 0&#x27;
    variable = porepressure
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0.7 0 0&#x27;
    variable = porepressure
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0.8 0 0&#x27;
    variable = porepressure
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0.9 0 0&#x27;
    variable = porepressure
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;1 0 0&#x27;
    variable = porepressure
  [../]
  [./xdisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_x
  [../]
  [./ydisp]
    type = PointValue
    outputs = csv
    point = &#x27;1 0.1 0&#x27;
    variable = disp_y
  [../]
  [./total_downwards_force]
     type = ElementAverageValue
     outputs = csv
     variable = tot_force
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.15*t&lt;0.01,0.15*t,0.01)
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 0.7
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = mandel
  [./csv]
    interval = 3
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="406c56ce-19fe-4bbb-98ed-e5690b8b7891"><div class="modal-content"><h4>test/tests/time_integrators/explicit_ssp_runge_kutta/explicit_ssp_runge_kutta.i</h4><pre class="moose-pre"><code class="language-text"># This test solves the following IVP:
#   du/dt = f(u(t), t),   u(0) = 1
#   f(u(t), t) = -u(t) + t^3 + 3t^2
# The exact solution is the following:
#   u(t) = exp(-t) + t^3

[Mesh]
  [./mesh]
    type = GeneratedMeshGenerator
    dim = 1
    nx = 1
  [../]
[]

[Variables]
  [./u]
    family = SCALAR
    order = FIRST
    initial_condition = 1
  [../]
[]

[ScalarKernels]
  [./time_derivative]
    type = ODETimeDerivative
    variable = u
  [../]
  [./source_part1]
    type = ParsedODEKernel
    variable = u
    function = &#x27;u&#x27;
  [../]
  [./source_part2]
    type = PostprocessorSinkScalarKernel
    variable = u
    postprocessor = sink_pp
  [../]
[]

[Functions]
  [./sink_fn]
    type = ParsedFunction
    value = &#x27;-t^3 - 3*t^2&#x27;
  [../]
[]

[Postprocessors]
  [./sink_pp]
    type = FunctionValuePostprocessor
    function = sink_fn
    execute_on = &#x27;LINEAR NONLINEAR&#x27;
  [../]
  [./l2_err]
    type = ScalarL2Error
    variable = u
    function = ${fparse exp(-0.5) + 0.5^3}
  [../]
[]

[Executioner]
  type = Transient

  [./TimeIntegrator]
    type = ExplicitSSPRungeKutta
    order = 1
  [../]

  end_time = 0.5
  dt = 0.1
[]

[Outputs]
  file_base = &#x27;first_order&#x27;
  exodus = true
  [./csv]
    type = CSV
    show = &#x27;u&#x27;
    execute_on = &#x27;FINAL&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5664bdbd-7258-445e-98a3-f047f2250597"><div class="modal-content"><h4>modules/fluid_properties/test/tests/functions/saturation_pressure_function/saturation_pressure_function.i</h4><pre class="moose-pre"><code class="language-text"># TestTwoPhaseFluidProperties has the following saturation pressure function:
#   p_sat(p) = 3 T
# Thus for T = 5, p_sat should be 15.

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 1
[]

[Modules]
  [./FluidProperties]
    [./fp_liquid]
      type = IdealGasFluidProperties
    [../]
    [./fp_vapor]
      type = IdealGasFluidProperties
    [../]
    [./fp_2phase]
      type = TestTwoPhaseFluidProperties
      fp_liquid = fp_liquid
      fp_vapor = fp_vapor
    [../]
  []
[]

[Functions]
  [./T]
    type = ConstantFunction
    value = 5
  [../]
  [./p_sat]
    type = SaturationPressureFunction
    T = T
    fp_2phase = fp_2phase
  [../]
[]

[Postprocessors]
  [./p_sat_pp]
    type = FunctionValuePostprocessor
    function = p_sat
    execute_on = &#x27;INITIAL&#x27;
  [../]
[]

[Problem]
  solve = false
[]

[Executioner]
  type = Steady
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="41adbce5-8843-4346-9e04-3b80d8fe2b15"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/pp_generation_unconfined_fully_saturated.i</h4><pre class="moose-pre"><code class="language-text"># A sample is constrained on all sides, except its top
# and its boundaries are
# also impermeable.  Fluid is pumped into the sample via a
# volumetric source (ie kg/second per cubic meter), and the
# rise in the top surface, porepressure, and stress are observed.
#
# In the standard poromechanics scenario, the Biot Modulus is held
# fixed and the source has units 1/time.  Then the expected result
# is
# strain_zz = disp_z = BiotCoefficient*BiotModulus*s*t/((bulk + 4*shear/3) + BiotCoefficient^2*BiotModulus)
# porepressure = BiotModulus*(s*t - BiotCoefficient*strain_zz)
# stress_xx = (bulk - 2*shear/3)*strain_zz   (remember this is effective stress)
# stress_zz = (bulk + 4*shear/3)*strain_zz   (remember this is effective stress)
#
# In porous_flow, however, the source has units kg/s/m^3.  The ratios remain
# fixed:
# stress_xx/strain_zz = (bulk - 2*shear/3) = 1 (for the parameters used here)
# stress_zz/strain_zz = (bulk + 4*shear/3) = 4 (for the parameters used here)
# porepressure/strain_zz = 13.3333333 (for the parameters used here)
#
# Expect
# disp_z = 0.3*10*s*t/((2 + 4*1.5/3) + 0.3^2*10) = 0.612245*s*t
# porepressure = 10*(s*t - 0.3*0.612245*s*t) = 8.163265*s*t
# stress_xx = (2 - 2*1.5/3)*0.612245*s*t = 0.612245*s*t
# stress_zz = (2 + 4*shear/3)*0.612245*s*t = 2.44898*s*t
# The relationship between the constant poroelastic source
# s (m^3/second/m^3) and the PorousFlow source, S (kg/second/m^3) is
# S = fluid_density * s = s * exp(porepressure/fluid_bulk)
#
# Finally, note that the volumetric strain has
# consistent_with_displaced_mesh = false
# which is needed when using the FullySaturated version of the Kernels
# in order to generate the above results
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back&#x27;
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    component = 2
    variable = disp_z
  [../]
  [./mass0]
    type = PorousFlowFullySaturatedMassTimeDerivative
    variable = porepressure
    coupling_type = HydroMechanical
    biot_coefficient = 0.3
  [../]
  [./source]
    type = BodyForce
    function = &#x27;0.1*exp(8.163265306*0.1*t/3.3333333333)&#x27;
    variable = porepressure
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 3.3333333333
      density0 = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature_qp]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
    consistent_with_displaced_mesh = false
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = porepressure
  [../]
  [./simple_fluid_qp]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # the &quot;const&quot; is irrelevant here: all that uses Porosity is the BiotModulus, which just uses the initial value of porosity
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.3
    fluid_bulk_modulus = 3.3333333333
    solid_bulk_compliance = 0.5
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0.5&#x27;
    variable = disp_z
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./stress_xx_over_strain]
    type = FunctionValuePostprocessor
    function = stress_xx_over_strain_fcn
    outputs = csv
  [../]
  [./stress_zz_over_strain]
    type = FunctionValuePostprocessor
    function = stress_zz_over_strain_fcn
    outputs = csv
  [../]
  [./p_over_strain]
    type = FunctionValuePostprocessor
    function = p_over_strain_fcn
    outputs = csv
  [../]
[]

[Functions]
  [./stress_xx_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;stress_xx zdisp&#x27;
  [../]
  [./stress_zz_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;stress_zz zdisp&#x27;
  [../]
  [./p_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;p0 zdisp&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  dt = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = pp_generation_unconfined_fully_saturated
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="521fa31f-53f9-4267-8d60-999a99c79dc7"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mohr_coulomb/many_deforms_cap.i</h4><pre class="moose-pre"><code class="language-text"># apply many large deformations, checking that the algorithm returns correctly to
# the yield surface each time


[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[BCs]
  [./bottomx]
    type = DirichletBC
    variable = disp_x
    boundary = back
    value = 0.0
  [../]
  [./bottomy]
    type = DirichletBC
    variable = disp_y
    boundary = back
    value = 0.0
  [../]
  [./bottomz]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]

  [./topx]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = front
    function = &#x27;(sin(0.05*t)+x)/1E0&#x27;
  [../]
  [./topy]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = front
    function = &#x27;(cos(0.04*t)+x*y)/1E0&#x27;
  [../]
  [./topz]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = front
    function = &#x27;t/1E2&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn
  [../]
[]

[Postprocessors]
  [./yield_fcn_at_zero]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;yield_fcn_at_zero&#x27;
  [../]
[]

[UserObjects]
  [./mc_coh]
    type = TensorMechanicsHardeningConstant
    value = 1E3
  [../]
  [./mc_phi]
    type = TensorMechanicsHardeningConstant
    value = 30
    convert_to_radians = true
  [../]
  [./mc_psi]
    type = TensorMechanicsHardeningConstant
    value = 5
    convert_to_radians = true
  [../]
  [./mc]
    type = TensorMechanicsPlasticMohrCoulomb
    cohesion = mc_coh
    friction_angle = mc_phi
    dilation_angle = mc_psi
    tip_scheme = cap
    mc_tip_smoother = 0.0
    cap_start = 1000
    cap_rate = 1E-3
    mc_edge_smoother = 10
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-6
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0 1E7&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    max_NR_iterations = 1000
    ep_plastic_tolerance = 1E-6
    plastic_models = mc
    debug_fspb = crash
    deactivation_scheme = safe
  [../]
[]


[Executioner]
  end_time = 1000
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = many_deforms_cap
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b6eaf3ed-34b6-411e-b739-2ac5bba4b28e"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh17.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = false
# gravity = true
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 0.01
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 1
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-15 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh17
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3a2b88c4-de95-42a6-9e62-c47c6fbdd31a"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav02b.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established in the steady-state situation when 0&lt;saturation&lt;1 (note the strictly less-than).
# 2phase (PP), 2components, vanGenuchten, constant fluid bulk-moduli for each phase, constant viscosity, constant permeability, Corey relative perm
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./ppwater]
    initial_condition = -1.0
  [../]
  [./ppgas]
    initial_condition = 0
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = ppwater
    gravity = &#x27;-1 0 0&#x27;
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = ppgas
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[BCs]
  [./ppwater]
    type = DirichletBC
    boundary = right
    variable = ppwater
    value = -1
  [../]
  [./ppgas]
    type = DirichletBC
    boundary = right
    variable = ppgas
    value = 0
  [../]
[]

[Functions]
  [./ana_ppwater]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 2 pp_water_top 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
  [./ana_ppgas]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 1 pp_gas_top 0.1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater ppgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 1
      density0 = 0.1
      viscosity = 0.5
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = ppwater
    phase1_porepressure = ppgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[Postprocessors]
  [./pp_water_top]
    type = PointValue
    variable = ppwater
    point = &#x27;0 0 0&#x27;
  [../]
  [./pp_water_base]
    type = PointValue
    variable = ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_water_analytical]
    type = FunctionValuePostprocessor
    function = ana_ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_gas_top]
    type = PointValue
    variable = ppgas
    point = &#x27;0 0 0&#x27;
  [../]
  [./pp_gas_base]
    type = PointValue
    variable = ppgas
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_gas_analytical]
    type = FunctionValuePostprocessor
    function = ana_ppgas
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]


[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  file_base = grav02b
  [./csv]
    type = CSV
  [../]
  exodus = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="47c0a376-28c7-4c31-b0e6-246bf8c4d614"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_01.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = false
# transient = false

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.4
    max = 0.6
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.4
    max = 1.6
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardsfgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
    outputs = none # no reason why mass should be conserved
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
    outputs = none # no reason why mass should be conserved
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;nonzero&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
  nl_rel_tol = 1.e-10
  nl_max_its = 10
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_fu_01
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="acdc96e7-41b2-4243-a5c9-61d0e76c04fb"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/terzaghi_fully_saturated_volume.i</h4><pre class="moose-pre"><code class="language-text"># Terzaghi&#x27;s problem of consolodation of a drained medium
# The FullySaturated Kernels are used, with multiply_by_density = false
# so that this becomes a linear problem with constant Biot Modulus
# Also, since the FullySaturated Kernels are used, we have to
# use consistent_with_displaced_mesh = false in the calculation of volumetric strain
#
# A saturated soil sample sits in a bath of water.
# It is constrained on its sides, and bottom.
# Its sides and bottom are also impermeable.
# Initially it is unstressed.
# A normal stress, q, is applied to the soil&#x27;s top.
# The soil then slowly compresses as water is squeezed
# out from the sample from its top (the top BC for
# the porepressure is porepressure = 0).
#
# See, for example.  Section 2.2 of the online manuscript
# Arnold Verruijt &quot;Theory and Problems of Poroelasticity&quot; Delft University of Technology 2013
# but note that the &quot;sigma&quot; in that paper is the negative
# of the stress in TensorMechanics
#
# Here are the problem&#x27;s parameters, and their values:
# Soil height.  h = 10
# Soil&#x27;s Lame lambda.  la = 2
# Soil&#x27;s Lame mu, which is also the Soil&#x27;s shear modulus.  mu = 3
# Soil bulk modulus.  K = la + 2*mu/3 = 4
# Soil confined compressibility.  m = 1/(K + 4mu/3) = 0.125
# Soil bulk compliance.  1/K = 0.25
# Fluid bulk modulus.  Kf = 8
# Fluid bulk compliance.  1/Kf = 0.125
# Fluid mobility (soil permeability/fluid viscosity).  k = 1.5
# Soil initial porosity.  phi0 = 0.1
# Biot coefficient.  alpha = 0.6
# Soil initial storativity, which is the reciprocal of the initial Biot modulus.  S = phi0/Kf + (alpha - phi0)(1 - alpha)/K = 0.0625
# Consolidation coefficient.  c = k/(S + alpha^2 m) = 13.95348837
# Normal stress on top.  q = 1
# Initial porepressure, resulting from instantaneous application of q, assuming corresponding instantaneous increase of porepressure (Note that this is calculated by MOOSE: we only need it for the analytical solution).  p0 = alpha*m*q/(S + alpha^2 m) = 0.69767442
# Initial vertical displacement (down is positive), resulting from instantaneous application of q (Note this is calculated by MOOSE: we only need it for the analytical solution).  uz0 = q*m*h*S/(S + alpha^2 m)
# Final vertical displacement (down in positive) (Note this is calculated by MOOSE: we only need it for the analytical solution).  uzinf = q*m*h
#
# The solution for porepressure is
# P = 4*p0/\pi \sum_{k=1}^{\infty} \frac{(-1)^{k-1}}{2k-1} \cos ((2k-1)\pi z/(2h)) \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))
# This series converges very slowly for ct/h^2 small, so in that domain
# P = p0 erf( (1-(z/h))/(2 \sqrt(ct/h^2)) )
#
# The degree of consolidation is defined as
# U = (uz - uz0)/(uzinf - uz0)
# where uz0 and uzinf are defined above, and
# uz = the vertical displacement of the top (down is positive)
# U = 1 - (8/\pi^2)\sum_{k=1}^{\infty} \frac{1}{(2k-1)^2} \exp(-(2k-1)^2 \pi^2 ct/(4 h^2))

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 10
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = 0
  zmax = 10
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./basefixed]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = back
  [../]
  [./topdrained]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = front
  [../]
  [./topload]
    type = NeumannBC
    variable = disp_z
    value = -1
    boundary = front
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.6
    component = 2
    variable = disp_z
  [../]
  [./mass0]
    type = PorousFlowFullySaturatedMassTimeDerivative
    coupling_type = HydroMechanical
    biot_coefficient = 0.6
    multiply_by_density = false
    variable = porepressure
  [../]
  [./flux]
    type = PorousFlowFullySaturatedDarcyBase
    multiply_by_density = false
    variable = porepressure
    gravity = &#x27;0 0 0&#x27;
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 8
      density0 = 1
      thermal_expansion = 0
      viscosity = 0.96
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;2 3&#x27;
    # bulk modulus is lambda + 2*mu/3 = 2 + 2*3/3 = 4
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure_qp]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
    consistent_with_displaced_mesh = false
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = porepressure
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid_qp]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    biot_coefficient = 0.6
    fluid_bulk_modulus = 8
    solid_bulk_compliance = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.5 0 0   0 1.5 0   0 0 1.5&#x27;
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p1]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 1&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p2]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 2&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p3]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 3&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p4]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 4&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p5]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 5&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p6]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 6&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p7]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 7&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p8]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 8&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p9]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 9&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./p99]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = porepressure
    use_displaced_mesh = false
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 10&#x27;
    variable = disp_z
    use_displaced_mesh = false
  [../]
  [./dt]
    type = FunctionValuePostprocessor
    outputs = console
    function = if(0.5*t&lt;0.1,0.5*t,0.1)
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = dt
    dt = 0.0001
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = terzaghi_fully_saturated_volume
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="77330e6d-fcc2-42c3-8b44-3b897a752bb9"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mean_cap/random.i</h4><pre class="moose-pre"><code class="language-text"># apply many random large deformations, checking that the algorithm returns correctly to
# the yield surface each time.  Two yield surfaces are used: one for compression and one for tension.


[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1000
  ny = 125
  nz = 1
  xmin = 0
  xmax = 1000
  ymin = 0
  ymax = 125
  zmin = 0
  zmax = 1
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./max_yield_fcn]
    type = ElementExtremeValue
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./av_iter]
    type = ElementAverageValue
    variable = iter
    outputs = &#x27;console&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;max_yield_fcn&#x27;
  [../]
[]

[UserObjects]
  [./strength]
    type = TensorMechanicsHardeningConstant
    value = 1
  [../]
  [./cap1]
    type = TensorMechanicsPlasticMeanCap
    a = -1
    strength = strength
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-9
  [../]
  [./cap2]
    type = TensorMechanicsPlasticMeanCap
    a = 1
    strength = strength
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-9
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0.7E7 1E7&#x27;
  [../]
  [./strain]
    type = ComputeIncrementalSmallStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    max_NR_iterations = 2
    ep_plastic_tolerance = 1E-6
    plastic_models = &#x27;cap1 cap2&#x27;
    debug_fspb = crash
    deactivation_scheme = optimized
    min_stepsize = 1
    max_stepsize_for_dumb = 1
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random
  exodus = false
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f3914cfc-aab3-46ac-9689-593ba10f9663"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/mohr_coulomb/random_planar.i</h4><pre class="moose-pre"><code class="language-text"># apply many random large deformations, checking that the algorithm returns correctly to
# the yield surface each time.


[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 100
  ny = 1250
  nz = 1
  xmin = 0
  xmax = 100
  ymin = 0
  ymax = 1250
  zmin = 0
  zmax = 1
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[ICs]
  [./x]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_x
  [../]
  [./y]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_y
  [../]
  [./z]
    type = RandomIC
    min = -0.1
    max = 0.1
    variable = disp_z
  [../]
[]

[BCs]
  [./x]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
  [./z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = &#x27;front back&#x27;
    function = &#x27;0&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./iter]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    index = 0
    property = plastic_yield_function
    variable = yield_fcn
  [../]
  [./iter]
    type = MaterialRealAux
    property = plastic_NR_iterations
    variable = iter
  [../]
[]

[Postprocessors]
  [./yield_fcn_at_zero]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
  [./av_iter]
    type = ElementAverageValue
    variable = iter
    outputs = &#x27;console&#x27;
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;yield_fcn_at_zero&#x27;
  [../]
[]

[UserObjects]
  [./coh]
    type = TensorMechanicsHardeningCubic
    value_0 = 1000
    value_residual = 100
    internal_limit = 4
  [../]
  [./phi]
    type = TensorMechanicsHardeningCubic
    value_0 = 0.8
    value_residual = 0.3
    internal_limit = 2
  [../]
  [./psi]
    type = TensorMechanicsHardeningConstant
    value = 15
    convert_to_radians = true
  [../]
  [./mc]
    type = TensorMechanicsPlasticMohrCoulombMulti
    cohesion = coh
    friction_angle = phi
    dilation_angle = psi
    yield_function_tolerance = 1E-3
    shift = 1E-10
    internal_constraint_tolerance = 1E-6
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    fill_method = symmetric_isotropic
    C_ijkl = &#x27;0.7E7 1E7&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    ep_plastic_tolerance = 1E-10
    plastic_models = mc
    min_stepsize = 1
    max_stepsize_for_dumb = 1
  [../]
[]


[Executioner]
  end_time = 1
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = random_planar
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5ea12dd8-64f1-4415-a943-0f0577679977"><div class="modal-content"><h4>test/tests/controls/tag_based_naming_access/system_object_param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
    control_tags = &#x27;tag&#x27;
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;tag/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="bf75fd3b-1f90-4e08-ab1b-a8dafbdf2cc4"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/pp_generation.i</h4><pre class="moose-pre"><code class="language-text"># A sample is constrained on all sides and its boundaries are
# also impermeable.  Fluid is pumped into the sample via a
# volumetric source (ie kg/second per cubic meter), and the
# rise in porepressure is observed.
#
# Source = s  (units = kg/m^3/second)
#
# Expect:
# fluid_mass = mass0 + s*t
# stress = 0 (remember this is effective stress)
# Porepressure = fluid_bulk*log(fluid_mass_density/density_P0), where fluid_mass_density = fluid_mass*porosity
# porosity = biot+(phi0-biot)*exp(pp(biot-1)/solid_bulk)
#
# Parameters:
# Biot coefficient = 0.3
# Phi0 = 0.1
# Solid Bulk modulus = 2
# fluid_bulk = 13
# density_P0 = 1


[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back front&#x27;
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    component = 2
    variable = disp_z
  [../]
  [./poro_vol_exp]
    type = PorousFlowMassVolumetricExpansion
    variable = porepressure
    fluid_component = 0
  [../]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = porepressure
  [../]
  [./flux]
    type = PorousFlowAdvectiveFlux
    variable = porepressure
    gravity = &#x27;0 0 0&#x27;
    fluid_component = 0
  [../]
  [./source]
    type = BodyForce
    function = 0.1
    variable = porepressure
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./porosity]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./porosity]
    type = PorousFlowPropertyAux
    variable = porosity
    property = porosity
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 13
      density0 = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = porepressure
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    fluid = true
    mechanical = true
    porosity_zero = 0.1
    biot_coefficient = 0.3
    solid_bulk = 2
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0   0 1 0   0 0 1&#x27; # unimportant
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 0 # unimportant in this fully-saturated situation
    phase = 0
  [../]
[]

[Functions]
  [./porosity_analytic]
    type = ParsedFunction
    value = &#x27;biot+(phi0-biot)*exp(pp*(biot-1)/bulk)&#x27;
    vars = &#x27;biot phi0 pp bulk&#x27;
    vals = &#x27;0.3 0.1 p0 2&#x27;
  [../]
[]

[Postprocessors]
  [./fluid_mass]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;initial timestep_end&#x27;
    use_displaced_mesh = true
  [../]
  [./porosity]
    type = PointValue
    outputs = &#x27;console csv&#x27;
    point = &#x27;0 0 0&#x27;
    variable = porosity
  [../]
  [./p0]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = porepressure
  [../]
  [./porosity_analytic]
    type = FunctionValuePostprocessor
    function = porosity_analytic
  [../]
  [./zdisp]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0.5&#x27;
    variable = disp_z
  [../]
  [./stress_xx]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = csv
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]

[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_max_it -snes_stol&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 10000 1E-11&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  dt = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = pp_generation
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1d75ecec-f630-48d3-a1de-1dc8bf0f2565"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/pls03.i</h4><pre class="moose-pre"><code class="language-text"># Test that the upwinding works correctly.
#
# A poly-line sink sits at the centre of the element.
# It has length=4 and weight=0.5, and extracts fluid
# at a constant rate of
# (1 * relative_permeability) kg.m^-1.s^-1
# Since it sits at the centre of the element, it extracts
# equally from each node, so the rate of extraction from
# each node is
# (0.5 * relative_permeability) kg.s^-1
# including the length and weight effects.
#
# There is no fluid flow.
#
# The initial conditions are such that all nodes have
# relative_permeability=0, except for one which has
# relative_permeaility = 1.  Therefore, all nodes should
# remain at their initial porepressure, except the one.
#
# The porosity is 0.1, and the elemental volume is 2,
# so the fluid mass at the node in question = 0.2 * density / 4,
# where the 4 is the number of nodes in the element.
# In this simulation density = dens0 * exp(P / bulk), with
# dens0 = 100, and bulk = 20 MPa.
# The initial porepressure P0 = 10 MPa, so the final (after
# 1 second of simulation) is
# P(t=1) = 8.748592 MPa
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmin = 0
  xmax = 2
  ymin = 0
  ymax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    #function = if((x&lt;1)&amp;(y&lt;0.5),1E7,-1E7)
    function = if((x&lt;1)&amp;(y&gt;0.5),1E7,-1E7)
    #function = if((x&gt;1)&amp;(y&lt;0.5),1E7,-1E7)
    #function = if((x&gt;1)&amp;(y&gt;0.5),1E7,-1E7)
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pls_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      density0 = 100
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityFLAC
    phase = 0
    m = 2
    s_res = 0.99
    sum_s_res = 0.99
  [../]
[]

[DiracKernels]
  [./pls]
    type = PorousFlowPolyLineSink
    fluid_phase = 0
    point_file = pls03.bh
    use_relative_permeability = true
    line_length = 4
    SumQuantityUO = pls_total_outflow_mass
    variable = pp
    p_or_t_vals = &#x27;0 1E7&#x27;
    fluxes = &#x27;1 1&#x27;
  [../]
[]

[Postprocessors]
  [./pls_report]
    type = PorousFlowPlotQuantity
    uo = pls_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p00]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
  [./p01]
    type = PointValue
    variable = pp
    point = &#x27;0 1 0&#x27;
    execute_on = timestep_end
  [../]
  [./p20]
    type = PointValue
    variable = pp
    point = &#x27;2 0 0&#x27;
    execute_on = timestep_end
  [../]
  [./p21]
    type = PointValue
    variable = pp
    point = &#x27;2 1 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 pls_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1
  dt = 1
  solve_type = NEWTON
[]

[Outputs]
  file_base = pls03
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="81ddcfdf-a798-45b9-b56e-e466b7767ee2"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except15.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f377561b-597d-4ecd-a544-1d27aef40aa3"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s02.i</h4><pre class="moose-pre"><code class="language-text"># apply a sink flux with use_mobility=true and observe the correct behavior
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  zmin = 0
  zmax = 2
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Variables]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = y+1
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.3
      density0 = 1.1
      thermal_expansion = 0
      viscosity = 1.1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.2 0 0 0 0.1 0 0 0 0.1&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[AuxVariables]
  [./flux_out]
  [../]
  [./xval]
  [../]
  [./yval]
  [../]
[]

[ICs]
  [./xval]
    type = FunctionIC
    variable = xval
    function = x
  [../]
  [./yval]
    type = FunctionIC
    variable = yval
    function = y
  [../]
[]

[Functions]
  [./mass00]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)&#x27;
    vars = &#x27;vol por dens0 pp bulk&#x27;
    vals = &#x27;0.25 0.1 1.1 p00 1.3&#x27;
  [../]
  [./mass01]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)&#x27;
    vars = &#x27;vol por dens0 pp bulk&#x27;
    vals = &#x27;0.25 0.1 1.1 p01 1.3&#x27;
  [../]
  [./expected_mass_change00]
    type = ParsedFunction
    value = &#x27;fcn*perm*dens0*exp(pp/bulk)/visc*area*dt&#x27;
    vars = &#x27;fcn perm dens0 pp bulk visc area dt&#x27;
    vals = &#x27;6   0.2  1.1  p00 1.3  1.1  0.5  1E-3&#x27;
  [../]
  [./expected_mass_change01]
    type = ParsedFunction
    value = &#x27;fcn*perm*dens0*exp(pp/bulk)/visc*area*dt&#x27;
    vars = &#x27;fcn perm dens0 pp bulk visc area dt&#x27;
    vals = &#x27;6   0.2  1.1  p01 1.3  1.1  0.5  1E-3&#x27;
  [../]
  [./mass00_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-mass_change&#x27;
    vars = &#x27;mass_prev mass_change&#x27;
    vals = &#x27;m00_prev  del_m00&#x27;
  [../]
  [./mass01_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-mass_change&#x27;
    vars = &#x27;mass_prev mass_change&#x27;
    vals = &#x27;m01_prev  del_m01&#x27;
  [../]
[]

[Postprocessors]
  [./p00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m00]
    type = FunctionValuePostprocessor
    function = mass00
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m00_prev]
    type = FunctionValuePostprocessor
    function = mass00
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./del_m00]
    type = FunctionValuePostprocessor
    function = expected_mass_change00
    execute_on = &#x27;timestep_end&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m00_expect]
    type = FunctionValuePostprocessor
    function = mass00_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./p10]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p01]
    type = PointValue
    point = &#x27;0 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m01]
    type = FunctionValuePostprocessor
    function = mass01
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m01_prev]
    type = FunctionValuePostprocessor
    function = mass01
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./del_m01]
    type = FunctionValuePostprocessor
    function = expected_mass_change01
    execute_on = &#x27;timestep_end&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m01_expect]
    type = FunctionValuePostprocessor
    function = mass01_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./p11]
    type = PointValue
    point = &#x27;1 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[BCs]
  [./flux]
    type = PorousFlowSink
    boundary = &#x27;left&#x27;
    variable = pp
    use_mobility = true
    use_relperm = true
    fluid_phase = 0
    flux_function = 6
    save_in = flux_out
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 10000 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E-3
  end_time = 0.03
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[Outputs]
  file_base = s02
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
    interval = 30
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;timestep_end&#x27;
    interval = 3
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="521aaf68-364d-44e5-92b9-a5e13a471c37"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s04.i</h4><pre class="moose-pre"><code class="language-text"># apply a piecewise-linear sink flux and observe the correct behavior
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  zmin = 0
  zmax = 2
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Variables]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = y+1
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.3
      density0 = 1.1
      thermal_expansion = 0
      viscosity = 1.1
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-5 0 0 0 1E-5 0 0 0 1E-5&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[AuxVariables]
  [./flux_out]
  [../]
  [./xval]
  [../]
  [./yval]
  [../]
  [./pt_shift]
    initial_condition = 0.3
  [../]
[]

[ICs]
  [./xval]
    type = FunctionIC
    variable = xval
    function = x
  [../]
  [./yval]
    type = FunctionIC
    variable = yval
    function = y
  [../]
[]

[Functions]
  [./mass10]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)&#x27;
    vars = &#x27;vol por dens0 pp bulk&#x27;
    vals = &#x27;0.25 0.1 1.1 p10 1.3&#x27;
  [../]
  [./rate10]
    type = ParsedFunction
    value = &#x27;fcn*if(pp&gt;0.8,1,if(pp&lt;0.3,0.5,0.2+pp))&#x27;
    vars = &#x27;fcn pp&#x27;
    vals = &#x27;8   p10&#x27;
  [../]
  [./mass10_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-rate*area*dt&#x27;
    vars = &#x27;mass_prev rate     area dt&#x27;
    vals = &#x27;m10_prev  m10_rate 0.5 1E-3&#x27;
  [../]
  [./mass11]
    type = ParsedFunction
    value = &#x27;vol*por*dens0*exp(pp/bulk)&#x27;
    vars = &#x27;vol por dens0 pp bulk&#x27;
    vals = &#x27;0.25 0.1 1.1 p11 1.3&#x27;
  [../]
  [./rate11]
    type = ParsedFunction
    value = &#x27;fcn*if(pp&gt;0.8,1,if(pp&lt;0.3,0.5,0.2+pp))&#x27;
    vars = &#x27;fcn pp&#x27;
    vals = &#x27;8   p11&#x27;
  [../]
  [./mass11_expect]
    type = ParsedFunction
    value = &#x27;mass_prev-rate*area*dt&#x27;
    vars = &#x27;mass_prev rate     area dt&#x27;
    vals = &#x27;m11_prev  m11_rate 0.5 1E-3&#x27;
  [../]
[]

[Postprocessors]
  [./p00]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p10]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m10]
    type = FunctionValuePostprocessor
    function = mass10
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m10_prev]
    type = FunctionValuePostprocessor
    function = mass10
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m10_rate]
    type = FunctionValuePostprocessor
    function = rate10
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./m10_expect]
    type = FunctionValuePostprocessor
    function = mass10_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./p01]
    type = PointValue
    point = &#x27;0 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./p11]
    type = PointValue
    point = &#x27;1 1 0&#x27;
    variable = pp
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m11]
    type = FunctionValuePostprocessor
    function = mass11
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./m11_prev]
    type = FunctionValuePostprocessor
    function = mass11
    execute_on = &#x27;timestep_begin&#x27;
    outputs = &#x27;console&#x27;
  [../]
  [./m11_rate]
    type = FunctionValuePostprocessor
    function = rate11
    execute_on = &#x27;timestep_end&#x27;
  [../]
  [./m11_expect]
    type = FunctionValuePostprocessor
    function = mass11_expect
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[BCs]
  [./flux]
    type = PorousFlowPiecewiseLinearSink
    boundary = &#x27;right&#x27;
    PT_shift = pt_shift
    pt_vals = &#x27;0.0 0.5&#x27;
    multipliers = &#x27;0.5 1&#x27;
    variable = pp
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 8
    save_in = flux_out
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 10000 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E-3
  end_time = 1E-2
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[Outputs]
  file_base = s04
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="728110b6-2b04-40a6-b7d0-ca082f03df38"><div class="modal-content"><h4>test/tests/multiapps/initial_transfer/master.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  nx = 2
  ny = 2
[]

[Problem]
  kernel_coverage_check = false
[]

[Variables][dummy][][]

[Functions]
  [func]
    type = ConstantFunction
    value = 1
  []
[]

[Postprocessors]
  [c]
    type = FunctionValuePostprocessor
    function = func
    execute_on = initial
    # this will force this postprocessor to be evaluated before transfer on initial
    force_preic = true
  []
[]

[Executioner]
  type = Steady
[]

[MultiApps]
  [sub]
    type = FullSolveMultiApp
    input_files = sub.i
    execute_on = initial
  [../]
[]

[Transfers]
  [to_sub]
    type = MultiAppPostprocessorTransfer
    direction = to_multiapp
    multi_app = sub
    from_postprocessor = c
    to_postprocessor = receiver
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c9c3272b-6d51-4acd-851a-d7977b115403"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/fully_saturated_grav01c.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established
# 1phase, 2-component, constant fluid-bulk, constant viscosity, constant permeability
# fully saturated with fully-saturated Kernel
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = RandomIC
      min = 0
      max = 1
    [../]
  [../]
  [./frac]
    [./InitialCondition]
      type = RandomIC
      min = 0
      max = 1
    [../]
  [../]
[]

[Kernels]
  [./flux1]
    type = PorousFlowFullySaturatedDarcyFlow
    variable = pp
    fluid_component = 0
    gravity = &#x27;-1 0 0&#x27;
  [../]
  [./flux0]
    type = PorousFlowFullySaturatedDarcyFlow
    variable = frac
    fluid_component = 1
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_pp]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 1.2 0 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[BCs]
  [./z]
    type = DirichletBC
    variable = pp
    boundary = right
    value = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp frac&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1.2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = frac
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
[]

[Postprocessors]
  [./pp_base]
    type = PointValue
    variable = pp
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_analytical]
    type = FunctionValuePostprocessor
    function = ana_pp
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = fully_saturated_grav01c
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="cbb57dc1-2d8d-487a-966d-1f54d847399b"><div class="modal-content"><h4>test/tests/controls/tag_based_naming_access/object_param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
    control_tags = &#x27;tag&#x27;
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;tag::*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7355a448-fdb3-4b8c-99ed-c469f7005af5"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except04.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    at_nodes = true # Needed to force exepected error
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    function_of = temperature
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2c2276cf-7870-461f-968c-f013604f189c"><div class="modal-content"><h4>test/tests/controls/tag_based_naming_access/system_asterisk_param.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = FunctionValuePostprocessor
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
  [./other_point_test_object]
    type = FunctionValuePostprocessor
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;tag/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8ebd9e62-9b34-454e-b38a-9400c3c51212"><div class="modal-content"><h4>test/tests/functions/parsed/mms_transient_coupled.i</h4><pre class="moose-pre"><code class="language-text">###########################################################
# This is a simple test of the Function System. This
# test uses forcing terms produced from analytical
# functions of space and time to verify a solution
# using MMS.
#
# @Requirement F6.20
###########################################################


[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = 0.0
  xmax = 1.0
  nx = 10
  ymin = 0.0
  ymax = 1.0
  ny = 10
  uniform_refine = 2
  elem_type = QUAD4
[]

[Variables]
  [./u]
  [../]
  [./v]
  [../]
[]

[Functions]
  [./v_left_bc]
    # Left-side boundary condition for v equation, v(0,y,t) = u(0.5,y,t). This is accomplished using a PointValue postprocessor, which is what this input file was designed to test.
    type = ParsedFunction
    value = a
    vals = u_midpoint
    vars = a
  [../]
  [./u_mms_func]
    # MMS Forcing function for the u equation.
    type = ParsedFunction
    value = &#x27; 20*exp(20*t)*x*x*x-6*exp(20*t)*x-(2-0.125*exp(20*t))*sin(5/2*x*pi)-0.125*exp(20*t)-1
&#x27;
  [../]
  [./v_mms_func]
    # MMS forcing function for the v equation.
    type = ParsedFunction
    value = -2.5*exp(20*t)*sin(5/2*x*pi)+2.5*exp(20*t)+25/4*(2-0.125*exp(20*t))*sin(5/2*x*pi)*pi*pi
  [../]
  [./u_right_bc]
    type = ParsedFunction
    value = 3*exp(20*t) # \nabla{u}|_{x=1} = 3\exp(20*t)
  [../]
  [./u_exact]
    # Exact solution for the MMS function for the u variable.
    type = ParsedFunction
    value = exp(20*t)*pow(x,3)+1
  [../]
  [./v_exact]
    # Exact MMS solution for v.
    type = ParsedFunction
    value = (2-0.125*exp(20*t))*sin(5/2*pi*x)+0.125*exp(20*t)+1
  [../]
[]

[Kernels]
  # Strong Form:
  # \frac{\partial u}{\partial t} - \nabla \cdot 0.5 \nabla u - v = 0
  # \frac{\partial u}{\partial t} - \nabla \cdot \nabla v = 0
  #
  # BCs:
  # u(0,y,t) = 1
  # \nabla u |_{x=1} = 3\exp(20*t)
  # v(0,y,t) = u(0.5,y,t)
  # v(1,y,t) = 3
  # \nabla u |_{y=0,1} = 0
  # \nabla v |_{y=0,1} = 0
  #
  [./u_time]
    type = TimeDerivative
    variable = u
  [../]
  [./u_diff]
    type = Diffusion
    variable = u
  [../]
  [./u_source]
    type = CoupledForce
    variable = u
    v = v
  [../]
  [./v_diff]
    type = Diffusion
    variable = v
  [../]
  [./u_mms]
    type = BodyForce
    variable = u
    function = u_mms_func
  [../]
  [./v_mms]
    type = BodyForce
    variable = v
    function = v_mms_func
  [../]
  [./v_time]
    type = TimeDerivative
    variable = v
  [../]
[]

[BCs]
  [./u_left]
    type = DirichletBC
    variable = u
    boundary = left # x=0
    value = 1 # u(0,y,t)=1
  [../]
  [./u_right]
    type = FunctionNeumannBC
    variable = u
    boundary = right # x=1
    function = u_right_bc # \nabla{u}|_{x=1}=3\exp(20t)
  [../]
  [./v_left]
    type = FunctionDirichletBC
    variable = v
    boundary = left # x=0
    function = v_left_bc # v(0,y,t) = u(0.5,y,t)
  [../]
  [./v_right]
    type = DirichletBC
    variable = v
    boundary = right # x=1
    value = 3 # v(1,y,t) = 3
  [../]
[]

[Postprocessors]
  [./u_midpoint]
    type = PointValue
    variable = u
    point = &#x27;0.5 0.5 0&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./u_midpoint_exact]
    type = FunctionValuePostprocessor
    function = u_exact
    point = &#x27;0.5 0.5 0.0&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./u_error]
    type = ElementL2Error
    variable = u
    function = u_exact
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./v_error]
    type = ElementL2Error
    variable = v
    function = v_exact
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Executioner]
  type = Transient
  dt = 0.01

  solve_type = NEWTON

  end_time = 0.1
  scheme = crank-nicolson
[]

[Outputs]
  exodus = true
[]

[ICs]
  [./u_initial]
    # Use the MMS exact solution to compute the initial conditions.
    function = u_exact
    variable = u
    type = FunctionIC
  [../]
  [./v_exact]
    # Use the MMS exact solution to compute the initial condition.
    function = v_exact
    variable = v
    type = FunctionIC
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f284db1e-54ba-48ed-a03b-d4c2d9244513"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh_except11.i</h4><pre class="moose-pre"><code class="language-text"># PorousFlowPeacemanBorehole exception test
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = TimeDerivative
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-7
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    bottom_p_or_t = 0
    fluid_phase = 0
    point_file = bh02.bh
    use_relative_permeability = true
    SumQuantityUO = borehole_total_outflow_mass
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 0.5
  dt = 1E-2
  solve_type = NEWTON
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6d63c3d9-fc21-45d6-a8f2-e3dac52e5898"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/weak_plane_shear/small_deform3.i</h4><pre class="moose-pre"><code class="language-text"># apply a number of &quot;random&quot; configurations and
# check that the algorithm returns to the yield surface
#
# must be careful here - we cannot put in arbitrary values of C_ijkl, otherwise the condition
# df/dsigma * C * flow_dirn &lt; 0 for some stresses
# The important features that must be obeyed are:
# 0 = C_0222 = C_1222  (holds for transversely isotropic, for instance)
# C_0212 &lt; C_0202 = C_1212 (holds for transversely isotropic)
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]


[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]


[BCs]
  [./bottomx]
    type = DirichletBC
    variable = disp_x
    boundary = back
    value = 0.0
  [../]
  [./bottomy]
    type = DirichletBC
    variable = disp_y
    boundary = back
    value = 0.0
  [../]
  [./bottomz]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]

  # the following are &quot;random&quot; deformations
  # each is O(1E-5) to keep deformations small
  [./topx]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = front
    function = &#x27;(sin(0.1*t)+x)/1E5&#x27;
  [../]
  [./topy]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = front
    function = &#x27;(cos(t)+x*y)/1E5&#x27;
  [../]
  [./topz]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = front
    function = &#x27;sin(0.4321*t)*x*y*z/1E5&#x27;
  [../]
[]

[AuxVariables]
  [./yield_fcn]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./yield_fcn_auxk]
    type = MaterialStdVectorAux
    property = plastic_yield_function
    index = 0
    variable = yield_fcn
  [../]
[]

[Postprocessors]
  [./yield_fcn_at_zero]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = yield_fcn
    outputs = &#x27;console&#x27;
  [../]
  [./should_be_zero]
    type = FunctionValuePostprocessor
    function = should_be_zero_fcn
  [../]
[]

[Functions]
  [./should_be_zero_fcn]
    type = ParsedFunction
    value = &#x27;if(a&lt;1E-3,0,a)&#x27;
    vars = &#x27;a&#x27;
    vals = &#x27;yield_fcn_at_zero&#x27;
  [../]
[]

[UserObjects]
  [./coh]
    type = TensorMechanicsHardeningConstant
    value = 1E3
  [../]
  [./tanphi]
    type = TensorMechanicsHardeningConstant
    value = 0.5773503
  [../]
  [./tanpsi]
    type = TensorMechanicsHardeningConstant
    value = 0.08748866
  [../]
  [./wps]
    type = TensorMechanicsPlasticWeakPlaneShear
    cohesion = coh
    tan_friction_angle = tanphi
    tan_dilation_angle = tanpsi
    smoother = 100
    yield_function_tolerance = 1E-3
    internal_constraint_tolerance = 1E-3
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    block = 0
    # the following is transversely isotropic, i think.
    fill_method = symmetric9
    C_ijkl = &#x27;3E9 1E9 3E9 3E9 3E9 6E9 1E9 1E9 9E9&#x27;
  [../]
  [./strain]
    type = ComputeFiniteStrain
    block = 0
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./mc]
    type = ComputeMultiPlasticityStress
    block = 0
    plastic_models = wps
    transverse_direction = &#x27;0 0 1&#x27;
    max_NR_iterations = 100
    ep_plastic_tolerance = 1E-3
    debug_fspb = crash
  [../]
[]


[Executioner]
  end_time = 1E4
  dt = 1
  type = Transient
[]


[Outputs]
  file_base = small_deform3
  exodus = false
  [./csv]
    type = CSV
    [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d40cf410-0f6a-4886-a14f-fbb02cdf1a14"><div class="modal-content"><h4>modules/porous_flow/test/tests/poro_elasticity/pp_generation_unconfined.i</h4><pre class="moose-pre"><code class="language-text"># A sample is constrained on all sides, except its top
# and its boundaries are
# also impermeable.  Fluid is pumped into the sample via a
# volumetric source (ie kg/second per cubic meter), and the
# rise in the top surface, porepressure, and stress are observed.
#
# In the standard poromechanics scenario, the Biot Modulus is held
# fixed and the source has units 1/time.  Then the expected result
# is
# strain_zz = disp_z = BiotCoefficient*BiotModulus*s*t/((bulk + 4*shear/3) + BiotCoefficient^2*BiotModulus)
# porepressure = BiotModulus*(s*t - BiotCoefficient*strain_zz)
# stress_xx = (bulk - 2*shear/3)*strain_zz   (remember this is effective stress)
# stress_zz = (bulk + 4*shear/3)*strain_zz   (remember this is effective stress)
#
# In porous_flow, however, the source has units kg/s/m^3 and the
# Biot Modulus is not held fixed.  This means that disp_z, porepressure,
# etc are not linear functions of t.  Nevertheless, the ratios remain
# fixed:
# stress_xx/strain_zz = (bulk - 2*shear/3) = 1 (for the parameters used here)
# stress_zz/strain_zz = (bulk + 4*shear/3) = 4 (for the parameters used here)
# porepressure/strain_zz = 13.3333333 (for the parameters used here)

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -0.5
  xmax = 0.5
  ymin = -0.5
  ymax = 0.5
  zmin = -0.5
  zmax = 0.5
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  block = 0
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure disp_x disp_y disp_z&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
[]

[BCs]
  [./confinex]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = &#x27;left right&#x27;
  [../]
  [./confiney]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = &#x27;bottom top&#x27;
  [../]
  [./confinez]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;back&#x27;
  [../]
[]

[Kernels]
  [./grad_stress_x]
    type = StressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./grad_stress_y]
    type = StressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./grad_stress_z]
    type = StressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./poro_x]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    variable = disp_x
    component = 0
  [../]
  [./poro_y]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    variable = disp_y
    component = 1
  [../]
  [./poro_z]
    type = PorousFlowEffectiveStressCoupling
    biot_coefficient = 0.3
    component = 2
    variable = disp_z
  [../]
  [./poro_vol_exp]
    type = PorousFlowMassVolumetricExpansion
    variable = porepressure
    fluid_component = 0
  [../]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = porepressure
  [../]
  [./flux]
    type = PorousFlowAdvectiveFlux
    variable = porepressure
    gravity = &#x27;0 0 0&#x27;
    fluid_component = 0
  [../]
  [./source]
    type = BodyForce
    function = 0.1
    variable = porepressure
  [../]
[]

[AuxVariables]
  [./stress_xx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_xz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_yz]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 3.3333333333
      density0 = 1
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1.5&#x27;
    # bulk modulus is lambda + 2*mu/3 = 1 + 2*1.5/3 = 2
    fill_method = symmetric_isotropic
  [../]
  [./strain]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    fluid = true
    mechanical = true
    porosity_zero = 0.1
    biot_coefficient = 0.3
    solid_bulk = 2
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0   0 1 0   0 0 1&#x27; # unimportant
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 0 # unimportant in this fully-saturated situation
    phase = 0
  [../]
[]

[Postprocessors]
  [./p0]
    type = PointValue
    outputs = none
    point = &#x27;0 0 0&#x27;
    variable = porepressure
  [../]
  [./zdisp]
    type = PointValue
    outputs = none
    point = &#x27;0 0 0.5&#x27;
    variable = disp_z
  [../]
  [./stress_xx]
    type = PointValue
    outputs = none
    point = &#x27;0 0 0&#x27;
    variable = stress_xx
  [../]
  [./stress_yy]
    type = PointValue
    outputs = none
    point = &#x27;0 0 0&#x27;
    variable = stress_yy
  [../]
  [./stress_zz]
    type = PointValue
    outputs = none
    point = &#x27;0 0 0&#x27;
    variable = stress_zz
  [../]
  [./stress_xx_over_strain]
    type = FunctionValuePostprocessor
    function = stress_xx_over_strain_fcn
    outputs = csv
  [../]
  [./stress_zz_over_strain]
    type = FunctionValuePostprocessor
    function = stress_zz_over_strain_fcn
    outputs = csv
  [../]
  [./p_over_strain]
    type = FunctionValuePostprocessor
    function = p_over_strain_fcn
    outputs = csv
  [../]
[]

[Functions]
  [./stress_xx_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;stress_xx zdisp&#x27;
  [../]
  [./stress_zz_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;stress_zz zdisp&#x27;
  [../]
  [./p_over_strain_fcn]
    type = ParsedFunction
    value = a/b
    vars = &#x27;a b&#x27;
    vals = &#x27;p0 zdisp&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-14 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  start_time = 0
  end_time = 10
  dt = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = pp_generation_unconfined
  [./csv]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="de053dbf-97f8-4851-99ed-b7d9cb773464"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/ad_viscoplasticity_stress_update/lps_single_split.i</h4><pre class="moose-pre"><code class="language-text"># This test provides an example of combining two LPS viscoplasticity model.
# The answer should be close, but not exactly the same, as lps_single.i

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  xmax = 0.002
  ymax = 0.002
[]

[Modules/TensorMechanics/Master/All]
  strain = FINITE
  add_variables = true
  generate_output = &#x27;strain_xx strain_yy strain_xy hydrostatic_stress vonmises_stress&#x27;
  use_automatic_differentiation = true
[]

[Functions]
  [./pull]
    type = PiecewiseLinear
    x = &#x27;0 0.1&#x27;
    y = &#x27;0 1e-5&#x27;
  [../]
  [./tot_effective_viscoplasticity]
    type = ParsedFunction
    vals = &#x27;lps_1_eff_creep_strain lps_2_eff_creep_strain&#x27;
    vars = &#x27;lps_1_eff_creep_strain lps_2_eff_creep_strain&#x27;
    value = &#x27;lps_1_eff_creep_strain+lps_2_eff_creep_strain&#x27;
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 1e10
    poissons_ratio = 0.3
  [../]
  [./stress]
    type = ADComputeMultiplePorousInelasticStress
    inelastic_models = &#x27;one two&#x27;
    initial_porosity = 0.1
    outputs = all
  [../]

  [./one]
    type = ADViscoplasticityStressUpdate
    coefficient = &#x27;coef&#x27;
    power = 3
    base_name = &#x27;lps_first&#x27;
    outputs = all
    relative_tolerance = 1e-11
  [../]
  [./two]
    type = ADViscoplasticityStressUpdate
    coefficient = &#x27;coef&#x27;
    power = 3
    base_name = &#x27;lps_second&#x27;
    outputs = all
    relative_tolerance = 1e-11
  [../]
  [./coef]
    type = ADParsedMaterial
    f_name = coef
    # Example of creep power law
    function = &#x27;0.5e-18 * exp(-4e4 / 1.987 / 1200)&#x27;
  [../]
[]

[BCs]
  [./no_disp_x]
    type = ADDirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./no_disp_y]
    type = ADDirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
  [./pull_disp_y]
    type = ADFunctionDirichletBC
    variable = disp_y
    boundary = top
    function = pull
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  dt = 0.01
  end_time = 0.12
[]

[Postprocessors]
  [./disp_x]
    type = SideAverageValue
    variable = disp_x
    boundary = right
  [../]
  [./disp_y]
    type = SideAverageValue
    variable = disp_y
    boundary = top
  [../]
  [./avg_hydro]
    type = ElementAverageValue
    variable = hydrostatic_stress
  [../]
  [./avg_vonmises]
    type = ElementAverageValue
    variable = vonmises_stress
  [../]
  [./dt]
    type = TimestepSize
  [../]
  [./num_lin]
    type = NumLinearIterations
    outputs = console
  [../]
  [./num_nonlin]
    type = NumNonlinearIterations
    outputs = console
  [../]
  [./lps_1_eff_creep_strain]
    type = ElementAverageValue
    variable = lps_first_effective_viscoplasticity
    outputs = none
  [../]
  [./lps_2_eff_creep_strain]
    type = ElementAverageValue
    variable = lps_second_effective_viscoplasticity
    outputs = none
  [../]
  [./eff_creep_strain_tot]
    type = FunctionValuePostprocessor
    function = tot_effective_viscoplasticity
  [../]
  [./porosity]
    type = ElementAverageValue
    variable = porosity
  [../]
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#813145d5-5d97-4d4a-9073-bec5d09df275" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#6bed8e54-b6b2-42bb-aebe-1159b09b7064" class="tooltipped" data-position="left" data-tooltip="Input Files">Input Files</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>