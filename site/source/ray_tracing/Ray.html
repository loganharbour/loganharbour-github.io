<!DOCTYPE html><head><meta charset="UTF-8"><title>Ray.md|MOOSE Ray Tracing Module</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="/modules/ray_tracing" class="left moose-logo hide-on-med-and-down">MOOSE Ray Tracing Module</a><a href="https://github.com/idaholab/moose" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="c75403e7-1728-4da6-a3af-b19a9ddb74bf"><i class="material-icons">menu</i></a><ul class="sidenav" id="c75403e7-1728-4da6-a3af-b19a9ddb74bf"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/modules/ray_tracing" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">ray_tracing</span><a href="#" class="breadcrumb">Ray</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="c7077a2a-83bf-4bdc-a29f-f05c2fd658ab" data-section-level="1" data-section-text="Ray"><h1 id="ray">Ray</h1><p>A <code>Ray</code> is the data structure that represents a single ray in the <a href="../../modules/ray_tracing/index.html">Ray Tracing Module</a> that is generated and traced by a <a href="RayTracingStudy.html">RayTracingStudy</a>. It can store data and auxiliary data that can modified along the trace via <a href="../../syntax/RayKernels/index.html">RayKernels</a> and <a href="../../syntax/RayBCs/index.html">RayBCs</a>.</p><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>A significant portion of this information is irrelevant for many use cases of the <a href="../../modules/ray_tracing/index.html">Ray Tracing Module</a>. TODO: getting started</p></p></div></div></div><p>The discussion of how to use and interact with a <code>Ray</code> is summarized into the following sections:</p><ul class="browser-default"><li><p><a href="Ray.html#defining-a-ray-trajectory">Defining a Ray Trajectory</a>: How to define a <code>Ray</code> trajectory for it to be traced using a <a href="RayTracingStudy.html">RayTracingStudy</a>. </p></li><li><p><a href="Ray.html#modifying-a-ray-trajectory">Modifying a Ray Trajectory</a>: How to modify a <code>Ray</code> trajectory while it is being traced via <a href="../../syntax/RayKernels/index.html">RayKernels</a> and <a href="../../syntax/RayBCs/index.html">RayBCs</a>. </p></li><li><p><a href="Ray.html#using-ray-data">Using Ray Data</a>: How to best access and use the data stored on the <code>Ray</code>. </p></li><li><p><a href="Ray.html#getting-a-ray">Getting a Ray</a>: How to obtain a <code>Ray</code> to be used for tracing.</p></li></ul><p>Useful member variables avaiable on the <code>Ray</code> are:</p><ul class="browser-default"><li><p><code>start()</code> - The start point. After a <code>Ray</code> has started to be traced, this is no longer guanateed to be the original start point. When being traced across processors, this point is changed to the start point on the processor that is continuing the trace. When being changed mid-trace within a <a href="../../syntax/RayKernels/index.html">RayKernel</a>, this is set to the new point at which the <code>Ray</code> starts within the element. </p></li><li><p><code>end()</code> - The end point. This is only a valid value if the <code>Ray</code> is set to end at a specific point <em></em>within** the mesh (does not need to be killed by <a href="../../syntax/RayKernels/index.html">RayKernels</a> or <a href="../../syntax/RayBCs/index.html">RayBCs</a>. </p></li><li><p><code>direction()</code> - The curent direction of the <code>Ray</code> trajectory. </p></li><li><p><code>data()</code> - Access into the data stored on the <code>Ray</code>. </p></li><li><p><code>auxData()</code> - Access into the auxiliary data stored on the <code>Ray</code>. </p></li><li><p><code>distance()</code> - The total distance the <code>Ray</code> has traveled thus far. </p></li><li><p><code>shouldContinue()</code> - Whether or not the <code>Ray</code> should continue to be traced after <a href="../../syntax/RayKernels/index.html">RayKernels</a> and <a href="../../syntax/RayBCs/index.html">RayBCs</a> are executed. </p></li><li><p><code>setShouldContinue()</code> - Makes it possible to set a <code>Ray</code> to be killed after <a href="../../syntax/RayKernels/index.html">RayKernels</a> and <a href="../../syntax/RayBCs/index.html">RayBCs</a> are executed. </p></li><li><p><code>getInfo()</code> - Helper method for creating a <code>std::string</code> with useful information about the <code>Ray</code>.</p></li></ul><section class="scrollspy" id="25bdf47a-fd39-43a3-950a-522a34b0718f" data-section-level="2" data-section-text="Defining a Ray Trajectory"><h2 id="defining-a-ray-trajectory">Defining a Ray Trajectory</h2><p>A <code>Ray</code>&#x27;s trajectory defines where it is going to be traced by the <a href="Ray.html#modifying-a-ray-trajectory">RayTracingStudy.md]. This description is <em>only</em> for defining a <code>Ray</code>&#x27;s trajectory before it is being traced. To change a <code>Ray</code>&#x27;s trajectory mid-trace, see [Modifying a Ray Trajectory</a>. </p><p>There are two methods that you should start with to define a <code>Ray</code>&#x27;s trajectory to be traced:</p><ul class="browser-default"><li><p><code>setStartEnd()</code>: Takes as arguments a starting point and an end point. This is to be used for a <code>Ray</code> that is to be killed at a specific point _within_ the mesh. That is, it will be traced until it hits said end point within the mesh. For optimization purposes, if you want your <code>Ray</code> to end on a boundary, you should instead use the <code>setStartDirection()</code> method and have a <a href="../../syntax/RayBCs/index.html">RayBC</a> that kills the <code>Ray</code> on the boundary, like a <a href="../ray_bcs/KillRayBC.html">KillRayBC</a>. </p></li><li><p><code>setStartDirection()</code>: Takes as arguments a starting point and a direction. This is to be used for a <code>Ray</code> that is to be killed by either a <a href="../../syntax/RayKernels/index.html">RayKernel</a> or a <a href="../../syntax/RayBCs/index.html">RayBC</a> along its trajectory.</p></li></ul><p>With either the start/end or start/direction set, you must also set the element for the <code>Ray</code> to start in via <code>setStartingElem()</code>. In addition, if the <code>Ray</code> starts on a side of an element, you should also use <code>setIncomingSide()</code> to set said side. This side <em></em>must** be incoming for the <code>Ray</code>, meaning the dot product of the outward normal of the side and the direction must be negative.</p><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>The generation of rays can easily become a very complicated task. When a <code>Ray</code> is added to the buffer to be traced, it must be on the processor that its starting element is on or if on a processor boundary on a neighboring processor to the starting element. It is recommended that you first see if the <a href="RepeatableRayStudy.html">RepeatableRayStudy</a> is sufficient for the generation of Rays for your use case.</p></p></div></div></div></section><section class="scrollspy" id="0a1b73bb-3ec9-4adf-8946-16ee4f7adc02" data-section-level="2" data-section-text="Modifying a Ray Trajectory"><h2 id="modifying-a-ray-trajectory">Modifying a Ray Trajectory</h2><p>It is possible to modify the trajectory of a <code>Ray</code> while it is being traced via <a href="../../syntax/RayKernels/index.html">RayKernels</a> and <a href="../../syntax/RayBCs/index.html">RayBCs</a>:</p><p>To modify the trajectory of a <code>Ray</code> mid trace, see:</p><ul class="browser-default"><li><p><a href="../../syntax/RayKernels/index.html#changing-the-ray-trajectory">Changing the Ray Trajectory</a> for changing a <code>Ray</code>&#x27;s trajectory in a <a href="../../syntax/RayKernels/index.html">RayKernel</a> </p></li><li><p><a href="../../syntax/RayBCs/index.html#changing-the-ray-trajectory">Changing the Ray Trajectory</a> for changing a <code>Ray</code>&#x27;s trajectory in a <a href="../../syntax/RayBCs/index.html">RayBC</a></p></li></ul></section><section class="scrollspy" id="9cdd5006-4fcb-4cf9-81eb-1c3f563ed78c" data-section-level="2" data-section-text="Using Ray Data"><h2 id="using-ray-data">Using Ray Data</h2><p>In its simplest form, <code>Ray</code> data is a vector of arbitrarily sized data and auxiliary data that lives on the <code>Ray</code> and remains until it is changed.</p><p>In order to ensure that said data is sized appropriately for the use case, a system exists to register the need for data in the <a href="RayTracingStudy.html">RayTracingStudy</a>. This guarantees that <a href="RayTracingStudy.html">RayTracingStudy</a> objects, all <a href="../../syntax/RayBCs/index.html">RayBC</a> objects, and all <a href="../../syntax/RayKernels/index.html">RayKernel</a> objects will have access to the data that they need on all <code>Ray</code>s that are traced. This registration devises an index into the <code>Ray</code> data and auxiliary data and sizes that all <code>Ray</code> data and auxiliary data should be sized to. For more information, see TODO.</p><p>Many of the internal methods for <code>Ray</code> generation ensure that the data and auxiliary data is sized appropriately before and during the trace. If you develop a custom routine for <code>Ray</code> generation, it may be necessary to resize the data before per the sizes required by the <code>Ray</code> data registration in the <a href="RayTracingStudy.html">RayTracingStudy</a> via <code>RayTracingStudy::rayDataSize()</code> and <code>RayTracingStudy::rayAuxDataSize()</code>.</p><p>With a specific data or auxiliary data index, the data are accessed using the <code>data()</code> and <code>auxData()</code> member variables on the <code>Ray</code>.</p></section><section class="scrollspy" id="f6e3f578-c4a2-4534-b1ef-353ac517268a" data-section-level="2" data-section-text="Getting a Ray"><h2 id="getting-a-ray">Getting a Ray</h2><p>The <a href="RayTracingStudy.html">RayTracingStudy</a> has a &quot;pool&quot; of <code>Ray</code> objects available for use. This pool allows for previously-allocated <code>Ray</code> objects that are no longer in use to be reset and re-used without deallocating and allocating memory again. With this, it is recommended to _always_ use this pool to obtain new <code>Ray</code> objects for tracing.</p><p>To acquire a <code>Ray</code>, use <code>RayTracingStudy::acquireRay()</code>. For acquiring <code>Ray</code>s during tracing within <a href="../../syntax/RayBCs/index.html">RayBCs</a> and <a href="../../syntax/RayKernels/index.html">RayKernels</a>, there exist specialized methods for acquiring and initializing <code>Ray</code>s: <code>RayBoundaryConditionBase::acquireRay()</code> and <code>RayKenelBase::acquireRay()</code>.</p><p></p></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#25bdf47a-fd39-43a3-950a-522a34b0718f" class="tooltipped" data-position="left" data-tooltip="Defining a Ray Trajectory">Defining a Ray Trajectory</a></li><li><a href="#0a1b73bb-3ec9-4adf-8946-16ee4f7adc02" class="tooltipped" data-position="left" data-tooltip="Modifying a Ray Trajectory">Modifying a Ray Trajectory</a></li><li><a href="#9cdd5006-4fcb-4cf9-81eb-1c3f563ed78c" class="tooltipped" data-position="left" data-tooltip="Using Ray Data">Using Ray Data</a></li><li><a href="#f6e3f578-c4a2-4534-b1ef-353ac517268a" class="tooltipped" data-position="left" data-tooltip="Getting a Ray">Getting a Ray</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>