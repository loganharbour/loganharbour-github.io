<!DOCTYPE html><head><meta charset="UTF-8"><title>FunctionDT.md|MOOSE Ray Tracing Module</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="/modules/ray_tracing" class="left moose-logo hide-on-med-and-down">MOOSE Ray Tracing Module</a><a href="https://github.com/idaholab/moose" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="58ba5804-ef52-453a-84e2-ada7e70a85e6"><i class="material-icons">menu</i></a><ul class="sidenav" id="58ba5804-ef52-453a-84e2-ada7e70a85e6"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/modules/ray_tracing" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">timesteppers</span><a href="#" class="breadcrumb">FunctionDT</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="0d8074dd-afcb-417e-bdb2-42695951ddd3" data-section-level="1" data-section-text="FunctionDT"><h1 id="functiondt">FunctionDT</h1><p>Timestepper whose steps vary over time according to a user-defined function</p><section class="scrollspy" id="61e5c2b0-b1ec-4e1b-a7d7-c0f6745d0925" data-section-level="2" data-section-text="Description"><h2 id="description">Description</h2><p>The <code>FunctionDT</code> type of TimeStepper takes time steps that vary over time according to a user-defined function.</p><p>The time step is controlled by a piecewise linear function defined using the <code>time_t</code> and <code>time_dt</code> parameters. A vector of time steps is provided using the <code>time_dt</code> parameter. An accompanying vector of corresponding times is specified using the <code>time_t</code> parameter. These two vectors are used to form a time step vs. time function. The time step for a given step is computed by linearly interpolating between the pairs of values provided in the vectors.</p><p>The same procedure that is used with <a href="ConstantDT.html">ConstantDT</a> is used to reduce the time step from the user-specified value if a failed solution occurs.</p></section><section class="scrollspy" id="f1cd3f54-a71b-49ed-8bf0-9f949114e650" data-section-level="2" data-section-text="Example Input Syntax"><h2 id="example-input-syntax">Example Input Syntax</h2><pre class="moose-pre"><code class="language-text">[Executioner]
  type = Transient

  start_time = 0
  num_steps = 10
  [./TimeStepper]
    type = FunctionDT
    function = dts
    min_dt = 0.1
  [../]
[]
</code></pre><a href="#9b2289d2-f023-48c2-ada0-37c06e06c634" class="modal-trigger">(test/tests/time_steppers/function_dt/function_dt_min.i)</a><div class="modal moose-modal" id="9b2289d2-f023-48c2-ada0-37c06e06c634"><div class="modal-content"><h4>/Users/harblh/projects/moc/private_moose/test/tests/time_steppers/function_dt/function_dt_min.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = -1
  xmax =  1
  ymin = -1
  ymax =  1
  nx = 2
  ny = 2
  elem_type = QUAD9
[]

[Functions]
  [./exact_fn]
    type = ParsedFunction
    value = t*t*(x*x+y*y)
  [../]

  [./forcing_fn]
    type = ParsedFunction
    value = 2*t*(x*x+y*y)-4*t*t
  [../]

  [./dts]
    type = PiecewiseLinear
    x = &#x27;0   0.85 2&#x27;
    y = &#x27;0.2 0.2  0.2&#x27;
  [../]
[]

[Variables]
  [./u]
    family = LAGRANGE
    order = SECOND
  [../]
[]

[ICs]
  [./u_var]
    type = FunctionIC
    variable = u
    function = exact_fn
  [../]
[]

[Kernels]
  [./td]
    type = TimeDerivative
    variable = u
  [../]

  [./diff]
    type = Diffusion
    variable = u
  [../]

  [./ffn]
    type = BodyForce
    variable = u
    function = forcing_fn
  [../]
[]

[BCs]
  [./all]
    type = FunctionDirichletBC
    variable = u
    boundary = &#x27;left right top bottom&#x27;
    function = exact_fn
  [../]
[]

[Executioner]
  type = Transient

  start_time = 0
  num_steps = 10
  [./TimeStepper]
    type = FunctionDT
    function = dts
    min_dt = 0.1
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section><section class="scrollspy" id="89f1d626-77e3-481a-8f61-793517c124af" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="cf437966-f210-443b-af33-c1b13d2626d0" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">cutback_factor_at_failure</span><span class="moose-parameter-header-default">0.5</span><span class="moose-parameter-header-description">Factor to apply to timestep if it a time step fails to convergence.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0.5</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Factor to apply to timestep if it a time step fails to convergence.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">function</span><span class="moose-parameter-header-description">The name of the time-dependent function that prescribes the time step size.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>FunctionName</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The name of the time-dependent function that prescribes the time step size.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">growth_factor</span><span class="moose-parameter-header-default">1.79769e+308</span><span class="moose-parameter-header-description">Maximum ratio of new to previous timestep sizes following a step that required the time step to be cut due to a failed solve.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1.79769e+308</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Maximum ratio of new to previous timestep sizes following a step that required the time step to be cut due to a failed solve.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">interpolate</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Whether or not to interpolate DT between times.  This is true by default for historical reasons.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Whether or not to interpolate DT between times.  This is true by default for historical reasons.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">min_dt</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The minimal dt to take.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The minimal dt to take.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">reset_dt</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Use when restarting a calculation to force a change in dt.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Use when restarting a calculation to force a change in dt.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">time_dt</span><span class="moose-parameter-header-description">The values of dt</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<double></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The values of dt</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">time_t</span><span class="moose-parameter-header-description">The values of t</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<double></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The values of t</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="56da0add-19bf-4598-95c8-86cc97ea5736" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<std::string></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section></section><section class="scrollspy" id="1323a91d-2aec-4f66-bcb6-abb0606526f2" data-section-level="2" data-section-text="Input Files"><h2 id="input-files">Input Files</h2><ul class="moose-list-inputs browser-default"><li><a href="#cf98f69a-0e44-4133-b440-3a48cacdb970" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_lumped_18.i</a></li><li><a href="#b79584a6-f53f-45ae-a57f-ed7503acd7f2" class="modal-trigger">test/tests/time_steppers/function_dt/function_dt_no_interpolation.i</a></li><li><a href="#344c5f09-5db6-42ab-8f4e-aff8403ebff4" class="modal-trigger">modules/richards/test/tests/theis/th02.i</a></li><li><a href="#3c6f2481-2d84-424f-bf99-416cc619452e" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_lumped_08.i</a></li><li><a href="#63537809-f448-4c6a-9907-4f81fb37ca40" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rd02.i</a></li><li><a href="#757dcc76-db41-439a-a4e1-dcc1369150ef" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh04.i</a></li><li><a href="#32327ab1-da46-4e11-acd5-69732c3931a4" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/bw01.i</a></li><li><a href="#559b7b29-be4a-4c04-96f8-7c64e733bc5b" class="modal-trigger">modules/richards/test/tests/buckley_leverett/bl20_lumped_fu.i</a></li><li><a href="#f4b6faa5-3f2d-48d6-ade4-2b1e8e8d0221" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh06.i</a></li><li><a href="#df337387-a0bc-41c9-b0d4-26207de274af" class="modal-trigger">modules/geochemistry/test/tests/time_dependent_reactions/seawater_evaporation_no_flow_through.i</a></li><li><a href="#2341dd5a-c3ca-4cac-80fe-f63a0b258a93" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rd03.i</a></li><li><a href="#11a36ce7-a6ff-4491-b4aa-5e7d48a7d8cc" class="modal-trigger">modules/tensor_mechanics/test/tests/combined_creep_plasticity/combined_stress_relaxation.i</a></li><li><a href="#9672f943-5a68-4294-b68a-84ec458f4413" class="modal-trigger">tutorials/darcy_thermo_mech/step07_adaptivity/problems/step7c_adapt.i</a></li><li><a href="#3c2391f4-a528-4405-a516-bd705462bc1a" class="modal-trigger">modules/richards/test/tests/rogers_stallybrass_clements/rsc02.i</a></li><li><a href="#61891572-8b39-4e2a-b82e-a53920b98710" class="modal-trigger">modules/richards/test/tests/broadbridge_white/bw_lumped_02.i</a></li><li><a href="#d8bf2aff-7a36-4768-8deb-b70f23600642" class="modal-trigger">test/tests/multiapps/picard/function_dt_master.i</a></li><li><a href="#92909a6d-1111-4733-a886-0c6148612960" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_05.i</a></li><li><a href="#324f7d4c-cf8f-42ce-a2a7-2ef78fbb6a13" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh07.i</a></li><li><a href="#1fc2fee3-119c-4180-a198-c1acded70b51" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_lumped_17.i</a></li><li><a href="#3991f8d1-6c86-46db-8bba-085fca5b37ea" class="modal-trigger">modules/richards/test/tests/gravity_head_2/ghQ2P_pgas.i</a></li><li><a href="#0f13df69-faae-4cb0-aeb0-61b17a3fe37c" class="modal-trigger">modules/richards/test/tests/dirac/bh05.i</a></li><li><a href="#1c5bf642-0557-4a79-a6f3-3ae844ffb9eb" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav02d.i</a></li><li><a href="#adf8fbd5-4f60-451c-8b6b-85d413575a15" class="modal-trigger">modules/richards/test/tests/theis/th22.i</a></li><li><a href="#9fad5b19-b473-4ed1-baaa-bcc6ba03ff73" class="modal-trigger">modules/richards/test/tests/dirac/bh07.i</a></li><li><a href="#88400e31-01e4-43d2-a2d0-1ce983ffda53" class="modal-trigger">modules/richards/test/tests/recharge_discharge/rd01.i</a></li><li><a href="#978ca550-0411-444e-bde9-fb9661c764a7" class="modal-trigger">modules/geochemistry/test/tests/time_dependent_reactions/seawater_evaporation_flow_through.i</a></li><li><a href="#d8d434bb-bbeb-4c52-8ff8-9029e09f80ab" class="modal-trigger">modules/richards/test/tests/dirac/bh27.i</a></li><li><a href="#555776e3-1b1e-4433-932e-9a9a5e987e45" class="modal-trigger">modules/richards/test/tests/dirac/bh_fu_08.i</a></li><li><a href="#ac9f7a56-5947-4404-80ec-5f5766ed0023" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_06.i</a></li><li><a href="#07d0e95c-dc12-46d4-8731-c929def19431" class="modal-trigger">test/tests/time_steppers/function_dt/function_dt_min.i</a></li><li><a href="#0fcc01d4-2fcf-4d29-b249-f4641cdfc23b" class="modal-trigger">modules/richards/test/tests/rogers_stallybrass_clements/rsc01.i</a></li><li><a href="#b9bd4370-e9f3-45a6-ab4d-fea98c431239" class="modal-trigger">modules/richards/test/tests/gravity_head_1/gh22.i</a></li><li><a href="#052a61f6-7780-4895-9a02-a9c27b9624fa" class="modal-trigger">modules/geochemistry/test/tests/time_dependent_reactions/mixing.i</a></li><li><a href="#88180543-589f-4f30-b6cf-36ffe5fbc9f9" class="modal-trigger">modules/richards/test/tests/buckley_leverett/bl21.i</a></li><li><a href="#66b821bb-df70-4856-9de3-d2051333ac3a" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_17.i</a></li><li><a href="#d4f48d3c-5730-4c41-b477-0340d36599e9" class="modal-trigger">modules/richards/test/tests/gravity_head_1/gh20.i</a></li><li><a href="#0a561bd6-bca6-4441-bf3f-6eed054bdf64" class="modal-trigger">tutorials/darcy_thermo_mech/step10_multiapps/problems/step10.i</a></li><li><a href="#6defb1a1-64b2-424a-acdb-5a78cec5110e" class="modal-trigger">modules/richards/test/tests/gravity_head_1/gh23.i</a></li><li><a href="#318cc0a7-cadc-4013-89f2-5f6dc93fdee2" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/bw02.i</a></li><li><a href="#4ca3608b-d359-43c4-9a3b-e09018051c70" class="modal-trigger">test/tests/time_steppers/cutback_factor_at_failure/function_dt_cutback.i</a></li><li><a href="#e5e5b64b-610f-46cb-be0b-29aa8b642a2a" class="modal-trigger">modules/porous_flow/examples/flow_through_fractured_media/fine_transient.i</a></li><li><a href="#384b1057-639f-4454-ae3a-61772fd723d4" class="modal-trigger">modules/richards/test/tests/gravity_head_1/gh_fu_22.i</a></li><li><a href="#002e62fd-e480-4919-ac5c-d3510c937687" class="modal-trigger">tutorials/darcy_thermo_mech/step07_adaptivity/problems/step7a_coarse.i</a></li><li><a href="#a1911adb-b6c9-4ac2-8f73-6536a1825e19" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh18.i</a></li><li><a href="#b0ba0cd7-b801-42f9-afaa-d7519a3fc53e" class="modal-trigger">modules/richards/test/tests/dirac/q2p01.i</a></li><li><a href="#89a25292-f4da-46c1-b026-7dde8c6a91ae" class="modal-trigger">modules/richards/test/tests/broadbridge_white/bw01.i</a></li><li><a href="#d4c53d5b-47ac-4045-a587-1f1eeb73d8a3" class="modal-trigger">tutorials/darcy_thermo_mech/step07_adaptivity/problems/step7d_adapt_blocks.i</a></li><li><a href="#7865d87e-0fb2-41d6-8928-1772e84311dc" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_fu_18.i</a></li><li><a href="#ef848109-7d29-4695-87b8-38855c168eec" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rsc01.i</a></li><li><a href="#5aaf24e2-77ec-4d92-a595-e87bd335ba2a" class="modal-trigger">modules/richards/test/tests/theis/th_lumped_01.i</a></li><li><a href="#e2831a74-dd06-4d07-b6c4-bf5b4f5cddda" class="modal-trigger">modules/tensor_mechanics/test/tests/combined_creep_plasticity/combined_creep_plasticity_start_time.i</a></li><li><a href="#e85f3760-e028-4797-ad75-61045a2fc6c4" class="modal-trigger">modules/richards/test/tests/dirac/bh_fu_05.i</a></li><li><a href="#ebaa0be3-8f99-42b5-92b5-c461bfe9d798" class="modal-trigger">modules/richards/test/tests/gravity_head_1/gh_fu_20.i</a></li><li><a href="#f780cb7e-b54f-43ab-aea5-404e9a741583" class="modal-trigger">modules/richards/test/tests/rogers_stallybrass_clements/rsc_lumped_01.i</a></li><li><a href="#1059d549-4c96-4e09-8e55-1e8153b082a3" class="modal-trigger">modules/richards/test/tests/theis/th_lumped_02.i</a></li><li><a href="#d965b387-56f7-4b7d-b5d0-94cfefa4bd04" class="modal-trigger">modules/tensor_mechanics/test/tests/j_integral_vtest/c_int_surfbreak_ellip_crack_sym_mm.i</a></li><li><a href="#696286b3-1ef1-4e0b-97b2-375b25ab2bf1" class="modal-trigger">modules/richards/test/tests/theis/th01.i</a></li><li><a href="#f88c6d00-605a-4aca-894c-aa5d2647e32f" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh_lumped_07.i</a></li><li><a href="#9c74233a-e46d-4587-a4cb-1485a5f34dbc" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh05.i</a></li><li><a href="#b810becb-fc69-4d53-a6d3-7246f8a7365c" class="modal-trigger">modules/tensor_mechanics/test/tests/combined_creep_plasticity/combined_creep_plasticity.i</a></li><li><a href="#39303e46-3b55-4a48-a89a-3411c9884e2e" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rsc02.i</a></li><li><a href="#a54cd0d5-f587-4a8e-8121-a86ed780d90c" class="modal-trigger">modules/richards/test/tests/broadbridge_white/bw02.i</a></li><li><a href="#4335d8e7-4dd5-499d-bef2-b51d87156b4f" class="modal-trigger">tutorials/darcy_thermo_mech/step07_adaptivity/problems/step7b_fine.i</a></li><li><a href="#c4546f04-5796-4061-9dba-dc3f13500392" class="modal-trigger">tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/problems/step6b_transient_inflow.i</a></li><li><a href="#a0d04eaf-cc84-4774-8f72-7ea517f266d1" class="modal-trigger">test/tests/multiapps/multilevel/time_dt_from_master_master.i</a></li><li><a href="#b2db2ba0-fae4-46bc-8354-93c752d1da41" class="modal-trigger">modules/richards/test/tests/rogers_stallybrass_clements/rsc_fu_02.i</a></li><li><a href="#1c96a674-c8bd-4f8f-8b6d-a1a10698d591" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh05.i</a></li><li><a href="#16f17885-c91c-4de4-8d29-b7a53b7bfc04" class="modal-trigger">modules/richards/test/tests/buckley_leverett/bl20_lumped.i</a></li><li><a href="#62f96c5e-2f06-4e93-ba40-841e12742b5f" class="modal-trigger">modules/richards/test/tests/dirac/bh_fu_04.i</a></li><li><a href="#199db4bc-05e8-4d68-8e16-805b767de91e" class="modal-trigger">modules/richards/test/tests/buckley_leverett/bl20.i</a></li><li><a href="#07b81647-d156-405d-83af-ebc93dc3e566" class="modal-trigger">modules/richards/test/tests/buckley_leverett/bl22_lumped_fu.i</a></li><li><a href="#e12b0a47-e3db-4bb5-b88b-bbfa3bcb28d0" class="modal-trigger">modules/geochemistry/test/tests/solubilities_and_activities/gypsum_solubility.i</a></li><li><a href="#6018af6a-c427-4b80-8e69-69e0c5803c4d" class="modal-trigger">modules/richards/test/tests/dirac/bh_lumped_07.i</a></li><li><a href="#12d553bc-7e97-41d0-b3f4-71638670ffb3" class="modal-trigger">test/tests/multiapps/sub_cycling_failure/sub_gold.i</a></li><li><a href="#8693880e-7a0e-4ddc-831d-ad526182776e" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh16.i</a></li><li><a href="#ee7a6bf8-fb51-4d19-9b0e-739838284a49" class="modal-trigger">modules/richards/test/tests/buckley_leverett/bl22_lumped.i</a></li><li><a href="#55a83f81-2c56-474c-af03-a0db1bf5e41a" class="modal-trigger">tutorials/darcy_thermo_mech/step09_mechanics/problems/step9.i</a></li><li><a href="#7923b52e-0dd6-4925-9b12-aaf754b187b0" class="modal-trigger">modules/porous_flow/examples/flow_through_fractured_media/fine_thick_fracture_transient.i</a></li><li><a href="#dd4fc3ba-490d-4ffe-8386-4a9251b32d1a" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh08.i</a></li><li><a href="#c865dcea-9e24-4135-8d8d-6c6bd8b84b53" class="modal-trigger">tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/problems/step6a_coupled.i</a></li><li><a href="#4c26b309-23af-4178-835e-67cae174ae97" class="modal-trigger">modules/porous_flow/test/tests/gravity/grav02c.i</a></li><li><a href="#641a5b8b-01f0-4c9f-a43a-55d9982823a1" class="modal-trigger">modules/tensor_mechanics/test/tests/combined_creep_plasticity/combined_stress_prescribed.i</a></li><li><a href="#90fbf520-cb27-4559-8ece-07f2ab35f4cc" class="modal-trigger">test/tests/multiapps/sub_cycling_failure/master_gold.i</a></li><li><a href="#9ac64a26-ed27-4646-9d2f-59c50c1df851" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh07.i</a></li><li><a href="#a9532ead-4620-4714-aae3-e09e8087cec4" class="modal-trigger">test/tests/multiapps/picard/function_dt_sub.i</a></li><li><a href="#ee3da686-5013-4a3e-b4f9-e319dbc9fa42" class="modal-trigger">modules/richards/test/tests/dirac/bh04.i</a></li><li><a href="#3e5ef2e6-881c-4f18-bed1-9bd6c7aa0cf8" class="modal-trigger">modules/richards/test/tests/buckley_leverett/bl22.i</a></li><li><a href="#2f52c779-da0c-4c4d-ad2f-ec6455194a9b" class="modal-trigger">modules/richards/test/tests/dirac/bh_fu_07.i</a></li><li><a href="#808086ea-8a68-49d2-9463-b29fa89b4042" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rd01.i</a></li><li><a href="#eabf539d-9614-4fbb-9d55-b047c2716a73" class="modal-trigger">modules/porous_flow/test/tests/buckley_leverett/bl01.i</a></li><li><a href="#4e5cc737-e43e-48d1-b9e7-5ad53d1e49fb" class="modal-trigger">modules/richards/test/tests/recharge_discharge/rd02.i</a></li><li><a href="#6fb67f8e-dd81-46a5-b245-e1654df24bc9" class="modal-trigger">test/tests/auxkernels/time_integration/time_integration.i</a></li><li><a href="#7c059551-253a-4d85-8bdd-b706ca724dcd" class="modal-trigger">modules/richards/test/tests/rogers_stallybrass_clements/rsc_fu_01.i</a></li><li><a href="#fcc259ec-df29-4ed7-b19c-cd9f90bca0d6" class="modal-trigger">tutorials/darcy_thermo_mech/step08_postprocessors/problems/step8.i</a></li><li><a href="#e74b3bca-f7f5-4046-a77e-a1298f2b5cf5" class="modal-trigger">modules/richards/test/tests/gravity_head_2/gh17.i</a></li><li><a href="#19325e12-6a2a-4db4-adf3-9c508b6fcc8e" class="modal-trigger">tutorials/darcy_thermo_mech/step11_action/problems/step11.i</a></li><li><a href="#820a7cf1-9246-4ca8-bfbd-991c9135c719" class="modal-trigger">modules/geochemistry/test/tests/kinetics/quartz_dissolution.i</a></li><li><a href="#9263aabb-d1d0-411b-a0ff-032a97e0f23b" class="modal-trigger">modules/richards/test/tests/gravity_head_1/gh21.i</a></li><li><a href="#28d529ca-64bf-442c-aac0-99c0861e3838" class="modal-trigger">modules/richards/test/tests/recharge_discharge/rd03.i</a></li><li><a href="#1a940fd3-0011-49e3-828d-39890aa81389" class="modal-trigger">modules/richards/test/tests/theis/th21.i</a></li><li><a href="#c81b0407-ece6-4f78-8a28-0ed252a4e0a2" class="modal-trigger">modules/richards/test/tests/theis/th_lumped_22.i</a></li></ul><div class="modal moose-modal" id="cf98f69a-0e44-4133-b440-3a48cacdb970"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_lumped_18.i</h4><pre class="moose-pre"><code class="language-text"># with immobile saturation
# unsaturated = true
# gravity = true
# supg = true
# transient = true
# lumped = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 0.5E-3&#x27;
  gravity = &#x27;-1 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 0.5E1 0.5E2 0.4E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.4
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh_lumped_18
  execute_on = &#x27;timestep_end final&#x27;
  interval = 100000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b79584a6-f53f-45ae-a57f-ed7503acd7f2"><div class="modal-content"><h4>test/tests/time_steppers/function_dt/function_dt_no_interpolation.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = -1
  xmax =  1
  ymin = -1
  ymax =  1
  nx = 2
  ny = 2
  elem_type = QUAD9
[]

[Functions]
  [./exact_fn]
    type = ParsedFunction
    value = t*t*(x*x+y*y)
  [../]

  [./forcing_fn]
    type = ParsedFunction
    value = 2*t*(x*x+y*y)-4*t*t
  [../]

  [./dts]
    type = PiecewiseConstant
    x = &#x27;0  4  8 12  20&#x27;
    y = &#x27;0  1  2  4  8&#x27;
    direction = right
  [../]
[]

[Variables]
  [./u]
    family = LAGRANGE
    order = SECOND
  [../]
[]

[ICs]
  [./u_var]
    type = FunctionIC
    variable = u
    function = exact_fn
  [../]
[]

[Kernels]
  [./td]
    type = TimeDerivative
    variable = u
  [../]

  [./diff]
    type = Diffusion
    variable = u
  [../]

  [./ffn]
    type = BodyForce
    variable = u
    function = forcing_fn
  [../]
[]

[BCs]
  [./all]
    type = FunctionDirichletBC
    variable = u
    boundary = &#x27;left right top bottom&#x27;
    function = exact_fn
  [../]
[]

[Executioner]
  type = Transient

  start_time = 0
  end_time = 20
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="344c5f09-5db6-42ab-8f4e-aff8403ebff4"><div class="modal-content"><h4>modules/richards/test/tests/theis/th02.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = FileMesh
  file = th02_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 2 4 20&#x27;
    x = &#x27;0 1 10 100&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]

  [./total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsPolyLineSink
    pressures = &#x27;-1E9 1E9&#x27;
    fluxes = &#x27;200 200&#x27;
    point_file = th01.points
    SumQuantityUO = total_outflow_mass
    variable = pressure
  [../]
[]


[Postprocessors]
  [./flow_report]
    type = RichardsPlotQuantity
    uo = total_outflow_mass
  [../]
  [./p50]
    type = PointValue
    variable = pressure
    point = &#x27;50 0 0&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E5
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-6 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 100
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = th02
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3c6f2481-2d84-424f-bf99-416cc619452e"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_lumped_08.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = true
# transient = true
# lumped = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 0.5E-3&#x27;
  gravity = &#x27;-1 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_lumped_08
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="63537809-f448-4c6a-9907-4f81fb37ca40"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rd02.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 120
  ny = 1
  xmin = 0
  xmax = 6
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1 10 500 5000 50000&#x27;
    x = &#x27;0 10 100 1000 10000 500000&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.336
    alpha = 1.43e-4
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      viscosity = 1.01e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityVG
    m = 0.336
    seff_turnover = 0.99
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.33
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.295E-12 0 0  0 0.295E-12 0  0 0 0.295E-12&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = 0.0
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-10 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./base]
    type = DirichletBC
    boundary = left
    value = 0.0
    variable = pressure
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;6 0 0&#x27;
    sort_by = x
    num_points = 121
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 345600

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rd02
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
  [./along_line]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="757dcc76-db41-439a-a4e1-dcc1369150ef"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh04.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1 1E1 1E2 1E3&#x27;
    x = &#x27;0 1E-1 1 1E1 1E2 1E3&#x27;
  [../]
[]

[Variables]
  [./pp]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityFLAC
    m = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    variable = pp
    SumQuantityUO = borehole_total_outflow_mass
    point_file = bh02.bh
    fluid_phase = 0
    bottom_p_or_t = -1E6
    unit_weight = &#x27;0 0 0&#x27;
    use_mobility = true
    character = 1
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]

[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1E3
  solve_type = NEWTON
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bh04
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="32327ab1-da46-4e11-acd5-69732c3931a4"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/bw01.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 400
  ny = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-5 1E-2 1E-2 1E-1&#x27;
    x = &#x27;0 1E-5 1 10&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureBW
    Sn = 0.0
    Ss = 1.0
    C = 1.5
    las = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 4
      density0 = 10
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityBW
    Sn = 0.0
    Ss = 1.0
    Kn = 0
    Ks = 1
    C = 1.5
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 1 0  0 0 1&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = -9E2
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-0.1 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./recharge]
    type = PorousFlowSink
    variable = pressure
    boundary = right
    flux_function = -1.25 # corresponds to Rstar being 0.5 because i have to multiply by density*porosity
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;-10 0 0&#x27;
    end_point = &#x27;10 0 0&#x27;
    sort_by = x
    num_points = 101
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 8

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bw01
  sync_times = &#x27;0.5 2 8&#x27;
  [./exodus]
    type = Exodus
    sync_only = true
  [../]
  [./along_line]
    type = CSV
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="559b7b29-be4a-4c04-96f8-7c64e733bc5b"><div class="modal-content"><h4>modules/richards/test/tests/buckley_leverett/bl20_lumped_fu.i</h4><pre class="moose-pre"><code class="language-text"># two-phase version
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 30
  xmin = 0
  xmax = 15
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;0.1 0.5 0.5 1 2  4&#x27;
    x = &#x27;0   0.1 1   5 40 42&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E6
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1E-5
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./w_aux_seff]
  [../]
[]



[Kernels]
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]

[AuxKernels]
  [./w_aux_seff_auxk]
    type = RichardsSeffAux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
    variable = w_aux_seff
  [../]
[]


[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_water
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_gas
  [../]
[]

[BCs]
  [./left_w]
    type = DirichletBC
    variable = pwater
    boundary = left
    value = 1E6
  [../]
  [./left_g]
    type = DirichletBC
    variable = pgas
    boundary = left
    value = 1000
  [../]
  [./right_w]
    type = DirichletBC
    variable = pwater
    boundary = right
    value = -300000
  [../]
  [./right_g]
    type = DirichletBC
    variable = pgas
    boundary = right
    value = 0
  [../]
[]


[Functions]
  [./initial_water]
    type = ParsedFunction
    value = 1000000*(1-min(x/5,1))-if(x&lt;5,0,300000)
  [../]
  [./initial_gas]
    type = ParsedFunction
    value = 1000
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.15
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    viscosity = &#x27;1E-3 1E-6&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  active = &#x27;standard&#x27;

  [./bounded]
  # must use --use-petsc-dm command line argument
    type = SMP
    full = true
    petsc_options_iname = &#x27;-snes_type -pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;vinewtonssls nonzero&#x27;
  [../]

  [./standard]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;nonzero&#x27;
  [../]

[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 50

  nl_rel_tol = 1.e-9
  nl_max_its = 10

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bl20_lumped_fu
  execute_on = &#x27;initial timestep_end final&#x27;
  interval = 100000
  exodus = true
  hide = pgas
  [./console_out]
    type = Console
    interval = 1
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f4b6faa5-3f2d-48d6-ade4-2b1e8e8d0221"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh06.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = false
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh06
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="df337387-a0bc-41c9-b0d4-26207de274af"><div class="modal-content"><h4>modules/geochemistry/test/tests/time_dependent_reactions/seawater_evaporation_no_flow_through.i</h4><pre class="moose-pre"><code class="language-text">#Progressively remove H2O until virtually none remains
[UserObjects]
  [./definition]
    type = GeochemicalModelDefinition
    database_file = &quot;../../../database/moose_geochemdb.json&quot;
    basis_species = &quot;H2O H+ Cl- Ca++ Mg++ Na+ K+ SO4-- HCO3-&quot;
    equilibrium_minerals = &quot;Dolomite Epsomite Gypsum Halite Magnesite Mirabilite Sylvite&quot;
    equilibrium_gases = &quot;CO2(g)&quot;
    piecewise_linear_interpolation = true # for precise agreement with GWB
  [../]
[]

[TimeDependentReactionSolver]
  model_definition = definition
  geochemistry_reactor_name = reactor
  swap_out_of_basis = &quot;H+&quot;
  swap_into_basis = &quot;  CO2(g)&quot;
  charge_balance_species = &quot;Cl-&quot; # this means the bulk moles of Cl- will not be exactly as set below
  constraint_species = &quot;H2O              CO2(g)       Cl-                Na+                SO4--              Mg++               Ca++               K+                 HCO3-&quot;
  constraint_value = &quot;  1.0              0.0003162278 0.5656             0.4850             0.02924            0.05501            0.01063            0.010576055        0.002412&quot;
  constraint_meaning = &quot;kg_solvent_water fugacity     moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species&quot;
  close_system_at_time = 0
  source_species_names = &quot;H2O&quot;
  source_species_rates = &quot;-1.0&quot; # 1kg H2O = 55.51 moles, each time step removes 1 mole
  mode = mode
  ramp_max_ionic_strength_initial = 0 # not needed in this simple example
  stoichiometric_ionic_str_using_Cl_only = true # for precise agreement with GWB
  execute_console_output_on = &#x27;&#x27; # only CSV output for this example
[]

[Functions]
  [./timestepper]
    type = PiecewiseLinear
    x = &#x27;0 50 55&#x27;
    y = &#x27;5 5 1&#x27;
  [../]
[]

[Executioner]
  type = Transient
  [./TimeStepper]
    type = FunctionDT
    function = timestepper
  [../]
  end_time = 55
[]

[AuxVariables]
  [./mode]
  [../]
[]

[AuxKernels]
  [./mode]
    type = FunctionAux
    variable = mode
    function = &#x27;if(t&lt;=1.0, 1.0, 0.0)&#x27; # initial &quot;dump&quot; then &quot;normal&quot;
    execute_on = &#x27;timestep_begin&#x27;
  [../]
[]

[GlobalParams]
  point = &#x27;0 0 0&#x27;
[]
[Postprocessors]
  [./solvent_kg]
    type = PointValue
    variable = &#x27;kg_solvent_H2O&#x27;
  [../]
  [./dolomite]
    type = PointValue
    variable = &#x27;free_cm3_Dolomite&#x27;
  [../]
  [./gypsum]
    type = PointValue
    variable = &#x27;free_cm3_Gypsum&#x27;
  [../]
  [./halite]
    type = PointValue
    variable = &#x27;free_cm3_Halite&#x27;
  [../]
  [./mirabilite]
    type = PointValue
    variable = &#x27;free_cm3_Mirabilite&#x27;
  [../]
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2341dd5a-c3ca-4cac-80fe-f63a0b258a93"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rd03.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  file = gold/rd02.e
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;2E4 1E6&#x27;
    x = &#x27;0 1E6&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.336
    alpha = 1.43e-4
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      viscosity = 1.01e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityVG
    m = 0.336
    seff_turnover = 0.99
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.33
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.295E-12 0 0  0 0.295E-12 0  0 0 0.295E-12&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_from_file_timestep = LATEST
    initial_from_file_var = pressure
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-10 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./base]
    type = DirichletBC
    boundary = left
    value = 0.0
    variable = pressure
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;6 0 0&#x27;
    sort_by = x
    num_points = 121
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 8.2944E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rd03
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
  [./along_line]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="11a36ce7-a6ff-4491-b4aa-5e7d48a7d8cc"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/combined_creep_plasticity/combined_stress_relaxation.i</h4><pre class="moose-pre"><code class="language-text">#
# 1x1x1 unit cube with constant displacement on top face
#
# This problem was taken from &quot;Finite element three-dimensional elastic-plastic
#    creep analysis&quot; by A. Levy, Eng. Struct., 1981, Vol. 3, January, pp. 9-16.
#
# The problem is a one-dimensional creep analysis.  The top face is displaced 0.01
#    units and held there.  The stress relaxes in time according to the creep law.
#
# The analytic solution to this problem is (contrary to what is shown in the paper):
#
#                 /      (E*ef)^3      \^(1/3)
#    stress_yy = |---------------------|
#                \ 3*a*E^4*ef^3*t + 1 /
#
#    where E  = 2.0e11  (Young&#x27;s modulus)
#          a  = 3e-26  (creep coefficient)
#          ef = 0.01   (displacement)
#          t  = 2160.0    (time)
#
#    such that the analytical solution is computed to be 2.9518e3 Pa
#
# Averaged over the single element block, MOOSE calculates the stress in the yy direction to be
#     to be 3.046e3 Pa, which is a 3.2% error from the analytical solution.
#

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1e-2 1e-1 1e0 1e1 1e2&#x27;
    x = &#x27;0    7e-1 7e0 7e1 1e2&#x27;
  [../]
[]

[Modules/TensorMechanics/Master]
  [./all]
    strain = FINITE
    incremental = true
    add_variables = true
    generate_output = &#x27;stress_yy creep_strain_xx creep_strain_yy creep_strain_zz elastic_strain_yy&#x27;
  [../]
[]

[BCs]
  [./u_top_pull]
    type = DirichletBC
    variable = disp_y
    boundary = top
    value = 0.01
  [../]
  [./u_bottom_fix]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
  [./u_yz_fix]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./u_xy_fix]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.0e11
    poissons_ratio = 0.3
  [../]
  [./radial_return_stress]
    type = ComputeMultipleInelasticStress
    tangent_operator = elastic
    inelastic_models = &#x27;power_law_creep&#x27;
  [../]
  [./power_law_creep]
    type = PowerLawCreepStressUpdate
    coefficient = 3.0e-26
    n_exponent = 4
    activation_energy = 0.0
    relative_tolerance = 1e-14
    absolute_tolerance = 1e-14
  [../]
[]

[Postprocessors]
  [./stress_yy]
    type = ElementAverageValue
    variable = stress_yy
  [../]
[]

[Executioner]
  type = Transient

  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp&#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;101&#x27;

  line_search = &#x27;none&#x27;

  l_max_its = 100
  nl_max_its = 100
  nl_rel_tol = 1e-5
  nl_abs_tol = 1e-8
  l_tol = 1e-5
  start_time = 0.0
  end_time = 2160

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9672f943-5a68-4294-b68a-84ec458f4413"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step07_adaptivity/problems/step7c_adapt.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 30
  ny = 3
  xmax = 0.304 # Length of test chamber
  ymax = 0.0257 # Test chamber radius
  uniform_refine = 3
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = right
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = left
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []

  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = right
  []
[]

[Materials]
  [column]
    type = PackedColumn
    radius = 1
    temperature = temperature
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = X
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  automatic_scaling = true

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  end_time = 100
  dt = 0.25
  start_time = -1

  steady_state_tolerance = 1e-5
  steady_state_detection = true

  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]

[Outputs]
  exodus = true
[]

[Adaptivity]
  marker = error_frac
  max_h_level = 3
  [Indicators]
    [temperature_jump]
      type = GradientJumpIndicator
      variable = temperature
      scale_by_flux_faces = true
    []
  []
  [Markers]
    [error_frac]
      type = ErrorFractionMarker
      coarsen = 0.15
      indicator = temperature_jump
      refine = 0.7
    []
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3c2391f4-a528-4405-a516-bd705462bc1a"><div class="modal-content"><h4>modules/richards/test/tests/rogers_stallybrass_clements/rsc02.i</h4><pre class="moose-pre"><code class="language-text"># RSC test with low-res time and spatial resolution
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 1
  xmin = 0
  xmax = 10 # x is the depth variable, called zeta in RSC
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;3E-2 5E-1 8E-1&#x27;
    x = &#x27;0 1 5&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater poil&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 10
    bulk_mod = 2E9
  [../]
  [./DensityOil]
    type = RichardsDensityConstBulk
    dens0 = 20
    bulk_mod = 2E9
  [../]
  [./SeffWater]
    type = RichardsSeff2waterRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./SeffOil]
    type = RichardsSeff2gasRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./RelPerm]
    type = RichardsRelPermMonomial
    simm = 0
    n = 1
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E-2
  [../]
[]


[Variables]
  [./pwater]
  [../]
  [./poil]
  [../]
[]

[ICs]
  [./water_init]
    type = ConstantIC
    variable = pwater
    value = 0
  [../]
  [./oil_init]
    type = ConstantIC
    variable = poil
    value = 15
  [../]
[]

[Kernels]
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstoil]
    type = RichardsMassChange
    variable = poil
  [../]
  [./richardsfoil]
    type = RichardsFlux
    variable = poil
  [../]
[]


[AuxVariables]
  [./SWater]
  [../]
  [./SOil]
  [../]
[]


[AuxKernels]
  [./Seff1VGwater_AuxK]
    type = RichardsSeffAux
    variable = SWater
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
  [./Seff1VGoil_AuxK]
    type = RichardsSeffAux
    variable = SOil
    seff_UO = SeffOil
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
[]


[BCs]
# we are pumping water into a system that has virtually incompressible fluids, hence the pressures rise enormously.  this adversely affects convergence because of almost-overflows and precision-loss problems.  The fixed things help keep pressures low and so prevent these awful behaviours.   the movement of the saturation front is the same regardless of the fixed things.
  active = &#x27;recharge fixedoil fixedwater&#x27;
  [./recharge]
    type = RichardsPiecewiseLinearSink
    variable = pwater
    boundary = &#x27;left&#x27;
    pressures = &#x27;-1E10 1E10&#x27;
    bare_fluxes = &#x27;-1 -1&#x27;
    use_mobility = false
    use_relperm = false
  [../]
  [./fixedwater]
    type = DirichletBC
    variable = pwater
    boundary = &#x27;right&#x27;
    value = 0
  [../]
  [./fixedoil]
    type = DirichletBC
    variable = poil
    boundary = &#x27;right&#x27;
    value = 15
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.25
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityOil&#x27;
    relperm_UO = &#x27;RelPerm RelPerm&#x27;
    SUPG_UO = &#x27;SUPGstandard SUPGstandard&#x27;
    sat_UO = &#x27;Saturation Saturation&#x27;
    seff_UO = &#x27;SeffWater SeffOil&#x27;
    viscosity = &#x27;1E-3 2E-3&#x27;
    gravity = &#x27;0E-0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = rsc02
  interval = 100000
  execute_on = &#x27;initial timestep_end final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="61891572-8b39-4e2a-b82e-a53920b98710"><div class="modal-content"><h4>modules/richards/test/tests/broadbridge_white/bw_lumped_02.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermBW
  SUPG_UO = SUPGstandard
  sat_UO = Saturation
  seff_UO = SeffBW
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-1 5E-1 5E-1&#x27;
    x = &#x27;0 1 10&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 10
    bulk_mod = 2E9
  [../]
  [./SeffBW]
    type = RichardsSeff1BWsmall
    Sn = 0.0
    Ss = 1.0
    C = 1.5
    las = 2
  [../]
  [./RelPermBW]
    type = RichardsRelPermBW
    Sn = 0.0
    Ss = 1.0
    Kn = 0
    Ks = 1
    C = 1.5
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E2
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -9E2
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsLumpedMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]


[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffBW
    pressure_vars = pressure
  [../]
[]


[BCs]
  active = &#x27;recharge&#x27;
  [./recharge]
    type = RichardsPiecewiseLinearSink
    variable = pressure
    boundary = &#x27;right&#x27;
    pressures = &#x27;-1E10 1E10&#x27;
    bare_fluxes = &#x27;-1.25 -1.25&#x27; # corresponds to Rstar being 0.5 because i have to multiply by density*porosity
    use_mobility = false
    use_relperm = false
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.25
    mat_permeability = &#x27;1 0 0  0 1 0  0 0 1&#x27;
    viscosity = 4
    gravity = &#x27;-0.1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 2

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = bw_lumped_02
  interval = 10000
  execute_on = &#x27;timestep_end final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d8bf2aff-7a36-4768-8deb-b70f23600642"><div class="modal-content"><h4>test/tests/multiapps/picard/function_dt_master.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = 0
  ymin = 0
  xmax = 1
  ymax = 1
  nx = 10
  ny = 10
[]

[Functions]
  [./v_fn]
    type = ParsedFunction
    value = t*x
  [../]
  [./ffn]
    type = ParsedFunction
    value = x
  [../]

  [./dts]
    type = PiecewiseLinear
    x = &#x27;0.1  10&#x27;
    y = &#x27;0.1  10&#x27;
  [../]
[]

[AuxVariables]
  [./v]
  [../]
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./td]
    type = TimeDerivative
    variable = u
  [../]
  [./ufn]
    type = BodyForce
    variable = u
    function = ffn
  [../]
[]

[BCs]
  [./all]
    type = FunctionDirichletBC
    variable = u
    boundary = &#x27;left right top bottom&#x27;
    function = v_fn
  [../]
[]

[Executioner]
  type = Transient
  dt = 0.1
  solve_type = &#x27;PJFNK&#x27;

  nl_abs_tol = 1e-10
  picard_max_its = 2
  start_time = 0
  num_steps = 3
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  exodus = true
[]

[MultiApps]
  [./sub_app]
    app_type = MooseTestApp
    type = TransientMultiApp
    input_files = &#x27;function_dt_sub.i&#x27;
    execute_on = timestep_end
    positions = &#x27;0 -1 0&#x27;
  [../]
[]

[Transfers]
  [./from_sub]
    type = MultiAppNearestNodeTransfer
    direction = from_multiapp
    multi_app = sub_app
    source_variable = u
    variable = v
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="92909a6d-1111-4733-a886-0c6148612960"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = false
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.2
    max = 0.8
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.2
    max = 1.8
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_fu_05
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="324f7d4c-cf8f-42ce-a2a7-2ef78fbb6a13"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh07.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.2
    max = 0.8
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.2
    max = 1.8
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh07
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1fc2fee3-119c-4180-a198-c1acded70b51"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_lumped_17.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = false
# gravity = true
# supg = true
# transient = true
# lumped = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 0.5E-3&#x27;
  gravity = &#x27;-1 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 0.01
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 1
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-15 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_lumped_17
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3991f8d1-6c86-46db-8bba-085fca5b37ea"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/ghQ2P_pgas.i</h4><pre class="moose-pre"><code class="language-text"># quick two phase with Pgas and Swater being variables

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = Q2PRelPermPowerGas
    simm = 0.0
    n = 3
  [../]
[]

[Variables]
  [./pgas]
  [../]
  [./swater]
  [../]
[]

[ICs]
  [./pp_ic]
    type = ConstantIC
    value = 1
    variable = pgas
  [../]
  [./sat_ic]
    type = ConstantIC
    value = 0.5
    variable = swater
  [../]
[]

[Q2P]
  porepressure = pgas
  saturation = swater
  water_density = DensityWater
  water_relperm = RelPermWater
  water_viscosity = 1
  gas_density = DensityGas
  gas_relperm = RelPermGas
  gas_viscosity = 1
  diffusivity = 0
[]

[Postprocessors]
  [./pp_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
  [../]
  [./pp_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
  [../]

  [./sat_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = swater
  [../]
  [./sat_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = swater
  [../]
[]


[Materials]
  [./rock]
    type = Q2PMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = ghQ2P_pgas
  csv = true
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0f13df69-faae-4cb0-aeb0-61b17a3fe37c"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# injection
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;500 500 1E1&#x27;
    x = &#x27;4000 5000 6500&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh03.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = -1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = -2E5
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 6500
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = bh05
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1c5bf642-0557-4a79-a6f3-3ae844ffb9eb"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav02d.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established in the transient situation when 0&lt;=saturation&lt;=1 (note the less-than-or-equal-to).
# 2phase (PP), 2components, vanGenuchten, constant fluid bulk-moduli for each phase, constant viscosity, constant permeability, Corey relative perm.
# A boundary condition enforces porepressures at the right boundary
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    x = &#x27;1E-3 1E-2 1E-1 2E-1&#x27;
    y = &#x27;1E-3 1E-2 0.2E-1 1E-1&#x27;
  [../]
[]

[Variables]
  [./ppwater]
    initial_condition = 0
  [../]
  [./ppgas]
    initial_condition = 0.5
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]

[BCs]
  [./ppwater]
    type = DirichletBC
    boundary = right
    variable = ppwater
    value = 0
  [../]
  [./ppgas]
    type = DirichletBC
    boundary = right
    variable = ppgas
    value = 0.5
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = ppwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = ppwater
    gravity = &#x27;-1 0 0&#x27;
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = ppgas
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = ppgas
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_ppwater]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 2 pp_water_top 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater ppgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 1.2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 1
      density0 = 0.1
      viscosity = 0.5
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = ppwater
    phase1_porepressure = ppgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[Postprocessors]
  [./pp_water_top]
    type = PointValue
    variable = ppwater
    point = &#x27;0 0 0&#x27;
  [../]
  [./pp_water_base]
    type = PointValue
    variable = ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_water_analytical]
    type = FunctionValuePostprocessor
    function = ana_ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./ppwater_00]
    type = PointValue
    variable = ppwater
    point = &#x27;0 0 0&#x27;
  [../]
  [./ppwater_01]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.1 0 0&#x27;
  [../]
  [./ppwater_02]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.2 0 0&#x27;
  [../]
  [./ppwater_03]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.3 0 0&#x27;
  [../]
  [./ppwater_04]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.4 0 0&#x27;
  [../]
  [./ppwater_05]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.5 0 0&#x27;
  [../]
  [./ppwater_06]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.6 0 0&#x27;
  [../]
  [./ppwater_07]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.7 0 0&#x27;
  [../]
  [./ppwater_08]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.8 0 0&#x27;
  [../]
  [./ppwater_09]
    type = PointValue
    variable = ppwater
    point = &#x27;-0.9 0 0&#x27;
  [../]
  [./ppwater_10]
    type = PointValue
    variable = ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./ppgas_00]
    type = PointValue
    variable = ppgas
    point = &#x27;0 0 0&#x27;
  [../]
  [./ppgas_01]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.1 0 0&#x27;
  [../]
  [./ppgas_02]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.2 0 0&#x27;
  [../]
  [./ppgas_03]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.3 0 0&#x27;
  [../]
  [./ppgas_04]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.4 0 0&#x27;
  [../]
  [./ppgas_05]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.5 0 0&#x27;
  [../]
  [./ppgas_06]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.6 0 0&#x27;
  [../]
  [./ppgas_07]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.7 0 0&#x27;
  [../]
  [./ppgas_08]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.8 0 0&#x27;
  [../]
  [./ppgas_09]
    type = PointValue
    variable = ppgas
    point = &#x27;-0.9 0 0&#x27;
  [../]
  [./ppgas_10]
    type = PointValue
    variable = ppgas
    point = &#x27;-1 0 0&#x27;
  [../]
[]

[Preconditioning]
  active = andy
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000&#x27;
  [../]
  [./check]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -snes_type&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000 test&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
  end_time = 1.0
[]

[Outputs]
  [./csv]
    type = CSV
    execute_on = &#x27;initial final&#x27;
    file_base = grav02d
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="adf8fbd5-4f60-451c-8b6b-85d413575a15"><div class="modal-content"><h4>modules/richards/test/tests/theis/th22.i</h4><pre class="moose-pre"><code class="language-text"># two-phase, fully-saturated
# production
[Mesh]
  type = FileMesh
  file = th02_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 2 4 20&#x27;
    x = &#x27;0 1 10 100&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1E-5
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]

  [./total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]


[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_pressure
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsPolyLineSink
    pressures = &#x27;-1E9 1E9&#x27;
    fluxes = &#x27;200 200&#x27;
    point_file = th01.points
    SumQuantityUO = total_outflow_mass
    variable = pwater
  [../]
[]


[Postprocessors]
  [./flow_report]
    type = RichardsPlotQuantity
    uo = total_outflow_mass
  [../]
  [./p50]
    type = PointValue
    variable = pwater
    point = &#x27;50 0 0&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E5
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 1E-5&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-7 1E-10 20 1E-10 1E-100&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 100
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = th22
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9fad5b19-b473-4ed1-baaa-bcc6ba03ff73"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh07.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = FileMesh
  file = bh07_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1000 10000&#x27;
    x = &#x27;100 1000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[BCs]
  [./fix_outer]
    type = DirichletBC
    boundary = perimeter
    variable = pressure
    value = 1E7
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh07.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    re_constant = 0.1594
    character = 2
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./fluid_mass]
    type = RichardsMass
    variable = pressure
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-11 0 0  0 1E-11 0  0 0 1E-11&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1000
  solve_type = NEWTON

  [./TimeStepper]
    # get only marginally better results for smaller time steps
    type = FunctionDT
    function = dts
  [../]

[]

[Outputs]
  file_base = bh07
  execute_on = &#x27;initial timestep_end final&#x27;
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="88400e31-01e4-43d2-a2d0-1ce983ffda53"><div class="modal-content"><h4>modules/richards/test/tests/recharge_discharge/rd01.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  # very little mesh dependence here
  nx = 120
  ny = 1
  xmin = 0
  xmax = 6
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1 10 500 5000 5000&#x27;
    x = &#x27;0 10 100 1000 10000 100000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1E3
    bulk_mod = 2E7
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.336
    al = 1.43E-4
  [../]
  [./RelPermPower]
    type = RichardsRelPermVG1
    scut = 0.99
    simm = 0.0
    m = 0.336
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E+2
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -72620.4
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]


[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffVG
    pressure_vars = pressure
  [../]
[]


[BCs]
  active = &#x27;recharge&#x27;
  [./recharge]
    type = RichardsPiecewiseLinearSink
    variable = pressure
    boundary = &#x27;right&#x27;
    pressures = &#x27;0 1E9&#x27;
    bare_fluxes = &#x27;-2.315E-3 -2.315E-3&#x27;
    use_relperm = false
    use_mobility = false
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.33
    mat_permeability = &#x27;0.295E-12 0 0  0 0.295E-12 0  0 0 0.295E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1.01E-3
    gravity = &#x27;-10 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-15 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 359424

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = rd01
  interval = 100000
  execute_on = &#x27;initial final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="978ca550-0411-444e-bde9-fb9661c764a7"><div class="modal-content"><h4>modules/geochemistry/test/tests/time_dependent_reactions/seawater_evaporation_flow_through.i</h4><pre class="moose-pre"><code class="language-text">#Progressively remove H2O until virtually none remains, all the while removing any minerals that precipitate
[UserObjects]
  [./definition]
    type = GeochemicalModelDefinition
    database_file = &quot;../../../database/moose_geochemdb.json&quot;
    basis_species = &quot;H2O H+ Cl- Ca++ Mg++ Na+ K+ SO4-- HCO3-&quot;
    equilibrium_minerals = &quot;Dolomite Epsomite Gypsum Halite Magnesite Mirabilite Sylvite&quot;
    equilibrium_gases = &quot;CO2(g)&quot;
    piecewise_linear_interpolation = true # for precise agreement with GWB
  [../]
[]

[TimeDependentReactionSolver]
  model_definition = definition
  geochemistry_reactor_name = reactor
  swap_out_of_basis = &quot;H+&quot;
  swap_into_basis = &quot;  CO2(g)&quot;
  charge_balance_species = &quot;Cl-&quot; # this means the bulk moles of Cl- will not be exactly as set below
  constraint_species = &quot;H2O              CO2(g)       Cl-                Na+                SO4--              Mg++               Ca++               K+                 HCO3-&quot;
  constraint_value = &quot;  1.0              0.0003162278 0.5656             0.4850             0.02924            0.05501            0.01063            0.010576055        0.002412&quot;
  constraint_meaning = &quot;kg_solvent_water fugacity     moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species&quot;
  source_species_names = &quot;H2O&quot;
  source_species_rates = &quot;-1.0&quot; # 1kg H2O = 55.51 moles, each time step removes 1 mole
  mode = mode
  ramp_max_ionic_strength_initial = 0 # not needed in this simple example
  stoichiometric_ionic_str_using_Cl_only = true # for precise agreement with GWB
  execute_console_output_on = &#x27;&#x27; # only CSV output for this example
[]

[Functions]
  [./timestepper]
    type = PiecewiseLinear
    x = &#x27;0 50 55&#x27;
    y = &#x27;5 5 1&#x27;
  [../]
[]
[Executioner]
  type = Transient
  [./TimeStepper]
    type = FunctionDT
    function = timestepper
  [../]
  end_time = 55
[]

[AuxVariables]
  [./mode]
  [../]
  [./dolomite_mol]
  [../]
  [./halite_mol]
  [../]
  [./gypsum_mol]
  [../]
  [./mirabilite_mol]
  [../]
[]

[AuxKernels]
  [./mode_auxk]
    type = FunctionAux
    variable = mode
    function = &#x27;if(t&lt;=1.0, 1.0, 2.0)&#x27; # initial &quot;dump&quot; then &quot;flow_through&quot;
    execute_on = &#x27;timestep_begin&#x27;
  [../]
  [./dolomite_mol_auxk]
    type = GeochemistryQuantityAux
    reactor = reactor
    variable = dolomite_mol
    species = Dolomite
    quantity = moles_dumped
  [../]
  [./gypsum_mol_auxk]
    type = GeochemistryQuantityAux
    reactor = reactor
    variable = gypsum_mol
    species = Gypsum
    quantity = moles_dumped
  [../]
  [./halite_mol]
    type = GeochemistryQuantityAux
    reactor = reactor
    variable = halite_mol
    species = Halite
    quantity = moles_dumped
  [../]
  [./mirabilite_mol]
    type = GeochemistryQuantityAux
    reactor = reactor
    variable = mirabilite_mol
    species = Mirabilite
    quantity = moles_dumped
  [../]
[]

[GlobalParams]
  point = &#x27;0 0 0&#x27;
[]
[Postprocessors]
  [./solvent_kg]
    type = PointValue
    variable = &#x27;kg_solvent_H2O&#x27;
  [../]
  [./dolomite_mol]
    type = PointValue
    variable = dolomite_mol
  [../]
  [./gypsum_mol]
    type = PointValue
    variable = &#x27;gypsum_mol&#x27;
  [../]
  [./halite_mol]
    type = PointValue
    variable = &#x27;halite_mol&#x27;
  [../]
  [./mirabilite_mol]
    type = PointValue
    variable = &#x27;mirabilite_mol&#x27;
  [../]
[]

[Outputs]
  csv = true
[]

</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d8d434bb-bbeb-4c52-8ff8-9029e09f80ab"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh27.i</h4><pre class="moose-pre"><code class="language-text">#2-phase version of bh07 (go to steadystate with borehole)
[Mesh]
  type = FileMesh
  file = bh07_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 1E-5&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1000 10000&#x27;
    x = &#x27;100 1000&#x27;
  [../]
[]


[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.6
    al = 1E-5
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.6
    al = 1E-5
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = 1E7
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = 1E7
  [../]
[]

[BCs]
  [./fix_outer_w]
    type = DirichletBC
    boundary = perimeter
    variable = pwater
    value = 1E7
  [../]
  [./fix_outer_g]
    type = DirichletBC
    boundary = perimeter
    variable = pgas
    value = 1E7
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh07.bh
    SumQuantityUO = borehole_total_outflow_mass
    fully_upwind = true
    variable = pwater
    unit_weight = &#x27;0 0 0&#x27;
    re_constant = 0.1594
    character = 2 # this is to make the length 1m borehole fill the entire 2m height
  [../]
  [./bh_gas_dummy]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh07.bh
    SumQuantityUO = borehole_total_outflow_mass
    fully_upwind = true
    variable = pgas
    unit_weight = &#x27;0 0 0&#x27;
    re_constant = 0.1594
    character = 2 # this is to make the length 1m borehole fill the entire 2m height
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./water_mass]
    type = RichardsMass
    variable = pwater
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./gas_mass]
    type = RichardsMass
    variable = pgas
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]



[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-11 0 0  0 1E-11 0  0 0 1E-11&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10 1E-10 20 1E-10 1E-100&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1000
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]

[]

[Outputs]
  file_base = bh27
  execute_on = &#x27;initial timestep_end final&#x27;
  interval = 1000000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="555776e3-1b1e-4433-932e-9a9a5e987e45"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh_fu_08.i</h4><pre class="moose-pre"><code class="language-text">#fullyupwind
[Mesh]
  type = FileMesh
  file = bh07_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1000 10000&#x27;
    x = &#x27;100 1000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[BCs]
  [./fix_outer]
    type = DirichletBC
    boundary = perimeter
    variable = pressure
    value = 1E7
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFullyUpwindFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh08.bh
    borehole_length = 1
    borehole_direction = &#x27;0 0 1&#x27;
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    re_constant = 0.1594
    character = 2
    fully_upwind = true
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./fluid_mass]
    type = RichardsMass
    variable = pressure
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-11 0 0  0 1E-11 0  0 0 1E-11&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1000
  solve_type = NEWTON

  [./TimeStepper]
    # get only marginally better results for smaller time steps
    type = FunctionDT
    function = dts
  [../]

[]

[Outputs]
  file_base = bh_fu_08
  execute_on = &#x27;initial timestep_end final&#x27;
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ac9f7a56-5947-4404-80ec-5f5766ed0023"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_06.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = false
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_fu_06
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="07d0e95c-dc12-46d4-8731-c929def19431"><div class="modal-content"><h4>test/tests/time_steppers/function_dt/function_dt_min.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = -1
  xmax =  1
  ymin = -1
  ymax =  1
  nx = 2
  ny = 2
  elem_type = QUAD9
[]

[Functions]
  [./exact_fn]
    type = ParsedFunction
    value = t*t*(x*x+y*y)
  [../]

  [./forcing_fn]
    type = ParsedFunction
    value = 2*t*(x*x+y*y)-4*t*t
  [../]

  [./dts]
    type = PiecewiseLinear
    x = &#x27;0   0.85 2&#x27;
    y = &#x27;0.2 0.2  0.2&#x27;
  [../]
[]

[Variables]
  [./u]
    family = LAGRANGE
    order = SECOND
  [../]
[]

[ICs]
  [./u_var]
    type = FunctionIC
    variable = u
    function = exact_fn
  [../]
[]

[Kernels]
  [./td]
    type = TimeDerivative
    variable = u
  [../]

  [./diff]
    type = Diffusion
    variable = u
  [../]

  [./ffn]
    type = BodyForce
    variable = u
    function = forcing_fn
  [../]
[]

[BCs]
  [./all]
    type = FunctionDirichletBC
    variable = u
    boundary = &#x27;left right top bottom&#x27;
    function = exact_fn
  [../]
[]

[Executioner]
  type = Transient

  start_time = 0
  num_steps = 10
  [./TimeStepper]
    type = FunctionDT
    function = dts
    min_dt = 0.1
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0fcc01d4-2fcf-4d29-b249-f4641cdfc23b"><div class="modal-content"><h4>modules/richards/test/tests/rogers_stallybrass_clements/rsc01.i</h4><pre class="moose-pre"><code class="language-text"># RSC test with high-res time and spatial resolution
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 600
  ny = 1
  xmin = 0
  xmax = 10 # x is the depth variable, called zeta in RSC
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;3E-3 3E-2 0.05&#x27;
    x = &#x27;0 1 5&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater poil&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 10
    bulk_mod = 2E9
  [../]
  [./DensityOil]
    type = RichardsDensityConstBulk
    dens0 = 20
    bulk_mod = 2E9
  [../]
  [./SeffWater]
    type = RichardsSeff2waterRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./SeffOil]
    type = RichardsSeff2gasRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./RelPerm]
    type = RichardsRelPermMonomial
    simm = 0
    n = 1
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E-2
  [../]
[]


[Variables]
  [./pwater]
  [../]
  [./poil]
  [../]
[]

[ICs]
  [./water_init]
    type = ConstantIC
    variable = pwater
    value = 0
  [../]
  [./oil_init]
    type = ConstantIC
    variable = poil
    value = 15
  [../]
[]

[Kernels]
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstoil]
    type = RichardsMassChange
    variable = poil
  [../]
  [./richardsfoil]
    type = RichardsFlux
    variable = poil
  [../]
[]


[AuxVariables]
  [./SWater]
  [../]
  [./SOil]
  [../]
[]


[AuxKernels]
  [./Seff1VGwater_AuxK]
    type = RichardsSeffAux
    variable = SWater
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
  [./Seff1VGoil_AuxK]
    type = RichardsSeffAux
    variable = SOil
    seff_UO = SeffOil
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
[]


[BCs]
# we are pumping water into a system that has virtually incompressible fluids, hence the pressures rise enormously.  this adversely affects convergence because of almost-overflows and precision-loss problems.  The fixed things help keep pressures low and so prevent these awful behaviours.   the movement of the saturation front is the same regardless of the fixed things.
  active = &#x27;recharge fixedoil fixedwater&#x27;
  [./recharge]
    type = RichardsPiecewiseLinearSink
    variable = pwater
    boundary = &#x27;left&#x27;
    pressures = &#x27;-1E10 1E10&#x27;
    bare_fluxes = &#x27;-1 -1&#x27;
    use_mobility = false
    use_relperm = false
  [../]
  [./fixedwater]
    type = DirichletBC
    variable = pwater
    boundary = &#x27;right&#x27;
    value = 0
  [../]
  [./fixedoil]
    type = DirichletBC
    variable = poil
    boundary = &#x27;right&#x27;
    value = 15
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.25
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityOil&#x27;
    relperm_UO = &#x27;RelPerm RelPerm&#x27;
    SUPG_UO = &#x27;SUPGstandard SUPGstandard&#x27;
    sat_UO = &#x27;Saturation Saturation&#x27;
    seff_UO = &#x27;SeffWater SeffOil&#x27;
    viscosity = &#x27;1E-3 2E-3&#x27;
    gravity = &#x27;0E-0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = rsc01
  interval = 100000
  execute_on = &#x27;initial final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b9bd4370-e9f3-45a6-ab4d-fea98c431239"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_1/gh22.i</h4><pre class="moose-pre"><code class="language-text"># investigating validity of immobile saturation
# 50 elements, no SUPG

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 50
  xmin = -1
  xmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 10 100 1000 10000&#x27;
    x = &#x27;0 10 100 1000 10000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E3
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.1
  [../]
  [./SUPGnone]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -1.0
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffVG
    pressure_vars = pressure
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGnone
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E0
  end_time = 1E5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh22
  execute_on = &#x27;timestep_end final&#x27;
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="052a61f6-7780-4895-9a02-a9c27b9624fa"><div class="modal-content"><h4>modules/geochemistry/test/tests/time_dependent_reactions/mixing.i</h4><pre class="moose-pre"><code class="language-text"># Seawater at temperature=4degC is slowly mixed with this fluid initially at temperature=273degC until a 10:1 ratio is achieved
[TimeDependentReactionSolver]
  model_definition = definition
  geochemistry_reactor_name = reactor
  swap_into_basis = &quot;H2S(aq)&quot;
  swap_out_of_basis = &quot;O2(aq)&quot;
  charge_balance_species = &quot;Cl-&quot;
  constraint_species = &quot;H2O              H+           Cl-    Na+    Mg++    SO4--   Ca++    K+      HCO3-  Ba++  SiO2(aq) Sr++     Zn++  Cu+     Al+++  Fe++   Mn++    H2S(aq)&quot;
  constraint_value = &quot;1.0                6.309573E-5  600E-3 529E-3 0.01E-6 0.01E-6 21.6E-3 26.7E-3 2.0E-3 15E-6 20.2E-3  100.5E-6 41E-6 0.02E-6 4.1E-6 903E-6 1039E-6 6.81E-3&quot;
  constraint_meaning = &quot;kg_solvent_water activity moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species moles_bulk_species&quot;
  close_system_at_time = -0.01
  remove_fixed_activity_name = &#x27;H+&#x27;
  remove_fixed_activity_time = -0.01
  initial_temperature = 273
  temperature = T
  # The following source species and rates are taken from the Geochemists Workbench (see output from mixing.rea)
  # An alternative is to run the seawater_mixing MOOSE input files and extract the source species and rates
  source_species_names = &quot;H2O Al+++ Ba++ Ca++ Cl- Cu+ Fe++ H+ HCO3- K+ Mg++ Mn++ Na+ O2(aq) SO4-- SiO2(aq) Sr++ Zn++&quot;
  source_species_rates = &quot;H2O_rate Al+++_rate Ba++_rate Ca++_rate Cl-_rate Cu+_rate Fe++_rate H+_rate HCO3-_rate K+_rate Mg++_rate Mn++_rate Na+_rate O2aq_rate SO4--_rate SiO2aq_rate Sr++_rate Zn++_rate&quot;
  mode = mode
  execute_console_output_on = &#x27;&#x27; # only CSV output needed for this example
  stoichiometric_ionic_str_using_Cl_only = true # for comparison with GWB
[]

[AuxVariables]
  [./T]
  [../]
  [./mode]
  [../]
  [./H2O_rate]
  [../]
  [./Al+++_rate]
  [../]
  [./Ba++_rate]
  [../]
  [./Ca++_rate]
  [../]
  [./Cl-_rate]
  [../]
  [./Cu+_rate]
  [../]
  [./Fe++_rate]
  [../]
  [./H+_rate]
  [../]
  [./HCO3-_rate]
  [../]
  [./K+_rate]
  [../]
  [./Mg++_rate]
  [../]
  [./Mn++_rate]
  [../]
  [./Na+_rate]
  [../]
  [./O2aq_rate]
  [../]
  [./SO4--_rate]
  [../]
  [./SiO2aq_rate]
  [../]
  [./Sr++_rate]
  [../]
  [./Zn++_rate]
  [../]
[]
[AuxKernels]
  [./mode_auxk]
    type = FunctionAux
    variable = mode
    function = &#x27;if(t&lt;=0, 1, 0)&#x27; # dump at start of first timestep
    execute_on = timestep_begin
  [../]
  [./T_auxk]
    type = FunctionAux
    variable = T
    function = &#x27;if(t&lt;=0, 273, 4)&#x27; # during initialisation and dumping, T=273, while during adding T=temperature of reactants
    execute_on = timestep_begin
  [../]
  [./H2O_rate_auxk]
    type = FunctionAux
    variable = H2O_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 55.510000000000005)&#x27;
  [../]
  [./Al+++_rate]
    type = FunctionAux
    variable = Al+++_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 3.643e-10)&#x27;
  [../]
  [./Ba++_rate]
    type = FunctionAux
    variable = Ba++_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 8.831e-08)&#x27;
  [../]
  [./Ca++_rate]
    type = FunctionAux
    variable = Ca++_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.0104)&#x27;
  [../]
  [./Cl-_rate]
    type = FunctionAux
    variable = Cl-_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.559)&#x27;
  [../]
  [./Cu+_rate]
    type = FunctionAux
    variable = Cu+_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 7.000000000000001e-09)&#x27;
  [../]
  [./Fe++_rate]
    type = FunctionAux
    variable = Fe++_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 4.746e-15)&#x27;
  [../]
  [./H+_rate]
    type = FunctionAux
    variable = H+_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.0002005)&#x27;
  [../]
  [./HCO3-_rate]
    type = FunctionAux
    variable = HCO3-_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.002153)&#x27;
  [../]
  [./K+_rate]
    type = FunctionAux
    variable = K+_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.010100000000000001)&#x27;
  [../]
  [./Mg++_rate]
    type = FunctionAux
    variable = Mg++_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.054400000000000004)&#x27;
  [../]
  [./Mn++_rate]
    type = FunctionAux
    variable = Mn++_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 6.79e-14)&#x27;
  [../]
  [./Na+_rate]
    type = FunctionAux
    variable = Na+_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.48019999999999996)&#x27;
  [../]
  [./O2aq_rate]
    type = FunctionAux
    variable = O2aq_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.000123)&#x27;
  [../]
  [./SO4--_rate]
    type = FunctionAux
    variable = SO4--_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.0295)&#x27;
  [../]
  [./SiO2aq_rate]
    type = FunctionAux
    variable = SiO2aq_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 0.00017)&#x27;
  [../]
  [./Sr++_rate]
    type = FunctionAux
    variable = Sr++_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 3.8350000000000004e-05)&#x27;
  [../]
  [./Zn++_rate]
    type = FunctionAux
    variable = Zn++_rate
    execute_on = timestep_begin
    function = &#x27;if(t&lt;=0, 0, 1e-08)&#x27;
  [../]
[]

[Postprocessors]
  [./temperature]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;solution_temperature&quot;
  [../]
  [./fugactity_O2]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;activity_O2(g)&quot;
  [../]
  [./molal_SO4--]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;molal_SO4--&quot;
  [../]
  [./molal_NaSO4]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;molal_NaSO4-&quot;
  [../]
  [./molal_H2Saq]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;molal_H2S(aq)&quot;
  [../]
  [./molal_HSO4-]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;molal_HSO4-&quot;
  [../]
  [./cm3_Anhydrite]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;free_cm3_Anhydrite&quot;
  [../]
  [./cm3_Pyrite]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;free_cm3_Pyrite&quot;
  [../]
  [./cm3_Talc]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;free_cm3_Talc&quot;
  [../]
  [./cm3_AmSil]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &quot;free_cm3_Amrph^silica&quot;
  [../]
[]

[Functions]
  [./timestepper]
    type = PiecewiseLinear
    x = &#x27;0    0.1  1   10&#x27;
    y = &#x27;0.01 0.01 0.5 10&#x27;
  [../]
[]

[Executioner]
  type = Transient
  start_time = -0.01 # to allow initial dump to occur
  [./TimeStepper]
    type = FunctionDT
    function = timestepper
  [../]
  end_time = 10
[]

[UserObjects]
  [./definition]
    type = GeochemicalModelDefinition
    database_file = &quot;../../../database/moose_geochemdb.json&quot;
    basis_species = &quot;H2O H+ Cl- Na+ Mg++ SO4-- Ca++ K+ HCO3- Ba++ SiO2(aq) Sr++ Zn++ Cu+ Al+++ Fe++ Mn++ O2(aq)&quot;
    equilibrium_minerals = &quot;Anhydrite Pyrite Talc Amrph^silica Barite Dolomite-ord Muscovite Nontronit-Na Pyrolusite Strontianite&quot;
    equilibrium_gases = &quot;O2(g)&quot;
  [../]
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="88180543-589f-4f30-b6cf-36ffe5fbc9f9"><div class="modal-content"><h4>modules/richards/test/tests/buckley_leverett/bl21.i</h4><pre class="moose-pre"><code class="language-text"># two-phase version
# sharp front version
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 150
  xmin = 0
  xmax = 15
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-3 1E-2 3E-2 4E-2 0.5 0.5 1&#x27;
    x = &#x27;0    1E-2 1E-1 1    5   40  41&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E6
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 3E-5
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 3E-5
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
  [./bounds_dummy]
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
  [./richardsppenalty]
    type = RichardsPPenalty
    variable = pgas
    a = 1E-18
    lower_var = pwater
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
  [../]
[]

[Bounds]
  [./pwater_upper_bounds]
    type = ConstantBoundsAux
    variable = bounds_dummy
    bounded_variable = pwater
    bound_type = upper
    bound_value = 1E7
  [../]
  [./pwater_lower_bounds]
    type = ConstantBoundsAux
    variable = bounds_dummy
    bounded_variable = pwater
    bound_type = lower
    bound_value = -110000
  [../]
[]


[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_water
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_gas
  [../]
[]

[BCs]
  [./left_w]
    type = DirichletBC
    variable = pwater
    boundary = left
    value = 1E6
  [../]
  [./left_g]
    type = DirichletBC
    variable = pgas
    boundary = left
    value = 1E6+1000
  [../]
  [./right_w]
    type = DirichletBC
    variable = pwater
    boundary = right
    value = -100000
  [../]
  [./right_g]
    type = DirichletBC
    variable = pgas
    boundary = right
    value = 0+1000
  [../]
[]


[Functions]
  [./initial_water]
    type = ParsedFunction
    value = 1000000*(1-min(x/5,1))-100000*(max(x-5,0)/max(abs(x-5),1E-10))
  [../]
  [./initial_gas]
    type = ParsedFunction
    value = max(1000000*(1-x/5),0)+1000
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.15
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 1E-6&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  active = &#x27;standard&#x27;

  [./bounded]
  # must use --use-petsc-dm command line argument
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -snes_type -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 50 vinewtonssls 1E-20 1E-20&#x27;
  [../]

  [./standard]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 20 1E-20 1E-20&#x27;
  [../]

[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 50

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bl21
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="66b821bb-df70-4856-9de3-d2051333ac3a"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_17.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = false
# gravity = true
# full upwinding = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 0.01
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 1
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-15 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_fu_17
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d4f48d3c-5730-4c41-b477-0340d36599e9"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_1/gh20.i</h4><pre class="moose-pre"><code class="language-text"># investigating validity of immobile saturation
# 5 elements, no SUPG

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 5
  xmin = -1
  xmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 10 100 1000 10000&#x27;
    x = &#x27;0 10 100 1000 10000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E3
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.1
  [../]
  [./SUPGnone]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -1.0
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffVG
    pressure_vars = pressure
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGnone
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E0
  end_time = 1E5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh20
  execute_on = &#x27;timestep_end final&#x27;
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0a561bd6-bca6-4441-bf3f-6eed054bdf64"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step10_multiapps/problems/step10.i</h4><pre class="moose-pre"><code class="language-text">[GlobalParams]
  displacements = &#x27;disp_r disp_z&#x27;
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 100
  ymax = 0.304 # Length of test chamber
  xmax = 0.0257 # Test chamber radius
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [k_eff]
    initial_condition = 15.0 # water at 20C
  []
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Modules/TensorMechanics/Master]
  [all]
    # This block adds all of the proper Kernels, strain calculators, and Variables
    # for TensorMechanics in the correct coordinate system (autodetected)
    add_variables = true
    strain = FINITE
    eigenstrain_names = eigenstrain
    use_automatic_differentiation = true
    generate_output = &#x27;vonmises_stress elastic_strain_xx elastic_strain_yy strain_xx strain_yy&#x27;
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = bottom
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = top
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = bottom
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = top
  []
  [hold_inlet]
    type = DirichletBC
    variable = disp_z
    boundary = bottom
    value = 0
  []
  [hold_center]
    type = DirichletBC
    variable = disp_r
    boundary = left
    value = 0
  []
  [hold_outside]
    type = DirichletBC
    variable = disp_r
    boundary = right
    value = 0
  []
[]

[Materials]
  viscosity_file = data/water_viscosity.csv
  density_file = data/water_density.csv
  specific_heat_file = data/water_specific_heat.csv
  thermal_expansion_file = data/water_thermal_expansion.csv
  [column]
    type = PackedColumn
    temperature = temperature
    radius = 1
    thermal_conductivity = k_eff # Use the AuxVariable instead of calculating
    fluid_viscosity_file = ${viscosity_file}
    fluid_density_file = ${density_file}
    fluid_specific_heat_file = ${specific_heat_file}
    fluid_thermal_expansion_file = ${thermal_expansion_file}
  []

  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 200e9 # (Pa) from wikipedia
    poissons_ratio = .3 # from wikipedia
  []
  [elastic_stress]
    type = ADComputeFiniteStrainElasticStress
  []
  [thermal_strain]
    type = ADComputeThermalExpansionEigenstrain
    stress_free_temperature = 300
    thermal_expansion_coeff = 1e-6
    eigenstrain_name = eigenstrain
    temperature = temperature
  []
[]

[Postprocessors]
  [average_temperature]
    type = ElementAverageValue
    variable = temperature
  []
[]

[Executioner]
  type = Transient
  start_time = -1
  end_time = 200
  steady_state_tolerance = 1e-7
  steady_state_detection = true
  dt = 0.25
  solve_type = PJFNK
  automatic_scaling = true
  compute_scaling_once = false
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;hypre boomeramg 500&#x27;
  line_search = none
  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]


[MultiApps]
  [micro]
    type = TransientMultiApp
    app_type = DarcyThermoMechApp
    positions = &#x27;0.01285 0.0    0
                 0.01285 0.0608 0
                 0.01285 0.1216 0
                 0.01285 0.1824 0
                 0.01285 0.2432 0
                 0.01285 0.304  0&#x27;
    input_files = step10_micro.i
    execute_on = &#x27;timestep_end&#x27;
  []
[]

[Transfers]
  [keff_from_sub]
    type = MultiAppPostprocessorInterpolationTransfer
    direction = from_multiapp
    multi_app = micro
    variable = k_eff
    power = 1
    postprocessor = k_eff
    execute_on = &#x27;timestep_end&#x27;
  []
  [temperature_to_sub]
    type = MultiAppVariableValueSamplePostprocessorTransfer
    direction = to_multiapp
    multi_app = micro
    source_variable = temperature
    postprocessor = temperature_in
    execute_on = &#x27;timestep_end&#x27;
  []
[]

[Controls]
  [multiapp]
    type = TimePeriod
    disable_objects = &#x27;MultiApps::micro Transfers::keff_from_sub Transfers::temperature_to_sub&#x27;
    start_time = &#x27;0&#x27;
    execute_on = &#x27;initial&#x27;
  []
[]

[Outputs]
  [out]
    type = Exodus
    elemental_as_nodal = true
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6defb1a1-64b2-424a-acdb-5a78cec5110e"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_1/gh23.i</h4><pre class="moose-pre"><code class="language-text"># investigating validity of immobile saturation
# 50 elements, with SUPG

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 50
  xmin = -1
  xmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 10 100 1000 10000&#x27;
    x = &#x27;0 10 100 1000 10000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E3
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.1
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E-6
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -1.0
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffVG
    pressure_vars = pressure
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E0
  end_time = 1E5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh23
  execute_on = &#x27;timestep_end final&#x27;
  interval = 10000
  exodus = true
  [./console]
    interval = 1
    type = Console
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="318cc0a7-cadc-4013-89f2-5f6dc93fdee2"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/bw02.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-1 5E-1 5E-1&#x27;
    x = &#x27;0 1 10&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureBW
    Sn = 0.0
    Ss = 1.0
    C = 1.5
    las = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 4
      density0 = 10
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityBW
    Sn = 0.0
    Ss = 1.0
    Kn = 0
    Ks = 1
    C = 1.5
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 1 0  0 0 1&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = -9E2
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-0.1 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./recharge]
    type = PorousFlowSink
    variable = pressure
    boundary = right
    flux_function = -1.25 # corresponds to Rstar being 0.5 because i have to multiply by density*porosity
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 2

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;-10 0 0&#x27;
    end_point = &#x27;10 0 0&#x27;
    sort_by = x
    num_points = 80
    execute_on = timestep_end
  [../]
[]

[Outputs]
  file_base = bw02
  sync_times = &#x27;0.5 2 8&#x27;
  [./exodus]
    type = Exodus
    sync_only = true
  [../]
  [./along_line]
    type = CSV
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4ca3608b-d359-43c4-9a3b-e09018051c70"><div class="modal-content"><h4>test/tests/time_steppers/cutback_factor_at_failure/function_dt_cutback.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    x = &#x27;0   0.85  2&#x27;
    y = &#x27;0.2 0.25  0.25&#x27;
  [../]
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Problem]
  type = FailingProblem
  fail_step = 3
[]

[Executioner]
  type = Transient
  num_steps = 10
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  [./TimeStepper]
    type = FunctionDT
    function = dts
    min_dt = 0.01
    cutback_factor_at_failure = 0.75
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e5e5b64b-610f-46cb-be0b-29aa8b642a2a"><div class="modal-content"><h4>modules/porous_flow/examples/flow_through_fractured_media/fine_transient.i</h4><pre class="moose-pre"><code class="language-text"># Using a mixed-dimensional mesh
# Transient flow and solute transport along a fracture in a porous matrix
# advective dominated flow in the fracture and diffusion into the porous matrix
#
# Note that fine_steady.i must be run to initialise the porepressure properly

[Mesh]
  file = &#x27;gold/fine_steady_out.e&#x27;
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./pp]
    initial_from_file_var = pp
    initial_from_file_timestep = 1
  [../]
  [./massfrac0]
  [../]
[]

[AuxVariables]
  [./velocity_x]
    family = MONOMIAL
    order = CONSTANT
    block = fracture
  [../]
  [./velocity_y]
    family = MONOMIAL
    order = CONSTANT
    block = fracture
  [../]
[]

[AuxKernels]
  [./velocity_x]
    type = PorousFlowDarcyVelocityComponentLowerDimensional
    variable = velocity_x
    component = x
    aperture = 6E-4
  [../]
  [./velocity_y]
    type = PorousFlowDarcyVelocityComponentLowerDimensional
    variable = velocity_y
    component = y
    aperture = 6E-4
  [../]
[]

[ICs]
  [./massfrac0]
    type = ConstantIC
    variable = massfrac0
    value = 0
  [../]
[]

[BCs]
  [./top]
    type = DirichletBC
    value = 0
    variable = massfrac0
    boundary = top
  [../]
  [./bottom]
    type = DirichletBC
    value = 1
    variable = massfrac0
    boundary = bottom
  [../]
  [./ptop]
    type = DirichletBC
    variable = pp
    boundary =  top
    value = 1e6
  [../]
  [./pbottom]
    type = DirichletBC
    variable = pp
    boundary = bottom
    value = 1.002e6
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./adv0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
  [../]
  [./diff0]
    type = PorousFlowDispersiveFlux
    fluid_component = 0
    variable = pp
    disp_trans = 0
    disp_long = 0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = massfrac0
  [../]
  [./adv1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = massfrac0
  [../]
  [./diff1]
    type = PorousFlowDispersiveFlux
    fluid_component = 1
    variable = massfrac0
    disp_trans = 0
    disp_long = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp massfrac0&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = massfrac0
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./poro_fracture]
    type = PorousFlowPorosityConst
    porosity = 6e-4   # = a * phif
    block = &#x27;fracture&#x27;
  [../]
  [./poro_matrix]
    type = PorousFlowPorosityConst
    porosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./diff1]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 1.0
    block = &#x27;fracture&#x27;
  [../]
  [./diff2]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./relp]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./permeability_fracture]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.8e-11 0 0 0 1.8e-11 0 0 0 1.8e-11&#x27; # kf=3e-8, a=6e-4m.  1.8e-11 = kf * a
    block = &#x27;fracture&#x27;
  [../]
  [./permeability_matrix]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-20 0 0 0 1e-20 0 0 0 1e-20&#x27;
    block = &#x27;matrix1 matrix2&#x27;
  [../]
[]

[Functions]
  [./dt_controller]
     type = PiecewiseConstant
     x = &#x27;0    30   40 100 200 83200&#x27;
     y = &#x27;0.01 0.1  1  10  100 32&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./mumps_is_best_for_parallel_jobs]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
  [./basic]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2             &#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 86400

  [./TimeStepper]
    type = FunctionDT
    function = dt_controller
  [../]

# controls for nonlinear iterations
  nl_max_its = 15
  nl_rel_tol = 1e-14
  nl_abs_tol = 1e-9
[]


[VectorPostprocessors]
  [./xmass]
    type = LineValueSampler
    start_point = &#x27;0.4 0 0&#x27;
    end_point = &#x27;0.5 0 0&#x27;
    sort_by = x
    num_points = 167
    variable = massfrac0
  [../]
[]

[Outputs]
  perf_graph = true
  console = true
  csv = true
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="384b1057-639f-4454-ae3a-61772fd723d4"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_1/gh_fu_22.i</h4><pre class="moose-pre"><code class="language-text"># investigating validity of immobile saturation
# 50 elements, full upwinding

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 50
  xmin = -1
  xmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  SUPG_UO = SUPGnone
  sat_UO = Saturation
  seff_UO = SeffVG
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 10 100 1000 10000&#x27;
    x = &#x27;0 10 100 1000 10000&#x27;
  [../]
[]


[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E3
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.1
  [../]
  [./SUPGnone]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -1.0
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFullyUpwindFlux
    variable = pressure
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffVG
    pressure_vars = pressure
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E0
  end_time = 1E5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh_fu_22
  execute_on = &#x27;timestep_end final&#x27;
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="002e62fd-e480-4919-ac5c-d3510c937687"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step07_adaptivity/problems/step7a_coarse.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 30
  ny = 3
  xmax = 0.304 # Length of test chamber
  ymax = 0.0257 # Test chamber radius
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = right
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = left
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = right
  []
[]

[Materials]
  [column]
    type = PackedColumn
    radius = 1
    temperature = temperature
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = X
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  automatic_scaling = true

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  end_time = 100
  dt = 0.25
  start_time = -1

  steady_state_tolerance = 1e-5
  steady_state_detection = true

  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a1911adb-b6c9-4ac2-8f73-6536a1825e19"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh18.i</h4><pre class="moose-pre"><code class="language-text"># with immobile saturation
# unsaturated = true
# gravity = true
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 0.5E1 0.5E2 0.4E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.4
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh18
  execute_on = &#x27;timestep_end final&#x27;
  interval = 100000
  exodus = true
  [./console]
    type = Console
    interval = 1
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b0ba0cd7-b801-42f9-afaa-d7519a3fc53e"><div class="modal-content"><h4>modules/richards/test/tests/dirac/q2p01.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1 1E1 1E2 1E3&#x27;
    x = &#x27;0 1E-1 1 1E1 1E2 1E3&#x27;
  [../]
[]


[UserObjects]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 0.5
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.3
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.2
    n = 2
  [../]
  [./RelPermGas]
    type = Q2PRelPermPowerGas
    simm = 0.1
    n = 3
  [../]

  [./borehole_total_outflow_water]
    type = RichardsSumQuantity
  [../]
  [./borehole_total_outflow_gas]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  [./pp]
  [../]
  [./sat]
  [../]
[]

[ICs]
  [./p_ic]
    type = ConstantIC
    variable = pp
    value = 1
  [../]
  [./s_ic]
    type = ConstantIC
    variable = sat
    value = 0.5
  [../]
[]


[Q2P]
  porepressure = pp
  saturation = sat
  water_density = DensityWater
  water_relperm = RelPermWater
  water_viscosity = 0.8
  gas_density = DensityGas
  gas_relperm = RelPermGas
  gas_viscosity = 0.5
  diffusivity = 0.0
  output_total_masses_to = &#x27;CSV&#x27;
[]

[DiracKernels]
  [./bh_water]
    type = Q2PBorehole
    bottom_pressure = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_water
    variable = sat
    unit_weight = &#x27;0 0 0&#x27;
    character = 8E9
    fluid_density = DensityWater
    fluid_relperm = RelPermWater
    other_var = pp
    var_is_porepressure = false
    fluid_viscosity = 0.8
  [../]
  [./bh_gas]
    type = Q2PBorehole
    bottom_pressure = 0
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_gas
    variable = pp
    unit_weight = &#x27;0 0 0&#x27;
    character = 1E10
    fluid_density = DensityGas
    fluid_relperm = RelPermGas
    other_var = sat
    var_is_porepressure = true
    fluid_viscosity = 0.5
  [../]
[]



[Postprocessors]
  [./bh_report_water]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_water
  [../]
  [./bh_report_gas]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_gas
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
  [./sat0]
    type = PointValue
    variable = sat
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]




[Materials]
  [./rock]
    type = Q2PMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    gravity = &#x27;0 0 0&#x27;
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1E3
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = q2p01
  execute_on = timestep_end
  [./CSV]
    type = CSV
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="89a25292-f4da-46c1-b026-7dde8c6a91ae"><div class="modal-content"><h4>modules/richards/test/tests/broadbridge_white/bw01.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-5 1E-2 1E-2 1E-1&#x27;
    x = &#x27;0 1E-5 1 10&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 10
    bulk_mod = 2E9
  [../]
  [./SeffBW]
    type = RichardsSeff1BWsmall
    Sn = 0.0
    Ss = 1.0
    C = 1.5
    las = 2
  [../]
  [./RelPermBW]
    type = RichardsRelPermBW
    Sn = 0.0
    Ss = 1.0
    Kn = 0
    Ks = 1
    C = 1.5
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E2
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -9E2
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]


[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffBW
    pressure_vars = pressure
  [../]
[]


[BCs]
  active = &#x27;recharge&#x27;
  [./recharge]
    type = RichardsPiecewiseLinearSink
    variable = pressure
    boundary = &#x27;right&#x27;
    pressures = &#x27;-1E10 1E10&#x27;
    bare_fluxes = &#x27;-1.25 -1.25&#x27; # corresponds to Rstar being 0.5 because i have to multiply by density*porosity
    use_mobility = false
    use_relperm = false
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.25
    mat_permeability = &#x27;1 0 0  0 1 0  0 0 1&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermBW
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffBW
    viscosity = 4
    gravity = &#x27;-0.1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 2

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = bw01
  interval = 10000
  execute_on = &#x27;timestep_end final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d4c53d5b-47ac-4045-a587-1f1eeb73d8a3"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step07_adaptivity/problems/step7d_adapt_blocks.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 40
  ny = 4
  xmax = 0.304 # Length of test chamber
  ymax = 0.0257 # Test chamber radius
  uniform_refine = 3
[]

[MeshModifiers]
  [bottom]
    type = SubdomainBoundingBox
    location = inside
    bottom_left = &#x27;0 0 0&#x27;
    top_right = &#x27;0.304 0.01285 0&#x27;
    block_id = 1
  []
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = right
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = left
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = right
  []
[]

[Materials]
  viscosity_file = data/water_viscosity.csv
  density_file = data/water_density.csv
  thermal_conductivity_file = data/water_thermal_conductivity.csv
  specific_heat_file = data/water_specific_heat.csv

  [column_bottom]
    type = PackedColumn
    block = 1
    radius = 1.15
    temperature = temperature
    fluid_viscosity_file = ${viscosity_file}
    fluid_density_file = ${density_file}
    fluid_thermal_conductivity_file = ${thermal_conductivity_file}
    fluid_specific_heat_file = ${specific_heat_file}
  []
  [column_top]
    type = PackedColumn
    block = 0
    radius = 1
    temperature = temperature
    porosity = &#x27;0.25952 + 0.7*x/0.304&#x27;
    fluid_viscosity_file = ${viscosity_file}
    fluid_density_file = ${density_file}
    fluid_thermal_conductivity_file = ${thermal_conductivity_file}
    fluid_specific_heat_file = ${specific_heat_file}
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = X
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  automatic_scaling = true

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  end_time = 100
  dt = 0.25
  start_time = -1

  steady_state_tolerance = 1e-5
  steady_state_detection = true

  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]

[Adaptivity]
  marker = error_frac
  max_h_level = 3
  [Indicators]
    [temperature_jump]
      type = GradientJumpIndicator
      variable = temperature
      scale_by_flux_faces = true
    []
  []
  [Markers]
    [error_frac]
      type = ErrorFractionMarker
      coarsen = 0.025
      indicator = temperature_jump
      refine = 0.9
    []
  []
[]

[Outputs]
  [out]
    type = Exodus
    output_material_properties = true
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7865d87e-0fb2-41d6-8928-1772e84311dc"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_fu_18.i</h4><pre class="moose-pre"><code class="language-text"># with immobile saturation - this illustrates a perfect case of fullyupwind working very well
# unsaturated = true
# gravity = true
# full upwinding = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 0.5E1 0.5E2 0.4E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.4
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh_fu_18
  execute_on = &#x27;timestep_end final&#x27;
  interval = 100000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ef848109-7d29-4695-87b8-38855c168eec"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rsc01.i</h4><pre class="moose-pre"><code class="language-text"># RSC test with high-res time and spatial resolution
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 600
  ny = 1
  xmin = 0
  xmax = 10 # x is the depth variable, called zeta in RSC
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;3E-3 3E-2 0.05&#x27;
    x = &#x27;0 1 5&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pwater poil&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
[]

[Modules]
  [./FluidProperties]
    [./water]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 10
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
    [./oil]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 20
      thermal_expansion = 0
      viscosity = 2e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = pwater
    phase1_porepressure = poil
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./water]
    type = PorousFlowSingleComponentFluid
    fp = water
    phase = 0
    compute_enthalpy = false
    compute_internal_energy = false
  [../]
  [./oil]
    type = PorousFlowSingleComponentFluid
    fp = oil
    phase = 1
    compute_enthalpy = false
    compute_internal_energy = false
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_oil]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
  [../]
[]

[Variables]
  [./pwater]
  [../]
  [./poil]
  [../]
[]

[ICs]
  [./water_init]
    type = ConstantIC
    variable = pwater
    value = 0
  [../]
  [./oil_init]
    type = ConstantIC
    variable = poil
    value = 15
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pwater
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = poil
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = poil
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./SOil]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
  [./SOil]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 1
    variable = SOil
  [../]
[]

[BCs]
# we are pumping water into a system that has virtually incompressible fluids, hence the pressures rise enormously.  this adversely affects convergence because of almost-overflows and precision-loss problems.  The fixed things help keep pressures low and so prevent these awful behaviours.   the movement of the saturation front is the same regardless of the fixed things.
  active = &#x27;recharge fixedoil fixedwater&#x27;
  [./recharge]
    type = PorousFlowSink
    variable = pwater
    boundary = &#x27;left&#x27;
    flux_function = -1.0
  [../]
  [./fixedwater]
    type = DirichletBC
    variable = pwater
    boundary = &#x27;right&#x27;
    value = 0
  [../]
  [./fixedoil]
    type = DirichletBC
    variable = poil
    boundary = &#x27;right&#x27;
    value = 15
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;7 0 0&#x27;
    sort_by = x
    num_points = 21
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 5
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rsc01
  [./along_line]
    type = CSV
    execute_vector_postprocessors_on = final
  [../]
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5aaf24e2-77ec-4d92-a595-e87bd335ba2a"><div class="modal-content"><h4>modules/richards/test/tests/theis/th_lumped_01.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
# lumped
[Mesh]
  type = FileMesh
  file = th01_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;0.5 1 2 10&#x27;
    x = &#x27;0 1 10 100&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]

  [./total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsLumpedMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsPolyLineSink
    pressures = &#x27;-1E9 1E9&#x27;
    fluxes = &#x27;200 200&#x27;
    point_file = th01.points
    SumQuantityUO = total_outflow_mass
    variable = pressure
  [../]
[]


[Postprocessors]
  [./flow_report]
    type = RichardsPlotQuantity
    uo = total_outflow_mass
  [../]
  [./p50]
    type = PointValue
    variable = pressure
    point = &#x27;50 0 0&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E5
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-6 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 100
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = th_lumped_01
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e2831a74-dd06-4d07-b6c4-bf5b4f5cddda"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/combined_creep_plasticity/combined_creep_plasticity_start_time.i</h4><pre class="moose-pre"><code class="language-text">#
# This test is Example 2 from &quot;A Consistent Formulation for the Integration
#   of Combined Plasticity and Creep&quot; by P. Duxbury, et al., Int J Numerical
#   Methods in Engineering, Vol. 37, pp. 1277-1295, 1994.
#
# The problem is a one-dimensional bar which is loaded from yield to a value of twice
#   the initial yield stress and then unloaded to return to the original stress. The
#   bar must harden to the required yield stress during the load ramp, with no
#   further yielding during unloading. The initial yield stress (sigma_0) is prescribed
#   as 20 with a plastic strain hardening of 100. The mesh is a 1x1x1 cube with symmetry
#   boundary conditions on three planes to provide a uniaxial stress field.
#
#  In the PowerLawCreep model, the creep strain rate is defined by:
#
#   edot = A(sigma)**n * exp(-Q/(RT)) * t**m
#
#   The creep law specified in the paper, however, defines the creep strain rate as:
#
#   edot = Ao * mo * (sigma)**n * t**(mo-1)
#      with the creep parameters given by
#         Ao = 1e-7
#         mo = 0.5
#         n  = 5
#
#   thus, input parameters for the test were specified as:
#         A = Ao * mo = 1e-7 * 0.5 = 0.5e-7
#         m = mo-1 = -0.5
#         n = 5
#         Q = 0
#
#   The variation of load P with time is:
#       P = 20 + 20t      0 &lt; t &lt; 1
#       P = 40 - 40(t-1)  1 &lt; t 1.5
#
#  The analytic solution for total strain during the loading period 0 &lt; t &lt; 1 is:
#
#    e_tot = (sigma_0 + 20*t)/E + 0.2*t + A * t**0.5  * sigma_0**n * [ 1 + (5/3)*t +
#               + 2*t**2 + (10/7)*t**3 + (5/9)**t**4 + (1/11)*t**5 ]
#
#    and during the unloading period 1 &lt; t &lt; 1.5:
#
#    e_tot = (sigma_1 - 40*(t-1))/E + 0.2 + (4672/693) * A * sigma_0**n +
#               A * sigma_0**n * [ t**0.5 * ( 32 - (80/3)*t + 16*t**2 - (40/7)*t**3
#                                  + (10/9)*t**4 - (1/11)*t**5 ) - (11531/693) ]
#
#         where sigma_1 is the stress at time t = 1.
#
#  Assuming a Young&#x27;s modulus (E) of 1000 and using the parameters defined above:
#
#    e_tot(1) = 2.39734
#    e_tot(1.5) = 3.16813
#
#
#   The numerically computed solution is:
#
#    e_tot(1) = 2.39718         (~0.006% error)
#    e_tot(1.5) = 3.15555       (~0.40% error)
#
[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
[]

[Modules/TensorMechanics/Master]
  [./all]
    strain = FINITE
    incremental = true
    add_variables = true
    generate_output = &#x27;stress_yy elastic_strain_yy creep_strain_yy plastic_strain_yy&#x27;
  [../]
[]

[Functions]
  [./top_pull]
    type = PiecewiseLinear
    x = &#x27;  10   11   11.5&#x27;
    y = &#x27;-20 -40   -20&#x27;
  [../]

  [./dts]
    type = PiecewiseLinear
    x = &#x27;10        10.5    11.0    11.5&#x27;
    y = &#x27;0.015  0.015  0.005  0.005&#x27;
  [../]
[]

[BCs]
  [./u_top_pull]
    type = Pressure
    variable = disp_y
    component = 1
    boundary = top
    factor = 1
    function = top_pull
  [../]
  [./u_bottom_fix]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
  [./u_yz_fix]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./u_xy_fix]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    block = 0
    youngs_modulus = 1e3
    poissons_ratio = 0.3
  [../]
  [./creep_plas]
    type = ComputeMultipleInelasticStress
    block = 0
    tangent_operator = elastic
    inelastic_models = &#x27;creep plas&#x27;
    max_iterations = 50
    absolute_tolerance = 1e-05
    combined_inelastic_strain_weights = &#x27;0.0 1.0&#x27;
  [../]
  [./creep]
    type = PowerLawCreepStressUpdate
    block = 0
    coefficient = 0.5e-7
    n_exponent = 5
    m_exponent = -0.5
    activation_energy = 0
    start_time = 10
  [../]
  [./plas]
    type = IsotropicPlasticityStressUpdate
    block = 0
    hardening_constant = 100
    yield_stress = 20
  [../]
[]

[Executioner]
  type = Transient

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp&#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;101&#x27;

  line_search = &#x27;none&#x27;

  l_max_its = 20
  nl_max_its = 6
  nl_rel_tol = 1e-6
  nl_abs_tol = 1e-10
  l_tol = 1e-5
  start_time = 10.0
  end_time = 11.5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e85f3760-e028-4797-ad75-61045a2fc6c4"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh_fu_05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# injection
# fullyupwind
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;500 500 1E1&#x27;
    x = &#x27;4000 5000 6500&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh03.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = -1
    fully_upwind = true
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = -2E5
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 6500
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = bh_fu_05
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ebaa0be3-8f99-42b5-92b5-c461bfe9d798"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_1/gh_fu_20.i</h4><pre class="moose-pre"><code class="language-text"># investigating validity of immobile saturation
# 5 elements, full upwinding

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 5
  xmin = -1
  xmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  SUPG_UO = SUPGnone
  sat_UO = Saturation
  seff_UO = SeffVG
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 10 100 1000 10000&#x27;
    x = &#x27;0 10 100 1000 10000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E3
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.1
  [../]
  [./SUPGnone]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -1.0
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFullyUpwindFlux
    variable = pressure
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffVG
    pressure_vars = pressure
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E0
  end_time = 1E5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh_fu_20
  execute_on = &#x27;timestep_end final&#x27;
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f780cb7e-b54f-43ab-aea5-404e9a741583"><div class="modal-content"><h4>modules/richards/test/tests/rogers_stallybrass_clements/rsc_lumped_01.i</h4><pre class="moose-pre"><code class="language-text"># RSC test with high-res time and spatial resolution
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 600
  ny = 1
  xmin = 0
  xmax = 10 # x is the depth variable, called zeta in RSC
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityOil&#x27;
  relperm_UO = &#x27;RelPerm RelPerm&#x27;
  SUPG_UO = &#x27;SUPGstandard SUPGstandard&#x27;
  sat_UO = &#x27;Saturation Saturation&#x27;
  seff_UO = &#x27;SeffWater SeffOil&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;3E-3 3E-2 0.05&#x27;
    x = &#x27;0 1 5&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater poil&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 10
    bulk_mod = 2E9
  [../]
  [./DensityOil]
    type = RichardsDensityConstBulk
    dens0 = 20
    bulk_mod = 2E9
  [../]
  [./SeffWater]
    type = RichardsSeff2waterRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./SeffOil]
    type = RichardsSeff2gasRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./RelPerm]
    type = RichardsRelPermMonomial
    simm = 0
    n = 1
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E-2
  [../]
[]


[Variables]
  [./pwater]
  [../]
  [./poil]
  [../]
[]

[ICs]
  [./water_init]
    type = ConstantIC
    variable = pwater
    value = 0
  [../]
  [./oil_init]
    type = ConstantIC
    variable = poil
    value = 15
  [../]
[]

[Kernels]
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstoil]
    type = RichardsLumpedMassChange
    variable = poil
  [../]
  [./richardsfoil]
    type = RichardsFlux
    variable = poil
  [../]
[]


[AuxVariables]
  [./SWater]
  [../]
  [./SOil]
  [../]
[]


[AuxKernels]
  [./Seff1VGwater_AuxK]
    type = RichardsSeffAux
    variable = SWater
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
  [./Seff1VGoil_AuxK]
    type = RichardsSeffAux
    variable = SOil
    seff_UO = SeffOil
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
[]


[BCs]
# we are pumping water into a system that has virtually incompressible fluids, hence the pressures rise enormously.  this adversely affects convergence because of almost-overflows and precision-loss problems.  The fixed things help keep pressures low and so prevent these awful behaviours.   the movement of the saturation front is the same regardless of the fixed things.
  active = &#x27;recharge fixedoil fixedwater&#x27;
  [./recharge]
    type = RichardsPiecewiseLinearSink
    variable = pwater
    boundary = &#x27;left&#x27;
    pressures = &#x27;-1E10 1E10&#x27;
    bare_fluxes = &#x27;-1 -1&#x27;
    use_mobility = false
    use_relperm = false
  [../]
  [./fixedwater]
    type = DirichletBC
    variable = pwater
    boundary = &#x27;right&#x27;
    value = 0
  [../]
  [./fixedoil]
    type = DirichletBC
    variable = poil
    boundary = &#x27;right&#x27;
    value = 15
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.25
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 2E-3&#x27;
    gravity = &#x27;0E-0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = rsc_lumped_01
  interval = 100000
  execute_on = &#x27;initial final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1059d549-4c96-4e09-8e55-1e8153b082a3"><div class="modal-content"><h4>modules/richards/test/tests/theis/th_lumped_02.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
# lumped
[Mesh]
  type = FileMesh
  file = th02_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 2 4 20&#x27;
    x = &#x27;0 1 10 100&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]

  [./total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsLumpedMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsPolyLineSink
    pressures = &#x27;-1E9 1E9&#x27;
    fluxes = &#x27;200 200&#x27;
    point_file = th01.points
    SumQuantityUO = total_outflow_mass
    variable = pressure
  [../]
[]


[Postprocessors]
  [./flow_report]
    type = RichardsPlotQuantity
    uo = total_outflow_mass
  [../]
  [./p50]
    type = PointValue
    variable = pressure
    point = &#x27;50 0 0&#x27;
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E5
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-6 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 100
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = th_lumped_02
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d965b387-56f7-4b7d-b5d0-94cfefa4bd04"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/j_integral_vtest/c_int_surfbreak_ellip_crack_sym_mm.i</h4><pre class="moose-pre"><code class="language-text">[GlobalParams]
  order = FIRST
  family = LAGRANGE
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  volumetric_locking_correction = true
[]

[Mesh]
  file = c_integral_coarse.e
  partitioner = centroid
  centroid_partitioner_direction = z
[]

[AuxVariables]
  [./SED]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./resid_z]
  [../]
[]

[Functions]
  [./rampConstantUp]
    type = PiecewiseLinear
    x = &#x27;0. 0.1 100.0&#x27;
    y = &#x27;0. 1 1&#x27;
    scale_factor = -68.95 #MPa
  [../]
  [./dts]
  type = PiecewiseLinear
  x = &#x27;0   1&#x27;
  y = &#x27;1   400000&#x27;
[../]
[]

[Modules/TensorMechanics/Master]
  [./master]
    strain = FINITE
    add_variables = true
    incremental = true
    generate_output = &#x27;stress_xx stress_yy stress_zz vonmises_stress&#x27;
  [../]
[]

[AuxKernels]
  [./SED]
    type = MaterialRealAux
    variable = SED
    property = strain_energy_density
    execute_on = timestep_end
  [../]
[]

[BCs]
  [./crack_y]
    type = DirichletBC
    variable = disp_z
    boundary = 6
    value = 0.0
  [../]
  [./no_y]
    type = DirichletBC
    variable = disp_y
    boundary = 12
    value = 0.0
  [../]
  [./no_x]
    type = DirichletBC
    variable = disp_x
    boundary = 1
    value = 0.0
  [../]
  [./Pressure]
    [./Side1]
      boundary = 5
      function = rampConstantUp
    [../]
  [../]
[] # BCs

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 206800
    poissons_ratio = 0.0
  [../]
  [./radial_return_stress]
    type = ComputeMultipleInelasticStress
    inelastic_models = &#x27;powerlawcrp&#x27;
  [../]
  [./powerlawcrp]
    type = PowerLawCreepStressUpdate
    coefficient = 3.125e-21 # 7.04e-17 #
    n_exponent = 4.0
    m_exponent = 0.0
    activation_energy = 0.0
    # max_inelastic_increment = 0.01
  [../]
[]

[DomainIntegral]
  integrals = CIntegral
  boundary = 1001
  crack_direction_method = CurvedCrackFront
  crack_end_direction_method = CrackDirectionVector
  crack_direction_vector_end_1 = &#x27;0.0 1.0 0.0&#x27;
  crack_direction_vector_end_2 = &#x27;1.0 0.0 0.0&#x27;
  radius_inner = &#x27;12.5 25.0 37.5&#x27;
  radius_outer = &#x27;25.0 37.5 50.0&#x27;
  intersecting_boundary = &#x27;1 2&#x27;
  symmetry_plane = 2
  incremental = true
  inelastic_models = &#x27;powerlawcrp&#x27;
[]

[Executioner]

   type = Transient
  # Two sets of linesearch options are for petsc 3.1 and 3.3 respectively
  #Preconditioned JFNK (default)
  solve_type = &#x27;NEWTON&#x27;

#  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart -pc_type -pc_hypre_type -pc_hypre_boomeramg_max_iter&#x27;
  petsc_options_value = &#x27;201                hypre    boomeramg      4&#x27;
  line_search = &#x27;none&#x27;

   l_max_its = 50
   nl_max_its = 20
   nl_abs_tol = 1e-3
   nl_rel_tol = 1e-11
   l_tol = 1e-2

   start_time = 0.0
   end_time = 401

   [./TimeStepper]
     type = FunctionDT
     function = dts
     min_dt = 1.0
   [../]
[]

[Postprocessors]
  [./_dt]
    type = TimestepSize
  [../]
  [./nl_its]
    type = NumNonlinearIterations
  [../]
  [./lin_its]
    type = NumLinearIterations
  [../]
  [./react_z]
    type = NodalSum
    variable = resid_z
    boundary = 5
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="696286b3-1ef1-4e0b-97b2-375b25ab2bf1"><div class="modal-content"><h4>modules/richards/test/tests/theis/th01.i</h4><pre class="moose-pre"><code class="language-text"># fully-saturated
# production
[Mesh]
  type = FileMesh
  file = th01_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;0.5 1 2 10&#x27;
    x = &#x27;0 1 10 100&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]

  [./total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsPolyLineSink
    pressures = &#x27;-1E9 1E9&#x27;
    fluxes = &#x27;200 200&#x27;
    point_file = th01.points
    SumQuantityUO = total_outflow_mass
    variable = pressure
  [../]
[]


[Postprocessors]
  [./flow_report]
    type = RichardsPlotQuantity
    uo = total_outflow_mass
  [../]
  [./p50]
    type = PointValue
    variable = pressure
    point = &#x27;50 0 0&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E5
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-6 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 100
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = th01
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f88c6d00-605a-4aca-894c-aa5d2647e32f"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh_lumped_07.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = true
# transient = true
# lumped = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
  viscosity = &#x27;1E-3 0.5E-3&#x27;
  gravity = &#x27;0 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.2
    max = 0.8
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.2
    max = 1.8
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh_lumped_07
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9c74233a-e46d-4587-a4cb-1485a5f34dbc"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# injection
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;500 500 1E1&#x27;
    x = &#x27;4000 5000 6500&#x27;
  [../]
[]

[Variables]
  [./pp]
    initial_condition = -2E5
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0 0 1E-12 0 0 0 1E-12&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityFLAC
    m = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    variable = pp
    SumQuantityUO = borehole_total_outflow_mass
    point_file = bh03.bh
    fluid_phase = 0
    bottom_p_or_t = 0
    unit_weight = &#x27;0 0 0&#x27;
    use_mobility = true
    character = -1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = PorousFlowFluidMass
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = PorousFlowFluidMass
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pp
    point = &#x27;0 0 0&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 6500
  solve_type = NEWTON
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bh05
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b810becb-fc69-4d53-a6d3-7246f8a7365c"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/combined_creep_plasticity/combined_creep_plasticity.i</h4><pre class="moose-pre"><code class="language-text">#
# This test is Example 2 from &quot;A Consistent Formulation for the Integration
#   of Combined Plasticity and Creep&quot; by P. Duxbury, et al., Int J Numerical
#   Methods in Engineering, Vol. 37, pp. 1277-1295, 1994.
#
# The problem is a one-dimensional bar which is loaded from yield to a value of twice
#   the initial yield stress and then unloaded to return to the original stress. The
#   bar must harden to the required yield stress during the load ramp, with no
#   further yielding during unloading. The initial yield stress (sigma_0) is prescribed
#   as 20 with a plastic strain hardening of 100. The mesh is a 1x1x1 cube with symmetry
#   boundary conditions on three planes to provide a uniaxial stress field.
#
#  In the PowerLawCreep model, the creep strain rate is defined by:
#
#   edot = A(sigma)**n * exp(-Q/(RT)) * t**m
#
#   The creep law specified in the paper, however, defines the creep strain rate as:
#
#   edot = Ao * mo * (sigma)**n * t**(mo-1)
#      with the creep parameters given by
#         Ao = 1e-7
#         mo = 0.5
#         n  = 5
#
#   thus, input parameters for the test were specified as:
#         A = Ao * mo = 1e-7 * 0.5 = 0.5e-7
#         m = mo-1 = -0.5
#         n = 5
#         Q = 0
#
#   The variation of load P with time is:
#       P = 20 + 20t      0 &lt; t &lt; 1
#       P = 40 - 40(t-1)  1 &lt; t 1.5
#
#  The analytic solution for total strain during the loading period 0 &lt; t &lt; 1 is:
#
#    e_tot = (sigma_0 + 20*t)/E + 0.2*t + A * t**0.5  * sigma_0**n * [ 1 + (5/3)*t +
#               + 2*t**2 + (10/7)*t**3 + (5/9)**t**4 + (1/11)*t**5 ]
#
#    and during the unloading period 1 &lt; t &lt; 1.5:
#
#    e_tot = (sigma_1 - 40*(t-1))/E + 0.2 + (4672/693) * A * sigma_0**n +
#               A * sigma_0**n * [ t**0.5 * ( 32 - (80/3)*t + 16*t**2 - (40/7)*t**3
#                                  + (10/9)*t**4 - (1/11)*t**5 ) - (11531/693) ]
#
#         where sigma_1 is the stress at time t = 1.
#
#  Assuming a Young&#x27;s modulus (E) of 1000 and using the parameters defined above:
#
#    e_tot(1) = 2.39734
#    e_tot(1.5) = 3.16813
#
#
#   The numerically computed solution is:
#
#    e_tot(1) = 2.39718         (~0.006% error)
#    e_tot(1.5) = 3.15555       (~0.40% error)
#
[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
[]

[Modules/TensorMechanics/Master]
  [./all]
    strain = FINITE
    incremental = true
    add_variables = true
    generate_output = &#x27;stress_yy elastic_strain_yy creep_strain_yy plastic_strain_yy&#x27;
  [../]
[]

[Functions]
  [./top_pull]
    type = PiecewiseLinear
    x = &#x27;  0   1   1.5&#x27;
    y = &#x27;-20 -40   -20&#x27;
  [../]

  [./dts]
    type = PiecewiseLinear
    x = &#x27;0        0.5    1.0    1.5&#x27;
    y = &#x27;0.015  0.015  0.005  0.005&#x27;
  [../]
[]

[BCs]
  [./u_top_pull]
    type = Pressure
    variable = disp_y
    component = 1
    boundary = top
    factor = 1
    function = top_pull
  [../]
  [./u_bottom_fix]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
  [./u_yz_fix]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./u_xy_fix]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    block = 0
    youngs_modulus = 1e3
    poissons_ratio = 0.3
  [../]
  [./creep_plas]
    type = ComputeMultipleInelasticStress
    block = 0
    tangent_operator = elastic
    inelastic_models = &#x27;creep plas&#x27;
    max_iterations = 50
    absolute_tolerance = 1e-05
    combined_inelastic_strain_weights = &#x27;0.0 1.0&#x27;
  [../]
  [./creep]
    type = PowerLawCreepStressUpdate
    block = 0
    coefficient = 0.5e-7
    n_exponent = 5
    m_exponent = -0.5
    activation_energy = 0
  [../]
  [./plas]
    type = IsotropicPlasticityStressUpdate
    block = 0
    hardening_constant = 100
    yield_stress = 20
  [../]
[]

[Executioner]
  type = Transient

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp&#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;101&#x27;

  line_search = &#x27;none&#x27;

  l_max_its = 20
  nl_max_its = 6
  nl_rel_tol = 1e-6
  nl_abs_tol = 1e-10
  l_tol = 1e-5
  start_time = 0.0
  end_time = 1.5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="39303e46-3b55-4a48-a89a-3411c9884e2e"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rsc02.i</h4><pre class="moose-pre"><code class="language-text"># RSC test with low-res time and spatial resolution
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 1
  xmin = 0
  xmax = 10 # x is the depth variable, called zeta in RSC
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;3E-2 5E-1 8E-1&#x27;
    x = &#x27;0 1 5&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pwater poil&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
[]

[Modules]
  [./FluidProperties]
    [./water]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 10
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
    [./oil]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 20
      thermal_expansion = 0
      viscosity = 2e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = pwater
    phase1_porepressure = poil
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./water]
    type = PorousFlowSingleComponentFluid
    fp = water
    phase = 0
    compute_enthalpy = false
    compute_internal_energy = false
  [../]
  [./oil]
    type = PorousFlowSingleComponentFluid
    fp = oil
    phase = 1
    compute_enthalpy = false
    compute_internal_energy = false
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_oil]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
  [../]
[]

[Variables]
  [./pwater]
  [../]
  [./poil]
  [../]
[]

[ICs]
  [./water_init]
    type = ConstantIC
    variable = pwater
    value = 0
  [../]
  [./oil_init]
    type = ConstantIC
    variable = poil
    value = 15
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pwater
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = poil
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = poil
  [../]
[]


[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./SOil]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]


[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
  [./SOil]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 1
    variable = SOil
  [../]
[]


[BCs]
# we are pumping water into a system that has virtually incompressible fluids, hence the pressures rise enormously.  this adversely affects convergence because of almost-overflows and precision-loss problems.  The fixed things help keep pressures low and so prevent these awful behaviours.   the movement of the saturation front is the same regardless of the fixed things.
  active = &#x27;recharge fixedoil fixedwater&#x27;
  [./recharge]
    type = PorousFlowSink
    variable = pwater
    boundary = &#x27;left&#x27;
    flux_function = -1.0
  [../]
  [./fixedwater]
    type = DirichletBC
    variable = pwater
    boundary = &#x27;right&#x27;
    value = 0
  [../]
  [./fixedoil]
    type = DirichletBC
    variable = poil
    boundary = &#x27;right&#x27;
    value = 15
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;7 0 0&#x27;
    sort_by = x
    num_points = 21
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 5
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rsc02
  [./along_line]
    type = CSV
    execute_vector_postprocessors_on = final
  [../]
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a54cd0d5-f587-4a8e-8121-a86ed780d90c"><div class="modal-content"><h4>modules/richards/test/tests/broadbridge_white/bw02.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-1 5E-1 5E-1&#x27;
    x = &#x27;0 1 10&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 10
    bulk_mod = 2E9
  [../]
  [./SeffBW]
    type = RichardsSeff1BWsmall
    Sn = 0.0
    Ss = 1.0
    C = 1.5
    las = 2
  [../]
  [./RelPermBW]
    type = RichardsRelPermBW
    Sn = 0.0
    Ss = 1.0
    Kn = 0
    Ks = 1
    C = 1.5
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E2
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -9E2
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]


[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffBW
    pressure_vars = pressure
  [../]
[]


[BCs]
  active = &#x27;recharge&#x27;
  [./recharge]
    type = RichardsPiecewiseLinearSink
    variable = pressure
    boundary = &#x27;right&#x27;
    pressures = &#x27;-1E10 1E10&#x27;
    bare_fluxes = &#x27;-1.25 -1.25&#x27; # corresponds to Rstar being 0.5 because i have to multiply by density*porosity
    use_mobility = false
    use_relperm = false
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.25
    mat_permeability = &#x27;1 0 0  0 1 0  0 0 1&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermBW
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffBW
    viscosity = 4
    gravity = &#x27;-0.1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 2

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = bw02
  interval = 10000
  execute_on = &#x27;timestep_end final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4335d8e7-4dd5-499d-bef2-b51d87156b4f"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step07_adaptivity/problems/step7b_fine.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 30
  ny = 3
  xmax = 0.304 # Length of test chamber
  ymax = 0.0257 # Test chamber radius
  uniform_refine = 3
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = right
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = left
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = right
  []
[]

[Materials]
  [column]
    type = PackedColumn
    radius = 1
    temperature = temperature
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = X
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  automatic_scaling = true

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  end_time = 100
  dt = 0.25
  start_time = -1

  steady_state_tolerance = 1e-5
  steady_state_detection = true

  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c4546f04-5796-4061-9dba-dc3f13500392"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/problems/step6b_transient_inflow.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 10
  xmax = 0.304 # Length of test chamber
  ymax = 0.0257 # Test chamber radius
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[Functions]
  [inlet_function]
    type = ParsedFunction
    value = 2000*sin(0.466*pi*t) # Inlet signal from Fig. 3
  []
  [outlet_function]
    type = ParsedFunction
    value = 2000*cos(0.466*pi*t) # Outlet signal from Fig. 3
  []
[]

[BCs]
  [inlet]
    type = FunctionDirichletBC
    variable = pressure
    boundary = left
    function = inlet_function
  []
  [outlet]
    type = FunctionDirichletBC
    variable = pressure
    boundary = right
    function = outlet_function
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = left
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = right
  []
[]

[Materials]
  [column]
    type = PackedColumn
    radius = 1
    temperature = temperature
    fluid_viscosity_file = data/water_viscosity.csv
    fluid_density_file = data/water_density.csv
    fluid_thermal_conductivity_file = data/water_thermal_conductivity.csv
    fluid_specific_heat_file = data/water_specific_heat.csv
    outputs = exodus
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = X
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  automatic_scaling = true

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  end_time = 100
  dt = 0.25
  start_time = -1

  steady_state_tolerance = 1e-5
  steady_state_detection = true

  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,(2*pi/(0.466*pi))/16)&#x27; # dt to always hit the peaks of sine/cosine BC
  []
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a0d04eaf-cc84-4774-8f72-7ea517f266d1"><div class="modal-content"><h4>test/tests/multiapps/multilevel/time_dt_from_master_master.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
  xmax = 100
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    x = &#x27;0     1&#x27;
    y = &#x27;0.25  1&#x27;
  [../]
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./td]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 4

  solve_type = &#x27;PJFNK&#x27;

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  dt = 0.25
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  exodus = true
  [./out]
    type = Console
    output_file = true
  [../]
[]

[MultiApps]
  [./sub]
    type = TransientMultiApp
    app_type = MooseTestApp
    positions = &#x27;0 0 0 0.5 0.5 0&#x27;
    input_files = time_dt_from_master_sub.i
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b2db2ba0-fae4-46bc-8354-93c752d1da41"><div class="modal-content"><h4>modules/richards/test/tests/rogers_stallybrass_clements/rsc_fu_02.i</h4><pre class="moose-pre"><code class="language-text"># RSC test with low-res time and spatial resolution
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 1
  xmin = 0
  xmax = 10 # x is the depth variable, called zeta in RSC
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityOil&#x27;
  relperm_UO = &#x27;RelPerm RelPerm&#x27;
  SUPG_UO = &#x27;SUPGstandard SUPGstandard&#x27;
  sat_UO = &#x27;Saturation Saturation&#x27;
  seff_UO = &#x27;SeffWater SeffOil&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;3E-2 5E-1 8E-1&#x27;
    x = &#x27;0 1 5&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater poil&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 10
    bulk_mod = 2E9
  [../]
  [./DensityOil]
    type = RichardsDensityConstBulk
    dens0 = 20
    bulk_mod = 2E9
  [../]
  [./SeffWater]
    type = RichardsSeff2waterRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./SeffOil]
    type = RichardsSeff2gasRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./RelPerm]
    type = RichardsRelPermMonomial
    simm = 0
    n = 1
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E-2
  [../]
[]


[Variables]
  [./pwater]
  [../]
  [./poil]
  [../]
[]

[ICs]
  [./water_init]
    type = ConstantIC
    variable = pwater
    value = 0
  [../]
  [./oil_init]
    type = ConstantIC
    variable = poil
    value = 15
  [../]
[]

[Kernels]
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstoil]
    type = RichardsMassChange
    variable = poil
  [../]
  [./richardsfoil]
    type = RichardsFullyUpwindFlux
    variable = poil
  [../]
[]


[AuxVariables]
  [./SWater]
  [../]
  [./SOil]
  [../]
[]


[AuxKernels]
  [./Seff1VGwater_AuxK]
    type = RichardsSeffAux
    variable = SWater
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
  [./Seff1VGoil_AuxK]
    type = RichardsSeffAux
    variable = SOil
    seff_UO = SeffOil
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
[]


[BCs]
# we are pumping water into a system that has virtually incompressible fluids, hence the pressures rise enormously.  this adversely affects convergence because of almost-overflows and precision-loss problems.  The fixed things help keep pressures low and so prevent these awful behaviours.   the movement of the saturation front is the same regardless of the fixed things.
  active = &#x27;recharge fixedoil fixedwater&#x27;
  [./recharge]
    type = RichardsPiecewiseLinearSink
    variable = pwater
    boundary = &#x27;left&#x27;
    pressures = &#x27;-1E10 1E10&#x27;
    bare_fluxes = &#x27;-1 -1&#x27;
    use_mobility = false
    use_relperm = false
  [../]
  [./fixedwater]
    type = DirichletBC
    variable = pwater
    boundary = &#x27;right&#x27;
    value = 0
  [../]
  [./fixedoil]
    type = DirichletBC
    variable = poil
    boundary = &#x27;right&#x27;
    value = 15
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.25
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 2E-3&#x27;
    gravity = &#x27;0E-0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = rsc_fu_02
  interval = 100000
  execute_on = &#x27;initial timestep_end final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1c96a674-c8bd-4f8f-8b6d-a1a10698d591"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh05.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = false
# supg = false
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGnone
  [../]
  [./SUPGgas]
    type = RichardsSUPGnone
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = RandomIC
    min = 0.2
    max = 0.8
    variable = pwater
  [../]
  [./gas_ic]
    type = RandomIC
    min = 1.2
    max = 1.8
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((p0-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh05
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="16f17885-c91c-4de4-8d29-b7a53b7bfc04"><div class="modal-content"><h4>modules/richards/test/tests/buckley_leverett/bl20_lumped.i</h4><pre class="moose-pre"><code class="language-text"># two-phase version
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 30
  xmin = 0
  xmax = 15
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;0.1 0.5 0.5 1 2  4&#x27;
    x = &#x27;0   0.1 1   5 40 42&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E6
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1E-5
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./w_aux_seff]
  [../]
[]



[Kernels]
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]

[AuxKernels]
  [./w_aux_seff_auxk]
    type = RichardsSeffAux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
    variable = w_aux_seff
  [../]
[]


[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_water
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_gas
  [../]
[]

[BCs]
  [./left_w]
    type = DirichletBC
    variable = pwater
    boundary = left
    value = 1E6
  [../]
  [./left_g]
    type = DirichletBC
    variable = pgas
    boundary = left
    value = 1000
  [../]
  [./right_w]
    type = DirichletBC
    variable = pwater
    boundary = right
    value = -300000
  [../]
  [./right_g]
    type = DirichletBC
    variable = pgas
    boundary = right
    value = 0
  [../]
[]


[Functions]
  [./initial_water]
    type = ParsedFunction
    value = 1000000*(1-min(x/5,1))-if(x&lt;5,0,300000)
  [../]
  [./initial_gas]
    type = ParsedFunction
    value = 1000
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.15
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    viscosity = &#x27;1E-3 1E-6&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  active = &#x27;standard&#x27;

  [./bounded]
  # must use --use-petsc-dm command line argument
    type = SMP
    full = true
    petsc_options_iname = &#x27;-snes_type   -pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;vinewtonssls nonzero&#x27;
  [../]

  [./standard]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;nonzero&#x27;
  [../]

[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 50

  nl_rel_tol = 1.e-9
  nl_max_its = 10

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bl20_lumped
  execute_on = &#x27;initial timestep_end final&#x27;
  interval = 100000
  exodus = true
  hide = pgas
  [./console_out]
    type = Console
    interval = 1
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="62f96c5e-2f06-4e93-ba40-841e12742b5f"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh_fu_04.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# production
# fullyupwind
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1 1E1 1E2 1E3&#x27;
    x = &#x27;0 1E-1 1 1E1 1E2 1E3&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = -1E6
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
    fully_upwind = true
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 0
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1E3
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = bh_fu_04
  exodus = false
  execute_on = timestep_end
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="199db4bc-05e8-4d68-8e16-805b767de91e"><div class="modal-content"><h4>modules/richards/test/tests/buckley_leverett/bl20.i</h4><pre class="moose-pre"><code class="language-text"># two-phase version
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 30
  xmin = 0
  xmax = 15
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;0.1 0.5 0.5 1 2  4&#x27;
    x = &#x27;0   0.1 1   5 40 42&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E6
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1E-5
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
  [./bounds_dummy]
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
  [./richardsppenalty]
    type = RichardsPPenalty
    variable = pgas
    a = 1E-18
    lower_var = pwater
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
  [../]
[]

[Bounds]
  [./pwater_upper_bounds]
    type = ConstantBoundsAux
    variable = bounds_dummy
    bounded_variable = pwater
    bound_type = upper
    bound_value = 1E7
  [../]
  [./pwater_lower_bounds]
    type = ConstantBoundsAux
    variable = bounds_dummy
    bounded_variable = pwater
    bound_type = lower
    bound_value = -310000
  [../]
[]


[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_water
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_gas
  [../]
[]

[BCs]
  [./left_w]
    type = DirichletBC
    variable = pwater
    boundary = left
    value = 1E6
  [../]
  [./left_g]
    type = DirichletBC
    variable = pgas
    boundary = left
    value = 1E6
  [../]
  [./right_w]
    type = DirichletBC
    variable = pwater
    boundary = right
    value = -300000
  [../]
  [./right_g]
    type = DirichletBC
    variable = pgas
    boundary = right
    value = 0
  [../]
[]


[Functions]
  [./initial_water]
    type = ParsedFunction
    value = 1000000*(1-min(x/5,1))-300000*(max(x-5,0)/max(abs(x-5),1E-10))
  [../]
  [./initial_gas]
    type = ParsedFunction
    value = max(1000000*(1-x/5),0)+1000
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.15
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 1E-6&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  active = &#x27;standard&#x27;

  [./bounded]
  # must use --use-petsc-dm command line argument
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -snes_type -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 50 vinewtonssls 1E-20 1E-20&#x27;
  [../]

  [./standard]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -snes_atol -snes_rtol -snes_max_it -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;gmres asm lu NONZERO 1E-10 1E-10 20 1E-20 1E-20&#x27;
  [../]

[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 50

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bl20
  execute_on = &#x27;initial timestep_end final&#x27;
  interval = 10000
  exodus = true
  hide = pgas
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="07b81647-d156-405d-83af-ebc93dc3e566"><div class="modal-content"><h4>modules/richards/test/tests/buckley_leverett/bl22_lumped_fu.i</h4><pre class="moose-pre"><code class="language-text"># two-phase version
# super-sharp front version
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 150
  xmin = 0
  xmax = 15
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-4 1E-3 1E-2 2E-2 5E-2 6E-2 0.1 0.2&#x27;
    x = &#x27;0    1E-2 1E-1 1    5    20   40  41&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E6
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1E-4
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1E-4
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
  [./bounds_dummy]
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFullyUpwindFlux
    variable = pgas
  [../]
  [./richardsppenalty]
    type = RichardsPPenalty
    variable = pgas
    a = 1E-18
    lower_var = pwater
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
  [../]
[]

[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_water
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_gas
  [../]
[]

[BCs]
  [./left_w]
    type = DirichletBC
    variable = pwater
    boundary = left
    value = 1E6
  [../]
  [./left_g]
    type = DirichletBC
    variable = pgas
    boundary = left
    value = 1000
  [../]
  [./right_w]
    type = DirichletBC
    variable = pwater
    boundary = right
    value = -100000
  [../]
  [./right_g]
    type = DirichletBC
    variable = pgas
    boundary = right
    value = 0
  [../]
[]


[Functions]
  [./initial_water]
    type = ParsedFunction
    value = 1000000*(1-min(x/5,1))-if(x&lt;5,0,100000)
  [../]
  [./initial_gas]
    type = ParsedFunction
    value = 1000
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.15
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    viscosity = &#x27;1E-3 1E-6&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]

  [./standard]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10 1E-10 20 1E-10 1E-100&#x27;
  [../]

[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 50

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = bl22_lumped_fu
  [./exodus]
    type = Exodus
    interval = 100000
    hide = &#x27;pgas bounds_dummy&#x27;
    execute_on = &#x27;initial final timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e12b0a47-e3db-4bb5-b88b-bbfa3bcb28d0"><div class="modal-content"><h4>modules/geochemistry/test/tests/solubilities_and_activities/gypsum_solubility.i</h4><pre class="moose-pre"><code class="language-text">[TimeDependentReactionSolver]
  model_definition = definition
  swap_out_of_basis = &quot;Ca++&quot;
  swap_into_basis = &quot;Gypsum&quot;
  charge_balance_species = &quot;SO4--&quot;
  constraint_species = &quot;H2O              Cl-           Na+           SO4--              Gypsum&quot;
  constraint_value = &quot;  1.0              1E-10         1E-10         1E-6               0.5814&quot;
  constraint_meaning = &quot;kg_solvent_water free_molality free_molality moles_bulk_species free_moles_mineral_species&quot;
  source_species_names = &#x27;NaCl&#x27;
  source_species_rates = &#x27;1.0&#x27;
  add_aux_pH = false # there is no H+ in the problem
  ramp_max_ionic_strength_initial = 0 # not needed in this simple problem
  stoichiometric_ionic_str_using_Cl_only = true # for comparison with GWB
  abs_tol = 1E-12
  execute_console_output_on = &#x27;&#x27; # only CSV output in this example
[]

[UserObjects]
  [./definition]
    type = GeochemicalModelDefinition
    database_file = &quot;../../../database/moose_geochemdb.json&quot;
    basis_species = &quot;H2O Cl- Na+ SO4-- Ca++&quot;
    equilibrium_minerals = &quot;Gypsum&quot;
    piecewise_linear_interpolation = true # for comparison with GWB
  [../]
[]

[Functions]
  [./timestepper]
    type = PiecewiseLinear
    x = &#x27;0    0.1&#x27;
    y = &#x27;0.01 0.1&#x27;
  [../]
[]

[Executioner]
  type = Transient
  [./TimeStepper]
    type = FunctionDT
    function = timestepper
  [../]
  end_time = 3
[]

[Outputs]
  csv = true
[]

[AuxVariables]
  [./dissolved_gypsum_moles]
  [../]
[]
[AuxKernels]
  [./dissolved_gypsum_moles]
    type = ParsedAux
    args = &#x27;bulk_moles_Gypsum free_mg_Gypsum&#x27;
    function = &#x27;bulk_moles_Gypsum - free_mg_Gypsum / 1000 / 172.168 &#x27;
    variable = dissolved_gypsum_moles
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[Postprocessors]
  [./cl_molal]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = &#x27;molal_Cl-&#x27;
  [../]
  [./dissolved_gypsum_mol]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = dissolved_gypsum_moles
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6018af6a-c427-4b80-8e69-69e0c5803c4d"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh_lumped_07.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = FileMesh
  file = bh07_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1000 10000&#x27;
    x = &#x27;100 1000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[BCs]
  [./fix_outer]
    type = DirichletBC
    boundary = perimeter
    variable = pressure
    value = 1E7
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsLumpedMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh07.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    re_constant = 0.1594
    character = 2
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./fluid_mass]
    type = RichardsMass
    variable = pressure
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-11 0 0  0 1E-11 0  0 0 1E-11&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1000
  solve_type = NEWTON

  [./TimeStepper]
    # get only marginally better results for smaller time steps
    type = FunctionDT
    function = dts
  [../]

[]

[Outputs]
  file_base = bh_lumped_07
  execute_on = &#x27;initial timestep_end final&#x27;
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="12d553bc-7e97-41d0-b3f4-71638670ffb3"><div class="modal-content"><h4>test/tests/multiapps/sub_cycling_failure/sub_gold.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Functions]
  [./dts]
    # These mimic the behavior of the failing solve
    type = PiecewiseConstant
    x = &#x27;0     0.1    0.105&#x27;
    y = &#x27;0.01  0.005  0.01&#x27;
  [../]
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./td]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 4
  dt = 0.01

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]

  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8693880e-7a0e-4ddc-831d-ad526182776e"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh16.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 0.01
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    output = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    output = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    output = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    output = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh16
  execute_on = &#x27;timestep_end final&#x27;
  interval = 100000
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ee7a6bf8-fb51-4d19-9b0e-739838284a49"><div class="modal-content"><h4>modules/richards/test/tests/buckley_leverett/bl22_lumped.i</h4><pre class="moose-pre"><code class="language-text"># two-phase version
# super-sharp front version
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 150
  xmin = 0
  xmax = 15
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-4 1E-3 1E-2 2E-2 5E-2 6E-2 0.1 0.2&#x27;
    x = &#x27;0    1E-2 1E-1 1    5    20   40  41&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E6
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1E-4
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1E-4
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
  [./bounds_dummy]
  [../]
[]

[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
  [./richardsppenalty]
    type = RichardsPPenalty
    variable = pgas
    a = 1E-18
    lower_var = pwater
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
  [../]
[]

[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_water
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_gas
  [../]
[]

[BCs]
  [./left_w]
    type = DirichletBC
    variable = pwater
    boundary = left
    value = 1E6
  [../]
  [./left_g]
    type = DirichletBC
    variable = pgas
    boundary = left
    value = 1000
  [../]
  [./right_w]
    type = DirichletBC
    variable = pwater
    boundary = right
    value = -100000
  [../]
  [./right_g]
    type = DirichletBC
    variable = pgas
    boundary = right
    value = 0
  [../]
[]


[Functions]
  [./initial_water]
    type = ParsedFunction
    value = 1000000*(1-min(x/5,1))-if(x&lt;5,0,100000)
  [../]
  [./initial_gas]
    type = ParsedFunction
    value = 1000
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.15
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    viscosity = &#x27;1E-3 1E-6&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]

  [./standard]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10 1E-10 20 1E-10 1E-100&#x27;
  [../]

[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 50

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = bl22_lumped
  [./exodus]
    type = Exodus
    interval = 100000
    hide = &#x27;pgas bounds_dummy&#x27;
    execute_on = &#x27;initial final timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="55a83f81-2c56-474c-af03-a0db1bf5e41a"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step09_mechanics/problems/step9.i</h4><pre class="moose-pre"><code class="language-text">[GlobalParams]
  displacements = &#x27;disp_r disp_z&#x27;
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  ny = 200
  nx = 10
  ymax = 0.304 # Length of test chamber
  xmax = 0.0257 # Test chamber radius
[]

[MeshModifiers]
  [bottom]
    type = SubdomainBoundingBox
    location = inside
    bottom_left = &#x27;0 0 0&#x27;
    top_right = &#x27;0.01285 0.304 0&#x27;
    block_id = 1
  []
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Modules/TensorMechanics/Master]
  [all]
    # This block adds all of the proper Kernels, strain calculators, and Variables
    # for TensorMechanics in the correct coordinate system (autodetected)
    add_variables = true
    strain = FINITE
    eigenstrain_names = eigenstrain
    use_automatic_differentiation = true
    generate_output = &#x27;vonmises_stress elastic_strain_xx elastic_strain_yy strain_xx strain_yy&#x27;
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = bottom
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = top
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = bottom
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = top
  []
  [hold_inlet]
    type = DirichletBC
    variable = disp_z
    boundary = bottom
    value = 0
  []
  [hold_center]
    type = DirichletBC
    variable = disp_r
    boundary = left
    value = 0
  []
  [hold_outside]
    type = DirichletBC
    variable = disp_r
    boundary = right
    value = 0
  []
[]

[Materials]
  viscosity_file = data/water_viscosity.csv
  density_file = data/water_density.csv
  thermal_conductivity_file = data/water_thermal_conductivity.csv
  specific_heat_file = data/water_specific_heat.csv
  thermal_expansion_file = data/water_thermal_expansion.csv

  [column_top]
    type = PackedColumn
    block = 0
    temperature = temperature
    radius = 1.15
    fluid_viscosity_file = ${viscosity_file}
    fluid_density_file = ${density_file}
    fluid_thermal_conductivity_file = ${thermal_conductivity_file}
    fluid_specific_heat_file = ${specific_heat_file}
    fluid_thermal_expansion_file = ${thermal_expansion_file}
  []
  [column_bottom]
    type = PackedColumn
    block = 1
    temperature = temperature
    radius = 1
    fluid_viscosity_file = ${viscosity_file}
    fluid_density_file = ${density_file}
    fluid_thermal_conductivity_file = ${thermal_conductivity_file}
    fluid_specific_heat_file = ${specific_heat_file}
    fluid_thermal_expansion_file = ${thermal_expansion_file}
  []

  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 200e9 # (Pa) from wikipedia
    poissons_ratio = .3 # from wikipedia

  []
  [elastic_stress]
    type = ADComputeFiniteStrainElasticStress
  []
  [thermal_strain]
    type = ADComputeThermalExpansionEigenstrain
    stress_free_temperature = 300
    eigenstrain_name = eigenstrain
    temperature = temperature
    thermal_expansion_coeff = 1e-5 # TM modules doesn&#x27;t support material property, but it will
  []
[]

[Postprocessors]
  [average_temperature]
    type = ElementAverageValue
    variable = temperature
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
[]

[Executioner]
  type = Transient
  start_time = -1
  end_time = 200
  steady_state_tolerance = 1e-7
  steady_state_detection = true
  dt = 0.25
  solve_type = PJFNK
  automatic_scaling = true
  compute_scaling_once = false
  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
  #petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  #petsc_options_value = &#x27;hypre boomeramg 500&#x27;
  line_search = none
  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]

[Outputs]
  [out]
    type = Exodus
    elemental_as_nodal = true
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7923b52e-0dd6-4925-9b12-aaf754b187b0"><div class="modal-content"><h4>modules/porous_flow/examples/flow_through_fractured_media/fine_thick_fracture_transient.i</h4><pre class="moose-pre"><code class="language-text"># Using a single-dimensional mesh
# Transient flow and solute transport along a fracture in a porous matrix
# advective dominated flow in the fracture and diffusion into the porous matrix
#
# Note that fine_thick_fracture_steady.i must be run to initialise the porepressure properly

[Mesh]
  file = &#x27;gold/fine_thick_fracture_steady_out.e&#x27;
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./pp]
    initial_from_file_var = pp
    initial_from_file_timestep = 1
  [../]
  [./massfrac0]
  [../]
[]

[AuxVariables]
  [./velocity_x]
    family = MONOMIAL
    order = CONSTANT
    block = fracture
  [../]
  [./velocity_y]
    family = MONOMIAL
    order = CONSTANT
    block = fracture
  [../]
[]

[AuxKernels]
  [./velocity_x]
    type = PorousFlowDarcyVelocityComponent
    variable = velocity_x
    component = x
  [../]
  [./velocity_y]
    type = PorousFlowDarcyVelocityComponent
    variable = velocity_y
    component = y
  [../]
[]

[ICs]
  [./massfrac0]
    type = ConstantIC
    variable = massfrac0
    value = 0
  [../]
[]

[BCs]
  [./top]
    type = DirichletBC
    value = 0
    variable = massfrac0
    boundary = top
  [../]
  [./bottom]
    type = DirichletBC
    value = 1
    variable = massfrac0
    boundary = bottom
  [../]
  [./ptop]
    type = DirichletBC
    variable = pp
    boundary =  top
    value = 1e6
  [../]
  [./pbottom]
    type = DirichletBC
    variable = pp
    boundary = bottom
    value = 1.002e6
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./adv0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
  [../]
  [./diff0]
    type = PorousFlowDispersiveFlux
    fluid_component = 0
    variable = pp
    disp_trans = 0
    disp_long = 0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = massfrac0
  [../]
  [./adv1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = massfrac0
  [../]
  [./diff1]
    type = PorousFlowDispersiveFlux
    fluid_component = 1
    variable = massfrac0
    disp_trans = 0
    disp_long = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp massfrac0&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = massfrac0
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./poro_fracture]
    type = PorousFlowPorosityConst
    porosity = 1.0    # this is the true porosity of the fracture
    block = &#x27;fracture&#x27;
  [../]
  [./poro_matrix]
    type = PorousFlowPorosityConst
    porosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./diff1]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 1.0
    block = &#x27;fracture&#x27;
  [../]
  [./diff2]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./relp]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./permeability1]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;3e-8 0 0 0 3e-8 0 0 0 3e-8&#x27; # this is the true permeability of the fracture
    block = &#x27;fracture&#x27;
  [../]
  [./permeability2]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-20 0 0 0 1e-20 0 0 0 1e-20&#x27;
    block = &#x27;matrix1 matrix2&#x27;
  [../]
[]

[Functions]
  [./dt_controller]
     type = PiecewiseConstant
     x = &#x27;0    30   40 100 200 83200&#x27;
     y = &#x27;0.01 0.1  1  10  100 32&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./mumps_is_best_for_parallel_jobs]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
  [./basic]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2             &#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 86400
  #dt = 0.01

  [./TimeStepper]
    type = FunctionDT
    function = dt_controller
  [../]

# controls for nonlinear iterations
  nl_max_its = 15
  nl_rel_tol = 1e-14
  nl_abs_tol = 1e-9
[]


[VectorPostprocessors]
  [./xmass]
    type = LineValueSampler
    start_point = &#x27;0.4 0 0&#x27;
    end_point = &#x27;0.5 0 0&#x27;
    sort_by = x
    num_points = 167
    variable = massfrac0
  [../]
[]

[Outputs]
  perf_graph = true
  console = true
  csv = true
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="dd4fc3ba-490d-4ffe-8386-4a9251b32d1a"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh08.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = true
# gravity = true
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-3
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 2
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]

  [./pg_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./pg_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pgas
    outputs = none
  [../]
  [./error_gas]
    type = FunctionValuePostprocessor
    function = fcn_error_gas
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
  [./fcn_error_gas]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;0.5E2 -0.5 pg_left 1 pg_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh08
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c865dcea-9e24-4135-8d8d-6c6bd8b84b53"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/problems/step6a_coupled.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 10
  xmax = 0.304 # Length of test chamber
  ymax = 0.0257 # Test chamber radius
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = right
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = left
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = right
  []
[]

[Materials]
  [column]
    type = PackedColumn
    temperature = temperature
    radius = 1
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = X
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  automatic_scaling = true

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  end_time = 100
  dt = 0.25
  start_time = -1

  steady_state_tolerance = 1e-5
  steady_state_detection = true

  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4c26b309-23af-4178-835e-67cae174ae97"><div class="modal-content"><h4>modules/porous_flow/test/tests/gravity/grav02c.i</h4><pre class="moose-pre"><code class="language-text"># Checking that gravity head is established in the transient situation when 0&lt;=saturation&lt;=1 (note the less-than-or-equal-to).
# 2phase (PP), 2components, vanGenuchten, constant fluid bulk-moduli for each phase, constant viscosity, constant permeability, Corey relative perm
# For better agreement with the analytical solution (ana_pp), just increase nx

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = -1
  xmax = 0
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-3 1E-2 1E-1&#x27;
    x = &#x27;1E-3 1E-2 1E-1&#x27;
  [../]
[]

[Variables]
  [./ppwater]
    initial_condition = -0.1
  [../]
  [./ppgas]
    initial_condition = 0
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = ppwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = ppwater
    gravity = &#x27;-1 0 0&#x27;
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = ppgas
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = ppgas
    gravity = &#x27;-1 0 0&#x27;
  [../]
[]

[Functions]
  [./ana_ppwater]
    type = ParsedFunction
    vars = &#x27;g B p0 rho0&#x27;
    vals = &#x27;1 2 pp_water_top 1&#x27;
    value = &#x27;-B*log(exp(-p0/B)+g*rho0*x/B)&#x27; # expected pp at base
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater ppgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 2
      density0 = 1
      viscosity = 1
      thermal_expansion = 0
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 1
      density0 = 0.1
      viscosity = 0.5
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = ppwater
    phase1_porepressure = ppgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 2 0  0 0 3&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[Postprocessors]
  [./pp_water_top]
    type = PointValue
    variable = ppwater
    point = &#x27;0 0 0&#x27;
  [../]
  [./pp_water_base]
    type = PointValue
    variable = ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./pp_water_analytical]
    type = FunctionValuePostprocessor
    function = ana_ppwater
    point = &#x27;-1 0 0&#x27;
  [../]
  [./mass_ph0]
    type = PorousFlowFluidMass
    fluid_component = 0
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./mass_ph1]
    type = PorousFlowFluidMass
    fluid_component = 1
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

[]

[Preconditioning]
  active = andy
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000&#x27;
  [../]
  [./check]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -snes_type&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-10 10000 test&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
  end_time = 1.0
[]

[Outputs]
  execute_on = &#x27;initial timestep_end&#x27;
  file_base = grav02c
  [./csv]
    type = CSV
  [../]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="641a5b8b-01f0-4c9f-a43a-55d9982823a1"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/combined_creep_plasticity/combined_stress_prescribed.i</h4><pre class="moose-pre"><code class="language-text">#
# 1x1x1 unit cube with time-varying pressure on top face
#
# The problem is a one-dimensional creep analysis.  The top face has a
#    pressure load that is a function of time.  The creep strain can be
#    calculated analytically.  There is no practical active linear
#    isotropic plasticity because the yield stress for the plasticity
#    model is set to 1e30 MPa, which will not be reached in this
#    regression test.
#
# The analytic solution to this problem is:
#
#    d ec
#    ---- = a*S^b  with S = c*t^d
#     dt
#
#    d ec = a*c^b*t^(b*d) dt
#
#         a*c^b
#    ec = ----- t^(b*d+1)
#         b*d+1
#
#    where S  = stress
#          ec = creep strain
#          t  = time
#          a  = constant
#          b  = constant
#          c  = constant
#          d  = constant
#
# With a = 3e-24,
#      b = 4,
#      c = 1,
#      d = 1/2, and
#      t = 32400
#   we have
#
#   S = t^(1/2) = 180
#
#   ec = 1e-24*t^3 = 3.4012224e-11
#
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  volumetric_locking_correction = true
[]

[Modules/TensorMechanics/Master]
  [./all]
    strain = FINITE
    incremental = true
    add_variables = true
    generate_output = &#x27;stress_yy creep_strain_yy&#x27;
  [../]
[]

[Functions]
  [./pressure]
    type = ParsedFunction
    value = &#x27;sqrt(t)&#x27;
  [../]

  [./dts]
    type = PiecewiseLinear
    y = &#x27;1e-2 1e-1 1e0 1e1 1e2&#x27;
    x = &#x27;0    7e-1 7e0 7e1 1e2&#x27;
  [../]
[]

[BCs]
  [./top_pressure]
    type = Pressure
    variable = disp_y
    component = 1
    boundary = top
    function = pressure
  [../]
  [./u_bottom_fix]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
  [./u_yz_fix]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./u_xy_fix]
    type = DirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.8e7
    poissons_ratio = 0.3
  [../]
  [./creep_plas]
    type = ComputeMultipleInelasticStress
    inelastic_models = &#x27;creep plas&#x27;
    tangent_operator = elastic
  [../]
  [./creep]
    type = PowerLawCreepStressUpdate
    coefficient = 3.0e-24
    n_exponent = 4
    m_exponent = 0
    activation_energy = 0
  [../]
  [./plas]
    type = IsotropicPlasticityStressUpdate
    hardening_constant = 1
    yield_stress = 1e30
  [../]
[]

[Executioner]
  type = Transient

  solve_type = &#x27;PJFNK&#x27;

  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27; lu       superlu_dist&#x27;

  line_search = &#x27;none&#x27;

  l_max_its = 100
  nl_max_its = 100
  nl_rel_tol = 1e-10
  nl_abs_tol = 1e-7
  l_tol = 1e-6
  start_time = 0.0
  end_time = 32400
  dt = 1e-2
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Postprocessors]
  [./timestep]
    type = TimestepSize
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="90fbf520-cb27-4559-8ece-07f2ab35f4cc"><div class="modal-content"><h4>test/tests/multiapps/sub_cycling_failure/master_gold.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Functions]
  # These mimic the behavior of the failing solve
  [./dts]
    type = PiecewiseLinear
    x = &#x27;0    0.1   0.15&#x27;
    y = &#x27;0.1  0.05  0.1&#x27;
  [../]
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./td]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 4
  dt = 0.1

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]

  solve_type = &#x27;PJFNK&#x27;

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true
[]

[MultiApps]
  [./sub]
    type = TransientMultiApp
    app_type = MooseTestApp
    execute_on = timestep_end
    positions = &#x27;0 0 0&#x27;
    input_files = sub_gold.i
    sub_cycling = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9ac64a26-ed27-4646-9d2f-59c50c1df851"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh07.i</h4><pre class="moose-pre"><code class="language-text"># Comparison with analytical solution for cylindrically-symmetric situation
[Mesh]
  type = FileMesh
  file = bh07_input.e
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1000 10000&#x27;
    x = &#x27;100 1000&#x27;
  [../]
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./fflux]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
    gravity = &#x27;0 0 0&#x27;
  [../]
[]

[BCs]
  [./fix_outer]
    type = DirichletBC
    boundary = perimeter
    variable = pp
    value = 1E7
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-11 0 0 0 1E-11 0 0 0 1E-11&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityFLAC
    m = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    variable = pp
    SumQuantityUO = borehole_total_outflow_mass
    point_file = bh07.bh
    fluid_phase = 0
    bottom_p_or_t = 0
    unit_weight = &#x27;0 0 0&#x27;
    use_mobility = true
    re_constant = 0.1594  # use Chen and Zhang version
    character = 2 # double the strength because bh07.bh only fills half the mesh
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./fluid_mass]
    type = PorousFlowFluidMass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[VectorPostprocessors]
  [./pp]
    type = LineValueSampler
    variable = pp
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;300 0 0&#x27;
    sort_by = x
    num_points = 300
    execute_on = timestep_end
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1E3
  solve_type = NEWTON
  [./TimeStepper]
    # get only marginally better results for smaller time steps
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bh07
  [./along_line]
    type = CSV
    execute_on = final
  [../]
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a9532ead-4620-4714-aae3-e09e8087cec4"><div class="modal-content"><h4>test/tests/multiapps/picard/function_dt_sub.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 1
  xmin = 0
  xmax = 1
  nx = 10
[]

[Functions]
  [./u_fn]
    type = ParsedFunction
    value = t*x
  [../]
  [./ffn]
    type = ParsedFunction
    value = x
  [../]

  [./dts]
    type = PiecewiseLinear
    x = &#x27;0.1  10&#x27;
    y = &#x27;0.1  10&#x27;
  [../]
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./td]
    type = TimeDerivative
    variable = u
  [../]
  [./fn]
    type = BodyForce
    variable = u
    function = ffn
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = FunctionDirichletBC
    variable = u
    boundary = right
    function = u_fn
  [../]
[]

[Executioner]
  type = Transient
  dt = 0.1
  solve_type = &#x27;PJFNK&#x27;

  nl_abs_tol = 1e-10
  start_time = 0
  num_steps = 3
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ee3da686-5013-4a3e-b4f9-e319dbc9fa42"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh04.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated
# production
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 1
  nz = 1
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  zmin = -1
  zmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1 1E1 1E2 1E3&#x27;
    x = &#x27;0 1E-1 1 1E1 1E2 1E3&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = -1E6
    point_file = bh02.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    character = 1
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
  [../]

  [./fluid_mass0]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_begin
  [../]

  [./fluid_mass1]
    type = RichardsMass
    variable = pressure
    execute_on = timestep_end
  [../]

  [./zmass_error]
    type = FunctionValuePostprocessor
    function = mass_bal_fcn
    execute_on = timestep_end
  [../]

  [./p0]
    type = PointValue
    variable = pressure
    point = &#x27;1 1 1&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 0
  [../]

  [./mass_bal_fcn]
    type = ParsedFunction
    value = abs((a-c+d)/2/(a+c))
    vars = &#x27;a c d&#x27;
    vals = &#x27;fluid_mass1 fluid_mass0 bh_report&#x27;
  [../]

[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 0
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-12 0 0  0 1E-12 0  0 0 1E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    sat_UO = Saturation
    seff_UO = Seff1VG
    SUPG_UO = SUPGstandard
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1E3
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = bh04
  exodus = false
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3e5ef2e6-881c-4f18-bed1-9bd6c7aa0cf8"><div class="modal-content"><h4>modules/richards/test/tests/buckley_leverett/bl22.i</h4><pre class="moose-pre"><code class="language-text"># two-phase version
# super-sharp front version
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 150
  xmin = 0
  xmax = 15
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-4 1E-3 1E-2 2E-2 5E-2 6E-2 0.1 0.2&#x27;
    x =  &#x27;0    1E-2 1E-1 1    5    20   40  41&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E6
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1E-4
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1E-4
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
  [./bounds_dummy]
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
  [./richardsppenalty]
    type = RichardsPPenalty
    variable = pgas
    a = 1E-18
    lower_var = pwater
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
  [../]
[]

[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_water
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_gas
  [../]
[]

[BCs]
  [./left_w]
    type = DirichletBC
    variable = pwater
    boundary = left
    value = 1E6
  [../]
  [./left_g]
    type = DirichletBC
    variable = pgas
    boundary = left
    value = 1E6
  [../]
  [./right_w]
    type = DirichletBC
    variable = pwater
    boundary = right
    value = -100000
  [../]
  [./right_g]
    type = DirichletBC
    variable = pgas
    boundary = right
    value = 0
  [../]
[]


[Functions]
  [./initial_water]
    type = ParsedFunction
    value = 1000000*(1-min(x/5,1))-100000*(max(x-5,0)/max(abs(x-5),1E-10))
  [../]
  [./initial_gas]
    type = ParsedFunction
    value = max(1000000*(1-x/5),0)+1000
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.15
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 1E-6&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]

  [./standard]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 20 1E-20 1E-20&#x27;
  [../]

[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 50

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = bl22
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
  [./exodus]
    type = Exodus
    interval = 100000
    hide = pgas
    execute_on = &#x27;initial final timestep_end&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2f52c779-da0c-4c4d-ad2f-ec6455194a9b"><div class="modal-content"><h4>modules/richards/test/tests/dirac/bh_fu_07.i</h4><pre class="moose-pre"><code class="language-text">#fullyupwind
[Mesh]
  type = FileMesh
  file = bh07_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = DensityConstBulk
  relperm_UO = RelPermPower
  sat_UO = Saturation
  seff_UO = Seff1VG
  SUPG_UO = SUPGstandard
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1000 10000&#x27;
    x = &#x27;100 1000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./Seff1VG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0
    sum_s_res = 0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1E8
  [../]

  [./borehole_total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]


[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./p_ic]
    type = FunctionIC
    variable = pressure
    function = initial_pressure
  [../]
[]

[BCs]
  [./fix_outer]
    type = DirichletBC
    boundary = perimeter
    variable = pressure
    value = 1E7
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFullyUpwindFlux
    variable = pressure
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsBorehole
    bottom_pressure = 0
    point_file = bh07.bh
    SumQuantityUO = borehole_total_outflow_mass
    variable = pressure
    unit_weight = &#x27;0 0 0&#x27;
    re_constant = 0.1594
    character = 2
    fully_upwind = true
  [../]
[]


[Postprocessors]
  [./bh_report]
    type = RichardsPlotQuantity
    uo = borehole_total_outflow_mass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]

  [./fluid_mass]
    type = RichardsMass
    variable = pressure
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E7
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    viscosity = 1E-3
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-11 0 0  0 1E-11 0  0 0 1E-11&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = Seff1VG
    pressure_vars = pressure
  [../]
[]


[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 1000
  solve_type = NEWTON

  [./TimeStepper]
    # get only marginally better results for smaller time steps
    type = FunctionDT
    function = dts
  [../]

[]

[Outputs]
  file_base = bh_fu_07
  execute_on = &#x27;initial timestep_end final&#x27;
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="808086ea-8a68-49d2-9463-b29fa89b4042"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rd01.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 120
  ny = 1
  xmin = 0
  xmax = 6
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1 10 500 5000 5000&#x27;
    x = &#x27;0 10 100 1000 10000 100000&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.336
    alpha = 1.43e-4
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      viscosity = 1.01e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityVG
    m = 0.336
    seff_turnover = 0.99
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.33
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.295E-12 0 0  0 0.295E-12 0  0 0 0.295E-12&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = -72620.4
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-10 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./base]
    type = PorousFlowSink
    boundary = right
    flux_function = -2.315E-3
    variable = pressure
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;6 0 0&#x27;
    sort_by = x
    num_points = 121
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 359424

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rd01
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
  [./along_line]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="eabf539d-9614-4fbb-9d55-b047c2716a73"><div class="modal-content"><h4>modules/porous_flow/test/tests/buckley_leverett/bl01.i</h4><pre class="moose-pre"><code class="language-text"># Buckley-Leverett 1-phase.
# The front starts at (around) x=5, and at t=50 it should
# have moved to x=9.6.  The version below has a nonzero
# suction function, and at t=50, the front sits between
# (about) x=9.6 and x=9.9.  Changing the van-Genuchten
# al parameter to 1E-4 softens the front so it sits between
# (about) x=9.7 and x=10.4, and the simulation runs much faster.
# With al=1E-2 and nx=600, the front sits between x=9.6 and x=9.8,
# but takes about 100 times longer to run.

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 150
  xmin = 0
  xmax = 15
[]

[GlobalParams]
  PorousFlowDictator = dictator
  compute_enthalpy = false
  compute_internal_energy = false
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = FunctionIC
      function = &#x27;max((1000000-x/5*1000000)-20000,-20000)&#x27;
    [../]
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
    gravity = &#x27;0 0 0&#x27;
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = pp
    boundary = left
    value = 980000
  [../]
[]

[AuxVariables]
  [./sat]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./sat]
    type = MaterialStdVectorAux
    variable = sat
    execute_on = timestep_end
    index = 0
    property = PorousFlow_saturation_qp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e6
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.15
  [../]
[]

[Preconditioning]
  active = andy
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres bjacobi 1E-10 1E-10 20&#x27;
  [../]
[]

[Functions]
  [./timestepper]
    type = PiecewiseLinear
    x = &#x27;0    0.01 0.1 1   1.5 2   20  30  40  50&#x27;
    y = &#x27;0.01 0.1  0.2 0.3 0.1 0.3 0.3 0.4 0.4 0.5&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 50
  [./TimeStepper]
    type = FunctionDT
    function = timestepper
  [../]
[]

[VectorPostprocessors]
  [./pp]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;15 0 0&#x27;
    num_points = 150
    sort_by = x
    variable = pp
  [../]
  [./sat]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;15 0 0&#x27;
    num_points = 150
    sort_by = x
    variable = sat
  [../]
[]


[Outputs]
  file_base = bl01
  [./csv]
    type = CSV
    sync_only = true
    sync_times = &#x27;0.01 50&#x27;
  [../]
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4e5cc737-e43e-48d1-b9e7-5ad53d1e49fb"><div class="modal-content"><h4>modules/richards/test/tests/recharge_discharge/rd02.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 120
  ny = 1
  xmin = 0
  xmax = 6
  ymin = 0
  ymax = 0.05
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1 10 500 5000 50000&#x27;
    x = &#x27;0 10 100 1000 10000 500000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1E3
    bulk_mod = 2E7
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.336
    al = 1.43E-4
  [../]
  [./RelPermPower]
    type = RichardsRelPermVG1
    scut = 0.99
    simm = 0.0
    m = 0.336
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E+0
  [../]
[]



[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.0
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]


[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffVG
    pressure_vars = pressure
  [../]
[]




[BCs]
  active = &#x27;fix_bot&#x27;
  [./fix_bot]
    type = DirichletBC
    variable = pressure
    boundary = &#x27;left&#x27;
    value = 0.0
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.33
    mat_permeability = &#x27;0.295E-12 0 0  0 0.295E-12 0  0 0 0.295E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1.01E-3
    gravity = &#x27;-10 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;

    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-15 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 345600

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = rd02
  interval = 100000
  execute_on = &#x27;initial final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6fb67f8e-dd81-46a5-b245-e1654df24bc9"><div class="modal-content"><h4>test/tests/auxkernels/time_integration/time_integration.i</h4><pre class="moose-pre"><code class="language-text"># This test covers the usage of the VariableTimeIntegrationAux
# kernel. Here we test three different schemes for integrating a field
# variable in time.  Midpoint, Trapezoidal, and Simpson&#x27;s rule are
# used.  For this test, we use a manufactured solution and we compare
# the Trapezoidal and Simpson&#x27;s rule, which must be exact for this
# exact solution, which is a linear function of time.
#
# The set up problem is
#
#  du/dt - Laplacian(u) = Q
#
# with exact solution: u = t*(x*x+y*y).
[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD9
  xmin = 0
  xmax = 1
  ymin = 0
  ymax = 1
  nx = 10
  ny = 10
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    x = &#x27;0.01 0.1&#x27;
    y = &#x27;0.005 0.05&#x27;
  [../]
[]

[Variables]
  [./u]
    initial_condition = 0.0
    family = LAGRANGE
    order = SECOND
  [../]
[]

[Kernels]
  active = &#x27;diff timederivative sourceterm&#x27;
  [./diff]
     type = Diffusion
     variable = u
  [../]
  [./timederivative]
     type = TimeDerivative
     variable = u
  [../]
  [./sourceterm]
     type = BodyForce
     variable = u
     function = Source
  [../]
[]

[AuxVariables]
  active = &#x27;v_midpoint v_trapazoid v_simpson&#x27;
  [./v_midpoint]
  [../]
  [./v_trapazoid]
  [../]
  [./v_simpson]
  [../]
[]

[AuxKernels]
  [./MidpointTimeIntegrator]
    type = VariableTimeIntegrationAux
    variable_to_integrate = u
    variable = v_midpoint
    order = 1
  [../]
  [./TrapazoidalTimeIntegrator]
    type = VariableTimeIntegrationAux
    variable_to_integrate = u
    variable = v_trapazoid
    order = 2
  [../]
  [./SimpsonsTimeIntegrator]
    type = VariableTimeIntegrationAux
    variable_to_integrate = u
    variable = v_simpson
    order = 3
  [../]
[]

[BCs]
  active = &#x27;RightBC LeftBC TopBC BottomBC&#x27;
 [./RightBC]
    type = FunctionDirichletBC
    variable = u
    function = RightBC
    boundary = &#x27;right&#x27;
 [../]
 [./LeftBC]
    type = FunctionDirichletBC
    variable = u
    function = LeftBC
    boundary = &#x27;left&#x27;
 [../]
 [./TopBC]
    type = FunctionDirichletBC
    variable = u
    function = TopBC
    boundary = &#x27;top&#x27;
 [../]
 [./BottomBC]
    type = FunctionDirichletBC
    variable = u
    function = BottomBC
    boundary = &#x27;bottom&#x27;
 [../]
[]

[Functions]
  active = &#x27;Soln Source TopBC BottomBC RightBC LeftBC&#x27;
 [./Soln]
    type = ParsedFunction
    value = &#x27;t*(x*x+y*y)&#x27;
 [../]
 [./Source]
    type = ParsedFunction
    value = &#x27;(x*x + y*y) - 4*t&#x27;
 [../]
 [./TopBC]
    type = ParsedFunction
    value = &#x27;t*(x*x+1)&#x27;
 [../]
 [./BottomBC]
    type = ParsedFunction
    value = &#x27;t*x*x&#x27;
 [../]
 [./RightBC]
   type = ParsedFunction
   value = &#x27;t*(y*y+1)&#x27;
 [../]
 [./LeftBC]
    type = ParsedFunction
    value = &#x27;t*y*y&#x27;
  [../]
[]
[Postprocessors]
  [./l2_error]
    type = NodalL2Error
    variable = u
    function = Soln
  [../]
[]

[Executioner]
  type = Transient

  end_time = 0.1
#  dt = 0.1
#  num_steps = 10
  [./TimeStepper]
     type = FunctionDT
     function = dts
  [../]

  nl_abs_tol = 1.e-15
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7c059551-253a-4d85-8bdd-b706ca724dcd"><div class="modal-content"><h4>modules/richards/test/tests/rogers_stallybrass_clements/rsc_fu_01.i</h4><pre class="moose-pre"><code class="language-text"># RSC test with high-res time and spatial resolution
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 600
  ny = 1
  xmin = 0
  xmax = 10 # x is the depth variable, called zeta in RSC
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityOil&#x27;
  relperm_UO = &#x27;RelPerm RelPerm&#x27;
  SUPG_UO = &#x27;SUPGstandard SUPGstandard&#x27;
  sat_UO = &#x27;Saturation Saturation&#x27;
  seff_UO = &#x27;SeffWater SeffOil&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;3E-3 3E-2 0.05&#x27;
    x = &#x27;0 1 5&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater poil&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 10
    bulk_mod = 2E9
  [../]
  [./DensityOil]
    type = RichardsDensityConstBulk
    dens0 = 20
    bulk_mod = 2E9
  [../]
  [./SeffWater]
    type = RichardsSeff2waterRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./SeffOil]
    type = RichardsSeff2gasRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
  [./RelPerm]
    type = RichardsRelPermMonomial
    simm = 0
    n = 1
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E-2
  [../]
[]


[Variables]
  [./pwater]
  [../]
  [./poil]
  [../]
[]

[ICs]
  [./water_init]
    type = ConstantIC
    variable = pwater
    value = 0
  [../]
  [./oil_init]
    type = ConstantIC
    variable = poil
    value = 15
  [../]
[]

[Kernels]
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFullyUpwindFlux
    variable = pwater
  [../]
  [./richardstoil]
    type = RichardsMassChange
    variable = poil
  [../]
  [./richardsfoil]
    type = RichardsFullyUpwindFlux
    variable = poil
  [../]
[]


[AuxVariables]
  [./SWater]
  [../]
  [./SOil]
  [../]
[]


[AuxKernels]
  [./Seff1VGwater_AuxK]
    type = RichardsSeffAux
    variable = SWater
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
  [./Seff1VGoil_AuxK]
    type = RichardsSeffAux
    variable = SOil
    seff_UO = SeffOil
    pressure_vars = &#x27;pwater poil&#x27;
  [../]
[]


[BCs]
# we are pumping water into a system that has virtually incompressible fluids, hence the pressures rise enormously.  this adversely affects convergence because of almost-overflows and precision-loss problems.  The fixed things help keep pressures low and so prevent these awful behaviours.   the movement of the saturation front is the same regardless of the fixed things.
  active = &#x27;recharge fixedoil fixedwater&#x27;
  [./recharge]
    type = RichardsPiecewiseLinearSink
    variable = pwater
    boundary = &#x27;left&#x27;
    pressures = &#x27;-1E10 1E10&#x27;
    bare_fluxes = &#x27;-1 -1&#x27;
    use_mobility = false
    use_relperm = false
  [../]
  [./fixedwater]
    type = DirichletBC
    variable = pwater
    boundary = &#x27;right&#x27;
    value = 0
  [../]
  [./fixedoil]
    type = DirichletBC
    variable = poil
    boundary = &#x27;right&#x27;
    value = 15
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.25
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    viscosity = &#x27;1E-3 2E-3&#x27;
    gravity = &#x27;0E-0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]

[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]


[Outputs]
  file_base = rsc_fu_01
  interval = 100000
  execute_on = &#x27;initial timestep_end final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="fcc259ec-df29-4ed7-b19c-cd9f90bca0d6"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step08_postprocessors/problems/step8.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 30
  ny = 3
  xmax = 0.304 # Length of test chamber
  ymax = 0.0257 # Test chamber radius
  uniform_refine = 2
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = right
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = left
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = right
  []
[]

[Materials]
  [column]
    type = PackedColumn
    radius = 1
    temperature = temperature
    porosity = &#x27;0.25952 + 0.7*y/0.0257&#x27;
  []
[]

[Postprocessors]
  [average_temperature]
    type = ElementAverageValue
    variable = temperature
  []
  [outlet_heat_flux]
    type = ADSideFluxIntegral
    variable = temperature
    boundary = right
    diffusivity = thermal_conductivity
  []
[]

[VectorPostprocessors]
  [temperature_sample]
    type = LineValueSampler
    num_points = 500
    start_point = &#x27;0.1 0      0&#x27;
    end_point =   &#x27;0.1 0.0257 0&#x27;
    variable = temperature
    sort_by = y
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = X
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  automatic_scaling = true

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  end_time = 100
  dt = 0.25
  start_time = -1

  steady_state_tolerance = 1e-5
  steady_state_detection = true

  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]

[Outputs]
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e74b3bca-f7f5-4046-a77e-a1298f2b5cf5"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_2/gh17.i</h4><pre class="moose-pre"><code class="language-text"># unsaturated = false
# gravity = true
# supg = true
# transient = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmin = 0
  xmax = 1
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1E-1 1E0 1E1 1E3 1E4 1E5 1E6 1E7&#x27;
    x = &#x27;0 1E-1 1E0 1E1 1E2 1E3 1E4 1E5 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E2
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 0.5
    bulk_mod = 0.5E2
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.15
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.05
    sum_s_res = 0.15
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 0.1
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 0.01
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./water_ic]
    type = ConstantIC
    value = 1
    variable = pwater
  [../]
  [./gas_ic]
    type = ConstantIC
    value = 1
    variable = pgas
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]


[AuxVariables]
  [./seffgas]
  [../]
  [./seffwater]
  [../]
[]

[AuxKernels]
  [./seffgas_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffGas
    variable = seffgas
  [../]
  [./seffwater_kernel]
    type = RichardsSeffAux
    pressure_vars = &#x27;pwater pgas&#x27;
    seff_UO = SeffWater
    variable = seffwater
  [../]
[]

[Postprocessors]
  [./mwater_init]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mgas_init]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_begin
    outputs = none
  [../]
  [./mwater_fin]
    type = RichardsMass
    variable = pwater
    execute_on = timestep_end
    outputs = none
  [../]
  [./mgas_fin]
    type = RichardsMass
    variable = pgas
    execute_on = timestep_end
    outputs = none
  [../]

  [./mass_error_water]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_w
  [../]
  [./mass_error_gas]
    type = FunctionValuePostprocessor
    function = fcn_mass_error_g
  [../]

  [./pw_left]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./pw_right]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = pwater
    outputs = none
  [../]
  [./error_water]
    type = FunctionValuePostprocessor
    function = fcn_error_water
  [../]
[]

[Functions]
  [./fcn_mass_error_w]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mwater_init mwater_fin&#x27;
  [../]
  [./fcn_mass_error_g]
    type = ParsedFunction
    value = &#x27;abs(0.5*(mi-mf)/(mi+mf))&#x27;
    vars = &#x27;mi mf&#x27;
    vals = &#x27;mgas_init mgas_fin&#x27;
  [../]
  [./fcn_error_water]
    type = ParsedFunction
    value = &#x27;abs((-b*log(-(gdens0*xval+(-b*exp(-p0/b)))/b)-p1)/p1)&#x27;
    vars = &#x27;b gdens0 p0 xval p1&#x27;
    vals = &#x27;1E2 -1 pw_left 1 pw_right&#x27;
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 0.5E-3&#x27;
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-15 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 1E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = gh17
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="19325e12-6a2a-4db4-adf3-9c508b6fcc8e"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step11_action/problems/step11.i</h4><pre class="moose-pre"><code class="language-text">[GlobalParams]
  displacements = &#x27;disp_r disp_z&#x27;
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  ny = 200
  nx = 10
  ymax = 0.304 # Length of test chamber
  xmax = 0.0257 # Test chamber radius
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[DarcyThermoMech]
[]

[Modules/TensorMechanics/Master]
  [all]
    # This block adds all of the proper Kernels, strain calculators, and Variables
    # for TensorMechanics in the correct coordinate system (autodetected)
    add_variables = true
    strain = FINITE
    eigenstrain_names = eigenstrain
    use_automatic_differentiation = true
    generate_output = &#x27;vonmises_stress elastic_strain_xx elastic_strain_yy strain_xx strain_yy&#x27;
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = bottom
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = top
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = bottom
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = top
  []
  [hold_inlet]
    type = DirichletBC
    variable = disp_z
    boundary = bottom
    value = 0
  []
  [hold_center]
    type = DirichletBC
    variable = disp_r
    boundary = left
    value = 0
  []
  [hold_outside]
    type = DirichletBC
    variable = disp_r
    boundary = right
    value = 0
  []
[]

[Materials]
  viscosity_file = data/water_viscosity.csv
  density_file = data/water_density.csv
  thermal_conductivity_file = data/water_thermal_conductivity.csv
  specific_heat_file = data/water_specific_heat.csv
  thermal_expansion_file = data/water_thermal_expansion.csv

  [column]
    type = PackedColumn
    block = 0
    temperature = temperature
    radius = 1.15
    fluid_viscosity_file = ${viscosity_file}
    fluid_density_file = ${density_file}
    fluid_thermal_conductivity_file = ${thermal_conductivity_file}
    fluid_specific_heat_file = ${specific_heat_file}
    fluid_thermal_expansion_file = ${thermal_expansion_file}
  []

  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 200e9 # (Pa) from wikipedia
    poissons_ratio = .3 # from wikipedia

  []
  [elastic_stress]
    type = ADComputeFiniteStrainElasticStress
  []
  [thermal_strain]
    type = ADComputeThermalExpansionEigenstrain
    stress_free_temperature = 300
    eigenstrain_name = eigenstrain
    temperature = temperature
    thermal_expansion_coeff = 1e-5
  []
[]

[Postprocessors]
  [average_temperature]
    type = ElementAverageValue
    variable = temperature
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
[]

[Executioner]
  type = Transient
  start_time = -1
  end_time = 200
  steady_state_tolerance = 1e-7
  steady_state_detection = true
  dt = 0.25
  solve_type = PJFNK
  automatic_scaling = true
  compute_scaling_once = false
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;hypre boomeramg 500&#x27;
  line_search = none
  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]

[Outputs]
  [out]
    type = Exodus
    elemental_as_nodal = true
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="820a7cf1-9246-4ca8-bfbd-991c9135c719"><div class="modal-content"><h4>modules/geochemistry/test/tests/kinetics/quartz_dissolution.i</h4><pre class="moose-pre"><code class="language-text"># Example of quartz dissolution.
[TimeDependentReactionSolver]
  model_definition = definition
  geochemistry_reactor_name = reactor
  charge_balance_species = &quot;Cl-&quot;
  constraint_species = &quot;H2O              H+                 Cl-                SiO2(aq)&quot;
  constraint_value = &quot;  1.0              1E-10              1E-10              1E-9&quot;
  constraint_meaning = &quot;kg_solvent_water moles_bulk_species moles_bulk_species free_molality&quot;
  initial_temperature = 100.0
  temperature = 100.0
  kinetic_species_name = Quartz
  kinetic_species_initial_moles = 83.216414271 # Quartz has 60.0843g/mol
  ramp_max_ionic_strength_initial = 0 # max_ionic_strength in such a simple problem does not need ramping
  stoichiometric_ionic_str_using_Cl_only = true # for comparison with GWB
  execute_console_output_on = &#x27;&#x27; # only CSV output for this example
[]

[UserObjects]
  [./rate_quartz]
    type = GeochemistryKineticRate
    kinetic_species_name = Quartz
    intrinsic_rate_constant = 1.728E-10 # 2.0E-15mol/s/cm^2 = 1.728E-10mol/day/cm^2
    multiply_by_mass = true
    area_quantity = 1000
  [../]
  [./definition]
    type = GeochemicalModelDefinition
    database_file = &quot;../../../database/moose_geochemdb.json&quot;
    basis_species = &quot;H2O SiO2(aq) H+ Cl-&quot;
    kinetic_minerals = &quot;Quartz&quot;
    kinetic_rate_descriptions = &quot;rate_quartz&quot;
    piecewise_linear_interpolation = true # for comparison with GWB
  [../]
[]

[Functions]
  [./timestepper]
    type = PiecewiseLinear
    x = &#x27;0 0.5 3&#x27;
    y = &#x27;0.01 0.05 0.1&#x27;
  [../]
[]

[Executioner]
  type = Transient
  [./TimeStepper]
    type = FunctionDT
    function = timestepper
  [../]
  end_time = 5.0
[]

[AuxVariables]
  [./diss]
  [../]
[]
[AuxKernels]
  [./diss]
    type = ParsedAux
    args = moles_Quartz
    function = &#x27;83.216414271 - moles_Quartz&#x27;
    variable = diss
  [../]
[]
[Postprocessors]
  [./dissolved_moles]
    type = PointValue
    point = &#x27;0 0 0&#x27;
    variable = diss
  [../]
[]
[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9263aabb-d1d0-411b-a0ff-032a97e0f23b"><div class="modal-content"><h4>modules/richards/test/tests/gravity_head_1/gh21.i</h4><pre class="moose-pre"><code class="language-text"># investigating validity of immobile saturation
# 5 elements, with SUPG

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 5
  xmin = -1
  xmax = 1
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 10 100 1000 10000&#x27;
    x = &#x27;0 10 100 1000 10000&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 1.0E3
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.8
    al = 1
  [../]
  [./RelPermPower]
    type = RichardsRelPermPower
    simm = 0.3
    n = 2
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.1
    sum_s_res = 0.1
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E-6
  [../]
[]

[Variables]
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_condition = -1.0
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffVG
    pressure_vars = pressure
  [../]
[]

[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1E-3
    gravity = &#x27;-1 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E0
  end_time = 1E5

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = gh21
  execute_on = &#x27;timestep_end final&#x27;
  interval = 10000
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="28d529ca-64bf-442c-aac0-99c0861e3838"><div class="modal-content"><h4>modules/richards/test/tests/recharge_discharge/rd03.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  file = gold/rd02.e
[]


[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;2E4 1E6&#x27;
    x = &#x27;0 1E6&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = pressure
  [../]
  [./DensityConstBulk]
    type = RichardsDensityConstBulk
    dens0 = 1E3
    bulk_mod = 2E7
  [../]
  [./SeffVG]
    type = RichardsSeff1VG
    m = 0.336
    al = 1.43E-4
  [../]
  [./RelPermPower]
    type = RichardsRelPermVG1
    scut = 0.99
    simm = 0.0
    m = 0.336
  [../]
  [./Saturation]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGstandard]
    type = RichardsSUPGstandard
    p_SUPG = 1.0E+0
  [../]
[]



[Variables]
  active = &#x27;pressure&#x27;
  [./pressure]
    order = FIRST
    family = LAGRANGE
    initial_from_file_timestep = 2
    initial_from_file_var = pressure
  [../]
[]


[Kernels]
  active = &#x27;richardsf richardst&#x27;
  [./richardst]
    type = RichardsMassChange
    variable = pressure
  [../]
  [./richardsf]
    type = RichardsFlux
    variable = pressure
  [../]
[]


[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffVG
    pressure_vars = pressure
  [../]
[]




[BCs]
  active = &#x27;fix_bot&#x27;
  [./fix_bot]
    type = DirichletBC
    variable = pressure
    boundary = &#x27;left&#x27;
    value = 0.0
  [../]
[]


[Materials]
  [./rock]
    type = RichardsMaterial
    block = 0
    mat_porosity = 0.33
    mat_permeability = &#x27;0.295E-12 0 0  0 0.295E-12 0  0 0 0.295E-12&#x27;
    density_UO = DensityConstBulk
    relperm_UO = RelPermPower
    SUPG_UO = SUPGstandard
    sat_UO = Saturation
    seff_UO = SeffVG
    viscosity = 1.01E-3
    gravity = &#x27;-10 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]


[Preconditioning]
  active = &#x27;andy&#x27;

  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;&#x27;

    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-13 1E-15 10000&#x27;
  [../]
[]


[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 8.2944E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rd03
  interval = 100000
  execute_on = &#x27;initial timestep_end final&#x27;
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1a940fd3-0011-49e3-828d-39890aa81389"><div class="modal-content"><h4>modules/richards/test/tests/theis/th21.i</h4><pre class="moose-pre"><code class="language-text"># two-phase, fully-saturated
# production
[Mesh]
  type = FileMesh
  file = th01_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;0.5 1 2 10&#x27;
    x = &#x27;0 1 10 100&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1E-5
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]

  [./total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]


[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_pressure
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsPolyLineSink
    pressures = &#x27;-1E9 1E9&#x27;
    fluxes = &#x27;200 200&#x27;
    point_file = th01.points
    SumQuantityUO = total_outflow_mass
    variable = pwater
  [../]
[]


[Postprocessors]
  [./flow_report]
    type = RichardsPlotQuantity
    uo = total_outflow_mass
  [../]
  [./p50]
    type = PointValue
    variable = pwater
    point = &#x27;50 0 0&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E5
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    density_UO = &#x27;DensityWater DensityGas&#x27;
    relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
    SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
    sat_UO = &#x27;SatWater SatGas&#x27;
    seff_UO = &#x27;SeffWater SeffGas&#x27;
    viscosity = &#x27;1E-3 1E-5&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-6 1E-10 10000 30&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 100
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  file_base = th21
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c81b0407-ece6-4f78-8a28-0ed252a4e0a2"><div class="modal-content"><h4>modules/richards/test/tests/theis/th_lumped_22.i</h4><pre class="moose-pre"><code class="language-text"># two-phase, fully-saturated
# production
# lumped
[Mesh]
  type = FileMesh
  file = th02_input.e
[]

[GlobalParams]
  richardsVarNames_UO = PPNames
  density_UO = &#x27;DensityWater DensityGas&#x27;
  relperm_UO = &#x27;RelPermWater RelPermGas&#x27;
  SUPG_UO = &#x27;SUPGwater SUPGgas&#x27;
  sat_UO = &#x27;SatWater SatGas&#x27;
  seff_UO = &#x27;SeffWater SeffGas&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1 2 4 20&#x27;
    x = &#x27;0 1 10 100&#x27;
  [../]
[]

[UserObjects]
  [./PPNames]
    type = RichardsVarNames
    richards_vars = &#x27;pwater pgas&#x27;
  [../]
  [./DensityWater]
    type = RichardsDensityConstBulk
    dens0 = 1000
    bulk_mod = 2E9
  [../]
  [./DensityGas]
    type = RichardsDensityConstBulk
    dens0 = 1
    bulk_mod = 2E6
  [../]
  [./SeffWater]
    type = RichardsSeff2waterVG
    m = 0.8
    al = 1E-5
  [../]
  [./SeffGas]
    type = RichardsSeff2gasVG
    m = 0.8
    al = 1E-5
  [../]
  [./RelPermWater]
    type = RichardsRelPermPower
    simm = 0.0
    n = 2
  [../]
  [./RelPermGas]
    type = RichardsRelPermPower
    simm = 0.0
    n = 3
  [../]
  [./SatWater]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SatGas]
    type = RichardsSat
    s_res = 0.0
    sum_s_res = 0.0
  [../]
  [./SUPGwater]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]
  [./SUPGgas]
    type = RichardsSUPGstandard
    p_SUPG = 1E-5
  [../]

  [./total_outflow_mass]
    type = RichardsSumQuantity
  [../]
[]

[Variables]
  [./pwater]
    order = FIRST
    family = LAGRANGE
  [../]
  [./pgas]
    order = FIRST
    family = LAGRANGE
  [../]
[]


[ICs]
  [./water_ic]
    type = FunctionIC
    variable = pwater
    function = initial_pressure
  [../]
  [./gas_ic]
    type = FunctionIC
    variable = pgas
    function = initial_pressure
  [../]
[]

[AuxVariables]
  [./Seff1VG_Aux]
  [../]
[]


[Kernels]
  active = &#x27;richardsfwater richardstwater richardsfgas richardstgas&#x27;
  [./richardstwater]
    type = RichardsLumpedMassChange
    variable = pwater
  [../]
  [./richardsfwater]
    type = RichardsFlux
    variable = pwater
  [../]
  [./richardstgas]
    type = RichardsLumpedMassChange
    variable = pgas
  [../]
  [./richardsfgas]
    type = RichardsFlux
    variable = pgas
  [../]
[]

[AuxKernels]
  [./Seff1VG_AuxK]
    type = RichardsSeffAux
    variable = Seff1VG_Aux
    seff_UO = SeffWater
    pressure_vars = &#x27;pwater pgas&#x27;
  [../]
[]

[DiracKernels]
  [./bh]
    type = RichardsPolyLineSink
    pressures = &#x27;-1E9 1E9&#x27;
    fluxes = &#x27;200 200&#x27;
    point_file = th01.points
    SumQuantityUO = total_outflow_mass
    variable = pwater
  [../]
[]


[Postprocessors]
  [./flow_report]
    type = RichardsPlotQuantity
    uo = total_outflow_mass
  [../]
  [./p50]
    type = PointValue
    variable = pwater
    point = &#x27;50 0 0&#x27;
    execute_on = timestep_end
  [../]
[]


[Functions]
  [./initial_pressure]
    type = ParsedFunction
    value = 1E5
  [../]
[]


[Materials]
  [./all]
    type = RichardsMaterial
    block = 1
    mat_porosity = 0.1
    mat_permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
    viscosity = &#x27;1E-3 1E-5&#x27;
    gravity = &#x27;0 0 0&#x27;
    linear_shape_fcns = true
  [../]
[]



[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it -ksp_rtol -ksp_atol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               2E-7 1E-10 20 1E-10 1E-100&#x27;
  [../]
[]


[Executioner]
  type = Transient
  end_time = 100
  solve_type = NEWTON

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]


[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = th_lumped_22
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#61e5c2b0-b1ec-4e1b-a7d7-c0f6745d0925" class="tooltipped" data-position="left" data-tooltip="Description">Description</a></li><li><a href="#f1cd3f54-a71b-49ed-8bf0-9f949114e650" class="tooltipped" data-position="left" data-tooltip="Example Input Syntax">Example Input Syntax</a></li><li><a href="#89f1d626-77e3-481a-8f61-793517c124af" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#1323a91d-2aec-4f66-bcb6-abb0606526f2" class="tooltipped" data-position="left" data-tooltip="Input Files">Input Files</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>