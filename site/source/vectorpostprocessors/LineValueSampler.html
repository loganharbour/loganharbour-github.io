<!DOCTYPE html><head><meta charset="UTF-8"><title>LineValueSampler.md|MOOSE Ray Tracing Module</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="/modules/ray_tracing" class="left moose-logo hide-on-med-and-down">MOOSE Ray Tracing Module</a><a href="https://github.com/idaholab/moose" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="e91b8b19-18fd-4674-b7aa-319fb73cd005"><i class="material-icons">menu</i></a><ul class="sidenav" id="e91b8b19-18fd-4674-b7aa-319fb73cd005"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/modules/ray_tracing" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">vectorpostprocessors</span><a href="#" class="breadcrumb">LineValueSampler</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="dff699f3-213d-4a38-8504-b3fc06b07e90" data-section-level="1" data-section-text="LineValueSampler"><h1 id="linevaluesampler">LineValueSampler</h1><p>Samples variable(s) along a specified line</p><section class="scrollspy" id="fda11b9b-3e2e-4573-b657-a4cd4006947b" data-section-level="2" data-section-text="Description"><h2 id="description">Description</h2><p>LineValueSampler samples the given variables/auxvariables at equally spaced points between the start and end points of a user provided line segment. The sampled points and the values are written to a csv file at every time step. The sorting order of the points can be changed using the <code>sort_by</code> parameter which takes <code>x</code>, <code>y</code>, <code>z</code> or <code>id</code> (increasing distance from start point) as input.</p><p>LineValueSampler could also be used as an UserObject with the <a href="../transfers/MultiAppUserObjectTransfer.html">MultiAppUserObjectTransfer</a> to transfer values to AuxVariables in the master or sub application. When using the LineValueSampler with the MultiAppUserObjectTransfer, an error is generated if more than one variable is supplied as input to the LineValueSampler as the transfer currently works only with one variable. Also, when calculating the value of the UserObject (LineValueSampler in this case) at a given point, the point is first projected onto the user defined line segment and the interpolated value at the projected point is returned as output. If the projected point falls outside the line segment, infinity is returned as output.</p><p>If the variable to be plotted needs to be scaled, this can be done by supplying a postprocessor. Caution should be used to make sure that the postprocessor is being evaluated in such a way that its value will not be lagged when being called by LineValueSampler.</p></section><section class="scrollspy" id="21872134-8d96-460d-9d21-2eed926b031e" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="6419206d-44bc-43f7-8736-4651bdd7390b" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">end_point</span><span class="moose-parameter-header-description">The ending of the line</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>libMesh::Point</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The ending of the line</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">num_points</span><span class="moose-parameter-header-description">The number of points to sample along the line</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The number of points to sample along the line</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">sort_by</span><span class="moose-parameter-header-description">What to sort the samples by</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>x y z id</p><p class="moose-parameter-description"><span>Description:</span>What to sort the samples by</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">start_point</span><span class="moose-parameter-header-description">The beginning of the line</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>libMesh::Point</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The beginning of the line</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">variable</span><span class="moose-parameter-header-description">The names of the variables that this VectorPostprocessor operates on</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<VariableName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The names of the variables that this VectorPostprocessor operates on</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="97f8af1d-e2a7-4354-b0c1-8bf9495365ec" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">_auto_broadcast</span><span class="moose-parameter-header-default">False</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"></p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">contains_complete_history</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Set this flag to indicate that the values in all vectors declared by this VPP represent a time history (e.g. with each invocation, new values are added and old values are never removed). This changes the output so that only a single file is output and updated with each invocation</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set this flag to indicate that the values in all vectors declared by this VPP represent a time history (e.g. with each invocation, new values are added and old values are never removed). This changes the output so that only a single file is output and updated with each invocation</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">execute_on</span><span class="moose-parameter-header-default">TIMESTEP_END</span><span class="moose-parameter-header-description">The list of flag(s) indicating when this object should be executed, the available options include NONE, INITIAL, LINEAR, NONLINEAR, TIMESTEP_END, TIMESTEP_BEGIN, FINAL, CUSTOM.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>TIMESTEP_END</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>ExecFlagEnum</p><p class="moose-parameter-description-options"><span>Options:</span>NONE INITIAL LINEAR NONLINEAR TIMESTEP_END TIMESTEP_BEGIN FINAL CUSTOM</p><p class="moose-parameter-description"><span>Description:</span>The list of flag(s) indicating when this object should be executed, the available options include NONE, INITIAL, LINEAR, NONLINEAR, TIMESTEP_END, TIMESTEP_BEGIN, FINAL, CUSTOM.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">parallel_type</span><span class="moose-parameter-header-default">REPLICATED</span><span class="moose-parameter-header-description">Set how the data is represented within the VectorPostprocessor (VPP); 'distributed' indicates that data within the VPP is distributed and no auto communication is preformed, this setting will result in parallel output within the CSV output; 'replicated' indicates that the data within the VPP is correct on processor 0, the data will automatically be broadcast to all processors unless the '_auto_broadcast' param is set to false within the validParams function.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>REPLICATED</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>DISTRIBUTED REPLICATED</p><p class="moose-parameter-description"><span>Description:</span>Set how the data is represented within the VectorPostprocessor (VPP); 'distributed' indicates that data within the VPP is distributed and no auto communication is preformed, this setting will result in parallel output within the CSV output; 'replicated' indicates that the data within the VPP is correct on processor 0, the data will automatically be broadcast to all processors unless the '_auto_broadcast' param is set to false within the validParams function.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">scaling</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">The postprocessor that the variables are multiplied with</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>PostprocessorName</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The postprocessor that the variables are multiplied with</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="4d9e354c-f443-4c72-94b1-7b08dfbf7021" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">allow_duplicate_execution_on_initial</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">In the case where this UserObject is depended upon by an initial condition, allow it to be executed twice during the initial setup (once before the IC and again after mesh adaptivity (if applicable).</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>In the case where this UserObject is depended upon by an initial condition, allow it to be executed twice during the initial setup (once before the IC and again after mesh adaptivity (if applicable).</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<std::string></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">force_preaux</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Forces the GeneralUserObject to be executed in PREAUX</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Forces the GeneralUserObject to be executed in PREAUX</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">force_preic</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Forces the GeneralUserObject to be executed in PREIC during initial setup</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Forces the GeneralUserObject to be executed in PREIC during initial setup</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">outputs</span><span class="moose-parameter-header-description">Vector of output names were you would like to restrict the output of variables(s) associated with this object</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<OutputName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Vector of output names were you would like to restrict the output of variables(s) associated with this object</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_displaced_mesh</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section></section><section class="scrollspy" id="f6c6309e-bfea-480b-b9fa-1a751b523d83" data-section-level="2" data-section-text="Input Files"><h2 id="input-files">Input Files</h2><ul class="moose-list-inputs browser-default"><li><a href="#8e172b68-cdf6-4c7b-ba06-839aa8ac1a1c" class="modal-trigger">modules/porous_flow/test/tests/heat_advection/heat_advection_1d.i</a></li><li><a href="#4c59cd5d-bae1-4371-92e9-e4f76963d03b" class="modal-trigger">modules/tensor_mechanics/test/tests/eigenstrain/reducedOrderRZQuadratic.i</a></li><li><a href="#9c362c59-7dcb-424c-8575-328ff5bdef3e" class="modal-trigger">modules/combined/test/tests/beam_eigenstrain_transfer/subapp1_uo_transfer.i</a></li><li><a href="#1acf9140-fb8a-4c18-a11c-6011c4522280" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/bw02.i</a></li><li><a href="#7a786513-3695-4e60-9bbf-f04a4f0a0aa0" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_2D.i</a></li><li><a href="#c697140d-6849-47cd-8535-11e933751127" class="modal-trigger">test/tests/outputs/csv_final_and_latest/final.i</a></li><li><a href="#93d44032-32b5-4ede-9a9e-716d34dcef55" class="modal-trigger">modules/tensor_mechanics/test/tests/static_deformations/cosserat_glide_fake_plastic.i</a></li><li><a href="#185213eb-c4ff-49c7-b027-bf8fead4d027" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/theis_rz.i</a></li><li><a href="#59f7de6f-53f4-4ae7-9044-b972b88e96fa" class="modal-trigger">test/tests/vectorpostprocessors/time_data/time_data.i</a></li><li><a href="#40b105d7-bb56-4b66-bc94-50287242ce83" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rsc01.i</a></li><li><a href="#6647781e-f108-4625-a9ff-125ce4dc9736" class="modal-trigger">modules/phase_field/examples/kim-kim-suzuki/kks_example_noflux.i</a></li><li><a href="#a2b6213a-2878-471a-8212-d54bd4b906a6" class="modal-trigger">test/tests/vectorpostprocessors/least_squares_fit/least_squares_fit.i</a></li><li><a href="#e7ee590e-6386-4a1d-9909-23a64e001708" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_2D_blocks.i</a></li><li><a href="#a706f7fe-1ac0-4de2-bd39-dc927b601597" class="modal-trigger">modules/porous_flow/examples/flow_through_fractured_media/fine_thick_fracture_transient.i</a></li><li><a href="#bd4371cd-6d8a-44fb-baf4-01daf859e44d" class="modal-trigger">modules/phase_field/test/tests/misc/equal_gradient_lagrange.i</a></li><li><a href="#ae78ed6b-5c52-452d-827f-cd4dccdba0a5" class="modal-trigger">modules/porous_flow/test/tests/pressure_pulse/pressure_pulse_1d_2phasePS_KT.i</a></li><li><a href="#f7a78099-c6f3-46c0-b322-169779444811" class="modal-trigger">modules/porous_flow/test/tests/capillary_pressure/vangenuchten1.i</a></li><li><a href="#a18b7e1a-7516-4cb5-8261-d3299f777bf4" class="modal-trigger">modules/porous_flow/test/tests/buckley_leverett/bl01.i</a></li><li><a href="#4e683781-f278-41f3-9cf6-b564335597aa" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/wli02.i</a></li><li><a href="#61154197-27c8-481c-8b64-55d00fb4af9d" class="modal-trigger">modules/porous_flow/test/tests/numerical_diffusion/pffltvd.i</a></li><li><a href="#8cf232ef-e41a-498b-b878-c174ffc3c163" class="modal-trigger">modules/combined/examples/publications/rapid_dev/fig7b.i</a></li><li><a href="#f88ffcf3-a038-44e5-97c4-289fb054454d" class="modal-trigger">modules/porous_flow/test/tests/numerical_diffusion/fltvd_no_antidiffusion.i</a></li><li><a href="#f9d0f2ff-6e50-471e-ae6d-9a038ddbae21" class="modal-trigger">modules/porous_flow/test/tests/thm_rehbinder/fixed_outer.i</a></li><li><a href="#a8684886-8d09-4004-ac0a-4a5d816c3f57" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rsc02.i</a></li><li><a href="#494e1a95-b338-45f8-b021-3566a1fa128d" class="modal-trigger">modules/porous_flow/examples/flow_through_fractured_media/coarse.i</a></li><li><a href="#d03da413-974c-4808-8e4e-da086b76f7c9" class="modal-trigger">modules/porous_flow/test/tests/capillary_pressure/vangenuchten3.i</a></li><li><a href="#eca73e22-fad1-4d49-b64e-db2f1c5eef22" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rd02.i</a></li><li><a href="#a8221984-1183-47a8-80d0-feee0f36e74f" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_1D_adaptivity.i</a></li><li><a href="#9135d7de-7539-4d99-92a0-92a0332ccc9b" class="modal-trigger">modules/porous_flow/test/tests/relperm/corey1.i</a></li><li><a href="#af9e8f03-581a-4d25-ba70-cad208513ffa" class="modal-trigger">modules/porous_flow/test/tests/numerical_diffusion/fully_saturated_action.i</a></li><li><a href="#72e700ae-d350-4adb-bd2d-014fef31cfc2" class="modal-trigger">modules/level_set/test/tests/kernels/advection/advection_mms.i</a></li><li><a href="#b7c2ab76-25c2-4f17-b31d-ad8d48cd7d70" class="modal-trigger">modules/porous_flow/examples/thm_example/2D.i</a></li><li><a href="#ee5ea807-b2e0-425a-86f1-603bd72fd92a" class="modal-trigger">modules/porous_flow/test/tests/newton_cooling/nc06.i</a></li><li><a href="#bb44dfa9-06f1-478a-8503-75bb30acbd89" class="modal-trigger">modules/phase_field/examples/multiphase/GrandPotential3Phase.i</a></li><li><a href="#b1ce7165-cb41-434e-9d13-0664042cdb17" class="modal-trigger">modules/combined/test/tests/beam_eigenstrain_transfer/subapp_err_2.i</a></li><li><a href="#5a6e2b77-9c09-436a-90da-563a4ce94276" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_1D.i</a></li><li><a href="#831a4a1d-7105-489e-b26e-d9cba87528bc" class="modal-trigger">modules/combined/examples/stochastic/graphite_ring_thermomechanics.i</a></li><li><a href="#11f9506e-07bd-4ac9-96d4-a41cb3ef0985" class="modal-trigger">modules/porous_flow/test/tests/relperm/corey4.i</a></li><li><a href="#f12ef8d1-2b11-4d4c-b46b-60ff47f0da28" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_3D.i</a></li><li><a href="#addd2fd8-9a93-4fa3-a174-a88c1f318001" class="modal-trigger">modules/porous_flow/test/tests/numerical_diffusion/fltvd_none.i</a></li><li><a href="#a1447153-49c4-4f0f-bf7e-11235cf5bd1f" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/bw01.i</a></li><li><a href="#2fde0fed-a299-43a1-84b8-5a1da8d5a7cd" class="modal-trigger">modules/combined/examples/publications/rapid_dev/fig7a.i</a></li><li><a href="#6848ca7c-ce9a-419f-a95b-89634ec1c602" class="modal-trigger">test/tests/outputs/postprocessor_final/postprocessor_final.i</a></li><li><a href="#22af57c4-e6d1-4f37-bc72-0328dc1cde92" class="modal-trigger">python/peacock/tests/common/time_data.i</a></li><li><a href="#81f758a9-8498-4e7c-b2c4-1364e722bda5" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rd03.i</a></li><li><a href="#d87485a7-7f90-410f-adb9-0484609df6a9" class="modal-trigger">modules/porous_flow/test/tests/relperm/unity.i</a></li><li><a href="#e7014603-6fff-4704-9d11-e8e18a8dbf66" class="modal-trigger">modules/porous_flow/test/tests/relperm/brooks_corey2.i</a></li><li><a href="#45e55890-1b4f-46e4-a29d-8917e84ef196" class="modal-trigger">python/peacock/tests/input_tab/InputTree/gold/simple_diffusion_vp.i</a></li><li><a href="#7f46a024-fb25-4b70-a9bb-bf44593fe248" class="modal-trigger">modules/porous_flow/test/tests/heat_advection/heat_advection_1d_KT.i</a></li><li><a href="#8990e11e-4f69-49ec-a1e8-634ee61a9ff1" class="modal-trigger">test/tests/auxkernels/diffusion_flux/diffusion_flux.i</a></li><li><a href="#6240d74b-965f-45bf-b9f5-85fe5b07241d" class="modal-trigger">modules/combined/examples/publications/rapid_dev/fig6.i</a></li><li><a href="#6cc12f4a-fd4d-4d24-a8bd-55838848a84a" class="modal-trigger">modules/porous_flow/test/tests/newton_cooling/nc08.i</a></li><li><a href="#04335da1-97c5-4a75-8ef2-f1423a9d8aac" class="modal-trigger">modules/porous_flow/test/tests/dirackernels/bh07.i</a></li><li><a href="#b05326b2-698f-4d9d-a71c-209f57b5c0c4" class="modal-trigger">modules/porous_flow/test/tests/fluidstate/theis_brineco2.i</a></li><li><a href="#3e18d2b9-7598-48d2-896f-20ba2ccbd4d1" class="modal-trigger">modules/combined/test/tests/beam_eigenstrain_transfer/subapp2_uo_transfer.i</a></li><li><a href="#1be7499e-71dc-46c3-8cec-2bd033a5c318" class="modal-trigger">modules/porous_flow/test/tests/pressure_pulse/pressure_pulse_1d_2phasePSVG2.i</a></li><li><a href="#3b7ccb32-af4a-403d-b88f-47742b2375ff" class="modal-trigger">modules/tensor_mechanics/test/tests/static_deformations/beam_cosserat_01_slippery.i</a></li><li><a href="#4afbb6f6-dcac-4599-921b-77f51bbe342a" class="modal-trigger">test/tests/outputs/hide_vector_pp/hide_vector_pp.i</a></li><li><a href="#bf45e69f-8bff-4044-a933-bc74cc52e3a1" class="modal-trigger">modules/porous_flow/test/tests/pressure_pulse/pressure_pulse_1d_2phasePS.i</a></li><li><a href="#aae85da3-e2b2-4234-b617-3a9687a2d2f9" class="modal-trigger">modules/porous_flow/test/tests/capillary_pressure/brooks_corey2.i</a></li><li><a href="#2de828ff-2c14-4241-8b65-c803a68240a4" class="modal-trigger">modules/combined/test/tests/beam_eigenstrain_transfer/subapp_err_3.i</a></li><li><a href="#011dd926-f1ad-4d07-8e8c-474667195a4a" class="modal-trigger">modules/porous_flow/test/tests/heat_advection/heat_advection_1d_fully_saturated.i</a></li><li><a href="#f44eb1e6-e598-4887-88b5-5a55416a2b5c" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_2D_trimesh.i</a></li><li><a href="#0f5320f9-1058-4eae-94bf-9e42bd855ac1" class="modal-trigger">modules/porous_flow/test/tests/capillary_pressure/vangenuchten2.i</a></li><li><a href="#c432bb3d-817d-497f-ac66-149632c45a6f" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/wli01.i</a></li><li><a href="#6824422c-411c-445d-8ba5-e6fbac0e5008" class="modal-trigger">test/tests/functions/vector_postprocessor_function/vector_postprocessor_function.i</a></li><li><a href="#f194bf26-70de-4214-9800-f871dbb8c661" class="modal-trigger">modules/combined/examples/publications/rapid_dev/fig3.i</a></li><li><a href="#3c6afe9b-675f-45d0-961e-cc8f1c0bc128" class="modal-trigger">modules/porous_flow/test/tests/thm_rehbinder/free_outer.i</a></li><li><a href="#f3eb07f9-6bd5-4804-8759-1f868e93ddca" class="modal-trigger">modules/tensor_mechanics/test/tests/eigenstrain/reducedOrderRZLinear.i</a></li><li><a href="#5571914b-2afd-4cdc-b9d9-3b5456d39210" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_1D.i</a></li><li><a href="#4d6e0c21-863a-4b96-a3a4-fa6a1999d9e4" class="modal-trigger">modules/tensor_mechanics/test/tests/static_deformations/beam_cosserat_02_apply_stress.i</a></li><li><a href="#834a26df-940a-4928-a9a8-4c65e836f05b" class="modal-trigger">modules/porous_flow/test/tests/relperm/brooks_corey1.i</a></li><li><a href="#53378f9a-7206-4c1d-8bf9-0e0dcf5f25f0" class="modal-trigger">modules/porous_flow/examples/flow_through_fractured_media/coarse_3D.i</a></li><li><a href="#9fa7661b-acd5-4f7f-be44-3976f438c285" class="modal-trigger">modules/porous_flow/test/tests/numerical_diffusion/no_action.i</a></li><li><a href="#cc17db24-33a4-462f-baa2-c6a1dd7669d3" class="modal-trigger">modules/porous_flow/test/tests/numerical_diffusion/fltvd.i</a></li><li><a href="#0e864eb8-c817-4373-a7e1-aa6d68c2cba8" class="modal-trigger">modules/porous_flow/examples/flow_through_fractured_media/fine_transient.i</a></li><li><a href="#71ed2244-562e-4ce3-845f-a026249d3cb4" class="modal-trigger">test/tests/vectorpostprocessors/line_value_sampler/csv_delimiter.i</a></li><li><a href="#7705a044-1012-4431-a5ce-22dc21d80eb6" class="modal-trigger">modules/porous_flow/test/tests/sinks/s09.i</a></li><li><a href="#877b9894-c873-47b4-af01-e76ee2c74eca" class="modal-trigger">test/tests/executioners/nullspace/singular.i</a></li><li><a href="#5bc8b429-9d20-40fc-97f7-34bd26e3f70c" class="modal-trigger">test/tests/vectorpostprocessors/line_value_sampler/line_value_sampler.i</a></li><li><a href="#a70ac4e3-9cc8-4c7f-a106-256ecf16120a" class="modal-trigger">modules/porous_flow/test/tests/infiltration_and_drainage/rd01.i</a></li><li><a href="#8bff19ce-9c7b-459e-909b-df5ce23732e2" class="modal-trigger">test/tests/bcs/vectorpostprocessor/vectorpostprocessor.i</a></li><li><a href="#a65773dc-898c-43c1-9c60-648ee378c2e2" class="modal-trigger">test/tests/vectorpostprocessors/least_squares_fit_history/least_squares_fit_history.i</a></li><li><a href="#da7f8923-7200-48b0-8f29-5e87d6b9f0e8" class="modal-trigger">modules/porous_flow/test/tests/relperm/corey3.i</a></li><li><a href="#68db02e7-13ca-4934-a186-d884750383fd" class="modal-trigger">modules/porous_flow/test/tests/thm_rehbinder/fixed_outer_rz.i</a></li><li><a href="#cd737f0b-c428-4252-a1d6-1afad9764ec5" class="modal-trigger">modules/rdg/test/tests/advection_1d/rdgP0.i</a></li><li><a href="#fbd61070-c3f7-470e-ad7e-1b98c0a8385a" class="modal-trigger">modules/porous_flow/test/tests/sinks/s09_fully_saturated.i</a></li><li><a href="#b3a83be4-dd9d-423e-88eb-1ce8768dca71" class="modal-trigger">modules/porous_flow/test/tests/relperm/corey2.i</a></li><li><a href="#6e26d8c7-73d3-4d35-a756-269b5c000b9e" class="modal-trigger">modules/porous_flow/test/tests/newton_cooling/nc02.i</a></li><li><a href="#b2fa396a-138f-4303-a5f6-667151b99bbe" class="modal-trigger">modules/tensor_mechanics/test/tests/static_deformations/beam_cosserat_01.i</a></li><li><a href="#19980369-e4a3-48e1-9777-ad052d14b324" class="modal-trigger">modules/porous_flow/test/tests/numerical_diffusion/pffltvd_action.i</a></li><li><a href="#97ec7758-ae44-4d06-8ea1-cc7b35efe369" class="modal-trigger">modules/tensor_mechanics/test/tests/static_deformations/cosserat_glide.i</a></li><li><a href="#889a83cd-4f65-4bba-aff4-271002a01d0d" class="modal-trigger">modules/porous_flow/test/tests/capillary_pressure/brooks_corey1.i</a></li><li><a href="#aebe98a5-5a8b-45d5-82a0-8a7db0b4f508" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_2D.i</a></li><li><a href="#2a0b8bc5-7e2f-488d-bcfc-84f494215550" class="modal-trigger">modules/porous_flow/test/tests/numerical_diffusion/framework.i</a></li><li><a href="#bec84908-b99e-43fa-b967-619ed7cbe819" class="modal-trigger">modules/porous_flow/test/tests/sinks/injection_production_eg.i</a></li><li><a href="#c80f0156-1854-4f4b-a286-b2f5d4ae9fc5" class="modal-trigger">modules/heat_conduction/test/tests/semiconductor_linear_conductivity/steinhart-hart_linear.i</a></li><li><a href="#de6fa37b-45fc-45b9-9b07-66d4adf20271" class="modal-trigger">test/tests/outputs/csv_final_and_latest/latest.i</a></li><li><a href="#92288ab6-6b36-4834-adb0-fdf68afe70e4" class="modal-trigger">tutorials/darcy_thermo_mech/step08_postprocessors/problems/step8.i</a></li><li><a href="#43ba3ba3-913d-4844-98ce-866ff4d8fbbb" class="modal-trigger">modules/combined/examples/phase_field-mechanics/kks_mechanics_VTS.i</a></li><li><a href="#f6223922-4778-4b0f-8746-f69c58b7d726" class="modal-trigger">modules/porous_flow/test/tests/newton_cooling/nc04.i</a></li><li><a href="#3b87cd0c-b442-497b-bd31-1292305abdb3" class="modal-trigger">modules/porous_flow/test/tests/relperm/vangenuchten1.i</a></li><li><a href="#5c2aad3b-a3d6-4045-a184-c2373ab6440a" class="modal-trigger">modules/porous_flow/test/tests/heat_advection/heat_advection_1d_fully_saturated_action.i</a></li><li><a href="#28880924-58d4-4db6-8fcd-3e1c8ac93d9c" class="modal-trigger">modules/porous_flow/test/tests/pressure_pulse/pressure_pulse_1d_2phasePSVG.i</a></li><li><a href="#9548e4a9-f84e-46f9-a271-830b366d69ab" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_2D_trimesh.i</a></li><li><a href="#f16e0e8b-bc86-4549-be18-511fcda8558e" class="modal-trigger">modules/porous_flow/test/tests/fluidstate/theis_tabulated.i</a></li><li><a href="#84272609-4894-443a-9bca-56aaeb6673fc" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_1D_adaptivity.i</a></li><li><a href="#4ad2c461-4104-4e7a-b94c-3928df5816ec" class="modal-trigger">modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_3D.i</a></li><li><a href="#ffae3ef2-e746-4c0d-b67f-99f7ee08050c" class="modal-trigger">modules/level_set/test/tests/kernels/olsson_reinitialization/olsson_1d.i</a></li><li><a href="#25e98af9-cbbf-4959-9fb6-1cc4c72eb6f9" class="modal-trigger">modules/porous_flow/test/tests/newton_cooling/nc01.i</a></li><li><a href="#98b6d39b-55f1-4b4b-8e43-8a3240a50494" class="modal-trigger">modules/porous_flow/test/tests/relperm/vangenuchten2.i</a></li><li><a href="#d21c5536-eed6-4768-b22b-0acc6a52031a" class="modal-trigger">modules/combined/test/tests/beam_eigenstrain_transfer/subapp_err_4.i</a></li><li><a href="#e12d3179-2645-4f4b-afd6-fa794abf36ce" class="modal-trigger">test/tests/executioners/nullspace/singular_contaminated.i</a></li></ul><div class="modal moose-modal" id="8e172b68-cdf6-4c7b-ba06-839aa8ac1a1c"><div class="modal-content"><h4>modules/porous_flow/test/tests/heat_advection/heat_advection_1d.i</h4><pre class="moose-pre"><code class="language-text"># 1phase, heat advecting with a moving fluid
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 50
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./temp]
    initial_condition = 200
  [../]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = &#x27;1-x&#x27;
  [../]
[]

[BCs]
  [./pp0]
    type = DirichletBC
    variable = pp
    boundary = left
    value = 1
  [../]
  [./pp1]
    type = DirichletBC
    variable = pp
    boundary = right
    value = 0
  [../]
  [./spit_heat]
    type = DirichletBC
    variable = temp
    boundary = left
    value = 300
  [../]
  [./suck_heat]
    type = DirichletBC
    variable = temp
    boundary = right
    value = 200
  [../]
[]

[Kernels]
  [./mass_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./advection]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
  [../]
  [./energy_dot]
    type = PorousFlowEnergyTimeDerivative
    variable = temp
  [../]
  [./heat_advection]
    type = PorousFlowHeatAdvection
    variable = temp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;temp pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.6
    alpha = 1.3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 100
      density0 = 1000
      viscosity = 4.4
      thermal_expansion = 0
      cv = 2
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = temp
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.2
  [../]
  [./rock_heat]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 1.0
    density = 125
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.1 0 0 0 2 0 0 0 3&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./PS]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 0.01
  end_time = 0.6
[]

[VectorPostprocessors]
  [./T]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 51
    sort_by = x
    variable = temp
  [../]
[]

[Outputs]
  [./csv]
    type = CSV
    sync_times = &#x27;0.1 0.6&#x27;
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4c59cd5d-bae1-4371-92e9-e4f76963d03b"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/eigenstrain/reducedOrderRZQuadratic.i</h4><pre class="moose-pre"><code class="language-text">#
# This test checks whether the ComputeReducedOrderEigenstrain is functioning properly.
#
# If instead of &#x27;reduced_order_eigenstrain&#x27;, &#x27;thermal_eigenstrain&#x27; is given to
# eigenstrain_names in the Modules/TensorMechanics/Master/all block, the output will be
# quite different.
#
# Open the reducedOrderRZQuadratic_out_hydro_0001.csv file and plot the hydro variables as
# a function of x.
#

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
  volumetric_locking_correction = false
[]

[Problem]
  coord_type = RZ
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 1
  xmax = 3
  xmin = 1
  ymax = 1
  ymin = 0
  second_order = true
[]

[Functions]
  [./tempLinear]
    type = ParsedFunction
    value = &#x27;715-5*x&#x27;
  [../]
  [./tempQuadratic]
    type = ParsedFunction
    vars = &#x27;Tc Te&#x27;
    vals = &#x27;701 700&#x27;
    value = &#x27;(Te-Tc)/4.0*x*x+(Tc-Te)/2.0*x+Te+3.0*(Tc-Te)/4.0&#x27;
  [../]
  [./tempCubic]
    type = ParsedFunction
    value = &#x27;-1.25*x*x*x+11.25*x*x-33.75*x+733.75&#x27;
  [../]
[]

[Variables]
  [./temp]
    order = FIRST
    family = LAGRANGE
    initial_condition = 295.0
  [../]
[]

[AuxVariables]
  [./hydro_constant]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./hydro_first]
    order = FIRST
    family = MONOMIAL
  [../]
  [./hydro_second]
    order = SECOND
    family = MONOMIAL
  [../]
  [./sxx_constant]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./sxx_first]
    order = FIRST
    family = MONOMIAL
  [../]
  [./sxx_second]
    order = SECOND
    family = MONOMIAL
  [../]
  [./szz_constant]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./szz_first]
    order = FIRST
    family = MONOMIAL
  [../]
  [./szz_second]
    order = SECOND
    family = MONOMIAL
  [../]
  [./thermal_constant]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./thermal_first]
    order = FIRST
    family = MONOMIAL
  [../]
  [./thermal_second]
    order = SECOND
    family = MONOMIAL
  [../]
  [./reduced_constant]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./reduced_first]
    order = FIRST
    family = MONOMIAL
  [../]
  [./reduced_second]
    order = SECOND
    family = MONOMIAL
  [../]
  [./temp2]
    order = SECOND
    family = LAGRANGE
    initial_condition = 700
  [../]
[]

[Modules]
  [./TensorMechanics]
    [./Master]
      [./all]
        add_variables = true
        strain = SMALL
        incremental = true
        temperature = temp2
        #eigenstrain_names = thermal_eigenstrain
        eigenstrain_names = reduced_order_eigenstrain
      [../]
    [../]
  [../]
[]

[Kernels]
  [./heat]
    type = Diffusion
    variable = temp
  [../]
[]

[AuxKernels]
  [./hydro_constant_aux]
    type = RankTwoScalarAux
    variable = hydro_constant
    rank_two_tensor = stress
    scalar_type = Hydrostatic
    execute_on = timestep_end
  [../]
  [./hydro_first_aux]
    type = RankTwoScalarAux
    variable = hydro_first
    rank_two_tensor = stress
    scalar_type = Hydrostatic
    execute_on = timestep_end
  [../]
  [./hydro_second_aux]
    type = RankTwoScalarAux
    variable = hydro_second
    rank_two_tensor = stress
    scalar_type = Hydrostatic
    execute_on = timestep_end
  [../]
  [./sxx_constant_aux]
    type = RankTwoAux
    variable = sxx_constant
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
    execute_on = timestep_end
  [../]
  [./sxx_first_aux]
    type = RankTwoAux
    variable = sxx_first
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
    execute_on = timestep_end
  [../]
  [./sxx_second_aux]
    type = RankTwoAux
    variable = sxx_second
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
    execute_on = timestep_end
  [../]
  [./szz_constant_aux]
    type = RankTwoAux
    variable = szz_constant
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    execute_on = timestep_end
  [../]
  [./szz_first_aux]
    type = RankTwoAux
    variable = szz_first
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    execute_on = timestep_end
  [../]
  [./szz_second_aux]
    type = RankTwoAux
    variable = szz_second
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    execute_on = timestep_end
  [../]
  [./thermal_constant_aux]
    type = RankTwoAux
    variable = thermal_constant
    rank_two_tensor = thermal_eigenstrain
    index_i = 0
    index_j = 0
    execute_on = timestep_end
  [../]
  [./thermal_first_aux]
    type = RankTwoAux
    variable = thermal_first
    rank_two_tensor = thermal_eigenstrain
    index_i = 0
    index_j = 0
    execute_on = timestep_end
  [../]
  [./thermal_second_aux]
    type = RankTwoAux
    variable = thermal_second
    rank_two_tensor = thermal_eigenstrain
    index_i = 0
    index_j = 0
    execute_on = timestep_end
  [../]
  [./reduced_constant_aux]
    type = RankTwoAux
    variable = reduced_constant
    rank_two_tensor = reduced_order_eigenstrain
    index_i = 0
    index_j = 0
    execute_on = timestep_end
  [../]
  [./reduced_first_aux]
    type = RankTwoAux
    variable = reduced_first
    rank_two_tensor = reduced_order_eigenstrain
    index_i = 0
    index_j = 0
    execute_on = timestep_end
  [../]
  [./reduced_second_aux]
    type = RankTwoAux
    variable = reduced_second
    rank_two_tensor = reduced_order_eigenstrain
    index_i = 0
    index_j = 0
    execute_on = timestep_end
  [../]
  [./temp2]
    type = FunctionAux
    variable = temp2
    function = tempQuadratic
    execute_on = timestep_begin
  [../]
[]

[BCs]
  [./no_y]
    type = DirichletBC
    variable = disp_y
    boundary = bottom #&#x27;bottom top&#x27;
    value = 0.0
  [../]

  [./temp_right]
    type = DirichletBC
    variable = temp
    boundary = right
    value = 700
  [../]
  [./temp_left]
    type = DirichletBC
    variable = temp
    boundary = left
    value = 710
  [../]
[]


[Materials]
  [./fuel_stress]
    type = ComputeFiniteStrainElasticStress
  [../]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 1e8
    poissons_ratio = 0
  [../]
  [./fuel_thermal_expansion]
    type = ComputeThermalExpansionEigenstrain
    thermal_expansion_coeff = 1e-6
    temperature = temp2
    stress_free_temperature = 295.0
    eigenstrain_name = &#x27;thermal_eigenstrain&#x27;
  [../]
  [./reduced_order_eigenstrain]
    type = ComputeReducedOrderEigenstrain
    input_eigenstrain_names = &#x27;thermal_eigenstrain&#x27;
    eigenstrain_name = &#x27;reduced_order_eigenstrain&#x27;
  [../]
[]


[Preconditioning]
  [./SMP]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp_ew &#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart -pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;70 hypre boomeramg&#x27;

  num_steps = 1
  nl_rel_tol = 1e-8
[]

[Postprocessors]
  [./_dt]
    type = TimestepSize
  [../]
[]

[VectorPostprocessors]
  [./hydro]
    type = LineValueSampler
    num_points = 50
    start_point = &#x27;1 0.07e-3 0&#x27;
    end_point = &#x27;3 0.07e-3 0&#x27;
    sort_by = x
    variable = &#x27;temp2 disp_x disp_y hydro_constant hydro_first hydro_second sxx_constant sxx_first sxx_second szz_constant szz_first szz_second thermal_constant thermal_first thermal_second reduced_constant reduced_first reduced_second&#x27;
  [../]
[]

[Outputs]
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9c362c59-7dcb-424c-8575-328ff5bdef3e"><div class="modal-content"><h4>modules/combined/test/tests/beam_eigenstrain_transfer/subapp1_uo_transfer.i</h4><pre class="moose-pre"><code class="language-text"># SubApp with 2D model to test multi app vectorpostprocessor to aux var transfer

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 5
  xmin = 0.0
  xmax = 0.5
  ymin = 0.0
  ymax = 0.150080
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[AuxVariables]
  [./temp]
  [../]
  [./axial_strain]
    order = FIRST
    family = MONOMIAL
  [../]
[]

[Functions]
  [./temperature_load]
    type = ParsedFunction
    value = t*(500.0)+300.0
  [../]
[]

[Modules]
  [./TensorMechanics]
    [./Master]
      [./all]
        strain = SMALL
        incremental = true
        add_variables = true
        eigenstrain_names = eigenstrain
      [../]
    [../]
  [../]
[]

[AuxKernels]
  [./tempfuncaux]
    type = FunctionAux
    variable = temp
    function = temperature_load
  [../]
  [./axial_strain]
    type = RankTwoAux
    variable = axial_strain
    rank_two_tensor = total_strain
    index_i = 1
    index_j = 1
    execute_on = timestep_end
  [../]
[]

[BCs]
  [./x_bot]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./y_bot]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
  [../]
  [./small_stress]
    type = ComputeFiniteStrainElasticStress
  [../]
  [./thermal_expansion_strain]
    type = ComputeThermalExpansionEigenstrain
    stress_free_temperature = 298
    thermal_expansion_coeff = 1.3e-5
    temperature = temp
    eigenstrain_name = eigenstrain
  [../]
[]

[Executioner]
  type = Transient

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;101&#x27;

  line_search = &#x27;none&#x27;

  l_max_its = 50
  nl_max_its = 50
  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-8
  l_tol = 1e-9

  start_time = 0.0
  end_time = 0.075
  dt = 0.0125
  dtmin = 0.0001
[]

[Outputs]
  csv = true
  exodus = true
[]

[VectorPostprocessors]
  [./axial_str]
    type = LineValueSampler
    start_point = &#x27;0.5 0.0 0.0&#x27;
    end_point = &#x27;0.5 0.150080 0.0&#x27;
    variable = &#x27;axial_strain&#x27;
    num_points = 21
    sort_by = &#x27;id&#x27;
  [../]
[]

[Postprocessors]
  [./end_disp]
    type = PointValue
    variable = disp_y
    point = &#x27;0.5 0.150080 0.0&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1acf9140-fb8a-4c18-a11c-6011c4522280"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/bw02.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-1 5E-1 5E-1&#x27;
    x = &#x27;0 1 10&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureBW
    Sn = 0.0
    Ss = 1.0
    C = 1.5
    las = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 4
      density0 = 10
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityBW
    Sn = 0.0
    Ss = 1.0
    Kn = 0
    Ks = 1
    C = 1.5
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 1 0  0 0 1&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = -9E2
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-0.1 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./recharge]
    type = PorousFlowSink
    variable = pressure
    boundary = right
    flux_function = -1.25 # corresponds to Rstar being 0.5 because i have to multiply by density*porosity
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 2

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;-10 0 0&#x27;
    end_point = &#x27;10 0 0&#x27;
    sort_by = x
    num_points = 80
    execute_on = timestep_end
  [../]
[]

[Outputs]
  file_base = bw02
  sync_times = &#x27;0.5 2 8&#x27;
  [./exodus]
    type = Exodus
    sync_only = true
  [../]
  [./along_line]
    type = CSV
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7a786513-3695-4e60-9bbf-f04a4f0a0aa0"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_2D.i</h4><pre class="moose-pre"><code class="language-text"># Using flux-limited TVD advection ala Kuzmin and Turek, employing PorousFlow Kernels and UserObjects, with superbee flux-limiter
# 3D version
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  xmin = 0
  xmax = 1
  ny = 4
  ymin = 0
  ymax = 0.5
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer]
  [../]
[]

[ICs]
  [./porepressure]
    type = FunctionIC
    variable = porepressure
    function = &#x27;1 - x&#x27;
  [../]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = tracer
  [../]
  [./flux0]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = advective_flux_calculator_0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = porepressure
  [../]
  [./flux1]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = porepressure
    advective_flux_calculator = advective_flux_calculator_1
  [../]
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1
    boundary = left
  [../]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_component_1]
    type = PorousFlowPiecewiseLinearSink
    variable = porepressure
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 1
    use_mobility = true
    flux_function = 1E3
  [../]
  [./remove_component_0]
    type = PorousFlowPiecewiseLinearSink
    variable = tracer
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 0
    use_mobility = true
    flux_function = 1E3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      thermal_expansion = 0
      viscosity = 1.0
      density0 = 1000.0
    [../]
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure tracer&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
  [../]
  [./advective_flux_calculator_0]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 0
  [../]
  [./advective_flux_calculator_1]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 1
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = tracer
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = the_simple_fluid
    phase = 0
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-2 0 0   0 1E-2 0   0 0 1E-2&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c697140d-6849-47cd-8535-11e933751127"><div class="modal-content"><h4>test/tests/outputs/csv_final_and_latest/final.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 10
  dt = 0.25
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

# Vector Postprocessor System
[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    execute_on = &#x27;timestep_end final&#x27;
    variable = &#x27;u&#x27;
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = id
  [../]
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = &#x27;TIMESTEP_END FINAL&#x27;
    create_final_symlink = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="93d44032-32b5-4ede-9a9e-716d34dcef55"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/static_deformations/cosserat_glide_fake_plastic.i</h4><pre class="moose-pre"><code class="language-text"># Example taken from Appendix A of
# S Forest &quot;Mechanics of Cosserat media An introduction&quot;.  Available from http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.154.4476&amp;rep=rep1&amp;type=pdf
#
# This example uses plasticity, but with inifinitely large yield strength, so it is really elasticity
#
# Analytically, the displacements are
# wc_z = B sinh(w_e y)
# disp_x = (2 mu_c B / w_e / (mu + mu_c)) (1 - cosh(w_e y))
# with w_e^2 = 2 mu mu_c / be / (mu + mu_c)
# and B = arbitrary integration constant
#
# Also, the only nonzero stresses are
# m_zy = 2 B be w_e cosh(w_e y)
# si_yx = -4 mu mu_c/(mu + mu_c) B sinh(w_e y)
#
# MOOSE gives these stress components correctly.
# However, it also gives a seemingly non-zero si_xy
# component.  Upon increasing the resolution of the
# mesh (ny=10000, for example), the stress components
# are seen to limit correctly to the above forumlae
#
# I use mu = 2, mu_c = 3, be = 0.6, so w_e = 2
# Also i use B = 1, so at y = 1
# wc_z = 3.626860407847
# disp_x = -1.65731741465
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 100
  ymax = 1
  nz = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  Cosserat_rotations = &#x27;wc_x wc_y wc_z&#x27;
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./wc_x]
  [../]
  [./wc_y]
  [../]
  [./wc_z]
  [../]
[]

[Kernels]
  [./cx_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./cy_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./cz_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./x_couple]
    type = StressDivergenceTensors
    variable = wc_x
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 0
    base_name = couple
  [../]
  [./y_couple]
    type = StressDivergenceTensors
    variable = wc_y
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 1
    base_name = couple
  [../]
  [./z_couple]
    type = StressDivergenceTensors
    variable = wc_z
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 2
    base_name = couple
  [../]
  [./x_moment]
    type = MomentBalancing
    variable = wc_x
    component = 0
  [../]
  [./y_moment]
    type = MomentBalancing
    variable = wc_y
    component = 1
  [../]
  [./z_moment]
    type = MomentBalancing
    variable = wc_z
    component = 2
  [../]
[]

[BCs]
  # zmin is called back
  # zmax is called front
  # ymin is called bottom
  # ymax is called top
  # xmin is called left
  # xmax is called right
  [./disp_x_zero_at_y_zero]
    type = DirichletBC
    variable = disp_x
    boundary = bottom
    value = 0
  [../]
  [./disp_x_fixed_at_y_max]
    type = DirichletBC
    variable = disp_x
    boundary = top
    value = -1.65731741465
  [../]
  [./no_dispy]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back front bottom top left right&#x27;
    value = 0
  [../]
  [./no_dispz]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back front bottom top left right&#x27;
    value = 0
  [../]
  [./no_wc_x]
    type = DirichletBC
    variable = wc_x
    boundary = &#x27;back front bottom top left right&#x27;
    value = 0
  [../]
  [./no_wc_y]
    type = DirichletBC
    variable = wc_y
    boundary = &#x27;back front bottom top left right&#x27;
    value = 0
  [../]
  [./wc_z_zero_at_y_zero]
    type = DirichletBC
    variable = wc_z
    boundary = bottom
    value = 0
  [../]
  [./wc_z_fixed_at_y_max]
    type = DirichletBC
    variable = wc_z
    boundary = top
    value = 3.626860407847
  [../]
[]

[AuxVariables]
  [./stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./stress_zy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./couple_stress_xx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./couple_stress_xy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./couple_stress_xz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./couple_stress_yx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./couple_stress_yy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./couple_stress_yz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./couple_stress_zx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./couple_stress_zy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./couple_stress_zz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zz
    index_i = 2
    index_j = 2
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeCosseratElasticityTensor
    B_ijkl = &#x27;1.1 0.6 0.6&#x27; # In Forest notation this is alpha=1.1 (this is unimportant), beta=gamma=0.6.
    fill_method_bending = &#x27;general_isotropic&#x27;
    E_ijkl = &#x27;1 2 3&#x27; # In Forest notation this is lambda=1 (this is unimportant), mu=2, mu_c=3
    fill_method = &#x27;general_isotropic&#x27;
  [../]
  [./strain]
    type = ComputeCosseratIncrementalSmallStrain
  [../]
  [./stress_fake_plasticity]
    type = ComputeMultiPlasticityStress
    ep_plastic_tolerance = 1E-12
  [../]
[]

[VectorPostprocessors]
  [./soln]
    type = LineValueSampler
    sort_by = y
    variable = &#x27;disp_x wc_z stress_yx couple_stress_zy&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;0 1 0&#x27;
    num_points = 11
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it -ksp_atol -ksp_rtol&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-10 1E-14 10 1E-15 1E-10&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  num_steps = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = cosserat_glide_fake_plastic_out
  exodus = false
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="185213eb-c4ff-49c7-b027-bf8fead4d027"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/theis_rz.i</h4><pre class="moose-pre"><code class="language-text"># Theis problem: Flow to single sink using BasicTHM
# SinglePhase
# RZ mesh

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmax = 100
  bias_x = 1.05
[]

[Problem]
  coord_type = RZ
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./pp]
    initial_condition = 20E6
  [../]
[]

[PorousFlowBasicTHM]
  dictator_name = dictator
  add_darcy_aux = false
  fp = simple_fluid
  gravity = &#x27;0 0 0&#x27;
  multiply_by_density = false
  porepressure = pp
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      viscosity = 0.001
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.05
  [../]
  [./biot_mod]
    type = PorousFlowConstantBiotModulus
    fluid_bulk_modulus = 2E9
    biot_coefficient = 1.0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-14 0 0 0 1E-14 0 0 0 1E-14&#x27;
  [../]
[]

[DiracKernels]
  [./sink]
    type = PorousFlowSquarePulsePointSource
    point = &#x27;0 0 0&#x27;
    mass_flux = -0.16E-3 # recall this is a volumetric flux because multiply_by_density = false in the Action, so this corresponds to a mass_flux of 0.16 kg/s/m because density=1000
    variable = pp
  [../]
[]

[VectorPostprocessors]
  [./pp]
    type = LineValueSampler
    num_points = 25
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;100 0 0&#x27;
    sort_by = x
    variable = pp
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 200
  end_time = 1E3
  nl_abs_tol = 1e-10
[]

[Outputs]
  perf_graph = true
  [./csv]
    type = CSV
    execute_on = final
  [../]
[]

</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="59f7de6f-53f4-4ae7-9044-b972b88e96fa"><div class="modal-content"><h4>test/tests/vectorpostprocessors/time_data/time_data.i</h4><pre class="moose-pre"><code class="language-text">###############################################################
# The following tests that the CSV output object can include an
# additional .csv file that contains the time and timestep
# data from VectorPostprocessor object.
###############################################################


[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
  [./v]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./diff_v]
    type = Diffusion
    variable = v
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
  [./left_v]
    type = DirichletBC
    variable = v
    boundary = left
    value = 1
  [../]
  [./right_v]
    type = DirichletBC
    variable = v
    boundary = right
    value = 0
  [../]
[]

[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    variable = &#x27;u v&#x27;
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = id
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 20
  dt = 0.1
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  execute_on = &#x27;initial timestep_end&#x27;
  [./out]
    type = CSV
    time_data = true
    interval = 2
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="40b105d7-bb56-4b66-bc94-50287242ce83"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rsc01.i</h4><pre class="moose-pre"><code class="language-text"># RSC test with high-res time and spatial resolution
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 600
  ny = 1
  xmin = 0
  xmax = 10 # x is the depth variable, called zeta in RSC
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;3E-3 3E-2 0.05&#x27;
    x = &#x27;0 1 5&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pwater poil&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
[]

[Modules]
  [./FluidProperties]
    [./water]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 10
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
    [./oil]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 20
      thermal_expansion = 0
      viscosity = 2e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = pwater
    phase1_porepressure = poil
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./water]
    type = PorousFlowSingleComponentFluid
    fp = water
    phase = 0
    compute_enthalpy = false
    compute_internal_energy = false
  [../]
  [./oil]
    type = PorousFlowSingleComponentFluid
    fp = oil
    phase = 1
    compute_enthalpy = false
    compute_internal_energy = false
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_oil]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
  [../]
[]

[Variables]
  [./pwater]
  [../]
  [./poil]
  [../]
[]

[ICs]
  [./water_init]
    type = ConstantIC
    variable = pwater
    value = 0
  [../]
  [./oil_init]
    type = ConstantIC
    variable = poil
    value = 15
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pwater
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = poil
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = poil
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./SOil]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
  [./SOil]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 1
    variable = SOil
  [../]
[]

[BCs]
# we are pumping water into a system that has virtually incompressible fluids, hence the pressures rise enormously.  this adversely affects convergence because of almost-overflows and precision-loss problems.  The fixed things help keep pressures low and so prevent these awful behaviours.   the movement of the saturation front is the same regardless of the fixed things.
  active = &#x27;recharge fixedoil fixedwater&#x27;
  [./recharge]
    type = PorousFlowSink
    variable = pwater
    boundary = &#x27;left&#x27;
    flux_function = -1.0
  [../]
  [./fixedwater]
    type = DirichletBC
    variable = pwater
    boundary = &#x27;right&#x27;
    value = 0
  [../]
  [./fixedoil]
    type = DirichletBC
    variable = poil
    boundary = &#x27;right&#x27;
    value = 15
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;7 0 0&#x27;
    sort_by = x
    num_points = 21
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 5
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rsc01
  [./along_line]
    type = CSV
    execute_vector_postprocessors_on = final
  [../]
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6647781e-f108-4625-a9ff-125ce4dc9736"><div class="modal-content"><h4>modules/phase_field/examples/kim-kim-suzuki/kks_example_noflux.i</h4><pre class="moose-pre"><code class="language-text">#
# KKS simple example in the split form
#

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 150
  ny = 15
  nz = 0
  xmin = -25
  xmax = 25
  ymin = -2.5
  ymax = 2.5
  zmin = 0
  zmax = 0
  elem_type = QUAD4
[]

[AuxVariables]
  [./Fglobal]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[Variables]
  # order parameter
  [./eta]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute concentration
  [./c]
    order = FIRST
    family = LAGRANGE
  [../]

  # chemical potential
  [./w]
    order = FIRST
    family = LAGRANGE
  [../]

  # Liquid phase solute concentration
  [./cl]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.1
  [../]
  # Solid phase solute concentration
  [./cs]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.9
  [../]
[]

[Functions]
  [./ic_func_eta]
    type = ParsedFunction
    value = &#x27;0.5*(1.0-tanh((x)/sqrt(2.0)))&#x27;
  [../]
  [./ic_func_c]
    type = ParsedFunction
    value = &#x27;0.9*(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10)+0.1*(1-(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10))&#x27;
  [../]
[]


[ICs]
  [./eta]
    variable = eta
    type = FunctionIC
    function = ic_func_eta
  [../]
  [./c]
    variable = c
    type = FunctionIC
    function = ic_func_c
  [../]
[]

[Materials]
  # Free energy of the liquid
  [./fl]
    type = DerivativeParsedMaterial
    f_name = fl
    args = &#x27;cl&#x27;
    function = &#x27;(0.1-cl)^2&#x27;
  [../]

  # Free energy of the solid
  [./fs]
    type = DerivativeParsedMaterial
    f_name = fs
    args = &#x27;cs&#x27;
    function = &#x27;(0.9-cs)^2&#x27;
  [../]

  # h(eta)
  [./h_eta]
    type = SwitchingFunctionMaterial
    h_order = HIGH
    eta = eta
  [../]

  # g(eta)
  [./g_eta]
    type = BarrierFunctionMaterial
    g_order = SIMPLE
    eta = eta
  [../]

  # constant properties
  [./constants]
    type = GenericConstantMaterial
    prop_names  = &#x27;M   L   eps_sq&#x27;
    prop_values = &#x27;0.7 0.7 1.0  &#x27;
  [../]
[]

[Kernels]
  active = &#x27;PhaseConc ChemPotSolute CHBulk ACBulkF ACBulkC ACInterface dcdt detadt ckernel&#x27;

  # enforce c = (1-h(eta))*cl + h(eta)*cs
  [./PhaseConc]
    type = KKSPhaseConcentration
    ca       = cl
    variable = cs
    c        = c
    eta      = eta
  [../]

  # enforce pointwise equality of chemical potentials
  [./ChemPotSolute]
    type = KKSPhaseChemicalPotential
    variable = cl
    cb       = cs
    fa_name  = fl
    fb_name  = fs
  [../]

  #
  # Cahn-Hilliard Equation
  #
  [./CHBulk]
    type = KKSSplitCHCRes
    variable = c
    ca       = cl
    fa_name  = fl
    w        = w
  [../]

  [./dcdt]
    type = CoupledTimeDerivative
    variable = w
    v = c
  [../]
  [./ckernel]
    type = SplitCHWRes
    mob_name = M
    variable = w
  [../]

  #
  # Allen-Cahn Equation
  #
  [./ACBulkF]
    type = KKSACBulkF
    variable = eta
    fa_name  = fl
    fb_name  = fs
    w        = 1.0
    args = &#x27;cl cs&#x27;
  [../]
  [./ACBulkC]
    type = KKSACBulkC
    variable = eta
    ca       = cl
    cb       = cs
    fa_name  = fl
  [../]
  [./ACInterface]
    type = ACInterface
    variable = eta
    kappa_name = eps_sq
  [../]
  [./detadt]
    type = TimeDerivative
    variable = eta
  [../]
[]

[AuxKernels]
  [./GlobalFreeEnergy]
    variable = Fglobal
    type = KKSGlobalFreeEnergy
    fa_name = fl
    fb_name = fs
    w = 1.0
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;

  petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type&#x27;
  petsc_options_value = &#x27;asm      ilu          nonzero&#x27;

  l_max_its = 100
  nl_max_its = 100

  num_steps = 50
  dt = 0.1
[]

#
# Precondition using handcoded off-diagonal terms
#
[Preconditioning]
  [./full]
    type = SMP
    full = true
  [../]
[]


[VectorPostprocessors]
  [./c]
    type =  LineValueSampler
    start_point = &#x27;-25 0 0&#x27;
    end_point = &#x27;25 0 0&#x27;
    variable = c
    num_points = 151
    sort_by =  id
    execute_on = timestep_end
  [../]
  [./eta]
    type =  LineValueSampler
    start_point = &#x27;-25 0 0&#x27;
    end_point = &#x27;25 0 0&#x27;
    variable = eta
    num_points = 151
    sort_by =  id
    execute_on = timestep_end
  [../]

[]

[Outputs]
  exodus = true
  [./csv]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a2b6213a-2878-471a-8212-d54bd4b906a6"><div class="modal-content"><h4>test/tests/vectorpostprocessors/least_squares_fit/least_squares_fit.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
  [./v]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./diff_v]
    type = Diffusion
    variable = v
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
  [./left_v]
    type = DirichletBC
    variable = v
    boundary = left
    value = 1
  [../]
  [./right_v]
    type = DirichletBC
    variable = v
    boundary = right
    value = 0
  [../]
[]

[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    variable = &#x27;u v&#x27;
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = id
    outputs = none
  [../]
  [./least_squares_fit_sample]
    type = LeastSquaresFit
    vectorpostprocessor = line_sample
    x_name = &#x27;id&#x27;
    y_name = &#x27;u&#x27;
    order = 1
    num_samples = 20
    output = samples
  [../]
  [./least_squares_fit_coeffs]
    type = LeastSquaresFit
    vectorpostprocessor = line_sample
    x_name = &#x27;id&#x27;
    y_name = &#x27;u&#x27;
    order = 1
    output = coefficients
  [../]
  [./shift_and_scale_x_least_squares_fit_sample]
    type = LeastSquaresFit
    vectorpostprocessor = line_sample
    x_name = &#x27;id&#x27;
    y_name = &#x27;u&#x27;
    x_shift = 1
    x_scale = 10
    order = 1
    num_samples = 20
    output = samples
  [../]
  [./shift_and_scale_x_least_squares_fit_coeffs]
    type = LeastSquaresFit
    vectorpostprocessor = line_sample
    x_name = &#x27;id&#x27;
    y_name = &#x27;u&#x27;
    x_shift = 1
    x_scale = 10
    order = 1
    output = coefficients
  [../]
  [./shift_and_scale_y_least_squares_fit_sample]
    type = LeastSquaresFit
    vectorpostprocessor = line_sample
    x_name = &#x27;id&#x27;
    y_name = &#x27;u&#x27;
    y_shift = 1
    y_scale = 10
    order = 1
    num_samples = 20
    output = samples
  [../]
  [./shift_and_scale_y_least_squares_fit_coeffs]
    type = LeastSquaresFit
    vectorpostprocessor = line_sample
    x_name = &#x27;id&#x27;
    y_name = &#x27;u&#x27;
    y_shift = 1
    y_scale = 10
    order = 1
    output = coefficients
  [../]
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  file_base = out
  execute_on = &#x27;timestep_end&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e7ee590e-6386-4a1d-9909-23a64e001708"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_2D_blocks.i</h4><pre class="moose-pre"><code class="language-text"># Using Flux-Limited TVD Advection ala Kuzmin and Turek
# 2D version with blocks
# Top block: tracer is defined here, with velocity = (0.1, 0, 0)
# Central block: tracer is not defined here
# Bottom block: tracer is defined here, with velocity = (-0.1, 0, 0)

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 10
    xmin = 0
    xmax = 1
    ny = 5
    ymin = 0
    ymax = 1
  []
  [./top]
    input = gen
    type = SubdomainBoundingBoxGenerator
    bottom_left = &#x27;0 0.6 0&#x27;
    top_right = &#x27;1 1 0&#x27;
    block_id = 1
  [../]
  [./center]
    input = bottom
    type = SubdomainBoundingBoxGenerator
    bottom_left = &#x27;0 0.4 0&#x27;
    top_right = &#x27;1 0.6 0&#x27;
    block_id = 2
  [../]
  [./bottom]
    input = top
    type = SubdomainBoundingBoxGenerator
    bottom_left = &#x27;0 0 0&#x27;
    top_right = &#x27;1 0.6 0&#x27;
    block_id = 3
  [../]
  [./split_bdys]
    type = BreakBoundaryOnSubdomainGenerator
    input = center
    boundaries = &#x27;left right&#x27;
  [../]
[]

[GlobalParams]
  block = &#x27;1 2 3&#x27;
[]

[Variables]
  [./tracer]
    block = &#x27;1 3&#x27;
  [../]
  [./dummy]
  [../]
[]

[ICs]
  [./tracer_top]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1 | x&gt;0.3, 0, 1)&#x27;
    block = &#x27;1&#x27;
  [../]
  [./tracer_bot]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.7 | x &gt; 0.9, 0, 1)&#x27;
    block = &#x27;3&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = MassLumpedTimeDerivative
    variable = tracer
    block = &#x27;1 3&#x27;
  [../]
  [./flux_top]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo_top
    block = &#x27;1&#x27;
  [../]
  [./flux_bot]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo_bot
    block = &#x27;3&#x27;
  [../]
  [.dummy]
    type = TimeDerivative
    variable = dummy
  [../]
[]

[UserObjects]
  [./fluo_top]
    type = AdvectiveFluxCalculatorConstantVelocity
    flux_limiter_type = superbee
    u = tracer
    velocity = &#x27;0.1 0 0&#x27;
    block = &#x27;1&#x27;
  [../]
  [./fluo_bot]
    type = AdvectiveFluxCalculatorConstantVelocity
    flux_limiter_type = superbee
    u = tracer
    velocity = &#x27;-0.1 0 0&#x27;
    block = &#x27;3&#x27;
  [../]
[]

[BCs]
  [./no_tracer_on_left_top]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = &#x27;left_to_1&#x27;
  [../]
  [./remove_tracer_top]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = &#x27;right_to_1&#x27;
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
  [./no_tracer_on_left_bot]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = &#x27;left_to_3&#x27;
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
  [./remove_tracer_bot]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = &#x27;right_to_3&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer_bot]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
  [./tracer_top]
    type = LineValueSampler
    start_point = &#x27;0 1 0&#x27;
    end_point = &#x27;1 1 0&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  timestep_tolerance = 1E-3
[]

[Outputs]
  print_linear_residuals = false
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a706f7fe-1ac0-4de2-bd39-dc927b601597"><div class="modal-content"><h4>modules/porous_flow/examples/flow_through_fractured_media/fine_thick_fracture_transient.i</h4><pre class="moose-pre"><code class="language-text"># Using a single-dimensional mesh
# Transient flow and solute transport along a fracture in a porous matrix
# advective dominated flow in the fracture and diffusion into the porous matrix
#
# Note that fine_thick_fracture_steady.i must be run to initialise the porepressure properly

[Mesh]
  file = &#x27;gold/fine_thick_fracture_steady_out.e&#x27;
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./pp]
    initial_from_file_var = pp
    initial_from_file_timestep = 1
  [../]
  [./massfrac0]
  [../]
[]

[AuxVariables]
  [./velocity_x]
    family = MONOMIAL
    order = CONSTANT
    block = fracture
  [../]
  [./velocity_y]
    family = MONOMIAL
    order = CONSTANT
    block = fracture
  [../]
[]

[AuxKernels]
  [./velocity_x]
    type = PorousFlowDarcyVelocityComponent
    variable = velocity_x
    component = x
  [../]
  [./velocity_y]
    type = PorousFlowDarcyVelocityComponent
    variable = velocity_y
    component = y
  [../]
[]

[ICs]
  [./massfrac0]
    type = ConstantIC
    variable = massfrac0
    value = 0
  [../]
[]

[BCs]
  [./top]
    type = DirichletBC
    value = 0
    variable = massfrac0
    boundary = top
  [../]
  [./bottom]
    type = DirichletBC
    value = 1
    variable = massfrac0
    boundary = bottom
  [../]
  [./ptop]
    type = DirichletBC
    variable = pp
    boundary =  top
    value = 1e6
  [../]
  [./pbottom]
    type = DirichletBC
    variable = pp
    boundary = bottom
    value = 1.002e6
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./adv0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
  [../]
  [./diff0]
    type = PorousFlowDispersiveFlux
    fluid_component = 0
    variable = pp
    disp_trans = 0
    disp_long = 0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = massfrac0
  [../]
  [./adv1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = massfrac0
  [../]
  [./diff1]
    type = PorousFlowDispersiveFlux
    fluid_component = 1
    variable = massfrac0
    disp_trans = 0
    disp_long = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp massfrac0&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = massfrac0
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./poro_fracture]
    type = PorousFlowPorosityConst
    porosity = 1.0    # this is the true porosity of the fracture
    block = &#x27;fracture&#x27;
  [../]
  [./poro_matrix]
    type = PorousFlowPorosityConst
    porosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./diff1]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 1.0
    block = &#x27;fracture&#x27;
  [../]
  [./diff2]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./relp]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./permeability1]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;3e-8 0 0 0 3e-8 0 0 0 3e-8&#x27; # this is the true permeability of the fracture
    block = &#x27;fracture&#x27;
  [../]
  [./permeability2]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-20 0 0 0 1e-20 0 0 0 1e-20&#x27;
    block = &#x27;matrix1 matrix2&#x27;
  [../]
[]

[Functions]
  [./dt_controller]
     type = PiecewiseConstant
     x = &#x27;0    30   40 100 200 83200&#x27;
     y = &#x27;0.01 0.1  1  10  100 32&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./mumps_is_best_for_parallel_jobs]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
  [./basic]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2             &#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 86400
  #dt = 0.01

  [./TimeStepper]
    type = FunctionDT
    function = dt_controller
  [../]

# controls for nonlinear iterations
  nl_max_its = 15
  nl_rel_tol = 1e-14
  nl_abs_tol = 1e-9
[]


[VectorPostprocessors]
  [./xmass]
    type = LineValueSampler
    start_point = &#x27;0.4 0 0&#x27;
    end_point = &#x27;0.5 0 0&#x27;
    sort_by = x
    num_points = 167
    variable = massfrac0
  [../]
[]

[Outputs]
  perf_graph = true
  console = true
  csv = true
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="bd4371cd-6d8a-44fb-baf4-01daf859e44d"><div class="modal-content"><h4>modules/phase_field/test/tests/misc/equal_gradient_lagrange.i</h4><pre class="moose-pre"><code class="language-text">#
# This test demonstrates an InterfaceKernel set that can enforce the componentwise
# continuity of the gradient of a variable using the Lagrange multiplier method.
#

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 20
    ny = 10
    ymax = 0.5
  []
  [./box1]
    type = SubdomainBoundingBoxGenerator
    block_id = 1
    bottom_left = &#x27;0 0 0&#x27;
    top_right = &#x27;0.51 1 0&#x27;
    input = gen
  [../]
  [./box2]
    type = SubdomainBoundingBoxGenerator
    block_id = 2
    bottom_left = &#x27;0.49 0 0&#x27;
    top_right = &#x27;1 1 0&#x27;
    input = box1
  [../]
  [./iface_u]
    type = SideSetsBetweenSubdomainsGenerator
    primary_block = 1
    paired_block = 2
    new_boundary = 10
    input = box2
  [../]
[]

[Variables]
  [./u2]
    block = 1
    [./InitialCondition]
      type = FunctionIC
      function = &#x27;r:=sqrt((x-0.4)^2+(y-0.5)^2);if(r&lt;0.05,5,1)&#x27;
    [../]
  [../]
  [./v2]
    block = 2
    initial_condition = 0.8
  [../]
  [./lambda]
  [../]
[]

[Kernels]
  [./u2_diff]
    type = Diffusion
    variable = u2
    block = 1
  [../]
  [./u2_dt]
    type = TimeDerivative
    variable = u2
    block = 1
  [../]
  [./v2_diff]
    type = Diffusion
    variable = v2
    block = 2
  [../]
  [./v2_dt]
    type = TimeDerivative
    variable = v2
    block = 2
  [../]
  [./lambda]
    type = NullKernel
    variable = lambda
  [../]
[]

[InterfaceKernels]
  [./iface]
    type = InterfaceDiffusionBoundaryTerm
    boundary = 10
    variable = u2
    neighbor_var = v2
  [../]
  [./lambda]
    type = EqualGradientLagrangeMultiplier
    variable = lambda
    boundary = 10
    element_var = u2
    neighbor_var = v2
    component = 0
  [../]
  [./constraint]
    type = EqualGradientLagrangeInterface
    boundary = 10
    lambda = lambda
    variable = u2
    neighbor_var = v2
    component = 0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[VectorPostprocessors]
  [./uv]
    type = LineValueSampler
    variable = &#x27;u2 v2&#x27;
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    sort_by = x
    num_points = 100
  [../]
[]

[Executioner]
  type = Transient

  petsc_options_iname = &#x27;-pctype -sub_pc_type -sub_pc_factor_shift_type -pc_factor_shift_type&#x27;
  petsc_options_value = &#x27; asm    lu          nonzero                    nonzero&#x27;

  dt = 0.002
  num_steps = 10
[]

[Outputs]
  exodus = true
  csv = true
  hide = lambda
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ae78ed6b-5c52-452d-827f-cd4dccdba0a5"><div class="modal-content"><h4>modules/porous_flow/test/tests/pressure_pulse/pressure_pulse_1d_2phasePS_KT.i</h4><pre class="moose-pre"><code class="language-text"># Pressure pulse in 1D with 2 phases, 2components - transient
# Using KT stabilization

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = 0
  xmax = 100
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./ppwater]
    initial_condition = 2e6
  [../]
  [./sgas]
    initial_condition = 0.3
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
  [./ppgas]
    family = MONOMIAL
    order = FIRST
  [../]
[]

[Kernels]
  [./mass_component0]
    type = PorousFlowMassTimeDerivative
    variable = ppwater
    fluid_component = 0
  [../]
  [./flux_component0_phase0]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = ppwater
    advective_flux_calculator = afc_component0_phase0
  [../]
  [./flux_component0_phase1]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = ppwater
    advective_flux_calculator = afc_component0_phase1
  [../]
  [./mass_component1]
    type = PorousFlowMassTimeDerivative
    variable = sgas
    fluid_component = 1
  [../]
  [./flux_component1_phase0]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = sgas
    advective_flux_calculator = afc_component1_phase0
  [../]
  [./flux_component1_phase1]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = sgas
    advective_flux_calculator = afc_component1_phase1
  [../]
[]

[AuxKernels]
  [./ppgas]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = ppgas
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater sgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 1e5
  [../]
  [./afc_component0_phase0]
    type = PorousFlowAdvectiveFluxCalculatorUnsaturatedMultiComponent
    fluid_component = 0
    phase = 0
    flux_limiter_type = superbee
  [../]
  [./afc_component0_phase1]
    type = PorousFlowAdvectiveFluxCalculatorUnsaturatedMultiComponent
    fluid_component = 0
    phase = 1
    flux_limiter_type = superbee
  [../]
  [./afc_component1_phase0]
    type = PorousFlowAdvectiveFluxCalculatorUnsaturatedMultiComponent
    fluid_component = 1
    phase = 0
    flux_limiter_type = superbee
  [../]
  [./afc_component1_phase1]
    type = PorousFlowAdvectiveFluxCalculatorUnsaturatedMultiComponent
    fluid_component = 1
    phase = 1
    flux_limiter_type = superbee
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      density0 = 1
      thermal_expansion = 0
      viscosity = 1e-5
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = ppwater
    phase1_saturation = sgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-15 0 0 0 1e-15 0 0 0 1e-15&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[BCs]
  [./leftwater]
    type = DirichletBC
    boundary = left
    value = 3e6
    variable = ppwater
  [../]
  [./rightwater]
    type = DirichletBC
    boundary = right
    value = 2e6
    variable = ppwater
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-20 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1e3
  end_time = 1e4
[]

[VectorPostprocessors]
  [./pp]
    type = LineValueSampler
    sort_by = x
    variable = &#x27;ppwater ppgas&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;100 0 0&#x27;
    num_points = 11
  [../]
[]

[Outputs]
  file_base = pressure_pulse_1d_2phasePS_KT
  print_linear_residuals = false
  [./csv]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f7a78099-c6f3-46c0-b322-169779444811"><div class="modal-content"><h4>modules/porous_flow/test/tests/capillary_pressure/vangenuchten1.i</h4><pre class="moose-pre"><code class="language-text"># Test van Genuchten relative permeability curve by varying saturation over the mesh
# van Genuchten exponent m = 0.5 for both phases
# No residual saturation in either phase

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 500
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./p0]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 0
    variable = p0aux
  [../]
  [./p1]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = p1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    alpha = 1e-5
    m = 0.5
    sat_lr = 0.1
    log_extension = false
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityVG
    phase = 0
    m = 0.5
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 2
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux p0aux p1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 500
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-6
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a18b7e1a-7516-4cb5-8261-d3299f777bf4"><div class="modal-content"><h4>modules/porous_flow/test/tests/buckley_leverett/bl01.i</h4><pre class="moose-pre"><code class="language-text"># Buckley-Leverett 1-phase.
# The front starts at (around) x=5, and at t=50 it should
# have moved to x=9.6.  The version below has a nonzero
# suction function, and at t=50, the front sits between
# (about) x=9.6 and x=9.9.  Changing the van-Genuchten
# al parameter to 1E-4 softens the front so it sits between
# (about) x=9.7 and x=10.4, and the simulation runs much faster.
# With al=1E-2 and nx=600, the front sits between x=9.6 and x=9.8,
# but takes about 100 times longer to run.

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 150
  xmin = 0
  xmax = 15
[]

[GlobalParams]
  PorousFlowDictator = dictator
  compute_enthalpy = false
  compute_internal_energy = false
[]

[Variables]
  [./pp]
    [./InitialCondition]
      type = FunctionIC
      function = &#x27;max((1000000-x/5*1000000)-20000,-20000)&#x27;
    [../]
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
    gravity = &#x27;0 0 0&#x27;
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = pp
    boundary = left
    value = 980000
  [../]
[]

[AuxVariables]
  [./sat]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./sat]
    type = MaterialStdVectorAux
    variable = sat
    execute_on = timestep_end
    index = 0
    property = PorousFlow_saturation_qp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e6
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-10 0 0  0 1E-10 0  0 0 1E-10&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.15
  [../]
[]

[Preconditioning]
  active = andy
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres bjacobi 1E-10 1E-10 20&#x27;
  [../]
[]

[Functions]
  [./timestepper]
    type = PiecewiseLinear
    x = &#x27;0    0.01 0.1 1   1.5 2   20  30  40  50&#x27;
    y = &#x27;0.01 0.1  0.2 0.3 0.1 0.3 0.3 0.4 0.4 0.5&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 50
  [./TimeStepper]
    type = FunctionDT
    function = timestepper
  [../]
[]

[VectorPostprocessors]
  [./pp]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;15 0 0&#x27;
    num_points = 150
    sort_by = x
    variable = pp
  [../]
  [./sat]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;15 0 0&#x27;
    num_points = 150
    sort_by = x
    variable = sat
  [../]
[]


[Outputs]
  file_base = bl01
  [./csv]
    type = CSV
    sync_only = true
    sync_times = &#x27;0.01 50&#x27;
  [../]
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4e683781-f278-41f3-9cf6-b564335597aa"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/wli02.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 50
  ny = 1
  xmin = -1000
  xmax = 0
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureBW
    Sn = 0.0
    Ss = 1.0
    C = 1.5
    las = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 4
      density0 = 10
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityBW
    Sn = 0.0
    Ss = 1.0
    Kn = 0
    Ks = 1
    C = 1.5
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 1 0  0 0 1&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = -1E-4
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-0.1 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./base]
    type = DirichletBC
    boundary = &#x27;left&#x27;
    value = -1E-4
    variable = pressure
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;-1000 0 0&#x27;
    end_point = &#x27;0 0 0&#x27;
    sort_by = x
    num_points = 71
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 100
  dt = 5
[]

[Outputs]
  file_base = wli02
  sync_times = &#x27;100 500 1000&#x27;
  [./exodus]
    type = Exodus
    sync_only = true
  [../]
  [./along_line]
    type = CSV
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="61154197-27c8-481c-8b64-55d00fb4af9d"><div class="modal-content"><h4>modules/porous_flow/test/tests/numerical_diffusion/pffltvd.i</h4><pre class="moose-pre"><code class="language-text"># Using flux-limited TVD advection ala Kuzmin and Turek, employing PorousFlow Kernels and UserObjects, with superbee flux-limiter
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer]
  [../]
[]

[ICs]
  [./porepressure]
    type = FunctionIC
    variable = porepressure
    function = &#x27;1 - x&#x27;
  [../]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = tracer
  [../]
  [./flux0]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = advective_flux_calculator_0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = porepressure
  [../]
  [./flux1]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = porepressure
    advective_flux_calculator = advective_flux_calculator_1
  [../]
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1
    boundary = left
  [../]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_component_1]
    type = PorousFlowPiecewiseLinearSink
    variable = porepressure
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 1
    use_mobility = true
    flux_function = 1E3
  [../]
  [./remove_component_0]
    type = PorousFlowPiecewiseLinearSink
    variable = tracer
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 0
    use_mobility = true
    flux_function = 1E3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      thermal_expansion = 0
      viscosity = 1.0
      density0 = 1000.0
    [../]
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure tracer&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
  [../]
  [./advective_flux_calculator_0]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 0
  [../]
  [./advective_flux_calculator_1]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 1
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = tracer
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = the_simple_fluid
    phase = 0
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-2 0 0   0 1E-2 0   0 0 1E-2&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8cf232ef-e41a-498b-b878-c174ffc3c163"><div class="modal-content"><h4>modules/combined/examples/publications/rapid_dev/fig7b.i</h4><pre class="moose-pre"><code class="language-text">#
# Fig. 7 input for 10.1016/j.commatsci.2017.02.017
# D. Schwen et al./Computational Materials Science 132 (2017) 36-45
# Dashed black curve (2)
# Eigenstrain is globally applied. Single global elastic free energies.
# Supply the RADIUS parameter (10-35) on the command line to generate data
# for all curves in the plot.
#

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 32
  xmin = 0
  xmax = 100
  second_order = true
[]

[Problem]
  coord_type = RSPHERICAL
[]

[GlobalParams]
  displacements = &#x27;disp_r&#x27;
[]

[Functions]
  [./diff]
    type = ParsedFunction
    value = &#x27;${RADIUS}-pos_c&#x27;
    vars = pos_c
    vals = pos_c
  [../]
[]

# AuxVars to compute the free energy density for outputting
[AuxVariables]
  [./local_energy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./cross_energy]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./local_free_energy]
    type = TotalFreeEnergy
    variable = local_energy
    interfacial_vars = &#x27;c&#x27;
    kappa_names = &#x27;kappa_c&#x27;
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  [../]
[]

[Variables]
  # Solute concentration variable
  [./c]
    [./InitialCondition]
      type = SmoothCircleIC
      invalue = 1
      outvalue = 0
      x1 = 0
      y1 = 0
      radius = ${RADIUS}
      int_width = 3
    [../]
  [../]
  [./w]
  [../]

  # Phase order parameter
  [./eta]
    [./InitialCondition]
      type = SmoothCircleIC
      invalue = 1
      outvalue = 0
      x1 = 0
      y1 = 0
      radius = ${RADIUS}
      int_width = 3
    [../]
  [../]

  [./Fe_fit]
    order = SECOND
  [../]
[]

[Modules/TensorMechanics/Master/all]
  add_variables = true
  eigenstrain_names = eigenstrain
[]

[Kernels]
  # Split Cahn-Hilliard kernels
  [./c_res]
    type = SplitCHParsed
    variable = c
    f_name = F
    args = &#x27;eta&#x27;
    kappa_name = kappa_c
    w = w
  [../]
  [./wres]
    type = SplitCHWRes
    variable = w
    mob_name = M
  [../]
  [./time]
    type = CoupledTimeDerivative
    variable = w
    v = c
  [../]

  # Allen-Cahn and Lagrange-multiplier constraint kernels for order parameter 1
  [./detadt]
    type = TimeDerivative
    variable = eta
  [../]
  [./ACBulk1]
    type = AllenCahn
    variable = eta
    args = &#x27;c&#x27;
    mob_name = L
    f_name = F
  [../]
  [./ACInterface]
    type = ACInterface
    variable = eta
    mob_name = L
    kappa_name = kappa_eta
  [../]

  [./Fe]
    type = MaterialPropertyValue
    prop_name = Fe
    variable = Fe_fit
  [../]

  [./autoadjust]
    type = MaskedBodyForce
    variable = w
    function = diff
    mask = mask
  [../]
[]

[Materials]
  # declare a few constants, such as mobilities (L,M) and interface gradient prefactors (kappa*)
  [./consts]
    type = GenericConstantMaterial
    prop_names  = &#x27;M   L   kappa_c kappa_eta&#x27;
    prop_values = &#x27;1.0 1.0 0.5     1&#x27;
  [../]

  # forcing function mask
  [./mask]
    type = ParsedMaterial
    f_name = mask
    function = grad/dt
    material_property_names = &#x27;grad dt&#x27;
  [../]
  [./grad]
    type = VariableGradientMaterial
    variable = c
    prop = grad
  [../]
  [./time]
    type = TimeStepMaterial
  [../]

  # global mechanical properties
  [./elasticity_tensor]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1&#x27;
    fill_method = symmetric_isotropic
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]

  # eigenstrain as a function of phase
  [./eigenstrain]
    type = ComputeVariableEigenstrain
    eigen_base = &#x27;0.05 0.05 0.05 0 0 0&#x27;
    prefactor = h
    args = eta
    eigenstrain_name = eigenstrain
  [../]

  # switching functions
  [./switching]
    type = SwitchingFunctionMaterial
    function_name = h
    eta = eta
    h_order = SIMPLE
  [../]
  [./barrier]
    type = BarrierFunctionMaterial
    eta = eta
  [../]

  # chemical free energies
  [./chemical_free_energy_1]
    type = DerivativeParsedMaterial
    f_name = Fc1
    function = &#x27;c^2&#x27;
    args = &#x27;c&#x27;
    derivative_order = 2
  [../]
  [./chemical_free_energy_2]
    type = DerivativeParsedMaterial
    f_name = Fc2
    function = &#x27;(1-c)^2&#x27;
    args = &#x27;c&#x27;
    derivative_order = 2
  [../]

  # global chemical free energy
  [./chemical_free_energy]
    type = DerivativeTwoPhaseMaterial
    f_name = Fc
    fa_name = Fc1
    fb_name = Fc2
    eta = eta
    args = &#x27;c&#x27;
    W = 4
  [../]

  # global elastic free energy
  [./elastic_free_energy]
    type = ElasticEnergyMaterial
    f_name = Fe
    args = &#x27;eta&#x27;
    output_properties = Fe
    derivative_order = 2
  [../]

  # free energy
  [./free_energy]
    type = DerivativeSumMaterial
    f_name = F
    sum_materials = &#x27;Fc Fe&#x27;
    args = &#x27;c eta&#x27;
    derivative_order = 2
  [../]
[]

[BCs]
  [./left_r]
    type = DirichletBC
    variable = disp_r
    boundary = &#x27;left&#x27;
    value = 0
  [../]
[]

[Preconditioning]
  [./SMP]
    type = SMP
    full = true
  [../]
[]

# We monitor the total free energy and the total solute concentration (should be constant)
[Postprocessors]
  [./total_free_energy]
    type = ElementIntegralVariablePostprocessor
    variable = local_energy
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
  [./total_solute]
    type = ElementIntegralVariablePostprocessor
    variable = c
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
  [./pos_c]
    type = FindValueOnLine
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;100 0 0&#x27;
    v = c
    target = 0.582
    tol = 1e-8
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
  [./pos_eta]
    type = FindValueOnLine
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;100 0 0&#x27;
    v = eta
    target = 0.5
    tol = 1e-8
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
  [./c_min]
    type = ElementExtremeValue
    value_type = min
    variable = c
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
[]

[VectorPostprocessors]
  [./line]
    type = LineValueSampler
    variable = &#x27;Fe_fit c w&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point =   &#x27;100 0 0&#x27;
    num_points = 5000
    sort_by = x
    outputs = vpp
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  [../]
[]

[Executioner]
  type = Transient
  scheme = bdf2

  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -sub_pc_type&#x27;
  petsc_options_value = &#x27;asm      lu&#x27;

  l_max_its = 30
  nl_max_its = 15
  l_tol = 1.0e-4
  nl_rel_tol = 1.0e-8
  nl_abs_tol = 2.0e-9
  start_time = 0.0
  end_time = 100000.0

  [./TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 8
    iteration_window = 1
    dt = 1
  [../]

  [./Adaptivity]
    initial_adaptivity = 5
    interval = 10
    max_h_level = 5
    refine_fraction = 0.9
    coarsen_fraction = 0.1
  [../]
[]

[Outputs]
  print_linear_residuals = false
  perf_graph = true
  execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  [./table]
    type = CSV
    delimiter = &#x27; &#x27;
    file_base = radius_${RADIUS}/eigenstrain_pp
  [../]
  [./vpp]
    type = CSV
    delimiter = &#x27; &#x27;
    sync_times = &#x27;10 50 100 500 1000 5000 10000 50000 100000&#x27;
    sync_only = true
    time_data = true
    file_base = radius_${RADIUS}/eigenstrain_vpp
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f88ffcf3-a038-44e5-97c4-289fb054454d"><div class="modal-content"><h4>modules/porous_flow/test/tests/numerical_diffusion/fltvd_no_antidiffusion.i</h4><pre class="moose-pre"><code class="language-text"># Using Flux-Limited TVD Advection ala Kuzmin and Turek, but without any antidiffusion
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[Variables]
  [./tracer]
  [../]
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = MassLumpedTimeDerivative
    variable = tracer
  [../]
  [./flux]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo
  [../]
[]

[UserObjects]
  [./fluo]
    type = AdvectiveFluxCalculatorConstantVelocity
    flux_limiter_type = none
    u = tracer
    velocity = &#x27;0.1 0 0&#x27;
  [../]
[]

[BCs]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_tracer]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = right
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-1
  nl_abs_tol = 1E-8
  nl_max_its = 500
  timestep_tolerance = 1E-3
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f9d0f2ff-6e50-471e-ae6d-9a038ddbae21"><div class="modal-content"><h4>modules/porous_flow/test/tests/thm_rehbinder/fixed_outer.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 40
    nt = 16
    rmin = 0.1
    rmax = 1
    dmin = 0.0
    dmax = 90
    growth_r = 1.1
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    bottom_sideset = bottom
    top_sideset = top
    extrusion_vector = &#x27;0 0 1&#x27;
    num_layers = 1
  [../]
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  biot_coefficient = 1.0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
  [./temperature]
  [../]
[]

[BCs]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = dmin
  [../]
  [./xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = dmax
  [../]

  [./cavity_temperature]
    type = DirichletBC
    variable = temperature
    value = 1000
    boundary = rmin
  [../]
  [./cavity_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = rmin
  [../]
  [./cavity_zero_effective_stress_x]
    type = Pressure
    component = 0
    variable = disp_x
    function = 1E6
    boundary = rmin
    use_displaced_mesh = false
  [../]
  [./cavity_zero_effective_stress_y]
    type = Pressure
    component = 1
    variable = disp_y
    function = 1E6
    boundary = rmin
    use_displaced_mesh = false
  [../]

  [./outer_temperature]
    type = DirichletBC
    variable = temperature
    value = 0
    boundary = rmax
  [../]
  [./outer_pressure]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = rmax
  [../]
  [./fixed_outer_x]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = rmax
  [../]
  [./fixed_outer_y]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = rmax
  [../]
[]

[AuxVariables]
  [./stress_rr]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_pp]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./stress_rr]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_rr
    scalar_type = RadialStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
  [./stress_pp]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_pp
    scalar_type = HoopStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 1E12
      viscosity = 1.0E-3
      density0 = 1000.0
      cv = 1000.0
      cp = 1000.0
      porepressure_coefficient = 0.0
    [../]
  [../]
[]

[PorousFlowBasicTHM]
  coupling_type = ThermoHydroMechanical
  multiply_by_density = false
  add_stress_aux = true
  porepressure = porepressure
  temperature = temperature
  eigenstrain_names = thermal_contribution
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 1E10
    poissons_ratio = 0.2
  [../]
  [./strain]
    type = ComputeSmallStrain
    eigenstrain_names = thermal_contribution
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = temperature
    thermal_expansion_coeff = 1E-6
    eigenstrain_name = thermal_contribution
    stress_free_temperature = 0.0
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is ever used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    solid_bulk_compliance = 1E-10
    fluid_bulk_modulus = 1E12
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0   0 1E-12 0   0 0 1E-12&#x27;
  [../]
  [./thermal_expansion]
    type = PorousFlowConstantThermalExpansionCoefficient
    fluid_coefficient = 1E-6
    drained_coefficient = 1E-6
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;1E6 0 0  0 1E6 0  0 0 1E6&#x27;
  [../]
[]

[VectorPostprocessors]
  [./P]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = porepressure
  [../]
  [./T]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = temperature
  [../]
  [./U]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = disp_x
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_rtol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           1E-8&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  file_base = fixed_outer
  execute_on = timestep_end
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a8684886-8d09-4004-ac0a-4a5d816c3f57"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rsc02.i</h4><pre class="moose-pre"><code class="language-text"># RSC test with low-res time and spatial resolution
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 200
  ny = 1
  xmin = 0
  xmax = 10 # x is the depth variable, called zeta in RSC
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;3E-2 5E-1 8E-1&#x27;
    x = &#x27;0 1 5&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pwater poil&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureRSC
    oil_viscosity = 2E-3
    scale_ratio = 2E3
    shift = 10
  [../]
[]

[Modules]
  [./FluidProperties]
    [./water]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 10
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
    [./oil]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 20
      thermal_expansion = 0
      viscosity = 2e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePP
    phase0_porepressure = pwater
    phase1_porepressure = poil
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./water]
    type = PorousFlowSingleComponentFluid
    fp = water
    phase = 0
    compute_enthalpy = false
    compute_internal_energy = false
  [../]
  [./oil]
    type = PorousFlowSingleComponentFluid
    fp = oil
    phase = 1
    compute_enthalpy = false
    compute_internal_energy = false
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_oil]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-5 0 0  0 1E-5 0  0 0 1E-5&#x27;
  [../]
[]

[Variables]
  [./pwater]
  [../]
  [./poil]
  [../]
[]

[ICs]
  [./water_init]
    type = ConstantIC
    variable = pwater
    value = 0
  [../]
  [./oil_init]
    type = ConstantIC
    variable = poil
    value = 15
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pwater
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = poil
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = poil
  [../]
[]


[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./SOil]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
[]


[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
  [./SOil]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 1
    variable = SOil
  [../]
[]


[BCs]
# we are pumping water into a system that has virtually incompressible fluids, hence the pressures rise enormously.  this adversely affects convergence because of almost-overflows and precision-loss problems.  The fixed things help keep pressures low and so prevent these awful behaviours.   the movement of the saturation front is the same regardless of the fixed things.
  active = &#x27;recharge fixedoil fixedwater&#x27;
  [./recharge]
    type = PorousFlowSink
    variable = pwater
    boundary = &#x27;left&#x27;
    flux_function = -1.0
  [../]
  [./fixedwater]
    type = DirichletBC
    variable = pwater
    boundary = &#x27;right&#x27;
    value = 0
  [../]
  [./fixedoil]
    type = DirichletBC
    variable = poil
    boundary = &#x27;right&#x27;
    value = 15
  [../]
[]



[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;7 0 0&#x27;
    sort_by = x
    num_points = 21
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 5
  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rsc02
  [./along_line]
    type = CSV
    execute_vector_postprocessors_on = final
  [../]
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="494e1a95-b338-45f8-b021-3566a1fa128d"><div class="modal-content"><h4>modules/porous_flow/examples/flow_through_fractured_media/coarse.i</h4><pre class="moose-pre"><code class="language-text"># Flow and solute transport along a fracture embedded in a porous matrix
# The fracture is represented by lower dimensional elements
# fracture aperture = 6e-4m
# fracture porosity = 6e-4m = phi * a
# fracture permeability = 1.8e-11 which is based on k=3e-8 from a**2/12, and k*a = 3e-8*6e-4
# matrix porosity = 0.1
# matrix permeanility = 1e-20

[Mesh]
  type = FileMesh
  file = &#x27;coarse.e&#x27;
  block_id = &#x27;1 2 3&#x27;
  block_name = &#x27;fracture matrix1 matrix2&#x27;

  boundary_id = &#x27;1 2&#x27;
  boundary_name = &#x27;bottom top&#x27;
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./pp]
  [../]
  [./massfrac0]
  [../]
[]

[AuxVariables]
  [./velocity_x]
    family = MONOMIAL
    order = CONSTANT
    block = &#x27;fracture&#x27;
  [../]
  [./velocity_y]
    family = MONOMIAL
    order = CONSTANT
    block = &#x27;fracture&#x27;
  [../]
[]

[AuxKernels]
  [./velocity_x]
    type = PorousFlowDarcyVelocityComponentLowerDimensional
    variable = velocity_x
    component = x
    aperture = 6E-4
  [../]
  [./velocity_y]
    type = PorousFlowDarcyVelocityComponentLowerDimensional
    variable = velocity_y
    component = y
    aperture = 6E-4
  [../]
[]

[ICs]
  [./massfrac0]
    type = ConstantIC
    variable = massfrac0
    value = 0
  [../]
  [./pp_matrix]
    type = ConstantIC
    variable = pp
    value = 1E6
  [../]
[]

[BCs]
  [./top]
    type = DirichletBC
    value = 0
    variable = massfrac0
    boundary = top
  [../]
  [./bottom]
    type = DirichletBC
    value = 1
    variable = massfrac0
    boundary = bottom
  [../]
  [./ptop]
    type = DirichletBC
    variable = pp
    boundary =  top
    value = 1e6
  [../]
  [./pbottom]
    type = DirichletBC
    variable = pp
    boundary = bottom
    value = 1.002e6
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = pp
  [../]
  [./adv0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = pp
  [../]
  [./diff0]
    type = PorousFlowDispersiveFlux
    fluid_component = 1
    variable = pp
    disp_trans = 0
    disp_long = 0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = massfrac0
  [../]
  [./adv1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = massfrac0
  [../]
  [./diff1]
    type = PorousFlowDispersiveFlux
    fluid_component = 0
    variable = massfrac0
    disp_trans = 0
    disp_long = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp massfrac0&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = massfrac0
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./poro_fracture]
    type = PorousFlowPorosityConst
    porosity = 6e-4   # = a * phif
    block = &#x27;fracture&#x27;
  [../]
  [./poro_matrix]
    type = PorousFlowPorosityConst
    porosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./diff1]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 1.0
    block = &#x27;fracture&#x27;
  [../]
  [./diff2]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./permeability_fracture]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.8e-11 0 0 0 1.8e-11 0 0 0 1.8e-11&#x27;   # 1.8e-11 = a * kf
    block = &#x27;fracture&#x27;
  [../]
  [./permeability_matrix]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-20 0 0 0 1e-20 0 0 0 1e-20&#x27;
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./relp]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
[]

[Preconditioning]
  [./basic]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 10
  dt = 1

# controls for nonlinear iterations
  nl_max_its = 15
  nl_rel_tol = 1e-14
  nl_abs_tol = 1e-12

[]

[VectorPostprocessors]
  [./xmass]
    type = LineValueSampler
    start_point = &#x27;-0.5 0 0&#x27;
    end_point = &#x27;0.5 0 0&#x27;
    sort_by = x
    num_points = 41
    variable = massfrac0
    outputs = csv
  [../]
[]

[Outputs]
  [./csv]
    type = CSV
    execute_on = &#x27;final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d03da413-974c-4808-8e4e-da086b76f7c9"><div class="modal-content"><h4>modules/porous_flow/test/tests/capillary_pressure/vangenuchten3.i</h4><pre class="moose-pre"><code class="language-text"># Test van Genuchten relative permeability curve by varying saturation over the mesh
# van Genuchten exponent m = 0.5 for both phases
# No residual saturation in either phase

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 500
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./p0]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 0
    variable = p0aux
  [../]
  [./p1]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = p1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    alpha = 1e-5
    m = 0.5
    sat_lr = 0.1
    s_scale = 0.8
    log_extension = false
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityVG
    phase = 0
    m = 0.5
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 2
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux p0aux p1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 500
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-6
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="eca73e22-fad1-4d49-b64e-db2f1c5eef22"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rd02.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 120
  ny = 1
  xmin = 0
  xmax = 6
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1 10 500 5000 50000&#x27;
    x = &#x27;0 10 100 1000 10000 500000&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.336
    alpha = 1.43e-4
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      viscosity = 1.01e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityVG
    m = 0.336
    seff_turnover = 0.99
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.33
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.295E-12 0 0  0 0.295E-12 0  0 0 0.295E-12&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = 0.0
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-10 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./base]
    type = DirichletBC
    boundary = left
    value = 0.0
    variable = pressure
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;6 0 0&#x27;
    sort_by = x
    num_points = 121
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 345600

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rd02
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
  [./along_line]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a8221984-1183-47a8-80d0-feee0f36e74f"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_1D_adaptivity.i</h4><pre class="moose-pre"><code class="language-text"># Using Flux-Limited TVD Advection ala Kuzmin and Turek, with antidiffusion from superbee flux limiting
# 1D version with mesh adaptivity
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = 0
  xmax = 1
[]

[Adaptivity]
  initial_steps = 1
  initial_marker = tracer_marker
  marker = tracer_marker
  max_h_level = 1
  [./Markers]
    [./tracer_marker]
      type = ValueRangeMarker
      variable = tracer
      lower_bound = 0.02
      upper_bound = 0.98
    [../]
  [../]
[]

[Variables]
  [./tracer]
  [../]
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = MassLumpedTimeDerivative
    variable = tracer
  [../]
  [./flux]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo
  [../]
[]

[UserObjects]
  [./fluo]
    type = AdvectiveFluxCalculatorConstantVelocity
    flux_limiter_type = superbee
    u = tracer
    velocity = &#x27;0.1 0 0&#x27;
  [../]
[]

[BCs]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_tracer]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = right
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  nl_max_its = 500
  timestep_tolerance = 1E-3
[]

[Outputs]
  print_linear_residuals = false
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9135d7de-7539-4d99-92a0-92a0332ccc9b"><div class="modal-content"><h4>modules/porous_flow/test/tests/relperm/corey1.i</h4><pre class="moose-pre"><code class="language-text"># Test Corey relative permeability curve by varying saturation over the mesh
# Corey exponent n = 1 for both phases (linear residual saturation)
# No residual saturation in either phase

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./kr0]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 0
    variable = kr0aux
  [../]
  [./kr1]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 1
    variable = kr1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityCorey
    phase = 0
    n = 1
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 1
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux kr0aux kr1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 20
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-8
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="af9e8f03-581a-4d25-ba70-cad208513ffa"><div class="modal-content"><h4>modules/porous_flow/test/tests/numerical_diffusion/fully_saturated_action.i</h4><pre class="moose-pre"><code class="language-text"># Using the fully-saturated action, which does mass lumping but no upwinding
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer]
  [../]
[]

[ICs]
  [./porepressure]
    type = FunctionIC
    variable = porepressure
    function = &#x27;1 - x&#x27;
  [../]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[PorousFlowFullySaturated]
  porepressure = porepressure
  coupling_type = Hydro
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
  mass_fraction_vars = tracer
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1
    boundary = left
  [../]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_component_1]
    type = PorousFlowPiecewiseLinearSink
    variable = porepressure
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 1
    use_mobility = true
    flux_function = 1E3
  [../]
  [./remove_component_0]
    type = PorousFlowPiecewiseLinearSink
    variable = tracer
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 0
    use_mobility = true
    flux_function = 1E3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      viscosity = 1.0
      density0 = 1000.0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-2 0 0   0 1E-2 0   0 0 1E-2&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-1
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="72e700ae-d350-4adb-bd2d-014fef31cfc2"><div class="modal-content"><h4>modules/level_set/test/tests/kernels/advection/advection_mms.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 1
  xmin = 0
  xmax = 12
  nx = 48
[]

[Adaptivity]
  steps = 5
  marker = marker
  [./Markers]
    [./marker]
      type = UniformMarker
      mark = REFINE
    [../]
  [../]
[]

[Variables]
  [./phi]
  [../]
[]

[AuxVariables]
  [./velocity]
    family = LAGRANGE_VEC
  [../]
[]

[ICs]
  [./vel_ic]
    type = VectorFunctionIC
    variable = velocity
    function = velocity_func
  []
[]

[BCs]
  [./left]
    type = FunctionDirichletBC
    boundary = &#x27;left&#x27;
    function = phi_exact
    variable = phi
  [../]
[]

[Functions]
  [./phi_exact]
    type = ParsedFunction
    value = &#x27;a*sin(pi*x/b)*cos(pi*x)&#x27;
    vars = &#x27;a b&#x27;
    vals = &#x27;2 12&#x27;
  [../]
  [./phi_mms]
    type = ParsedFunction
    value = &#x27;-2*pi*a*sin(pi*x)*sin(pi*x/b) + 2*pi*a*cos(pi*x)*cos(pi*x/b)/b&#x27;
    vars = &#x27;a b&#x27;
    vals = &#x27;2 12&#x27;
  [../]
  [./velocity_func]
    type = ParsedVectorFunction
    value_x = &#x27;2&#x27;
    value_y = &#x27;2&#x27;
  [../]
[]

[Kernels]
  [./phi_advection]
    type = LevelSetAdvection
    variable = phi
    velocity = velocity
  [../]
  [./phi_forcing]
    type = BodyForce
    variable = phi
    function = phi_mms
  [../]
[]

[Postprocessors]
  [./error]
    type = ElementL2Error
    function = phi_exact
    variable = phi
  [../]
  [./h]
    type = AverageElementSize
  [../]
[]

[VectorPostprocessors]
  active = &#x27;&#x27;
  [./results]
    type = LineValueSampler
    variable = phi
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;12 0 0&#x27;
    num_points = 500
    sort_by = x
  [../]
[]

[Executioner]
  type = Steady
  nl_rel_tol = 1e-10
  solve_type = NEWTON
  # A steady-state pure advection problem is numerically challenging,
  # it has a zero diagonal in the Jabocian matrix. The following solver
  # settings seem to reliably solve this problem.
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist&#x27;
[]

[Outputs]
  execute_on = &#x27;TIMESTEP_END&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b7c2ab76-25c2-4f17-b31d-ad8d48cd7d70"><div class="modal-content"><h4>modules/porous_flow/examples/thm_example/2D.i</h4><pre class="moose-pre"><code class="language-text"># Two phase, temperature-dependent, with mechanics, radial with fine mesh, constant injection of cold co2 into a overburden-reservoir-underburden containing mostly water
# species=0 is water
# species=1 is co2
# phase=0 is liquid, and since massfrac_ph0_sp0 = 1, this is all water
# phase=1 is gas, and since massfrac_ph1_sp0 = 0, this is all co2
#
# The mesh used below has very high resolution, so the simulation takes a long time to complete.
# Some suggested meshes of different resolution:
# nx=50, bias_x=1.2
# nx=100, bias_x=1.1
# nx=200, bias_x=1.05
# nx=400, bias_x=1.02
# nx=1000, bias_x=1.01
# nx=2000, bias_x=1.003
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2000
  bias_x = 1.003
  xmin = 0.1
  xmax = 5000
  ny = 1
  ymin = 0
  ymax = 11
[]

[Problem]
  coord_type = RZ
[]

[GlobalParams]
  displacements = &#x27;disp_r disp_z&#x27;
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
  biot_coefficient = 1.0
[]

[Variables]
  [./pwater]
    initial_condition = 18.3e6
  [../]
  [./sgas]
    initial_condition = 0.0
  [../]
  [./temp]
    initial_condition = 358
  [../]
  [./disp_r]
  [../]
[]

[AuxVariables]
  [./rate]
  [../]
  [./disp_z]
  [../]
  [./massfrac_ph0_sp0]
    initial_condition = 1 # all H20 in phase=0
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0 # no H2O in phase=1
  [../]
  [./pgas]
    family = MONOMIAL
    order = FIRST
  [../]
  [./swater]
    family = MONOMIAL
    order = FIRST
  [../]
  [./stress_rr]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_tt]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./stress_zz]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[Kernels]
  [./mass_water_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./flux_water]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    use_displaced_mesh = false
    variable = pwater
  [../]
  [./mass_co2_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    use_displaced_mesh = false
    variable = sgas
  [../]
  [./flux_co2]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    use_displaced_mesh = false
    variable = sgas
  [../]
  [./energy_dot]
    type = PorousFlowEnergyTimeDerivative
    use_displaced_mesh = false
    variable = temp
  [../]
  [./advection]
    type = PorousFlowHeatAdvection
    use_displaced_mesh = false
    variable = temp
  [../]
  [./conduction]
    type = PorousFlowExponentialDecay
    use_displaced_mesh = false
    variable = temp
    reference = 358
    rate = rate
  [../]
  [./grad_stress_r]
    type = StressDivergenceRZTensors
    temperature = temp
    eigenstrain_names = thermal_contribution
    variable = disp_r
    use_displaced_mesh = false
    component = 0
  [../]
  [./poro_r]
    type = PorousFlowEffectiveStressCoupling
    variable = disp_r
    use_displaced_mesh = false
    component = 0
  [../]
[]

[AuxKernels]
  [./rate]
    type = FunctionAux
    variable = rate
    execute_on = timestep_begin
    function = decay_rate
  [../]
  [./pgas]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = pgas
  [../]
  [./swater]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = swater
  [../]
  [./stress_rr]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_rr
    index_i = 0
    index_j = 0
  [../]
  [./stress_tt]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_tt
    index_i = 2
    index_j = 2
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 1
    index_j = 1
  [../]
[]

[Functions]
  [./decay_rate]
# Eqn(26) of the first paper of LaForce et al.
# Ka * (rho C)_a = 10056886.914
# h = 11
    type = ParsedFunction
    value = &#x27;sqrt(10056886.914/t)/11.0&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;temp pwater sgas disp_r&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Modules]
  [./FluidProperties]
    [./water]
      type = SimpleFluidProperties
      bulk_modulus = 2.27e14
      density0 = 970.0
      viscosity = 0.3394e-3
      cv = 4149.0
      cp = 4149.0
      porepressure_coefficient = 0.0
      thermal_expansion = 0
    [../]
    [./co2]
      type = SimpleFluidProperties
      bulk_modulus = 2.27e14
      density0 = 516.48
      viscosity = 0.0393e-3
      cv = 2920.5
      cp = 2920.5
      porepressure_coefficient = 0.0
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = temp
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = pwater
    phase1_saturation = sgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./water]
    type = PorousFlowSingleComponentFluid
    fp = water
    phase = 0
  [../]
  [./gas]
    type = PorousFlowSingleComponentFluid
    fp = co2
    phase = 1
  [../]
  [./porosity_reservoir]
    type = PorousFlowPorosityConst
    porosity = 0.2
  [../]
  [./permeability_reservoir]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;2e-12 0 0  0 0 0  0 0 0&#x27;
  [../]
  [./relperm_liquid]
    type = PorousFlowRelativePermeabilityCorey
    n = 4
    phase = 0
    s_res = 0.200
    sum_s_res = 0.405
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityBC
    phase = 1
    s_res = 0.205
    sum_s_res = 0.405
    nw_phase = true
    lambda = 2
  [../]
  [./thermal_conductivity_reservoir]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;0 0 0  0 1.320 0  0 0 0&#x27;
    wet_thermal_conductivity = &#x27;0 0 0  0 3.083 0  0 0 0&#x27;
  [../]
  [./internal_energy_reservoir]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 1100
    density = 2350.0
  [../]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    shear_modulus = 6.0E9
    poissons_ratio = 0.2
  [../]
  [./strain]
    type = ComputeAxisymmetricRZSmallStrain
    eigenstrain_names = &#x27;thermal_contribution ini_stress&#x27;
  [../]
  [./ini_strain]
    type = ComputeEigenstrainFromInitialStress
    initial_stress = &#x27;-12.8E6 0 0  0 -51.3E6 0  0 0 -12.8E6&#x27;
    eigenstrain_name = ini_stress
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = temp
    stress_free_temperature = 358
    thermal_expansion_coeff = 5E-6
    eigenstrain_name = thermal_contribution
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./eff_fluid_pressure]
    type = PorousFlowEffectiveFluidPressure
  [../]
  [./vol_strain]
    type = PorousFlowVolumetricStrain
  [../]
[]

[BCs]
  [./outer_pressure_fixed]
    type = DirichletBC
    boundary = right
    value = 18.3e6
    variable = pwater
  [../]
  [./outer_saturation_fixed]
    type = DirichletBC
    boundary = right
    value = 0.0
    variable = sgas
  [../]
  [./outer_temp_fixed]
    type = DirichletBC
    boundary = right
    value = 358
    variable = temp
  [../]
  [./fixed_outer_r]
    type = DirichletBC
    variable = disp_r
    value = 0
    boundary = right
  [../]
  [./co2_injection]
    type = PorousFlowSink
    boundary = left
    variable = sgas
    use_mobility = false
    use_relperm = false
    fluid_phase = 1
    flux_function = &#x27;min(t/100.0,1)*(-2.294001475)&#x27; # 5.0E5 T/year = 15.855 kg/s, over area of 2Pi*0.1*11
  [../]
  [./cold_co2]
    type = DirichletBC
    boundary = left
    variable = temp
    value = 294
  [../]
  [./cavity_pressure_x]
    type = Pressure
    boundary = left
    variable = disp_r
    component = 0
    postprocessor = p_bh # note, this lags
    use_displaced_mesh = false
  [../]
[]

[Postprocessors]
  [./p_bh]
    type = PointValue
    variable = pwater
    point = &#x27;0.1 0 0&#x27;
    execute_on = timestep_begin
    use_displaced_mesh = false
  [../]
[]

[VectorPostprocessors]
  [./ptsuss]
    type = LineValueSampler
    use_displaced_mesh = false
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;5000 0 0&#x27;
    sort_by = x
    num_points = 50000
    outputs = csv
    variable = &#x27;pwater temp sgas disp_r stress_rr stress_tt&#x27;
  [../]
[]

[Preconditioning]
  active = &#x27;mumps&#x27;
  [./smp]
    type = SMP
    full = true
    #petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E2       1E-5        500&#x27;
  [../]
  [./mumps]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -pc_factor_mat_solver_package -pc_factor_shift_type -snes_rtol -snes_atol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      lu       mumps                         NONZERO               1E-5       1E2       50&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 1.5768e8
  #dtmax = 1e6
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
    growth_factor = 1.1
  [../]
[]

[Outputs]
  print_linear_residuals = false
  sync_times = &#x27;3600 86400 2.592E6 1.5768E8&#x27;
  perf_graph = true
  exodus = true
  [./csv]
    type = CSV
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ee5ea807-b2e0-425a-86f1-603bd72fd92a"><div class="modal-content"><h4>modules/porous_flow/test/tests/newton_cooling/nc06.i</h4><pre class="moose-pre"><code class="language-text"># Newton cooling from a bar.  1-phase and heat, steady
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 100
  ny = 1
  xmin = 0
  xmax = 100
  ymin = 0
  ymax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pressure temp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Variables]
  [./pressure]
  [../]
  [./temp]
  [../]
[]

[ICs]
  # have to start these reasonably close to their steady-state values
  [./pressure]
    type = FunctionIC
    variable = pressure
    function = &#x27;(2-x/100)*1E6&#x27;
  [../]
  [./temperature]
    type = FunctionIC
    variable = temp
    function = 100+0.1*x
  [../]
[]

[Kernels]
  [./flux]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    gravity = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
  [./heat_advection]
    type = PorousFlowHeatAdvection
    gravity = &#x27;0 0 0&#x27;
    variable = temp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1e6
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
      cv = 1e6
      porepressure_coefficient = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = temp
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-15 0 0 0 1E-15 0 0 0 1E-15&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey # irrelevant in this fully-saturated situation
    n = 2
    phase = 0
  [../]
[]

[BCs]
  [./leftp]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 2E6
  [../]
  [./leftt]
    type = DirichletBC
    variable = temp
    boundary = left
    value = 100
  [../]
  [./newtonp]
    type = PorousFlowPiecewiseLinearSink
    variable = pressure
    boundary = right
    pt_vals = &#x27;0 100000 200000 300000 400000 500000 600000 700000 800000 900000 1000000 1100000 1200000 1300000 1400000 1500000 1600000 1700000 1800000 1900000 2000000&#x27;
    multipliers = &#x27;0. 5.6677197748570516e-6 0.000011931518841831313 0.00001885408740732065 0.000026504708864284114 0.000034959953203725676 0.000044304443352900224 0.00005463170211001232 0.00006604508815181467 0.00007865883048198513 0.00009259917167338928 0.00010800563134618119 0.00012503240252705603 0.00014384989486488752 0.00016464644014777016 0.00018763017719085535 0.0002130311349595711 0.00024110353477682344 0.00027212833465544285 0.00030641604122040985 0.00034430981736352295&#x27;
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 1
  [../]
  [./newton]
    type = PorousFlowPiecewiseLinearSink
    variable = temp
    boundary = right
    pt_vals = &#x27;0 100000 200000 300000 400000 500000 600000 700000 800000 900000 1000000 1100000 1200000 1300000 1400000 1500000 1600000 1700000 1800000 1900000 2000000&#x27;
    multipliers = &#x27;0. 5.6677197748570516e-6 0.000011931518841831313 0.00001885408740732065 0.000026504708864284114 0.000034959953203725676 0.000044304443352900224 0.00005463170211001232 0.00006604508815181467 0.00007865883048198513 0.00009259917167338928 0.00010800563134618119 0.00012503240252705603 0.00014384989486488752 0.00016464644014777016 0.00018763017719085535 0.0002130311349595711 0.00024110353477682344 0.00027212833465544285 0.00030641604122040985 0.00034430981736352295&#x27;
    use_mobility = false
    use_relperm = false
    use_internal_energy = true
    fluid_phase = 0
    flux_function = 1
  [../]
[]

[VectorPostprocessors]
  [./porepressure]
    type = LineValueSampler
    variable = pressure
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;100 0.5 0&#x27;
    sort_by = x
    num_points = 11
    execute_on = timestep_end
  [../]
  [./temperature]
    type = LineValueSampler
    variable = temp
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;100 0.5 0&#x27;
    sort_by = x
    num_points = 11
    execute_on = timestep_end
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol &#x27;
    petsc_options_value = &#x27;gmres asm lu 100 NONZERO 2 1E-8 1E-15&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  file_base = nc06
  execute_on = timestep_end
  exodus = true
  [./along_line]
    type = CSV
    execute_vector_postprocessors_on = timestep_end
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="bb44dfa9-06f1-478a-8503-75bb30acbd89"><div class="modal-content"><h4>modules/phase_field/examples/multiphase/GrandPotential3Phase.i</h4><pre class="moose-pre"><code class="language-text"># This is an example of implementation of the multi-phase, multi-order parameter
# grand potential based phase-field model described in Phys. Rev. E, 98, 023309
# (2019). It includes 3 phases with 1 grain of each phase. This example was used
# to generate the results shown in Fig. 3 of the paper.

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 60
  xmin = -15
  xmax = 15
[]

[Variables]
  [./w]
  [../]
  [./etaa0]
  [../]
  [./etab0]
  [../]
  [./etad0]
  [../]
[]

[ICs]
  [./IC_etaa0]
    type = FunctionIC
    variable = etaa0
    function = ic_func_etaa0
  [../]
  [./IC_etab0]
    type = FunctionIC
    variable = etab0
    function = ic_func_etab0
  [../]
  [./IC_etad0]
    type = ConstantIC
    variable = etad0
    value = 0.1
  [../]
  [./IC_w]
    type = FunctionIC
    variable = w
    function = ic_func_w
  [../]
[]

[Functions]
  [./ic_func_etaa0]
    type = ParsedFunction
    value = &#x27;0.9*0.5*(1.0-tanh((x)/sqrt(2.0)))&#x27;
  [../]
  [./ic_func_etab0]
    type = ParsedFunction
    value = &#x27;0.9*0.5*(1.0+tanh((x)/sqrt(2.0)))&#x27;
  [../]
  [./ic_func_w]
    type = ParsedFunction
    value = 0
  [../]
[]

[Kernels]
# Order parameter eta_alpha0
  [./ACa0_bulk]
    type = ACGrGrMulti
    variable = etaa0
    v =           &#x27;etab0 etad0&#x27;
    gamma_names = &#x27;gab   gad&#x27;
  [../]
  [./ACa0_sw]
    type = ACSwitching
    variable = etaa0
    Fj_names  = &#x27;omegaa omegab omegad&#x27;
    hj_names  = &#x27;ha     hb     hd&#x27;
    args = &#x27;etab0 etad0 w&#x27;
  [../]
  [./ACa0_int]
    type = ACInterface
    variable = etaa0
    kappa_name = kappa
  [../]
  [./ea0_dot]
    type = TimeDerivative
    variable = etaa0
  [../]
# Order parameter eta_beta0
  [./ACb0_bulk]
    type = ACGrGrMulti
    variable = etab0
    v =           &#x27;etaa0 etad0&#x27;
    gamma_names = &#x27;gab   gbd&#x27;
  [../]
  [./ACb0_sw]
    type = ACSwitching
    variable = etab0
    Fj_names  = &#x27;omegaa omegab omegad&#x27;
    hj_names  = &#x27;ha     hb     hd&#x27;
    args = &#x27;etaa0 etad0 w&#x27;
  [../]
  [./ACb0_int]
    type = ACInterface
    variable = etab0
    kappa_name = kappa
  [../]
  [./eb0_dot]
    type = TimeDerivative
    variable = etab0
  [../]
# Order parameter eta_delta0
  [./ACd0_bulk]
    type = ACGrGrMulti
    variable = etad0
    v =           &#x27;etaa0 etab0&#x27;
    gamma_names = &#x27;gad   gbd&#x27;
  [../]
  [./ACd0_sw]
    type = ACSwitching
    variable = etad0
    Fj_names  = &#x27;omegaa omegab omegad&#x27;
    hj_names  = &#x27;ha     hb     hd&#x27;
    args = &#x27;etaa0 etab0 w&#x27;
  [../]
  [./ACd0_int]
    type = ACInterface
    variable = etad0
    kappa_name = kappa
  [../]
  [./ed0_dot]
    type = TimeDerivative
    variable = etad0
  [../]
#Chemical potential
  [./w_dot]
    type = SusceptibilityTimeDerivative
    variable = w
    f_name = chi
    args = &#x27;etaa0 etab0 etad0&#x27;
  [../]
  [./Diffusion]
    type = MatDiffusion
    variable = w
    diffusivity = Dchi
    args = &#x27;&#x27;
  [../]
  [./coupled_etaa0dot]
    type = CoupledSwitchingTimeDerivative
    variable = w
    v = etaa0
    Fj_names = &#x27;rhoa rhob rhod&#x27;
    hj_names = &#x27;ha   hb   hd&#x27;
    args = &#x27;etaa0 etab0 etad0&#x27;
  [../]
  [./coupled_etab0dot]
    type = CoupledSwitchingTimeDerivative
    variable = w
    v = etab0
    Fj_names = &#x27;rhoa rhob rhod&#x27;
    hj_names = &#x27;ha   hb   hd&#x27;
    args = &#x27;etaa0 etab0 etad0&#x27;
  [../]
  [./coupled_etad0dot]
    type = CoupledSwitchingTimeDerivative
    variable = w
    v = etad0
    Fj_names = &#x27;rhoa rhob rhod&#x27;
    hj_names = &#x27;ha   hb   hd&#x27;
    args = &#x27;etaa0 etab0 etad0&#x27;
  [../]
[]

[Materials]
  [./ha_test]
    type = SwitchingFunctionMultiPhaseMaterial
    h_name = ha
    all_etas = &#x27;etaa0 etab0 etad0&#x27;
    phase_etas = &#x27;etaa0&#x27;
  [../]
  [./hb_test]
    type = SwitchingFunctionMultiPhaseMaterial
    h_name = hb
    all_etas = &#x27;etaa0 etab0 etad0&#x27;
    phase_etas = &#x27;etab0&#x27;
  [../]
  [./hd_test]
    type = SwitchingFunctionMultiPhaseMaterial
    h_name = hd
    all_etas = &#x27;etaa0 etab0 etad0&#x27;
    phase_etas = &#x27;etad0&#x27;
  [../]
  [./omegaa]
    type = DerivativeParsedMaterial
    args = &#x27;w&#x27;
    f_name = omegaa
    material_property_names = &#x27;Vm ka caeq&#x27;
    function = &#x27;-0.5*w^2/Vm^2/ka-w/Vm*caeq&#x27;
    derivative_order = 2
  [../]
  [./omegab]
    type = DerivativeParsedMaterial
    args = &#x27;w&#x27;
    f_name = omegab
    material_property_names = &#x27;Vm kb cbeq&#x27;
    function = &#x27;-0.5*w^2/Vm^2/kb-w/Vm*cbeq&#x27;
    derivative_order = 2
  [../]
  [./omegad]
    type = DerivativeParsedMaterial
    args = &#x27;w&#x27;
    f_name = omegad
    material_property_names = &#x27;Vm kd cdeq&#x27;
    function = &#x27;-0.5*w^2/Vm^2/kd-w/Vm*cdeq&#x27;
    derivative_order = 2
  [../]
  [./rhoa]
    type = DerivativeParsedMaterial
    args = &#x27;w&#x27;
    f_name = rhoa
    material_property_names = &#x27;Vm ka caeq&#x27;
    function = &#x27;w/Vm^2/ka + caeq/Vm&#x27;
    derivative_order = 2
  [../]
  [./rhob]
    type = DerivativeParsedMaterial
    args = &#x27;w&#x27;
    f_name = rhob
    material_property_names = &#x27;Vm kb cbeq&#x27;
    function = &#x27;w/Vm^2/kb + cbeq/Vm&#x27;
    derivative_order = 2
  [../]
  [./rhod]
    type = DerivativeParsedMaterial
    args = &#x27;w&#x27;
    f_name = rhod
    material_property_names = &#x27;Vm kd cdeq&#x27;
    function = &#x27;w/Vm^2/kd + cdeq/Vm&#x27;
    derivative_order = 2
  [../]
  [./c]
    type = ParsedMaterial
    material_property_names = &#x27;Vm rhoa rhob rhod ha hb hd&#x27;
    function = &#x27;Vm * (ha * rhoa + hb * rhob + hd * rhod)&#x27;
    f_name = c
  [../]
  [./const]
    type = GenericConstantMaterial
    prop_names =  &#x27;kappa_c  kappa   L   D    Vm   ka    caeq kb    cbeq  kd    cdeq  gab gad gbd  mu  tgrad_corr_mult&#x27;
    prop_values = &#x27;0        1       1.0 1.0  1.0  10.0  0.1  10.0  0.9   10.0  0.5   1.5 1.5 1.5  1.0 0.0&#x27;
  [../]
  [./Mobility]
    type = DerivativeParsedMaterial
    f_name = Dchi
    material_property_names = &#x27;D chi&#x27;
    function = &#x27;D*chi&#x27;
    derivative_order = 2
  [../]
  [./chi]
    type = DerivativeParsedMaterial
    f_name = chi
    material_property_names = &#x27;Vm ha(etaa0,etab0,etad0) ka hb(etaa0,etab0,etad0) kb hd(etaa0,etab0,etad0) kd&#x27;
    function = &#x27;(ha/ka + hb/kb + hd/kd) / Vm^2&#x27;
    args = &#x27;etaa0 etab0 etad0&#x27;
    derivative_order = 2
  [../]
[]

[Preconditioning]
  [./SMP]
    type = SMP
    full = true
  [../]
[]

[VectorPostprocessors]
  [./etaa0]
    type = LineValueSampler
    variable = etaa0
    start_point = &#x27;-15 0 0&#x27;
    end_point = &#x27;15 0 0&#x27;
    num_points = 61
    sort_by = x
    execute_on = &#x27;initial timestep_end final&#x27;
  [../]
  [./etab0]
    type = LineValueSampler
    variable = etab0
    start_point = &#x27;-15 0 0&#x27;
    end_point = &#x27;15 0 0&#x27;
    num_points = 61
    sort_by = x
    execute_on = &#x27;initial timestep_end final&#x27;
  [../]
  [./etad0]
    type = LineValueSampler
    variable = etad0
    start_point = &#x27;-15 0 0&#x27;
    end_point = &#x27;15 0 0&#x27;
    num_points = 61
    sort_by = x
    execute_on = &#x27;initial timestep_end final&#x27;
  [../]
[]

[Executioner]
  type = Transient
  nl_max_its = 15
  scheme = bdf2
  solve_type = PJFNK
  petsc_options_iname = -pc_type
  petsc_options_value = asm
  l_max_its = 15
  l_tol = 1.0e-3
  nl_rel_tol = 1.0e-8
  start_time = 0.0
  num_steps = 20
  nl_abs_tol = 1e-10
  dt = 1.0
[]

[Outputs]
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial timestep_end final&#x27;
    interval = 1
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;initial timestep_end final&#x27;
    interval = 1
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b1ce7165-cb41-434e-9d13-0664042cdb17"><div class="modal-content"><h4>modules/combined/test/tests/beam_eigenstrain_transfer/subapp_err_2.i</h4><pre class="moose-pre"><code class="language-text"># SubApp with 2D model to test multi app vectorpostprocessor to aux var transfer

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 5
  xmin = 0.0
  xmax = 0.5
  ymin = 0.0
  ymax = 0.150080
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[AuxVariables]
  [./temp]
  [../]
  [./axial_strain]
    order = FIRST
    family = MONOMIAL
  [../]
[]

[Functions]
  [./temperature_load]
    type = ParsedFunction
    value = t*(500.0)+300.0
  [../]
[]

[Modules]
  [./TensorMechanics]
    [./Master]
      [./all]
        strain = SMALL
        incremental = true
        add_variables = true
        eigenstrain_names = eigenstrain
      [../]
    [../]
  [../]
[]

[AuxKernels]
  [./tempfuncaux]
    type = FunctionAux
    variable = temp
    function = temperature_load
  [../]
  [./axial_strain]
    type = RankTwoAux
    variable = axial_strain
    rank_two_tensor = total_strain
    index_i = 1
    index_j = 1
    execute_on = timestep_end
  [../]
[]

[BCs]
  [./x_bot]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./y_bot]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
  [../]
  [./small_stress]
    type = ComputeFiniteStrainElasticStress
  [../]
  [./thermal_expansion_strain]
    type = ComputeThermalExpansionEigenstrain
    stress_free_temperature = 298
    thermal_expansion_coeff = 1.3e-5
    temperature = temp
    eigenstrain_name = eigenstrain
  [../]
[]

[Executioner]
  type = Transient

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;101&#x27;

  line_search = &#x27;none&#x27;

  l_max_its = 50
  nl_max_its = 50
  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-8
  l_tol = 1e-9

  start_time = 0.0
  end_time = 0.075
  dt = 0.0125
  dtmin = 0.0001
[]

[Outputs]
  csv = true
  exodus = true
[]

[VectorPostprocessors]
  [./axial_str]
    type = LineValueSampler
    start_point = &#x27;0.5 0.0 0.0&#x27;
    end_point = &#x27;0.5 0.150080 0.0&#x27;
    variable = &#x27;axial_strain axial_strain&#x27;
    num_points = 21
    sort_by = &#x27;y&#x27;
  [../]
[]

[Postprocessors]
  [./end_disp]
    type = PointValue
    variable = disp_y
    point = &#x27;0.5 0.150080 0.0&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5a6e2b77-9c09-436a-90da-563a4ce94276"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_1D.i</h4><pre class="moose-pre"><code class="language-text"># Using Flux-Limited TVD Advection ala Kuzmin and Turek, with antidiffusion from superbee flux limiting
# 1D version
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = 0
  xmax = 1
[]

[Variables]
  [./tracer]
  [../]
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = MassLumpedTimeDerivative
    variable = tracer
  [../]
  [./flux]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo
  [../]
[]

[UserObjects]
  [./fluo]
    type = AdvectiveFluxCalculatorConstantVelocity
    flux_limiter_type = superbee
    u = tracer
    velocity = &#x27;0.1 0 0&#x27;
  [../]
[]

[BCs]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_tracer]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = right
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  nl_max_its = 500
  timestep_tolerance = 1E-3
[]

[Outputs]
  print_linear_residuals = false
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="831a4a1d-7105-489e-b26e-d9cba87528bc"><div class="modal-content"><h4>modules/combined/examples/stochastic/graphite_ring_thermomechanics.i</h4><pre class="moose-pre"><code class="language-text"># Generate 1/4 of a 2-ring disk and extrude it by half to obtain
# 1/8 of a 3D tube.  Mirror boundary conditions will exist on the
# cut portions.

[Mesh]
  [disk]
    type = ConcentricCircleMeshGenerator
    num_sectors = 10
    radii = &#x27;1.0 1.1 1.2&#x27;
    rings = &#x27;1 1 1&#x27;
    has_outer_square = false
    preserve_volumes = false
    portion = top_right
  []
  [ring]
    type = BlockDeletionGenerator
    input = disk
    block_id = 1
    new_boundary = &#x27;inner&#x27;
  []
  [cylinder]
    type = MeshExtruderGenerator
    input = ring
    extrusion_vector = &#x27;0 0 1.5&#x27;
    num_layers = 15
    bottom_sideset = &#x27;back&#x27;
    top_sideset = &#x27;front&#x27;
  []
[]

[Variables]
  [T]
    initial_condition = 300
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[Kernels]
  [hc]
    type = HeatConduction
    variable = T
  []
  [TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  []
[]

[BCs]
  [temp_inner]
    type = FunctionNeumannBC
    variable = T
    boundary = &#x27;inner&#x27;
    function = surface_source
  []
  [temp_front]
    type = ConvectiveHeatFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    T_infinity = 300
    heat_transfer_coefficient = 10
  []
  [temp_outer]
    type = ConvectiveHeatFluxBC
    variable = T
    boundary = &#x27;outer&#x27;
    T_infinity = 300
    heat_transfer_coefficient = 10
  []
  # mirror boundary conditions.
  [disp_x]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;left&#x27;
    value = 0.0
  []
  [disp_y]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;bottom&#x27;
    value = 0.0
  []
  [disp_z]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0.0
  []
[]

[Materials]
  [cond_inner]
    type = GenericConstantMaterial
    block = 2
    prop_names = thermal_conductivity
    prop_values = 25
  []
  [cond_outer]
    type = GenericConstantMaterial
    block = 3
    prop_names = thermal_conductivity
    prop_values = 100
  []
  [elasticity_tensor_inner]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
    block = 2
  []
  [elasticity_tensor_outer]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 3.1e5
    poissons_ratio = 0.2
    block = 3
  []
  [thermal_strain_inner]
    type = ComputeThermalExpansionEigenstrain
    thermal_expansion_coeff = 2e-6
    temperature = T
    stress_free_temperature = 300
    eigenstrain_name = eigenstrain_inner
    block = 2
  []
  [thermal_strain_outer]
    type = ComputeThermalExpansionEigenstrain
    thermal_expansion_coeff = 1e-6
    temperature = T
    stress_free_temperature = 300
    eigenstrain_name = eigenstrain_outer
    block = 3
  []
  [strain_inner] #We use small deformation mechanics
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    eigenstrain_names = &#x27;eigenstrain_inner&#x27;
    block = 2
  []
  [strain_outer] #We use small deformation mechanics
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    eigenstrain_names = &#x27;eigenstrain_outer&#x27;
    block = 3
  []
  [stress] #We use linear elasticity
    type = ComputeLinearElasticStress
  []
[]

[Functions]
  [surface_source]
    type = ParsedFunction
    value = &#x27;Q_t*pi/2.0/3.0 * cos(pi/3.0*z)&#x27;
    vars = &#x27;Q_t&#x27;
    vals = heat_source
  []
[]

[Executioner]
  type = Steady

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;hypre boomeramg 101&#x27;

  l_max_its = 30
  nl_max_its = 100
  nl_abs_tol = 1e-9
  l_tol = 1e-04
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
  []
[]

[Controls]
  [stochastic]
    type = SamplerReceiver
  []
[]

[VectorPostprocessors]
  [temp_center]
    type = LineValueSampler
    variable = T
    start_point = &#x27;1 0 0&#x27;
    end_point = &#x27;1.2 0 0&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [temp_end]
    type = LineValueSampler
    variable = T
    start_point = &#x27;1 0 1.5&#x27;
    end_point = &#x27;1.2 0 1.5&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [dispx_center]
    type = LineValueSampler
    variable = disp_x
    start_point = &#x27;1 0 0&#x27;
    end_point = &#x27;1.2 0 0&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [dispx_end]
    type = LineValueSampler
    variable = disp_x
    start_point = &#x27;1 0 1.5&#x27;
    end_point = &#x27;1.2 0 1.5&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
  [dispz_end]
    type = LineValueSampler
    variable = disp_z
    start_point = &#x27;1 0 1.5&#x27;
    end_point = &#x27;1.2 0 1.5&#x27;
    num_points = 11
    sort_by = &#x27;x&#x27;
  []
[]

[Postprocessors]
  [heat_source]
    type = FunctionValuePostprocessor
    function = 1
    scale_factor = 10000
    execute_on = linear
  []
  [temp_center_inner]
    type = PointValue
    variable = T
    point = &#x27;1 0 0&#x27;
  []
  [temp_center_outer]
    type = PointValue
    variable = T
    point = &#x27;1.2 0 0&#x27;
  []
  [temp_end_inner]
    type = PointValue
    variable = T
    point = &#x27;1 0 1.5&#x27;
  []
  [temp_end_outer]
    type = PointValue
    variable = T
    point = &#x27;1.2 0 1.5&#x27;
  []
  [dispx_center_inner]
    type = PointValue
    variable = disp_x
    point = &#x27;1 0 0&#x27;
  []
  [dispx_center_outer]
    type = PointValue
    variable = disp_x
    point = &#x27;1.2 0 0&#x27;
  []
  [dispx_end_inner]
    type = PointValue
    variable = disp_x
    point = &#x27;1 0 1.5&#x27;
  []
  [dispx_end_outer]
    type = PointValue
    variable = disp_x
    point = &#x27;1.2 0 1.5&#x27;
  []
  [dispz_inner]
    type = PointValue
    variable = disp_z
    point = &#x27;1 0 1.5&#x27;
  []
  [dispz_outer]
    type = PointValue
    variable = disp_z
    point = &#x27;1.2 0 1.5&#x27;
  []
[]

[Outputs]
  exodus = false
  csv = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="11f9506e-07bd-4ac9-96d4-a41cb3ef0985"><div class="modal-content"><h4>modules/porous_flow/test/tests/relperm/corey4.i</h4><pre class="moose-pre"><code class="language-text"># Test Corey relative permeability curve by varying saturation over the mesh
# Residual saturation of phase 0: s0r = 0.2
# Residual saturation of phase 1: s1r = 0.3

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
    family = LAGRANGE
    order = FIRST
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./kr0]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 0
    variable = kr0aux
  [../]
  [./kr1]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 1
    variable = kr1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityCorey
    scaling = 0.1
    phase = 0
    n = 2
    s_res = 0.2
    sum_s_res = 0.5
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityCorey
    scaling = 10.0
    phase = 1
    n = 2
    s_res = 0.3
    sum_s_res = 0.5
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux kr0aux kr1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 20
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-8
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f12ef8d1-2b11-4d4c-b46b-60ff47f0da28"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_3D.i</h4><pre class="moose-pre"><code class="language-text"># Using Flux-Limited TVD Advection ala Kuzmin and Turek, with antidiffusion from superbee flux limiting
# 3D version
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 10
  xmin = 0
  xmax = 1
  ny = 4
  ymin = 0
  ymax = 0.5
  nz = 3
  zmin = 0
  zmax = 2
[]

[Variables]
  [./tracer]
  [../]
[]

[Problem]
  error_on_jacobian_nonzero_reallocation=true
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = MassLumpedTimeDerivative
    variable = tracer
  [../]
  [./flux]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo
  [../]
[]

[UserObjects]
  [./fluo]
    type = AdvectiveFluxCalculatorConstantVelocity
    flux_limiter_type = superbee
    u = tracer
    velocity = &#x27;0.1 0 0&#x27;
  [../]
[]

[BCs]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_tracer]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = right
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0.5 2&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  nl_max_its = 500
  timestep_tolerance = 1E-3
[]

[Outputs]
  print_linear_residuals = false
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="addd2fd8-9a93-4fa3-a174-a88c1f318001"><div class="modal-content"><h4>modules/porous_flow/test/tests/numerical_diffusion/fltvd_none.i</h4><pre class="moose-pre"><code class="language-text"># Using Flux-Limited TVD Advection ala Kuzmin and Turek
# No antidiffusion, so this is identical to full-upwinding
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[Variables]
  [./tracer]
  [../]
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = MassLumpedTimeDerivative
    variable = tracer
  [../]
  [./flux]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo
  [../]
[]

[UserObjects]
  [./fluo]
    type = AdvectiveFluxCalculator
    flux_limiter_type = none
    u = tracer
    velocity = &#x27;0.1 0 0&#x27;
  [../]
[]

[BCs]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_tracer]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = right
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-1
  nl_abs_tol = 1E-8
  nl_max_its = 500
  timestep_tolerance = 1E-3
[]

[Outputs]
  csv = true
  execute_on = final
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a1447153-49c4-4f0f-bf7e-11235cf5bd1f"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/bw01.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 400
  ny = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-5 1E-2 1E-2 1E-1&#x27;
    x = &#x27;0 1E-5 1 10&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureBW
    Sn = 0.0
    Ss = 1.0
    C = 1.5
    las = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 4
      density0 = 10
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityBW
    Sn = 0.0
    Ss = 1.0
    Kn = 0
    Ks = 1
    C = 1.5
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 1 0  0 0 1&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = -9E2
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-0.1 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./recharge]
    type = PorousFlowSink
    variable = pressure
    boundary = right
    flux_function = -1.25 # corresponds to Rstar being 0.5 because i have to multiply by density*porosity
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;-10 0 0&#x27;
    end_point = &#x27;10 0 0&#x27;
    sort_by = x
    num_points = 101
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 8

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bw01
  sync_times = &#x27;0.5 2 8&#x27;
  [./exodus]
    type = Exodus
    sync_only = true
  [../]
  [./along_line]
    type = CSV
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2fde0fed-a299-43a1-84b8-5a1da8d5a7cd"><div class="modal-content"><h4>modules/combined/examples/publications/rapid_dev/fig7a.i</h4><pre class="moose-pre"><code class="language-text">#
# Fig. 7 input for 10.1016/j.commatsci.2017.02.017
# D. Schwen et al./Computational Materials Science 132 (2017) 36-45
# Solid gray curve (1)
# Eigenstrain and elastic energies ar computed per phase and then interpolated.
# Supply the RADIUS parameter (10-35) on the command line to generate data
# for all curves in the plot.
#

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 32
  xmin = 0
  xmax = 100
  second_order = true
[]

[Problem]
  coord_type = RSPHERICAL
[]

[GlobalParams]
  displacements = &#x27;disp_r&#x27;
[]

[Functions]
  [./diff]
    type = ParsedFunction
    value = &#x27;${RADIUS}-pos_c&#x27;
    vars = pos_c
    vals = pos_c
  [../]
[]

# AuxVars to compute the free energy density for outputting
[AuxVariables]
  [./local_energy]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./cross_energy]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./local_free_energy]
    type = TotalFreeEnergy
    variable = local_energy
    interfacial_vars = &#x27;c&#x27;
    kappa_names = &#x27;kappa_c&#x27;
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  [../]
[]

[Variables]
  # Solute concentration variable
  [./c]
    [./InitialCondition]
      type = SmoothCircleIC
      invalue = 1
      outvalue = 0
      x1 = 0
      y1 = 0
      radius = ${RADIUS}
      int_width = 3
    [../]
  [../]
  [./w]
  [../]

  # Phase order parameter
  [./eta]
    [./InitialCondition]
      type = SmoothCircleIC
      invalue = 1
      outvalue = 0
      x1 = 0
      y1 = 0
      radius = ${RADIUS}
      int_width = 3
    [../]
  [../]

  # Mesh displacement
  [./disp_r]
    order = SECOND
  [../]

  [./Fe_fit]
    order = SECOND
  [../]
[]

[Kernels]
  # Set up stress divergence kernels
  [./TensorMechanics]
  [../]

  # Split Cahn-Hilliard kernels
  [./c_res]
    type = SplitCHParsed
    variable = c
    f_name = F
    args = &#x27;eta&#x27;
    kappa_name = kappa_c
    w = w
  [../]
  [./wres]
    type = SplitCHWRes
    variable = w
    mob_name = M
  [../]
  [./time]
    type = CoupledTimeDerivative
    variable = w
    v = c
  [../]

  # Allen-Cahn and Lagrange-multiplier constraint kernels for order parameter 1
  [./detadt]
    type = TimeDerivative
    variable = eta
  [../]
  [./ACBulk1]
    type = AllenCahn
    variable = eta
    args = &#x27;c&#x27;
    mob_name = L
    f_name = F
  [../]
  [./ACInterface]
    type = ACInterface
    variable = eta
    mob_name = L
    kappa_name = kappa_eta
  [../]

  [./Fe]
    type = MaterialPropertyValue
    prop_name = Fe
    variable = Fe_fit
  [../]

  [./autoadjust]
    type = MaskedBodyForce
    variable = w
    function = diff
    mask = mask
  [../]
[]

[Materials]
  # declare a few constants, such as mobilities (L,M) and interface gradient prefactors (kappa*)
  [./consts]
    type = GenericConstantMaterial
    prop_names  = &#x27;M   L   kappa_c kappa_eta&#x27;
    prop_values = &#x27;1.0 1.0 0.5     1&#x27;
  [../]

  # forcing function mask
  [./mask]
    type = ParsedMaterial
    f_name = mask
    function = grad/dt
    material_property_names = &#x27;grad dt&#x27;
  [../]
  [./grad]
    type = VariableGradientMaterial
    variable = c
    prop = grad
  [../]
  [./time]
    type = TimeStepMaterial
  [../]

  # global mechanical properties
  [./elasticity_tensor_1]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1&#x27;
    base_name = phase1
    fill_method = symmetric_isotropic
  [../]
  [./elasticity_tensor_2]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;1 1&#x27;
    base_name = phase2
    fill_method = symmetric_isotropic
  [../]
  [./strain_1]
    type = ComputeRSphericalSmallStrain
    base_name = phase1
  [../]
  [./strain_2]
    type = ComputeRSphericalSmallStrain
    base_name = phase2
    eigenstrain_names = eigenstrain
  [../]
  [./stress_1]
    type = ComputeLinearElasticStress
    base_name = phase1
  [../]
  [./stress_2]
    type = ComputeLinearElasticStress
    base_name = phase2
  [../]

  # eigenstrain per phase
  [./eigenstrain2]
    type = ComputeEigenstrain
    eigen_base = &#x27;0.05 0.05 0.05 0 0 0&#x27;
    base_name = phase2
    eigenstrain_name = eigenstrain
  [../]

  # switching functions
  [./switching]
    type = SwitchingFunctionMaterial
    function_name = h
    eta = eta
    h_order = SIMPLE
  [../]
  [./barrier]
    type = BarrierFunctionMaterial
    eta = eta
  [../]

  # chemical free energies
  [./chemical_free_energy_1]
    type = DerivativeParsedMaterial
    f_name = Fc1
    function = &#x27;c^2&#x27;
    args = &#x27;c&#x27;
    derivative_order = 2
  [../]
  [./chemical_free_energy_2]
    type = DerivativeParsedMaterial
    f_name = Fc2
    function = &#x27;(1-c)^2&#x27;
    args = &#x27;c&#x27;
    derivative_order = 2
  [../]

  # elastic free energies
  [./elastic_free_energy_1]
    type = ElasticEnergyMaterial
    f_name = Fe1
    args = &#x27;&#x27;
    base_name = phase1
    derivative_order = 2
  [../]
  [./elastic_free_energy_2]
    type = ElasticEnergyMaterial
    f_name = Fe2
    args = &#x27;&#x27;
    base_name = phase2
    derivative_order = 2
  [../]

  # per phase free energies
  [./free_energy_1]
    type = DerivativeSumMaterial
    f_name = F1
    sum_materials = &#x27;Fc1 Fe1&#x27;
    args = &#x27;c&#x27;
    derivative_order = 2
  [../]
  [./free_energy_2]
    type = DerivativeSumMaterial
    f_name = F2
    sum_materials = &#x27;Fc2 Fe2&#x27;
    args = &#x27;c&#x27;
    derivative_order = 2
  [../]

  # global chemical free energy
  [./global_free_energy]
    type = DerivativeTwoPhaseMaterial
    f_name = F
    fa_name = F1
    fb_name = F2
    eta = eta
    args = &#x27;c&#x27;
    W = 4
  [../]

  # global stress
  [./global_stress]
    type = TwoPhaseStressMaterial
    base_A = phase1
    base_B = phase2
  [../]

  [./elastic_free_energy]
    type = DerivativeTwoPhaseMaterial
    f_name = Fe
    fa_name = Fe1
    fb_name = Fe2
    eta = eta
    args = &#x27;c&#x27;
    W = 0
  [../]
[]

[BCs]
  [./left_r]
    type = DirichletBC
    variable = disp_r
    boundary = &#x27;left&#x27;
    value = 0
  [../]
[]

[Preconditioning]
  [./SMP]
    type = SMP
    full = true
  [../]
[]

# We monitor the total free energy and the total solute concentration (should be constant)
[Postprocessors]
  [./total_free_energy]
    type = ElementIntegralVariablePostprocessor
    variable = local_energy
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
  [./total_solute]
    type = ElementIntegralVariablePostprocessor
    variable = c
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
  [./pos_c]
    type = FindValueOnLine
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;100 0 0&#x27;
    v = c
    target = 0.582
    tol = 1e-8
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
  [./pos_eta]
    type = FindValueOnLine
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;100 0 0&#x27;
    v = eta
    target = 0.5
    tol = 1e-8
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
  [./c_min]
    type = ElementExtremeValue
    value_type = min
    variable = c
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
    outputs = &#x27;table console&#x27;
  [../]
[]

[VectorPostprocessors]
  [./line]
    type = LineValueSampler
    variable = &#x27;Fe_fit c w&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point =   &#x27;100 0 0&#x27;
    num_points = 5000
    sort_by = x
    outputs = vpp
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  [../]
[]

[Executioner]
  type = Transient
  scheme = bdf2

  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -sub_pc_type&#x27;
  petsc_options_value = &#x27;asm      lu&#x27;

  l_max_its = 30
  nl_max_its = 15
  l_tol = 1.0e-4
  nl_rel_tol = 1.0e-8
  nl_abs_tol = 2.0e-9
  start_time = 0.0
  end_time = 100000.0

  [./TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    iteration_window = 1
    dt = 1
  [../]

  [./Adaptivity]
    initial_adaptivity = 5
    interval = 10
    max_h_level = 5
    refine_fraction = 0.9
    coarsen_fraction = 0.1
  [../]
[]

[Outputs]
  print_linear_residuals = false
  perf_graph = true
  execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  [./table]
    type = CSV
    delimiter = &#x27; &#x27;
    file_base = radius_${RADIUS}/energy_pp
  [../]
  [./vpp]
    type = CSV
    delimiter = &#x27; &#x27;
    sync_times = &#x27;10 50 100 500 1000 5000 10000 50000 100000&#x27;
    sync_only = true
    time_data = true
    file_base = radius_${RADIUS}/energy_vpp
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6848ca7c-ce9a-419f-a95b-89634ec1c602"><div class="modal-content"><h4>test/tests/outputs/postprocessor_final/postprocessor_final.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = u
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 1 0&#x27;
    outputs = test
    num_points = 10
    sort_by = id
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 20
  dt = 0.1
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  [./test]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="22af57c4-e6d1-4f37-bc72-0328dc1cde92"><div class="modal-content"><h4>python/peacock/tests/common/time_data.i</h4><pre class="moose-pre"><code class="language-text">###############################################################
# The following tests that the CSV output object can include an
# additional .csv file that contains the time and timestep
# data from VectorPostprocessor object.
###############################################################


[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
  [./v]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./diff_v]
    type = Diffusion
    variable = v
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
  [./left_v]
    type = DirichletBC
    variable = v
    boundary = left
    value = 1
  [../]
  [./right_v]
    type = DirichletBC
    variable = v
    boundary = right
    value = 0
  [../]
[]

[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    variable = &#x27;u v&#x27;
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = id
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 20
  dt = 0.1
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  execute_on = &#x27;initial timestep_end&#x27;
  file_base = &#x27;time_data&#x27;
  [./out]
    type = CSV
    time_data = true
    interval = 2
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="81f758a9-8498-4e7c-b2c4-1364e722bda5"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rd03.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  file = gold/rd02.e
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;2E4 1E6&#x27;
    x = &#x27;0 1E6&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.336
    alpha = 1.43e-4
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      viscosity = 1.01e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityVG
    m = 0.336
    seff_turnover = 0.99
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.33
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.295E-12 0 0  0 0.295E-12 0  0 0 0.295E-12&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_from_file_timestep = LATEST
    initial_from_file_var = pressure
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-10 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./base]
    type = DirichletBC
    boundary = left
    value = 0.0
    variable = pressure
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;6 0 0&#x27;
    sort_by = x
    num_points = 121
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 8.2944E6

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rd03
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
  [./along_line]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d87485a7-7f90-410f-adb9-0484609df6a9"><div class="modal-content"><h4>modules/porous_flow/test/tests/relperm/unity.i</h4><pre class="moose-pre"><code class="language-text"># Test perfectly mobile relative permeability curve by varying saturation over the mesh

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./kr0]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 0
    variable = kr0aux
  [../]
  [./kr1]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 1
    variable = kr1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityConst
    phase = 1
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux kr0aux kr1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 20
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-8
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e7014603-6fff-4704-9d11-e8e18a8dbf66"><div class="modal-content"><h4>modules/porous_flow/test/tests/relperm/brooks_corey2.i</h4><pre class="moose-pre"><code class="language-text"># Test Brooks-Corey relative permeability curve by varying saturation over the mesh
# Exponent lambda = 2 for both phases
# Residual saturation of phase 0: s0r = 0.2
# Residual saturation of phase 1: s1r = 0.3

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./kr0]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 0
    variable = kr0aux
  [../]
  [./kr1]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 1
    variable = kr1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityBC
    phase = 0
    lambda = 2
    s_res = 0.2
    sum_s_res = 0.5
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityBC
    phase = 1
    lambda = 2
    nw_phase = true
    s_res = 0.3
    sum_s_res = 0.5
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux kr0aux kr1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 20
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-8
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="45e55890-1b4f-46e4-a29d-8917e84ef196"><div class="modal-content"><h4>python/peacock/tests/input_tab/InputTree/gold/simple_diffusion_vp.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [u]
  []
[]

[Kernels]
  [diff]
    type = Diffusion
    variable = u
  []
[]

[BCs]
  [left]
    type = DirichletBC
    variable = u
    boundary = &#x27;left&#x27;
    value = 0
  []
  [right]
    type = DirichletBC
    variable = u
    boundary = &#x27;right&#x27;
    value = 1
  []
[]

[Executioner]
  # Preconditioned JFNK (default)
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true
[]

[VectorPostprocessors]
  [foo]
    type = LineValueSampler
    num_points = 10
    end_point = &#x27;1 0 0&#x27;
    start_point = &#x27;0 0 0&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7f46a024-fb25-4b70-a9bb-bf44593fe248"><div class="modal-content"><h4>modules/porous_flow/test/tests/heat_advection/heat_advection_1d_KT.i</h4><pre class="moose-pre"><code class="language-text"># 1phase, heat advecting with a moving fluid
# Using the Kuzmin-Turek stabilization scheme
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 50
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./temp]
    initial_condition = 200
  [../]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = &#x27;1-x&#x27;
  [../]
[]

[BCs]
  [./pp0]
    type = DirichletBC
    variable = pp
    boundary = left
    value = 1
  [../]
  [./pp1]
    type = DirichletBC
    variable = pp
    boundary = right
    value = 0
  [../]
  [./spit_heat]
    type = DirichletBC
    variable = temp
    boundary = left
    value = 300
  [../]
  [./suck_heat]
    type = DirichletBC
    variable = temp
    boundary = right
    value = 200
  [../]
[]

[Kernels]
  [./mass_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./fluid_advection]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = pp
    advective_flux_calculator = fluid_advective_flux
  [../]
  [./energy_dot]
    type = PorousFlowEnergyTimeDerivative
    variable = temp
  [../]
  [./heat_advection]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = temp
    advective_flux_calculator = heat_advective_flux
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;temp pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.6
    alpha = 1.3
  [../]
  [./fluid_advective_flux]
    type = PorousFlowAdvectiveFluxCalculatorSaturated
    flux_limiter_type = superbee
  [../]
  [./heat_advective_flux]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedHeat
    flux_limiter_type = superbee
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 100
      density0 = 1000
      viscosity = 4.4
      thermal_expansion = 0
      cv = 2
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = temp
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.2
  [../]
  [./rock_heat]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 1.0
    density = 125
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.1 0 0 0 2 0 0 0 3&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./PS]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 0.01
  end_time = 0.6
[]

[VectorPostprocessors]
  [./T]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 51
    sort_by = x
    variable = temp
  [../]
[]

[Outputs]
  file_base = heat_advection_1d_KT
  [./csv]
    type = CSV
    sync_times = &#x27;0.1 0.6&#x27;
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8990e11e-4f69-49ec-a1e8-634ee61a9ff1"><div class="modal-content"><h4>test/tests/auxkernels/diffusion_flux/diffusion_flux.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh # Can generate simple lines, rectangles and rectangular prisms
  dim = 2 # Dimension of the mesh
  nx = 10 # Number of elements in the x direction
  ny = 10 # Number of elements in the y direction
  xmax = 1.0
  ymax = 1.0
[]

[Variables]
  [./T]
  [../]
[]

[AuxVariables]
  [./flux_x]
      order = FIRST
      family = MONOMIAL
  [../]
  [./flux_y]
      order = FIRST
      family = MONOMIAL
  [../]
[]

[Kernels]
  [./diff]
    type = MatDiffusionTest # A Laplacian operator
    variable = T
    prop_name = &#x27;thermal_conductivity&#x27;
  [../]
[]

[AuxKernels]
  [./flux_x]
    type = DiffusionFluxAux
    diffusivity = &#x27;thermal_conductivity&#x27;
    variable = flux_x
    diffusion_variable = T
    component = x
  [../]
  [./flux_y]
    type = DiffusionFluxAux
    diffusivity = &#x27;thermal_conductivity&#x27;
    variable = flux_y
    diffusion_variable = T
    component = y
  [../]
[]

[BCs]
  [./inlet]
    type = DirichletBC # Simple u=value BC
    variable = T
    boundary = left
    value = 4000 # K
  [../]
  [./outlet]
    type = DirichletBC
    variable = T
    boundary = right
    value = 400 # K
  [../]
[]

[Materials]
  [./k]
    type = GenericConstantMaterial
    prop_names = &#x27;thermal_conductivity&#x27;
    prop_values = &#x27;10&#x27; # in W/mK
  [../]
[]

[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    variable = &#x27;T flux_x flux_y&#x27;
    start_point = &#x27;0 0. 0&#x27;
    end_point = &#x27;1.0 0. 0&#x27;
    num_points = 11
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady # Steady state problem
  solve_type = PJFNK #Preconditioned Jacobian Free Newton Krylov
  nl_rel_tol = 1e-12
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27; #Matches with the values below
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true # Output Exodus format
  execute_on = &#x27;initial timestep_end&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6240d74b-965f-45bf-b9f5-85fe5b07241d"><div class="modal-content"><h4>modules/combined/examples/publications/rapid_dev/fig6.i</h4><pre class="moose-pre"><code class="language-text">#
# Fig. 6 input for 10.1016/j.commatsci.2017.02.017
# D. Schwen et al./Computational Materials Science 132 (2017) 36-45
# Three phase interface simulation demonstrating the interfacial stability
# w.r.t. formation of a tspurious third phase
#

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 120
  ny = 120
  nz = 0
  xmin = 0
  xmax = 40
  ymin = 0
  ymax = 40
  zmin = 0
  zmax = 0
  elem_type = QUAD4
[]

[Variables]
  # concentration
  [./c]
  [../]

  # order parameter 1
  [./eta1]
  [../]

  # order parameter 2
  [./eta2]
  [../]

  # order parameter 3
  [./eta3]
  [../]

  # phase concentration 1
  [./c1]
    initial_condition = 0.4
  [../]

  # phase concentration 2
  [./c2]
    initial_condition = 0.5
  [../]

  # phase concentration 3
  [./c3]
    initial_condition = 0.8
  [../]

  # Lagrange multiplier
  [./lambda]
    initial_condition = 0.0
  [../]
[]

[AuxVariables]
  [./T]
    [./InitialCondition]
      type = FunctionIC
      function = &#x27;x-10&#x27;
    [../]
  [../]
[]


[Functions]
  [./ic_func_eta1]
    type = ParsedFunction
    value = &#x27;0.5*(1.0+tanh((x-10)/sqrt(2.0))) * 0.5*(1.0+tanh((y-10)/sqrt(2.0)))&#x27;
  [../]
  [./ic_func_eta2]
    type = ParsedFunction
    value = &#x27;0.5*(1.0-tanh((x-10)/sqrt(2.0)))&#x27;
  [../]
  [./ic_func_eta3]
    type = ParsedFunction
    value = &#x27;1 - 0.5*(1.0-tanh((x-10)/sqrt(2.0)))
              - 0.5*(1.0+tanh((x-10)/sqrt(2.0))) * 0.5*(1.0+tanh((y-10)/sqrt(2.0)))&#x27;
  [../]
  [./ic_func_c]
    type = ParsedFunction
    value = &#x27;0.5 * 0.5*(1.0-tanh((x-10)/sqrt(2.0)))
              + 0.4 * 0.5*(1.0+tanh((x-10)/sqrt(2.0))) * 0.5*(1.0+tanh((y-10)/sqrt(2.0)))
              + 0.8 * (1 - 0.5*(1.0-tanh((x-10)/sqrt(2.0)))
                        - 0.5*(1.0+tanh((x-10)/sqrt(2.0))) * 0.5*(1.0+tanh((y-10)/sqrt(2.0))))&#x27;
  [../]
[]

[ICs]
  [./eta1]
    variable = eta1
    type = FunctionIC
    function = ic_func_eta1
  [../]
  [./eta2]
    variable = eta2
    type = FunctionIC
    function = ic_func_eta2
  [../]
  [./eta3]
    variable = eta3
    type = FunctionIC
    function = ic_func_eta3
  [../]
  [./c]
    variable = c
    type = FunctionIC
    function = ic_func_c
  [../]
[]

[Materials]
  # simple toy free energies
  [./f1]
    type = DerivativeParsedMaterial
    f_name = F1
    args = &#x27;c1&#x27;
    function = &#x27;20*(c1-0.4)^2&#x27;
  [../]
  [./f2]
    type = DerivativeParsedMaterial
    f_name = F2
    args = &#x27;c2 T&#x27;
    function = &#x27;20*(c2-0.5)^2 + 0.01*T&#x27;
  [../]
  [./f3]
    type = DerivativeParsedMaterial
    f_name = F3
    args = &#x27;c3&#x27;
    function = &#x27;20*(c3-0.8)^2&#x27;
  [../]

  # Switching functions for each phase
  # h1(eta1, eta2, eta3)
  [./h1]
    type = SwitchingFunction3PhaseMaterial
    eta_i = eta1
    eta_j = eta2
    eta_k = eta3
    f_name = h1
  [../]
  # h2(eta1, eta2, eta3)
  [./h2]
    type = SwitchingFunction3PhaseMaterial
    eta_i = eta2
    eta_j = eta3
    eta_k = eta1
    f_name = h2
  [../]
  # h3(eta1, eta2, eta3)
  [./h3]
    type = SwitchingFunction3PhaseMaterial
    eta_i = eta3
    eta_j = eta1
    eta_k = eta2
    f_name = h3
  [../]

  # Coefficients for diffusion equation
  [./Dh1]
    type = DerivativeParsedMaterial
    material_property_names = &#x27;D h1&#x27;
    function = D*h1
    f_name = Dh1
  [../]
  [./Dh2]
    type = DerivativeParsedMaterial
    material_property_names = &#x27;D h2&#x27;
    function = D*h2
    f_name = Dh2
  [../]
  [./Dh3]
    type = DerivativeParsedMaterial
    material_property_names = &#x27;D h3&#x27;
    function = D*h3
    f_name = Dh3
  [../]

  # Barrier functions for each phase
  [./g1]
    type = BarrierFunctionMaterial
    g_order = SIMPLE
    eta = eta1
    function_name = g1
  [../]
  [./g2]
    type = BarrierFunctionMaterial
    g_order = SIMPLE
    eta = eta2
    function_name = g2
  [../]
  [./g3]
    type = BarrierFunctionMaterial
    g_order = SIMPLE
    eta = eta3
    function_name = g3
  [../]

  # constant properties
  [./constants]
    type = GenericConstantMaterial
    prop_names  = &#x27;L   kappa  D&#x27;
    prop_values = &#x27;1.0 1.0    1&#x27;
  [../]
[]

[Kernels]
  #Kernels for diffusion equation
  [./diff_time]
    type = TimeDerivative
    variable = c
  [../]
  [./diff_c1]
    type = MatDiffusion
    variable = c
    diffusivity = Dh1
    v = c1
  [../]
  [./diff_c2]
    type = MatDiffusion
    variable = c
    diffusivity = Dh2
    v = c2
  [../]
  [./diff_c3]
    type = MatDiffusion
    variable = c
    diffusivity = Dh3
    v = c3
  [../]

  # Kernels for Allen-Cahn equation for eta1
  [./deta1dt]
    type = TimeDerivative
    variable = eta1
  [../]
  [./ACBulkF1]
    type = KKSMultiACBulkF
    variable  = eta1
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    gi_name   = g1
    eta_i     = eta1
    wi        = 1.0
    args      = &#x27;c1 c2 c3 eta2 eta3&#x27;
  [../]
  [./ACBulkC1]
    type = KKSMultiACBulkC
    variable  = eta1
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    cj_names  = &#x27;c1 c2 c3&#x27;
    eta_i     = eta1
    args      = &#x27;eta2 eta3&#x27;
  [../]
  [./ACInterface1]
    type = ACInterface
    variable = eta1
    kappa_name = kappa
  [../]
  [./multipler1]
    type = MatReaction
    variable = eta1
    v = lambda
    mob_name = L
  [../]

  # Kernels for Allen-Cahn equation for eta2
  [./deta2dt]
    type = TimeDerivative
    variable = eta2
  [../]
  [./ACBulkF2]
    type = KKSMultiACBulkF
    variable  = eta2
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    gi_name   = g2
    eta_i     = eta2
    wi        = 1.0
    args      = &#x27;c1 c2 c3 eta1 eta3&#x27;
  [../]
  [./ACBulkC2]
    type = KKSMultiACBulkC
    variable  = eta2
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    cj_names  = &#x27;c1 c2 c3&#x27;
    eta_i     = eta2
    args      = &#x27;eta1 eta3&#x27;
  [../]
  [./ACInterface2]
    type = ACInterface
    variable = eta2
    kappa_name = kappa
  [../]
  [./multipler2]
    type = MatReaction
    variable = eta2
    v = lambda
    mob_name = L
  [../]

  # Kernels for the Lagrange multiplier equation
  [./mult_lambda]
    type = MatReaction
    variable = lambda
    mob_name = 3
  [../]
  [./mult_ACBulkF_1]
    type = KKSMultiACBulkF
    variable  = lambda
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    gi_name   = g1
    eta_i     = eta1
    wi        = 1.0
    mob_name  = 1
    args      = &#x27;c1 c2 c3 eta2 eta3&#x27;
  [../]
  [./mult_ACBulkC_1]
    type = KKSMultiACBulkC
    variable  = lambda
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    cj_names  = &#x27;c1 c2 c3&#x27;
    eta_i     = eta1
    args      = &#x27;eta2 eta3&#x27;
    mob_name  = 1
  [../]
  [./mult_CoupledACint_1]
    type = SimpleCoupledACInterface
    variable = lambda
    v = eta1
    kappa_name = kappa
    mob_name = 1
  [../]
  [./mult_ACBulkF_2]
    type = KKSMultiACBulkF
    variable  = lambda
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    gi_name   = g2
    eta_i     = eta2
    wi        = 1.0
    mob_name  = 1
    args      = &#x27;c1 c2 c3 eta1 eta3&#x27;
  [../]
  [./mult_ACBulkC_2]
    type = KKSMultiACBulkC
    variable  = lambda
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    cj_names  = &#x27;c1 c2 c3&#x27;
    eta_i     = eta2
    args      = &#x27;eta1 eta3&#x27;
    mob_name  = 1
  [../]
  [./mult_CoupledACint_2]
    type = SimpleCoupledACInterface
    variable = lambda
    v = eta2
    kappa_name = kappa
    mob_name = 1
  [../]
  [./mult_ACBulkF_3]
    type = KKSMultiACBulkF
    variable  = lambda
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    gi_name   = g3
    eta_i     = eta3
    wi        = 1.0
    mob_name  = 1
    args      = &#x27;c1 c2 c3 eta1 eta2&#x27;
  [../]
  [./mult_ACBulkC_3]
    type = KKSMultiACBulkC
    variable  = lambda
    Fj_names  = &#x27;F1 F2 F3&#x27;
    hj_names  = &#x27;h1 h2 h3&#x27;
    cj_names  = &#x27;c1 c2 c3&#x27;
    eta_i     = eta3
    args      = &#x27;eta1 eta2&#x27;
    mob_name  = 1
  [../]
  [./mult_CoupledACint_3]
    type = SimpleCoupledACInterface
    variable = lambda
    v = eta3
    kappa_name = kappa
    mob_name = 1
  [../]

  # Kernels for constraint equation eta1 + eta2 + eta3 = 1
  # eta3 is the nonlinear variable for the constraint equation
  [./eta3reaction]
    type = MatReaction
    variable = eta3
    mob_name = 1
  [../]
  [./eta1reaction]
    type = MatReaction
    variable = eta3
    v = eta1
    mob_name = 1
  [../]
  [./eta2reaction]
    type = MatReaction
    variable = eta3
    v = eta2
    mob_name = 1
  [../]
  [./one]
    type = BodyForce
    variable = eta3
    value = -1.0
  [../]

  # Phase concentration constraints
  [./chempot12]
    type = KKSPhaseChemicalPotential
    variable = c1
    cb       = c2
    fa_name  = F1
    fb_name  = F2
  [../]
  [./chempot23]
    type = KKSPhaseChemicalPotential
    variable = c2
    cb       = c3
    fa_name  = F2
    fb_name  = F3
  [../]
  [./phaseconcentration]
    type = KKSMultiPhaseConcentration
    variable = c3
    cj = &#x27;c1 c2 c3&#x27;
    hj_names = &#x27;h1 h2 h3&#x27;
    etas = &#x27;eta1 eta2 eta3&#x27;
    c = c
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -sub_pc_type   -sub_pc_factor_shift_type&#x27;
  petsc_options_value = &#x27;asm       ilu            nonzero&#x27;
  l_max_its = 30
  nl_max_its = 10
  l_tol = 1.0e-4
  nl_rel_tol = 1.0e-10
  nl_abs_tol = 1.0e-11

  num_steps = 1000
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 0.2
    optimal_iterations = 10
    iteration_window = 2
  [../]
[]

[Preconditioning]
  active = &#x27;full&#x27;
  [./full]
    type = SMP
    full = true
  [../]
  [./mydebug]
    type = FDP
    full = true
  [../]
[]

[Outputs]
  exodus = true
  checkpoint = true
  print_linear_residuals = false
  [./csv]
    type = CSV
    execute_on = &#x27;final&#x27;
  [../]
[]

#[VectorPostprocessors]
#  [./c]
#    type =  LineValueSampler
#    start_point = &#x27;-25 0 0&#x27;
#    end_point = &#x27;25 0 0&#x27;
#    variable = c
#    num_points = 151
#    sort_by =  id
#    execute_on = timestep_end
#  [../]
#  [./eta1]
#    type =  LineValueSampler
#    start_point = &#x27;-25 0 0&#x27;
#    end_point = &#x27;25 0 0&#x27;
#    variable = eta1
#    num_points = 151
#    sort_by =  id
#    execute_on = timestep_end
#  [../]
#  [./eta2]
#    type =  LineValueSampler
#    start_point = &#x27;-25 0 0&#x27;
#    end_point = &#x27;25 0 0&#x27;
#    variable = eta2
#    num_points = 151
#    sort_by =  id
#    execute_on = timestep_end
#  [../]
#  [./eta3]
#    type =  LineValueSampler
#    start_point = &#x27;-25 0 0&#x27;
#    end_point = &#x27;25 0 0&#x27;
#    variable = eta3
#    num_points = 151
#    sort_by =  id
#    execute_on = timestep_end
#  [../]
#[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6cc12f4a-fd4d-4d24-a8bd-55838848a84a"><div class="modal-content"><h4>modules/porous_flow/test/tests/newton_cooling/nc08.i</h4><pre class="moose-pre"><code class="language-text"># Newton cooling from a bar.  1-phase ideal fluid and heat, steady
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 100
  ny = 1
  xmin = 0
  xmax = 100
  ymin = 0
  ymax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pressure temp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Variables]
  [./pressure]
  [../]
  [./temp]
  [../]
[]

[ICs]
  # have to start these reasonably close to their steady-state values
  [./pressure]
    type = FunctionIC
    variable = pressure
    function = &#x27;200-0.5*x&#x27;
  [../]
  [./temperature]
    type = FunctionIC
    variable = temp
    function = 180+0.1*x
  [../]
[]

[Kernels]
  [./flux]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    gravity = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
  [./heat_advection]
    type = PorousFlowHeatAdvection
    gravity = &#x27;0 0 0&#x27;
    variable = temp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./idealgas]
      type = IdealGasFluidProperties
      molar_mass = 1.4
      gamma = 1.2
      mu = 1.2
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = temp
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./dens0]
    type = PorousFlowSingleComponentFluid
    fp = idealgas
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.1 0 0 0 1.1 0 0 0 1.1&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey # irrelevant in this fully-saturated situation
    n = 2
    phase = 0
  [../]
[]

[BCs]
  [./leftp]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 200
  [../]
  [./leftt]
    type = DirichletBC
    variable = temp
    boundary = left
    value = 180
  [../]
  [./newtonp]
    type = PorousFlowPiecewiseLinearSink
    variable = pressure
    boundary = right
    pt_vals = &#x27;-200 0 200&#x27;
    multipliers = &#x27;-200 0 200&#x27;
    use_mobility = true
    use_relperm = true
    fluid_phase = 0
    flux_function = 0.005 # 1/2/L
  [../]
  [./newtont]
    type = PorousFlowPiecewiseLinearSink
    variable = temp
    boundary = right
    pt_vals = &#x27;-200 0 200&#x27;
    multipliers = &#x27;-200 0 200&#x27;
    use_mobility = true
    use_relperm = true
    use_enthalpy = true
    fluid_phase = 0
    flux_function = 0.005 # 1/2/L
  [../]
[]

[VectorPostprocessors]
  [./porepressure]
    type = LineValueSampler
    variable = pressure
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;100 0.5 0&#x27;
    sort_by = x
    num_points = 11
    execute_on = timestep_end
  [../]
  [./temperature]
    type = LineValueSampler
    variable = temp
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;100 0.5 0&#x27;
    sort_by = x
    num_points = 11
    execute_on = timestep_end
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
  nl_rel_tol = 1E-10
  nl_abs_tol = 1E-15
[]

[Outputs]
  file_base = nc08
  execute_on = timestep_end
  exodus = true
  [./along_line]
    type = CSV
    execute_vector_postprocessors_on = timestep_end
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="04335da1-97c5-4a75-8ef2-f1423a9d8aac"><div class="modal-content"><h4>modules/porous_flow/test/tests/dirackernels/bh07.i</h4><pre class="moose-pre"><code class="language-text"># Comparison with analytical solution for cylindrically-symmetric situation
[Mesh]
  type = FileMesh
  file = bh07_input.e
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1000 10000&#x27;
    x = &#x27;100 1000&#x27;
  [../]
[]

[Variables]
  [./pp]
    initial_condition = 1E7
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./fflux]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
    gravity = &#x27;0 0 0&#x27;
  [../]
[]

[BCs]
  [./fix_outer]
    type = DirichletBC
    boundary = perimeter
    variable = pp
    value = 1E7
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./borehole_total_outflow_mass]
    type = PorousFlowSumQuantity
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 1e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-11 0 0 0 1E-11 0 0 0 1E-11&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityFLAC
    m = 2
    phase = 0
  [../]
[]

[DiracKernels]
  [./bh]
    type = PorousFlowPeacemanBorehole
    variable = pp
    SumQuantityUO = borehole_total_outflow_mass
    point_file = bh07.bh
    fluid_phase = 0
    bottom_p_or_t = 0
    unit_weight = &#x27;0 0 0&#x27;
    use_mobility = true
    re_constant = 0.1594  # use Chen and Zhang version
    character = 2 # double the strength because bh07.bh only fills half the mesh
  [../]
[]

[Postprocessors]
  [./bh_report]
    type = PorousFlowPlotQuantity
    uo = borehole_total_outflow_mass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./fluid_mass]
    type = PorousFlowFluidMass
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[VectorPostprocessors]
  [./pp]
    type = LineValueSampler
    variable = pp
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;300 0 0&#x27;
    sort_by = x
    num_points = 300
    execute_on = timestep_end
  [../]
[]

[Preconditioning]
  [./usual]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it -ksp_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-10 1E-10 10000 30&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1E3
  solve_type = NEWTON
  [./TimeStepper]
    # get only marginally better results for smaller time steps
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = bh07
  [./along_line]
    type = CSV
    execute_on = final
  [../]
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b05326b2-698f-4d9d-a71c-209f57b5c0c4"><div class="modal-content"><h4>modules/porous_flow/test/tests/fluidstate/theis_brineco2.i</h4><pre class="moose-pre"><code class="language-text"># Two phase Theis problem: Flow from single source.
# Constant rate injection 2 kg/s
# 1D cylindrical mesh
# Initially, system has only a liquid phase, until enough gas is injected
# to form a gas phase, in which case the system becomes two phase.
#
# This test takes a few minutes to run, so is marked heavy

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 2000
  xmax = 2000
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = Y
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[AuxVariables]
  [./saturation_gas]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./x1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./y0]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./saturation_gas]
    type = PorousFlowPropertyAux
    variable = saturation_gas
    property = saturation
    phase = 1
    execute_on = timestep_end
  [../]
  [./x1]
    type = PorousFlowPropertyAux
    variable = x1
    property = mass_fraction
    phase = 0
    fluid_component = 1
    execute_on = timestep_end
  [../]
  [./y0]
    type = PorousFlowPropertyAux
    variable = y0
    property = mass_fraction
    phase = 1
    fluid_component = 0
    execute_on = timestep_end
  [../]
[]

[Variables]
  [./pgas]
    initial_condition = 20e6
  [../]
  [./zi]
    initial_condition = 0
  [../]
  [./xnacl]
    initial_condition = 0.1
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pgas
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pgas
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = zi
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = zi
  [../]
  [./mass2]
    type = PorousFlowMassTimeDerivative
    fluid_component = 2
    variable = xnacl
  [../]
  [./flux2]
    type = PorousFlowAdvectiveFlux
    fluid_component = 2
    variable = xnacl
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pgas zi xnacl&#x27;
    number_fluid_phases = 2
    number_fluid_components = 3
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
  [./fs]
    type = PorousFlowBrineCO2
    brine_fp = brine
    co2_fp = co2
    capillary_pressure = pc
  [../]
[]

[Modules]
  [./FluidProperties]
    [./co2sw]
      type = CO2FluidProperties
    [../]
    [./co2]
      type = TabulatedFluidProperties
      fp = co2sw
    [../]
    [./water]
      type = Water97FluidProperties
    [../]
    [./watertab]
      type = TabulatedFluidProperties
      fp = water
      temperature_min = 273.15
      temperature_max = 573.15
      fluid_property_file = water_fluid_properties.csv
      save_file = false
    [../]
    [./brine]
      type = BrineFluidProperties
      water_fp = watertab
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./brineco2]
    type = PorousFlowFluidState
    gas_porepressure = pgas
    z = zi
    temperature_unit = Celsius
    xnacl = xnacl
    capillary_pressure = pc
    fluid_state = fs
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.2
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-12 0 0 0 1e-12 0 0 0 1e-12&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
    s_res = 0.1
    sum_s_res = 0.1
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 1
  [../]
[]

[BCs]
  [./rightwater]
    type = DirichletBC
    boundary = right
    value = 20e6
    variable = pgas
  [../]
[]

[DiracKernels]
  [./source]
    type = PorousFlowSquarePulsePointSource
    point = &#x27;0 0 0&#x27;
    mass_flux = 2
    variable = zi
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 1e5
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
    growth_factor = 1.5
  [../]
[]

[VectorPostprocessors]
  [./line]
    type = LineValueSampler
    sort_by = x
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;2000 0 0&#x27;
    num_points = 10000
    variable = &#x27;pgas zi xnacl x1 saturation_gas&#x27;
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[Postprocessors]
  [./pgas]
    type = PointValue
    point = &#x27;4 0 0&#x27;
    variable = pgas
  [../]
  [./sgas]
    type = PointValue
    point = &#x27;4 0 0&#x27;
    variable = saturation_gas
  [../]
  [./zi]
    type = PointValue
    point = &#x27;4 0 0&#x27;
    variable = zi
  [../]
  [./massgas]
    type = PorousFlowFluidMass
    fluid_component = 1
  [../]
  [./x1]
    type = PointValue
    point = &#x27;4 0 0&#x27;
    variable = x1
  [../]
  [./y0]
    type = PointValue
    point = &#x27;4 0 0&#x27;
    variable = y0
  [../]
  [./xnacl]
    type = PointValue
    point = &#x27;4 0 0&#x27;
    variable = xnacl
  [../]
[]

[Outputs]
  print_linear_residuals = false
  perf_graph = true
  [./csvout]
    type = CSV
    execute_on = timestep_end
    execute_vector_postprocessors_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3e18d2b9-7598-48d2-896f-20ba2ccbd4d1"><div class="modal-content"><h4>modules/combined/test/tests/beam_eigenstrain_transfer/subapp2_uo_transfer.i</h4><pre class="moose-pre"><code class="language-text"># This test involves only thermal expansion strains on a 2x2x2 cube of approximate
# steel material.  An initial temperature of 25 degrees C is given for the material,
# and an auxkernel is used to calculate the temperature in the entire cube to
# raise the temperature each time step.  After the first timestep,in which the
# temperature jumps, the temperature increases by 6.25C each timestep.
# The thermal strain increment should therefore be
#     6.25 C * 1.3e-5 1/C = 8.125e-5 m/m.

# This test is also designed to be used to identify problems with restart files

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 5
  xmin = 0.0
  xmax = 0.5
  ymin = 0.0
  ymax = 0.150080
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[AuxVariables]
  [./temp]
  [../]
  [./axial_strain]
    order = FIRST
    family = MONOMIAL
  [../]
[]

[Functions]
  [./temperature_load]
    type = ParsedFunction
    value = t*(1000.0)+300.0
  [../]
[]

[Modules]
  [./TensorMechanics]
    [./Master]
      [./all]
        strain = SMALL
        incremental = true
        add_variables = true
        eigenstrain_names = eigenstrain
      [../]
    [../]
  [../]
[]

[AuxKernels]
  [./tempfuncaux]
    type = FunctionAux
    variable = temp
    function = temperature_load
  [../]
  [./axial_strain]
    type = RankTwoAux
    variable = axial_strain
    rank_two_tensor = total_strain
    index_i = 1
    index_j = 1
    execute_on = timestep_end
  [../]
[]

[BCs]
  [./x_bot]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./y_bot]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
  [../]
  [./small_stress]
    type = ComputeFiniteStrainElasticStress
  [../]
  [./thermal_expansion_strain]
    type = ComputeThermalExpansionEigenstrain
    stress_free_temperature = 298
    thermal_expansion_coeff = 1.3e-5
    temperature = temp
    eigenstrain_name = eigenstrain
  [../]
[]

[Executioner]
  type = Transient

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;101&#x27;

  line_search = &#x27;none&#x27;

  l_max_its = 50
  nl_max_its = 50
  nl_rel_tol = 1e-12
  nl_abs_tol = 1e-10
  l_tol = 1e-9

  start_time = 0.0
  end_time = 0.075
  dt = 0.0125
  dtmin = 0.0001
[]

[Outputs]
  csv = true
  exodus = true
[]

[VectorPostprocessors]
  [./axial_str]
    type = LineValueSampler
    start_point = &#x27;0.5 0.0 0.0&#x27;
    end_point = &#x27;0.5 0.150080 0.0&#x27;
    variable = axial_strain
    num_points = 11
    sort_by = &#x27;id&#x27;
  [../]
[]

[Postprocessors]
  [./end_disp]
    type = PointValue
    variable = disp_y
    point = &#x27;0.5 0.150080 0.0&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="1be7499e-71dc-46c3-8cec-2bd033a5c318"><div class="modal-content"><h4>modules/porous_flow/test/tests/pressure_pulse/pressure_pulse_1d_2phasePSVG2.i</h4><pre class="moose-pre"><code class="language-text"># Pressure pulse in 1D with 2 phases, 2components - transient

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = 0
  xmax = 100
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./ppwater]
    initial_condition = 2e6
  [../]
  [./sgas]
    initial_condition = 0.3
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
  [./ppgas]
    family = MONOMIAL
    order = FIRST
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = ppwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    variable = ppwater
    fluid_component = 0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = sgas
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    variable = sgas
    fluid_component = 1
  [../]
[]

[AuxKernels]
  [./ppgas]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = ppgas
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater sgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-4
    sat_lr = 0.3
    pc_max = 1e9
    log_extension = true
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      density0 = 1
      thermal_expansion = 0
      viscosity = 1e-5
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = ppwater
    phase1_saturation = sgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-15 0 0 0 1e-15 0 0 0 1e-15&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[BCs]
  [./leftwater]
    type = DirichletBC
    boundary = left
    value = 3e6
    variable = ppwater
  [../]
  [./rightwater]
    type = DirichletBC
    boundary = right
    value = 2e6
    variable = ppwater
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-20 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1e3
  end_time = 1e4
[]

[VectorPostprocessors]
  [./pp]
    type = LineValueSampler
    sort_by = x
    variable = &#x27;ppwater ppgas&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;100 0 0&#x27;
    num_points = 11
  [../]
[]

[Outputs]
  file_base = pressure_pulse_1d_2phasePSVG2
  print_linear_residuals = false
  [./csv]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3b7ccb32-af4a-403d-b88f-47742b2375ff"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/static_deformations/beam_cosserat_01_slippery.i</h4><pre class="moose-pre"><code class="language-text"># Beam bending.  One end is clamped and the other end is subjected to
# a constant surface traction.
# The beam thickness is 1, and the Cosserat layer thickness is 0.5,
# so the beam contains 2 Cosserat layers.
# The joint normal stiffness is set very large and the shear stiffness very small
# so that the situation should be very close to a single beam of thickness
# 0.5.
# The deflection should be described by
# u_z = 2sx/G + 2s(1-nu^2)x^2(3L-x)/(Eh^2)
# wc_y = sx(x-2L)/(2B)
# Here
# s = applied shear stress = -2E-4
# x = coordinate along bar (0&lt;=x&lt;=10)
# G = shear modulus = E/2/(1+nu) = 0.4615
# nu = Poisson = 0.3
# L = length of bar = 10
# E = Young = 1.2
# h = Cosserat layer thickness = 0.5
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 80
  xmax = 10
  ny = 1
  nz = 1
  zmin = -0.5
  zmax = 0.5
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  Cosserat_rotations = &#x27;wc_x wc_y wc_z&#x27;
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./wc_y]
  [../]
[]

[Kernels]
  [./cx_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./cy_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./cz_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./y_couple]
    type = StressDivergenceTensors
    variable = wc_y
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 1
    base_name = couple
  [../]
  [./y_moment]
    type = MomentBalancing
    variable = wc_y
    component = 1
  [../]
[]

[BCs]
  # zmin is called back
  # zmax is called front
  # ymin is called bottom
  # ymax is called top
  # xmin is called left
  # xmax is called right
  [./no_dispy]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;bottom top&#x27;
    value = 0.0
  [../]
  [./no_wc_y]
    type = DirichletBC
    variable = wc_y
    boundary = &#x27;left&#x27;
    value = 0.0
  [../]
  [./clamp_z]
    type = DirichletBC
    variable = disp_z
    boundary = left
    value = 0.0
  [../]
  [./clamp_x]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./end_traction]
    type = VectorNeumannBC
    variable = disp_z
    vector_value = &#x27;-2E-4 0 0&#x27;
    boundary = right
  [../]
[]

[AuxVariables]
  [./wc_x]
  [../]
  [./wc_z]
  [../]
  [./strain_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./strain_xx]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_xx
    index_i = 0
    index_j = 0
  [../]
  [./strain_xy]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_xy
    index_i = 0
    index_j = 1
  [../]
  [./strain_xz]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_xz
    index_i = 0
    index_j = 2
  [../]
  [./strain_yx]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_yx
    index_i = 1
    index_j = 0
  [../]
  [./strain_yy]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_yy
    index_i = 1
    index_j = 1
  [../]
  [./strain_yz]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_yz
    index_i = 1
    index_j = 2
  [../]
  [./strain_zx]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_zx
    index_i = 2
    index_j = 0
  [../]
  [./strain_zy]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_zy
    index_i = 2
    index_j = 1
  [../]
  [./strain_zz]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_zz
    index_i = 2
    index_j = 2
  [../]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./stress_zy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./couple_stress_xx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./couple_stress_xy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./couple_stress_xz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./couple_stress_yx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./couple_stress_yy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./couple_stress_yz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./couple_stress_zx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./couple_stress_zy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./couple_stress_zz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zz
    index_i = 2
    index_j = 2
  [../]
[]

[VectorPostprocessors]
  [./soln]
    type = LineValueSampler
    sort_by = x
    variable = &#x27;disp_x disp_z stress_xx stress_xz stress_zx stress_zz wc_y couple_stress_xx couple_stress_xz couple_stress_zx couple_stress_zz&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;10 0 0&#x27;
    num_points = 11
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeLayeredCosseratElasticityTensor
    young = 1.2
    poisson = 0.3
    layer_thickness = 0.5
    joint_normal_stiffness = 1E16
    joint_shear_stiffness = 1E-6
  [../]
  [./strain]
    type = ComputeCosseratSmallStrain
  [../]
  [./stress]
    type = ComputeCosseratLinearElasticStress
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it -ksp_atol -ksp_rtol -sub_pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-10 1E-14 10 1E-15 1E-10 NONZERO&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  num_steps = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = beam_cosserat_01_slippery
  csv = true
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4afbb6f6-dcac-4599-921b-77f51bbe342a"><div class="modal-content"><h4>test/tests/outputs/hide_vector_pp/hide_vector_pp.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Postprocessors]
  [./pp]
    type = NumElems
    outputs = csv
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = u
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 1 0&#x27;
    num_points = 10
    sort_by = id
    outputs = &#x27;test&#x27;
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 20
  dt = 0.1
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  csv = true
  [./test]
    type = CSV
    execute_on = &#x27;FINAL&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="bf45e69f-8bff-4044-a933-bc74cc52e3a1"><div class="modal-content"><h4>modules/porous_flow/test/tests/pressure_pulse/pressure_pulse_1d_2phasePS.i</h4><pre class="moose-pre"><code class="language-text"># Pressure pulse in 1D with 2 phases, 2components - transient

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = 0
  xmax = 100
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./ppwater]
    initial_condition = 2e6
  [../]
  [./sgas]
    initial_condition = 0.3
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
  [./ppgas]
    family = MONOMIAL
    order = FIRST
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = ppwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    variable = ppwater
    fluid_component = 0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = sgas
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    variable = sgas
    fluid_component = 1
  [../]
[]

[AuxKernels]
  [./ppgas]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = ppgas
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater sgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 1e5
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      density0 = 1
      thermal_expansion = 0
      viscosity = 1e-5
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = ppwater
    phase1_saturation = sgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-15 0 0 0 1e-15 0 0 0 1e-15&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[BCs]
  [./leftwater]
    type = DirichletBC
    boundary = left
    value = 3e6
    variable = ppwater
  [../]
  [./rightwater]
    type = DirichletBC
    boundary = right
    value = 2e6
    variable = ppwater
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-20 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1e3
  end_time = 1e4
[]

[VectorPostprocessors]
  [./pp]
    type = LineValueSampler
    sort_by = x
    variable = &#x27;ppwater ppgas&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;100 0 0&#x27;
    num_points = 11
  [../]
[]

[Outputs]
  file_base = pressure_pulse_1d_2phasePS
  print_linear_residuals = false
  [./csv]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="aae85da3-e2b2-4234-b617-3a9687a2d2f9"><div class="modal-content"><h4>modules/porous_flow/test/tests/capillary_pressure/brooks_corey2.i</h4><pre class="moose-pre"><code class="language-text"># Test Brooks-Corey capillary pressure curve by varying saturation over the mesh
# lambda = 2, sat_lr = 0.1, log_extension = true

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 500
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./p0]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 0
    variable = p0aux
  [../]
  [./p1]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = p1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureBC
    lambda = 2
    log_extension = true
    pe = 1e5
    sat_lr = 0.1
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityVG
    phase = 0
    m = 0.5
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 2
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux p0aux p1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 500
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-6
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2de828ff-2c14-4241-8b65-c803a68240a4"><div class="modal-content"><h4>modules/combined/test/tests/beam_eigenstrain_transfer/subapp_err_3.i</h4><pre class="moose-pre"><code class="language-text"># SubApp with 2D model to test multi app vectorpostprocessor to aux var transfer

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 5
  xmin = 0.0
  xmax = 0.5
  ymin = 0.0
  ymax = 0.150080
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[AuxVariables]
  [./temp]
  [../]
  [./axial_strain]
    order = FIRST
    family = MONOMIAL
  [../]
[]

[Functions]
  [./temperature_load]
    type = ParsedFunction
    value = t*(500.0)+300.0
  [../]
[]

[Modules]
  [./TensorMechanics]
    [./Master]
      [./all]
        strain = SMALL
        incremental = true
        add_variables = true
        eigenstrain_names = eigenstrain
      [../]
    [../]
  [../]
[]

[AuxKernels]
  [./tempfuncaux]
    type = FunctionAux
    variable = temp
    function = temperature_load
  [../]
  [./axial_strain]
    type = RankTwoAux
    variable = axial_strain
    rank_two_tensor = total_strain
    index_i = 1
    index_j = 1
    execute_on = timestep_end
  [../]
[]

[BCs]
  [./x_bot]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./y_bot]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
  [../]
  [./small_stress]
    type = ComputeFiniteStrainElasticStress
  [../]
  [./thermal_expansion_strain]
    type = ComputeThermalExpansionEigenstrain
    stress_free_temperature = 298
    thermal_expansion_coeff = 1.3e-5
    temperature = temp
    eigenstrain_name = eigenstrain
  [../]
[]

[Executioner]
  type = Transient

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;101&#x27;

  line_search = &#x27;none&#x27;

  l_max_its = 50
  nl_max_its = 50
  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-8
  l_tol = 1e-9

  start_time = 0.0
  end_time = 0.075
  dt = 0.0125
  dtmin = 0.0001
[]

[Outputs]
  csv = true
  exodus = true
[]

[VectorPostprocessors]
  [./axial_str]
    type = LineValueSampler
    start_point = &#x27;0.5 0.0 0.0&#x27;
    end_point = &#x27;0.5 0.150080 0.0&#x27;
    variable = axial_strain
    num_points = 21
    sort_by = &#x27;y&#x27;
  [../]
[]

[Postprocessors]
  [./end_disp]
    type = PointValue
    variable = disp_y
    point = &#x27;0.5 0.150080 0.0&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="011dd926-f1ad-4d07-8e8c-474667195a4a"><div class="modal-content"><h4>modules/porous_flow/test/tests/heat_advection/heat_advection_1d_fully_saturated.i</h4><pre class="moose-pre"><code class="language-text"># 1phase, heat advecting with a moving fluid
# Using the FullySaturated Kernel
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 50
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./temp]
    initial_condition = 200
  [../]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = &#x27;1-x&#x27;
  [../]
[]

[BCs]
  [./pp0]
    type = DirichletBC
    variable = pp
    boundary = left
    value = 1
  [../]
  [./pp1]
    type = DirichletBC
    variable = pp
    boundary = right
    value = 0
  [../]
  [./spit_heat]
    type = DirichletBC
    variable = temp
    boundary = left
    value = 300
  [../]
  [./suck_heat]
    type = DirichletBC
    variable = temp
    boundary = right
    value = 200
  [../]
[]

[Kernels]
  [./mass_dot]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./advection]
    type = PorousFlowFullySaturatedDarcyBase
    variable = pp
  [../]
  [./energy_dot]
    type = PorousFlowEnergyTimeDerivative
    variable = temp
  [../]
  [./convection]
    type = PorousFlowFullySaturatedHeatAdvection
    variable = temp
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;temp pp&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 100
      density0 = 1000
      viscosity = 4.4
      thermal_expansion = 0
      cv = 2
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = temp
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.2
  [../]
  [./rock_heat]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 1.0
    density = 125
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.1 0 0 0 2 0 0 0 3&#x27;
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./PS]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres bjacobi 1E-15 1E-10 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 0.01
  end_time = 0.6
[]

[VectorPostprocessors]
  [./T]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 51
    sort_by = x
    variable = temp
  [../]
[]

[Outputs]
  file_base = heat_advection_1d_fully_saturated
  [./csv]
    type = CSV
    sync_times = &#x27;0.1 0.6&#x27;
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f44eb1e6-e598-4887-88b5-5a55416a2b5c"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_2D_trimesh.i</h4><pre class="moose-pre"><code class="language-text"># Using Flux-Limited TVD Advection ala Kuzmin and Turek, with antidiffusion from superbee flux limiting
# 2D version
[Mesh]
  type = FileMesh
  file = trimesh.msh
[]

[GlobalParams]
  block = &#x27;50&#x27;
[]

[Variables]
  [./tracer]
  [../]
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.305,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = MassLumpedTimeDerivative
    variable = tracer
  [../]
  [./flux]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo
  [../]
[]

[UserObjects]
  [./fluo]
    type = AdvectiveFluxCalculatorConstantVelocity
    flux_limiter_type = superbee
    u = tracer
    velocity = &#x27;0.1 0 0&#x27;
  [../]
[]

[BCs]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_tracer]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = right
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0.04 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  timestep_tolerance = 1E-3
[]

[Outputs]
  print_linear_residuals = false
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0f5320f9-1058-4eae-94bf-9e42bd855ac1"><div class="modal-content"><h4>modules/porous_flow/test/tests/capillary_pressure/vangenuchten2.i</h4><pre class="moose-pre"><code class="language-text"># Test van Genuchten relative permeability curve by varying saturation over the mesh
# van Genuchten exponent m = 0.5 for both phases
# No residual saturation in either phase

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 500
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./p0]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 0
    variable = p0aux
  [../]
  [./p1]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = p1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    alpha = 1e-5
    m = 0.5
    sat_lr = 0.1
    log_extension = true
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityVG
    phase = 0
    m = 0.5
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 2
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux p0aux p1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 500
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-6
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c432bb3d-817d-497f-ac66-149632c45a6f"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/wli01.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1000
  ny = 1
  xmin = -10000
  xmax = 0
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureBW
    Sn = 0.0
    Ss = 1.0
    C = 1.5
    las = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      viscosity = 4
      density0 = 10
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityBW
    Sn = 0.0
    Ss = 1.0
    Kn = 0
    Ks = 1
    C = 1.5
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.25
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1 0 0  0 1 0  0 0 1&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = -1E-4
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-0.1 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./base]
    type = DirichletBC
    boundary = &#x27;left&#x27;
    value = -1E-4
    variable = pressure
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10000&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;-5000 0 0&#x27;
    end_point = &#x27;0 0 0&#x27;
    sort_by = x
    num_points = 71
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 1000
  dt = 1
[]

[Outputs]
  file_base = wli01
  sync_times = &#x27;100 500 1000&#x27;
  [./exodus]
    type = Exodus
    sync_only = true
  [../]
  [./along_line]
    type = CSV
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6824422c-411c-445d-8ba5-e6fbac0e5008"><div class="modal-content"><h4>test/tests/functions/vector_postprocessor_function/vector_postprocessor_function.i</h4><pre class="moose-pre"><code class="language-text">#This function linearly interpolates the data generated by a vector post
#processor. The purpose is to have a function take points and a field variable
#(aux or primary) as arguments.
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 4
  xmin = 0.0
  xmax = 0.004
  ymin = 0.0
  ymax = 0.008
[]

[Variables]
  [./u]
    initial_condition = 0
  [../]
[]

[AuxVariables]
  [./v]
    initial_condition = 1
  [../]
[]

[Functions]
  [./ramp_u]
    type = ParsedFunction
    value = &#x27;t&#x27;
  [../]
  [./point_value_function_u]
    type = VectorPostprocessorFunction
    component = y
    argument_column = y
    value_column = u
    vectorpostprocessor_name = point_value_vector_postprocessor_u
  [../]
  [./line_value_function_v]
    type = VectorPostprocessorFunction
    component = y
    argument_column = y
    value_column = v
    vectorpostprocessor_name = line_value_vector_postprocessor_v
  [../]
  [./function_v]
    type = PiecewiseLinear
    x = &#x27;0 0.008&#x27;
    y = &#x27;1 2&#x27;
    axis = y
  [../]
[]

[Kernels]
  [./diffusion_u]
    type = Diffusion
    variable = u
  [../]
[]

[AuxKernels]
[./aux_v]
  type = FunctionAux
  variable = v
  function = function_v
[../]
[]

[BCs]
  [./top_u]
    type = FunctionDirichletBC
    boundary = top
    variable = u
    function = ramp_u
  [../]
  [./bottom_u]
    type = DirichletBC
    boundary = bottom
    variable = u
    value = 0
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;
  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; lu       superlu_dist                 51&#x27;
  line_search = &#x27;none&#x27;
  l_max_its = 50
  l_tol = 1e-3
  nl_max_its = 20
  nl_rel_tol = 1e-4
  nl_abs_tol = 1e-6
  start_time = 0
  num_steps = 1
  dt = 1
[]
[Postprocessors]
  [./point_value_postprocessor_u]
    type = FunctionValuePostprocessor
    function = point_value_function_u
    point = &#x27;0.002 0.004 0&#x27;
  [../]
  [./line_value_postprocessor_v]
    type = FunctionValuePostprocessor
    function = line_value_function_v
    point = &#x27;0.002 0.004 0&#x27;
  [../]
  [./postprocessor_average_u]
    type = ElementAverageValue
    variable = u
  [../]
  [./postprocessor_average_v]
    type = ElementAverageValue
    variable = v
  [../]
[]
[VectorPostprocessors]
  [./point_value_vector_postprocessor_u]
    type = PointValueSampler
    variable = u
    points = &#x27;0 0.001 0 0 0.004 0 0 0.008 0&#x27;
    #points = &#x27;0.001 0 0 0.002 0 0&#x27;
    sort_by = y
    execute_on = linear
  [../]
  [./line_value_vector_postprocessor_v]
    type = LineValueSampler
    variable = v
    start_point = &#x27;0 0.001 0&#x27;
    end_point = &#x27;0 0.008 0&#x27;
    num_points = 5
    sort_by = y
    execute_on = linear
  [../]
[]
[Outputs]
  interval = 1
  csv = false
  exodus = true
  file_base = out
  [./console]
    type = Console
    output_linear = true
    max_rows = 10
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f194bf26-70de-4214-9800-f871dbb8c661"><div class="modal-content"><h4>modules/combined/examples/publications/rapid_dev/fig3.i</h4><pre class="moose-pre"><code class="language-text">#
# Fig. 3 input for 10.1016/j.commatsci.2017.02.017
# D. Schwen et al./Computational Materials Science 132 (2017) 36-45
# Comparison of an analytical (ca) and numerical (c) phase field interface
# profile. Supply the L parameter on the command line to gather the data for
# the inset plot.
#

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = ${L}
  xmin = -30
  xmax = 30
[]

[Functions]
  [./solution]
    type = ParsedFunction
    value = 0.5*(1+tanh(x/2^0.5))
  [../]
[]

[Variables]
  [./c]
    [./InitialCondition]
      type = FunctionIC
      function = solution
      #type = FunctionIC
      #function = if(x&gt;0,1,0)
    [../]
  [../]
  [./w]
  [../]
[]

[AuxVariables]
  [./diff]
  [../]
  [./ca]
    [./InitialCondition]
      type = FunctionIC
      function = &#x27;0.5*(1+tanh(x/2^0.5))&#x27;
    [../]
  [../]
[]

[AuxKernels]
  [./diff]
    type = ParsedAux
    variable = diff
    function = c-ca
    args = &#x27;c ca&#x27;
  [../]
[]

[Materials]
  [./F]
    type = DerivativeParsedMaterial
    f_name = F
    function = &#x27;c^2*(1-c)^2&#x27;
    args = c
  [../]
[]

[Kernels]
  # Split Cahn-Hilliard kernels
  [./c_res]
    type = SplitCHParsed
    variable = c
    f_name = F
    kappa_name = 1
    w = w
  [../]
  [./wres]
    type = SplitCHWRes
    variable = w
    mob_name = 1
  [../]
  [./time]
    type = CoupledTimeDerivative
    variable = w
    v = c
  [../]
[]

[Postprocessors]
  [./L2]
    type = ElementL2Error
    function = solution
    variable = c
  [../]
[]

[VectorPostprocessors]
  [./c]
    type = LineValueSampler
    variable = &#x27;c ca diff&#x27;
    start_point = &#x27;-10 0 0&#x27;
    end_point = &#x27;10 0 0&#x27;
    num_points = 200
    sort_by = x
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON

  nl_rel_tol = 1e-10
  nl_abs_tol = 1e-12
  end_time = 1e+6

  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
    optimal_iterations = 5
    iteration_window = 1
  [../]
[]

[Outputs]
  csv = true
  execute_on = final
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3c6afe9b-675f-45d0-961e-cc8f1c0bc128"><div class="modal-content"><h4>modules/porous_flow/test/tests/thm_rehbinder/free_outer.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [annular]
    type = AnnularMeshGenerator
    nr = 40
    nt = 16
    rmin = 0.1
    rmax = 1
    dmin = 0.0
    dmax = 90
    growth_r = 1.1
  []
  [./make3D]
    input = annular
    type = MeshExtruderGenerator
    bottom_sideset = bottom
    top_sideset = top
    extrusion_vector = &#x27;0 0 1&#x27;
    num_layers = 1
  [../]
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  PorousFlowDictator = dictator
  biot_coefficient = 1.0
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
  [./temperature]
  [../]
[]

[BCs]
  # sideset 1 = outer
  # sideset 2 = cavity
  # sideset 3 = ymin
  # sideset 4 = xmin
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]
  [./ymin]
    type = DirichletBC
    variable = disp_y
    value = 0
    boundary = dmin
  [../]
  [./xmin]
    type = DirichletBC
    variable = disp_x
    value = 0
    boundary = dmax
  [../]

  [./cavity_temperature]
    type = DirichletBC
    variable = temperature
    value = 1000
    boundary = rmin
  [../]
  [./cavity_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = rmin
  [../]
  [./cavity_zero_effective_stress_x]
    type = Pressure
    component = 0
    variable = disp_x
    function = 1E6
    boundary = rmin
    use_displaced_mesh = false
  [../]
  [./cavity_zero_effective_stress_y]
    type = Pressure
    component = 1
    variable = disp_y
    function = 1E6
    boundary = rmin
    use_displaced_mesh = false
  [../]

  [./outer_temperature]
    type = DirichletBC
    variable = temperature
    value = 0
    boundary = rmax
  [../]
  [./outer_pressure]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = rmax
  [../]
[]

[AuxVariables]
  [./stress_rr]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_pp]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./stress_rr]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_rr
    scalar_type = RadialStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
  [./stress_pp]
    type = RankTwoScalarAux
    rank_two_tensor = stress
    variable = stress_pp
    scalar_type = HoopStress
    point1 = &#x27;0 0 0&#x27;
    point2 = &#x27;0 0 1&#x27;
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 1E12
      viscosity = 1.0E-3
      density0 = 1000.0
      cv = 1000.0
      cp = 1000.0
      porepressure_coefficient = 0.0
    [../]
  [../]
[]

[PorousFlowBasicTHM]
  coupling_type = ThermoHydroMechanical
  multiply_by_density = false
  add_stress_aux = true
  porepressure = porepressure
  temperature = temperature
  eigenstrain_names = thermal_contribution
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 1E10
    poissons_ratio = 0.2
  [../]
  [./strain]
    type = ComputeSmallStrain
    eigenstrain_names = thermal_contribution
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = temperature
    thermal_expansion_coeff = 1E-6
    eigenstrain_name = thermal_contribution
    stress_free_temperature = 0.0
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is ever used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    solid_bulk_compliance = 1E-10
    fluid_bulk_modulus = 1E12
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0   0 1E-12 0   0 0 1E-12&#x27;
  [../]
  [./thermal_expansion]
    type = PorousFlowConstantThermalExpansionCoefficient
    fluid_coefficient = 1E-6
    drained_coefficient = 1E-6
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;1E6 0 0  0 1E6 0  0 0 1E6&#x27;
  [../]
[]

[VectorPostprocessors]
  [./P]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = porepressure
  [../]
  [./T]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = temperature
  [../]
  [./U]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = disp_x
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_rtol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           1E-8&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  file_base = free_outer
  execute_on = timestep_end
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f3eb07f9-6bd5-4804-8759-1f868e93ddca"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/eigenstrain/reducedOrderRZLinear.i</h4><pre class="moose-pre"><code class="language-text">#
# This test checks whether the ComputeReducedOrderEigenstrain is functioning properly.
#
# If instead of &#x27;reduced_eigenstrain&#x27;, &#x27;thermal_eigenstrain&#x27; is given to
# eigenstrain_names in the Modules/TensorMechanics/Master/all block, the output will be
# quite different.
#
# Open the reducedOrderRZLinear_out_hydro_0001.csv file and plot the hydro variables as
# a function of x.  For the reduced order case, the values are smooth across each of the
# two elements with a jump upward from the left element to the right element.  However,
# when not using &#x27;reduced_order_eigenstrain&#x27;, a jump downward appears from the left
# element to the right element.
#

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
  volumetric_locking_correction = false
[]

[Problem]
  coord_type = RZ
[]

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 1
  xmax = 3
  xmin = 1
  ymax = 1
  ymin = 0
  #second_order = true
[]

[Functions]
  [./tempLinear]
    type = ParsedFunction
    value = &#x27;715-5*x&#x27;
  [../]
  [./tempQuadratic]
    type = ParsedFunction
    value = &#x27;2.5*x*x-15*x+722.5&#x27;
  [../]
  [./tempCubic]
    type = ParsedFunction
    value = &#x27;-1.25*x*x*x+11.25*x*x-33.75*x+733.75&#x27;
  [../]
[]

[Variables]
  [./temp]
    order = FIRST
    family = LAGRANGE
    initial_condition = 700
  [../]
[]

[AuxVariables]
  [./hydro_constant]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./hydro_first]
    order = FIRST
    family = MONOMIAL
  [../]
  [./hydro_second]
    order = SECOND
    family = MONOMIAL
  [../]
  [./sxx_constant]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./sxx_first]
    order = FIRST
    family = MONOMIAL
  [../]
  [./sxx_second]
    order = SECOND
    family = MONOMIAL
  [../]
  [./szz_constant]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./szz_first]
    order = FIRST
    family = MONOMIAL
  [../]
  [./szz_second]
    order = SECOND
    family = MONOMIAL
  [../]
  [./temp2]
    order = FIRST
    family = LAGRANGE
    initial_condition = 700
  [../]
[]

[Modules]
  [./TensorMechanics]
    [./Master]
      [./all]
        add_variables = true
        strain = SMALL
        incremental = true
        temperature = temp2
        eigenstrain_names = &#x27;reduced_eigenstrain&#x27; #&#x27;thermal_eigenstrain&#x27;
      [../]
    [../]
  [../]
[]

[Kernels]
  [./heat]
    type = Diffusion
    variable = temp
  [../]
[]

[AuxKernels]
  [./hydro_constant_aux]
    type = RankTwoScalarAux
    variable = hydro_constant
    rank_two_tensor = stress
    scalar_type = Hydrostatic
  [../]
  [./hydro_first_aux]
    type = RankTwoScalarAux
    variable = hydro_first
    rank_two_tensor = stress
    scalar_type = Hydrostatic
  [../]
  [./hydro_second_aux]
    type = RankTwoScalarAux
    variable = hydro_second
    rank_two_tensor = stress
    scalar_type = Hydrostatic
  [../]
  [./sxx_constant_aux]
    type = RankTwoAux
    variable = sxx_constant
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
  [../]
  [./sxx_first_aux]
    type = RankTwoAux
    variable = sxx_first
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
  [../]
  [./sxx_second_aux]
    type = RankTwoAux
    variable = sxx_second
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
  [../]
  [./szz_constant_aux]
    type = RankTwoAux
    variable = szz_constant
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
  [../]
  [./szz_first_aux]
    type = RankTwoAux
    variable = szz_first
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
  [../]
  [./szz_second_aux]
    type = RankTwoAux
    variable = szz_second
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
  [../]
  [./temp2]
    type = FunctionAux
    variable = temp2
    function = tempLinear
    execute_on = timestep_begin
  [../]
[]

[BCs]
  [./no_x]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./no_y]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;bottom top&#x27;
    value = 0.0
  [../]

  [./temp_right]
    type = DirichletBC
    variable = temp
    boundary = right
    value = 700
  [../]
  [./temp_left]
    type = DirichletBC
    variable = temp
    boundary = left
    value = 710
  [../]
[]


[Materials]
  [./fuel_stress]
    type = ComputeFiniteStrainElasticStress
  [../]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 1
    poissons_ratio = 0
  [../]
  [./fuel_thermal_expansion]
    type = ComputeThermalExpansionEigenstrain
    thermal_expansion_coeff = 1
    temperature = temp2
    stress_free_temperature = 700.0
    eigenstrain_name = &#x27;thermal_eigenstrain&#x27;
  [../]
  [./reduced_order_eigenstrain]
    type = ComputeReducedOrderEigenstrain
    input_eigenstrain_names = &#x27;thermal_eigenstrain&#x27;
    eigenstrain_name = &#x27;reduced_eigenstrain&#x27;
  [../]
[]


[Preconditioning]
  [./SMP]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp_ew &#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart -pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;70 hypre boomeramg&#x27;

  num_steps = 1
  nl_rel_tol = 1e-8 #1e-12
[]

[Postprocessors]
  [./_dt]
    type = TimestepSize
  [../]
[]

[VectorPostprocessors]
  [./hydro]
    type = LineValueSampler
    num_points = 100
    start_point = &#x27;1 0.07e-3 0&#x27;
    end_point = &#x27;3 0.07e-3 0&#x27;
    sort_by = x
    variable = &#x27;hydro_constant hydro_first hydro_second temp2 disp_x disp_y&#x27;
  [../]
[]

[Outputs]
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5571914b-2afd-4cdc-b9d9-3b5456d39210"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_1D.i</h4><pre class="moose-pre"><code class="language-text"># Using flux-limited TVD advection ala Kuzmin and Turek, mploying PorousFlow Kernels and UserObjects, with superbee flux-limiter
# 1D version
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer]
  [../]
[]

[ICs]
  [./porepressure]
    type = FunctionIC
    variable = porepressure
    function = &#x27;1 - x&#x27;
  [../]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = tracer
  [../]
  [./flux0]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = advective_flux_calculator_0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = porepressure
  [../]
  [./flux1]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = porepressure
    advective_flux_calculator = advective_flux_calculator_1
  [../]
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1
    boundary = left
  [../]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_component_1]
    type = PorousFlowPiecewiseLinearSink
    variable = porepressure
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 1
    use_mobility = true
    flux_function = 1E3
  [../]
  [./remove_component_0]
    type = PorousFlowPiecewiseLinearSink
    variable = tracer
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 0
    use_mobility = true
    flux_function = 1E3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      thermal_expansion = 0
      viscosity = 1.0
      density0 = 1000.0
    [../]
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure tracer&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
  [../]
  [./advective_flux_calculator_0]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 0
  [../]
  [./advective_flux_calculator_1]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 1
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = tracer
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = the_simple_fluid
    phase = 0
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-2 0 0   0 1E-2 0   0 0 1E-2&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4d6e0c21-863a-4b96-a3a4-fa6a1999d9e4"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/static_deformations/beam_cosserat_02_apply_stress.i</h4><pre class="moose-pre"><code class="language-text"># Beam bending.
# One end is clamped and the other end is subjected to a stress
# and micromechanical moment that will induce bending.
# The stress that will induce bending around the y axis is
# stress_xx = EAz
# This implies a micromechanical moment-stress of
# m_yx = (1/12)EAh^2 for joint_shear_stiffness=0.
# For joint_shear_stiffness!=0, the micromechanical moment-stress
# is
# m_yx = (1/12)EAa^2 G/(ak_s + G)
# All other stresses and moment stresses are assumed to be zero.
# With joint_shear_stiffness=0, and introducing D=-poisson*A, the
# nonzero strains are
# ep_xx = Az
# ep_yy = Dz
# ep_zz = Dz
# kappa_xy = -D
# kappa_yx = A
# This means the displacements are:
# u_x = Axz
# u_y = Dzy
# u_z = -(A/2)x^2 + (D/2)(z^2-y^2)
# wc_x = -Dy
# wc_y = Ax
# wc_z = 0
# This is bending of a bar around the y axis, in plane stress
# (stress_yy=0).  Displacements at the left-hand (x=0) are applied
# according to the above formulae; wc_x and wc_y are applied throughout
# the bar; and stress_xx is applied at the right-hand end (x=10).
# The displacements are measured and
# compared with the above formulae.
# The test uses: E=1.2, poisson=0.3, A=1.11E-2, h=2, ks=0.1, so
# stress_xx = 1.332E-2*z
# m_yx = 0.2379E-2
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 10
  ny = 1
  nz = 10
  xmin = 0
  xmax = 10
  ymin = -1
  ymax = 1
  zmin = -0.5
  zmax = 0.5
[]

[GlobalParams]
  #use_displaced_mesh = false
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  Cosserat_rotations = &#x27;wc_x wc_y wc_z&#x27;
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./wc_x]
  [../]
  [./wc_y]
  [../]
[]

[Kernels]
  [./cx_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./cy_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./cz_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./x_couple]
    type = StressDivergenceTensors
    variable = wc_x
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 0
    base_name = couple
  [../]
  [./y_couple]
    type = StressDivergenceTensors
    variable = wc_y
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 1
    base_name = couple
  [../]
  [./x_moment]
    type = MomentBalancing
    variable = wc_x
    component = 0
  [../]
  [./y_moment]
    type = MomentBalancing
    variable = wc_y
    component = 1
  [../]
[]

[BCs]
  # zmin is called back
  # zmax is called front
  # ymin is called bottom
  # ymax is called top
  # xmin is called left
  # xmax is called right
  [./clamp_z]
    type = FunctionDirichletBC
    variable = disp_z
    boundary = left
    function = &#x27;-0.3*(z*z-y*y)/2.0*1.11E-2&#x27;
  [../]
  [./clamp_y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = left
    function = &#x27;-0.3*z*y*1.11E-2&#x27;
  [../]
  [./clamp_x]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./end_stress]
    type = FunctionNeumannBC
    boundary = right
    function = z*1.2*1.11E-2
    variable = disp_x
  [../]
  [./fix_wc_x]
    type = FunctionDirichletBC
    variable = wc_x
    boundary = &#x27;left&#x27; # right top bottom front back&#x27;
    function = &#x27;0.3*y*1.11E-2&#x27;
  [../]
  [./fix_wc_y]
    type = FunctionDirichletBC
    variable = wc_y
    boundary = &#x27;left&#x27; # right top bottom front back&#x27;
    function = &#x27;1.11E-2*x&#x27;
  [../]
  [./end_moment]
    type = VectorNeumannBC
    boundary = right
    variable = wc_y
    vector_value = &#x27;2.3785714286E-3 0 0&#x27;
  [../]
[]


[AuxVariables]
  [./wc_z]
  [../]
  [./strain_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./strain_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./strain_xx]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_xx
    index_i = 0
    index_j = 0
  [../]
  [./strain_xy]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_xy
    index_i = 0
    index_j = 1
  [../]
  [./strain_xz]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_xz
    index_i = 0
    index_j = 2
  [../]
  [./strain_yx]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_yx
    index_i = 1
    index_j = 0
  [../]
  [./strain_yy]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_yy
    index_i = 1
    index_j = 1
  [../]
  [./strain_yz]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_yz
    index_i = 1
    index_j = 2
  [../]
  [./strain_zx]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_zx
    index_i = 2
    index_j = 0
  [../]
  [./strain_zy]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_zy
    index_i = 2
    index_j = 1
  [../]
  [./strain_zz]
    type = RankTwoAux
    rank_two_tensor = total_strain
    variable = strain_zz
    index_i = 2
    index_j = 2
  [../]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./stress_zy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./couple_stress_xx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./couple_stress_xy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./couple_stress_xz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./couple_stress_yx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./couple_stress_yy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./couple_stress_yz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./couple_stress_zx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./couple_stress_zy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./couple_stress_zz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zz
    index_i = 2
    index_j = 2
  [../]
[]

[VectorPostprocessors]
  [./soln]
    type = LineValueSampler
    sort_by = x
    variable = &#x27;disp_x disp_y disp_z stress_xx stress_xy stress_xz stress_yx stress_yy stress_yz stress_zx stress_zy stress_zz wc_x wc_y wc_z couple_stress_xx couple_stress_xy couple_stress_xz couple_stress_yx couple_stress_yy couple_stress_yz couple_stress_zx couple_stress_zy couple_stress_zz&#x27;
    start_point = &#x27;0 0 0.5&#x27;
    end_point = &#x27;10 0 0.5&#x27;
    num_points = 11
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeLayeredCosseratElasticityTensor
    young = 1.2
    poisson = 0.3
    layer_thickness = 2.0
    joint_normal_stiffness = 1E16
    joint_shear_stiffness = 0.1
  [../]
  [./strain]
    type = ComputeCosseratSmallStrain
  [../]
  [./stress]
    type = ComputeCosseratLinearElasticStress
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it -ksp_atol -ksp_rtol -ksp_max_it -sub_pc_factor_shift_type -pc_asm_overlap -ksp_gmres_restart&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-11 1E-11 10 1E-15 1E-10 100 NONZERO 2 100&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  num_steps = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = beam_cosserat_02_apply_stress
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="834a26df-940a-4928-a9a8-4c65e836f05b"><div class="modal-content"><h4>modules/porous_flow/test/tests/relperm/brooks_corey1.i</h4><pre class="moose-pre"><code class="language-text"># Test Brooks-Corey relative permeability curve by varying saturation over the mesh
# Exponent lambda = 2 for both phases

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./kr0]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 0
    variable = kr0aux
  [../]
  [./kr1]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 1
    variable = kr1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityBC
    phase = 0
    lambda = 2
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityBC
    phase = 1
    lambda = 2
    nw_phase = true
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux kr0aux kr1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 20
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-8
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="53378f9a-7206-4c1d-8bf9-0e0dcf5f25f0"><div class="modal-content"><h4>modules/porous_flow/examples/flow_through_fractured_media/coarse_3D.i</h4><pre class="moose-pre"><code class="language-text"># Flow and solute transport along 2 2D eliptical fractures embedded in a 3D porous matrix
# the model domain has dimensions 1 x 1 x 0.3m and the two fracture have r1 = 0.45 and r2 = 0.2
# The fractures intersect each other and the domain boundaries on two opposite sides
# fracture aperture = 6e-4m
# fracture porosity = 6e-4m
# fracture permeability = 1.8e-11 which is based in k=3e-8 from a**2/12, and k*a = 3e-8*6e-4;
# matrix porosity = 0.1;
# matrix permeanility = 1e-20;

[Mesh]
  type = FileMesh
  file = coarse_3D.e
  block_id = &#x27;1 2 3&#x27;
  block_name = &#x27;matrix f1 f2&#x27;

  boundary_id = &#x27;1 2 3 4&#x27;
  boundary_name = &#x27;rf2 lf1 right_matrix left_matrix&#x27;
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./pp]
  [../]
  [./tracer]
  [../]
[]

[AuxVariables]
  [./velocity_x]
    family = MONOMIAL
    order = CONSTANT
    block = &#x27;f1 f2&#x27;
  [../]
  [./velocity_y]
    family = MONOMIAL
    order = CONSTANT
    block = &#x27;f1 f2&#x27;
  [../]
  [./velocity_z]
    family = MONOMIAL
    order = CONSTANT
    block = &#x27;f1 f2&#x27;
  [../]
[]

[AuxKernels]
  [./velocity_x]
    type = PorousFlowDarcyVelocityComponentLowerDimensional
    variable = velocity_x
    component = x
    aperture = 6E-4
  [../]
  [./velocity_y]
    type = PorousFlowDarcyVelocityComponentLowerDimensional
    variable = velocity_y
    component = y
    aperture = 6E-4
  [../]
  [./velocity_z]
    type = PorousFlowDarcyVelocityComponentLowerDimensional
    variable = velocity_z
    component = z
    aperture = 6E-4
  [../]
[]

[ICs]
  [./pp]
    type = ConstantIC
    variable = pp
    value = 1e6
  [../]
  [./tracer]
    type = ConstantIC
    variable = tracer
    value = 0
  [../]
[]

[BCs]
  [./top]
    type = DirichletBC
    value = 0
    variable = tracer
    boundary = rf2
  [../]
  [./bottom]
    type = DirichletBC
    value = 1
    variable = tracer
    boundary = lf1
  [../]
  [./ptop]
    type = DirichletBC
    variable = pp
    boundary =  rf2
    value = 1e6
  [../]
  [./pbottom]
    type = DirichletBC
    variable = pp
    boundary = lf1
    value = 1.02e6
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./adv0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
  [../]
  [./diff0]
    type = PorousFlowDispersiveFlux
    fluid_component = 0
    variable = pp
    disp_trans = 0
    disp_long = 0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = tracer
  [../]
  [./adv1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = tracer
  [../]
  [./diff1]
    type = PorousFlowDispersiveFlux
    fluid_component = 1
    variable = tracer
    disp_trans = 0
    disp_long = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp tracer&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;tracer&#x27;
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./poro1]
    type = PorousFlowPorosityConst
    porosity = 6e-4   # = a * phif
    block = &#x27;f1 f2&#x27;
  [../]
  [./diff1]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1.e-9 1.e-9&#x27;
    tortuosity = 1.0
    block = &#x27;f1 f2&#x27;
  [../]
  [./poro2]
    type = PorousFlowPorosityConst
    porosity = 0.1
    block = &#x27;matrix&#x27;
  [../]
  [./diff2]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1.e-9 1.e-9&#x27;
    tortuosity = 0.1
    block = &#x27;matrix&#x27;
  [../]
  [./relp]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./permeability1]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.8e-11 0 0 0 1.8e-11 0 0 0 1.8e-11&#x27;   # 1.8e-11 = a * kf
    block = &#x27;f1 f2&#x27;
  [../]
  [./permeability2]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-20 0 0 0 1e-20 0 0 0 1e-20&#x27;
    block = &#x27;matrix&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./mumps_is_best_for_parallel_jobs]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
  [./basic]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2             &#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 20
  dt = 1
[]

[VectorPostprocessors]
  [./xmass]
    type = LineValueSampler
    start_point = &#x27;-0.5 0 0&#x27;
    end_point = &#x27;0.5 0 0&#x27;
    sort_by = x
    num_points = 41
    variable = tracer
    outputs = csv
  [../]
[]

[Outputs]
  [./csv]
    type = CSV
    execute_on = &#x27;final&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9fa7661b-acd5-4f7f-be44-3976f438c285"><div class="modal-content"><h4>modules/porous_flow/test/tests/numerical_diffusion/no_action.i</h4><pre class="moose-pre"><code class="language-text"># Using upwinded and mass-lumped PorousFlow Kernels
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer]
  [../]
[]

[ICs]
  [./porepressure]
    type = FunctionIC
    variable = porepressure
    function = &#x27;1 - x&#x27;
  [../]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = tracer
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = tracer
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = porepressure
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = porepressure
  [../]
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1
    boundary = left
  [../]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_component_1]
    type = PorousFlowPiecewiseLinearSink
    variable = porepressure
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 1
    use_mobility = true
    flux_function = 1E3
  [../]
  [./remove_component_0]
    type = PorousFlowPiecewiseLinearSink
    variable = tracer
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 0
    use_mobility = true
    flux_function = 1E3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      thermal_expansion = 0
      viscosity = 1.0
      density0 = 1000.0
    [../]
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure tracer&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = tracer
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = the_simple_fluid
    phase = 0
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-2 0 0   0 1E-2 0   0 0 1E-2&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-1
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="cc17db24-33a4-462f-baa2-c6a1dd7669d3"><div class="modal-content"><h4>modules/porous_flow/test/tests/numerical_diffusion/fltvd.i</h4><pre class="moose-pre"><code class="language-text"># Using Flux-Limited TVD Advection ala Kuzmin and Turek, with antidiffusion from superbee flux limiting
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[Variables]
  [./tracer]
  [../]
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = MassLumpedTimeDerivative
    variable = tracer
  [../]
  [./flux]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo
  [../]
[]

[UserObjects]
  [./fluo]
    type = AdvectiveFluxCalculatorConstantVelocity
    flux_limiter_type = superbee
    u = tracer
    velocity = &#x27;0.1 0 0&#x27;
  [../]
[]

[BCs]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_tracer]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = right
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  nl_max_its = 500
  timestep_tolerance = 1E-3
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="0e864eb8-c817-4373-a7e1-aa6d68c2cba8"><div class="modal-content"><h4>modules/porous_flow/examples/flow_through_fractured_media/fine_transient.i</h4><pre class="moose-pre"><code class="language-text"># Using a mixed-dimensional mesh
# Transient flow and solute transport along a fracture in a porous matrix
# advective dominated flow in the fracture and diffusion into the porous matrix
#
# Note that fine_steady.i must be run to initialise the porepressure properly

[Mesh]
  file = &#x27;gold/fine_steady_out.e&#x27;
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./pp]
    initial_from_file_var = pp
    initial_from_file_timestep = 1
  [../]
  [./massfrac0]
  [../]
[]

[AuxVariables]
  [./velocity_x]
    family = MONOMIAL
    order = CONSTANT
    block = fracture
  [../]
  [./velocity_y]
    family = MONOMIAL
    order = CONSTANT
    block = fracture
  [../]
[]

[AuxKernels]
  [./velocity_x]
    type = PorousFlowDarcyVelocityComponentLowerDimensional
    variable = velocity_x
    component = x
    aperture = 6E-4
  [../]
  [./velocity_y]
    type = PorousFlowDarcyVelocityComponentLowerDimensional
    variable = velocity_y
    component = y
    aperture = 6E-4
  [../]
[]

[ICs]
  [./massfrac0]
    type = ConstantIC
    variable = massfrac0
    value = 0
  [../]
[]

[BCs]
  [./top]
    type = DirichletBC
    value = 0
    variable = massfrac0
    boundary = top
  [../]
  [./bottom]
    type = DirichletBC
    value = 1
    variable = massfrac0
    boundary = bottom
  [../]
  [./ptop]
    type = DirichletBC
    variable = pp
    boundary =  top
    value = 1e6
  [../]
  [./pbottom]
    type = DirichletBC
    variable = pp
    boundary = bottom
    value = 1.002e6
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pp
  [../]
  [./adv0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pp
  [../]
  [./diff0]
    type = PorousFlowDispersiveFlux
    fluid_component = 0
    variable = pp
    disp_trans = 0
    disp_long = 0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = massfrac0
  [../]
  [./adv1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = massfrac0
  [../]
  [./diff1]
    type = PorousFlowDispersiveFlux
    fluid_component = 1
    variable = massfrac0
    disp_trans = 0
    disp_long = 0
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp massfrac0&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseFullySaturated
    porepressure = pp
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = massfrac0
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./poro_fracture]
    type = PorousFlowPorosityConst
    porosity = 6e-4   # = a * phif
    block = &#x27;fracture&#x27;
  [../]
  [./poro_matrix]
    type = PorousFlowPorosityConst
    porosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./diff1]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 1.0
    block = &#x27;fracture&#x27;
  [../]
  [./diff2]
    type = PorousFlowDiffusivityConst
    diffusion_coeff = &#x27;1e-9 1e-9&#x27;
    tortuosity = 0.1
    block = &#x27;matrix1 matrix2&#x27;
  [../]
  [./relp]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./permeability_fracture]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.8e-11 0 0 0 1.8e-11 0 0 0 1.8e-11&#x27; # kf=3e-8, a=6e-4m.  1.8e-11 = kf * a
    block = &#x27;fracture&#x27;
  [../]
  [./permeability_matrix]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-20 0 0 0 1e-20 0 0 0 1e-20&#x27;
    block = &#x27;matrix1 matrix2&#x27;
  [../]
[]

[Functions]
  [./dt_controller]
     type = PiecewiseConstant
     x = &#x27;0    30   40 100 200 83200&#x27;
     y = &#x27;0.01 0.1  1  10  100 32&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./mumps_is_best_for_parallel_jobs]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
  [./basic]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2             &#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 86400

  [./TimeStepper]
    type = FunctionDT
    function = dt_controller
  [../]

# controls for nonlinear iterations
  nl_max_its = 15
  nl_rel_tol = 1e-14
  nl_abs_tol = 1e-9
[]


[VectorPostprocessors]
  [./xmass]
    type = LineValueSampler
    start_point = &#x27;0.4 0 0&#x27;
    end_point = &#x27;0.5 0 0&#x27;
    sort_by = x
    num_points = 167
    variable = massfrac0
  [../]
[]

[Outputs]
  perf_graph = true
  console = true
  csv = true
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="71ed2244-562e-4ce3-845f-a026249d3cb4"><div class="modal-content"><h4>test/tests/vectorpostprocessors/line_value_sampler/csv_delimiter.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
[]

[AuxVariables]
  [./v]
    initial_condition = 1.23456789
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    variable = &#x27;u v&#x27;
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
  [./csv]
    type = CSV
    delimiter = &#x27; &#x27;
    precision = 5
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="7705a044-1012-4431-a5ce-22dc21d80eb6"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s09.i</h4><pre class="moose-pre"><code class="language-text"># Apply a piecewise-linear sink flux to the right-hand side and watch fluid flow to it
#
# This test has a single phase with two components.  The test initialises with
# the porous material fully filled with component=1.  The left-hand side is fixed
# at porepressure=1 and mass-fraction of the zeroth component being unity.
# The right-hand side has a very strong piecewise-linear flux that keeps the
# porepressure~0 at that side.  Fluid mass is extracted by this flux in proportion
# to the fluid component mass fraction.
#
# Therefore, the zeroth fluid component will flow from left to right (down the
# pressure gradient).
#
# The important DE is
# porosity * dc/dt = (perm / visc) * grad(P) * grad(c)
# which is true for c = mass-fraction, and very large bulk modulus of the fluid.
# For grad(P) constant in time and space (as in this example) this is just the
# advection equation for c, with velocity = perm / visc / porosity.  The parameters
# are chosen to velocity = 1 m/s.
# In the numerical world, and especially with full upwinding, the advection equation
# suffers from diffusion.  In this example, the diffusion is obvious when plotting
# the mass-fraction along the line, but the average velocity of the front is still
# correct at 1 m/s.
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp frac&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Variables]
  [./pp]
  [../]
  [./frac]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = 1-x
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = frac
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = pp
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    gravity = &#x27;0 0 0&#x27;
    variable = frac
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    gravity = &#x27;0 0 0&#x27;
    variable = pp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1e10 # need large in order for constant-velocity advection
      density0 = 1 # almost irrelevant, except that the ability of the right BC to keep P fixed at zero is related to density_P0
      thermal_expansion = 0
      viscosity = 11
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = frac
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.1 0 0 0 1.1 0 0 0 1.1&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2 # irrelevant in this fully-saturated situation
    phase = 0
  [../]
[]


[BCs]
  [./lhs_fixed_a]
    type = DirichletBC
    boundary = &#x27;left&#x27;
    variable = frac
    value = 1
  [../]
  [./lhs_fixed_b]
    type = DirichletBC
    boundary = &#x27;left&#x27;
    variable = pp
    value = 1
  [../]
  [./flux0]
    type = PorousFlowPiecewiseLinearSink
    boundary = &#x27;right&#x27;
    pt_vals = &#x27;-100 100&#x27;
    multipliers = &#x27;-1 1&#x27;
    variable = frac # the zeroth comonent
    mass_fraction_component = 0
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 1E4
  [../]
  [./flux1]
    type = PorousFlowPiecewiseLinearSink
    boundary = &#x27;right&#x27;
    pt_vals = &#x27;-100 100&#x27;
    multipliers = &#x27;-1 1&#x27;
    variable = pp # comonent 1
    mass_fraction_component = 1
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 1E4
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 10000 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E-2
  end_time = 1
  nl_rel_tol = 1E-12
  nl_abs_tol = 1E-12
[]

[VectorPostprocessors]
  [./mf]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 100
    sort_by = x
    variable = frac
  [../]
[]

[Outputs]
  file_base = s09
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
  [../]
  [./csv]
    type = CSV
    sync_times = &#x27;0.1 0.5 1&#x27;
    sync_only = true
  [../]
  interval = 10
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="877b9894-c873-47b4-af01-e76ee2c74eca"><div class="modal-content"><h4>test/tests/executioners/nullspace/singular.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
 type = GeneratedMesh
 dim = 1
 xmin = 0
 xmax = 10
 nx = 8
[]

[Problem]
  null_space_dimension = 1
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]

  [./eig]
    type = MassEigenKernel
    variable = u
    eigen_postprocessor = 1.0002920196258376e+01
    eigen = false
  [../]

  [./force]
    type = CoupledForce
    variable = u
    v = aux_v
  [../]
[]

[AuxVariables]
  [./aux_v]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = eigen_mode
    [../]
  [../]
[]

[AuxKernels]
  [./set_source]
    type = FunctionAux
    variable = aux_v
    function = second_harmonic
    execute_on = timestep_begin
  [../]
[]

[Functions]
  [./eigen_mode]
    type = ParsedFunction
    value = &#x27;sqrt(2.0 / L) * sin(mode * pi  * x / L)&#x27;
    vars = &#x27;L  mode&#x27;
    vals = &#x27;10 1&#x27;
  [../]

  [./second_harmonic]
    type = ParsedFunction
    value = &#x27;sqrt(2.0 / L) * sin(mode * pi  * x / L)&#x27;
    vars = &#x27;L  mode&#x27;
    vals = &#x27;10 2&#x27;
  [../]
[]

[BCs]
  [./homogeneous]
    type = DirichletBC
    variable = u
    boundary = &#x27;0 1&#x27;
    value = 0
  [../]
[]

[VectorPostprocessors]
  [./sample_solution]
    type = LineValueSampler
    variable = u
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;10 0 0&#x27;
    sort_by = x
    num_points = 9
    execute_on = timestep_end
  [../]
[]

[Preconditioning]
  [./prec]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = SteadyWithNull
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_pc_side -snes_type -ksp_norm_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg  left ksponly preconditioned&#x27;
  nl_rel_tol = 1.0e-14
  nl_abs_tol = 1.0e-14
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5bc8b429-9d20-40fc-97f7-34bd26e3f70c"><div class="modal-content"><h4>test/tests/vectorpostprocessors/line_value_sampler/line_value_sampler.i</h4><pre class="moose-pre"><code class="language-text">###########################################################
# This is a simple test of the Vector Postprocessor
# System. A LineValueSampler is placed inside of a 2D
# domain to sample solution points uniformly along a line.
#
# @Requirement F6.30
###########################################################


[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
  [./v]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./diff_v]
    type = Diffusion
    variable = v
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
  [./left_v]
    type = DirichletBC
    variable = v
    boundary = left
    value = 1
  [../]
  [./right_v]
    type = DirichletBC
    variable = v
    boundary = right
    value = 0
  [../]
[]

[Postprocessors]
  [./u_avg]
    type = ElementAverageValue
    variable = u
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

# Vector Postprocessor System
[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    variable = &#x27;u v&#x27;
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a70ac4e3-9cc8-4c7f-a106-256ecf16120a"><div class="modal-content"><h4>modules/porous_flow/test/tests/infiltration_and_drainage/rd01.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 120
  ny = 1
  xmin = 0
  xmax = 6
  ymin = 0
  ymax = 0.05
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Functions]
  [./dts]
    type = PiecewiseLinear
    y = &#x27;1E-2 1 10 500 5000 5000&#x27;
    x = &#x27;0 10 100 1000 10000 100000&#x27;
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = pressure
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.336
    alpha = 1.43e-4
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      viscosity = 1.01e-3
      density0 = 1000
      thermal_expansion = 0
    [../]
  [../]
[]

[Materials]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityVG
    m = 0.336
    seff_turnover = 0.99
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.33
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;0.295E-12 0 0  0 0.295E-12 0  0 0 0.295E-12&#x27;
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = -72620.4
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pressure
    gravity = &#x27;-10 0 0&#x27;
  [../]
[]

[AuxVariables]
  [./SWater]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./SWater]
    type = MaterialStdVectorAux
    property = PorousFlow_saturation_qp
    index = 0
    variable = SWater
  [../]
[]

[BCs]
  [./base]
    type = PorousFlowSink
    boundary = right
    flux_function = -2.315E-3
    variable = pressure
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-10      1E-10      10&#x27;
  [../]
[]

[VectorPostprocessors]
  [./swater]
    type = LineValueSampler
    variable = SWater
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;6 0 0&#x27;
    sort_by = x
    num_points = 121
    execute_on = timestep_end
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  petsc_options = &#x27;-snes_converged_reason&#x27;
  end_time = 359424

  [./TimeStepper]
    type = FunctionDT
    function = dts
  [../]
[]

[Outputs]
  file_base = rd01
  [./exodus]
    type = Exodus
    execute_on = &#x27;initial final&#x27;
  [../]
  [./along_line]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="8bff19ce-9c7b-459e-909b-df5ce23732e2"><div class="modal-content"><h4>test/tests/bcs/vectorpostprocessor/vectorpostprocessor.i</h4><pre class="moose-pre"><code class="language-text">
[Mesh]
  type = GeneratedMesh
  nx = 10
  ny = 10
  xmax = 1
  ymax = 1
  dim = 2
[]

[Variables]
  [./u]
  [../]
  [./v]
  [../]
[]

[Kernels]
  [./conv]
    type = ConservativeAdvection
    variable = u
    velocity = &#x27;0 1 0&#x27;
  [../]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./src]
    type = BodyForce
    variable = u
    function = ffn
  [../]
  [./diffv]
    type = Diffusion
    variable = v
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = bottom
    value = 2
  [../]
  [./right]
    type = ChannelGradientBC
    variable = u
    boundary = right
    channel_gradient_pps = channel_gradient
    axis = y
    h_name = h
  [../]
  [./top]
    type = OutflowBC
    variable = u
    boundary = top
    velocity = &#x27;0 1 0&#x27;
  [../]
  [./leftv]
    type = DirichletBC
    variable = v
    boundary = left
    value = 0
  [../]
  [./rightv]
    type = DirichletBC
    variable = v
    boundary = right
    value = 1
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;h&#x27;

    #Nu = 4
    #k = 1
    #half_channel_length = 0.5
    #h=Nu*k/half_channel_length
    prop_values = &#x27;8&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  exodus = true
[]

[VectorPostprocessors]
  [./lv1]
    num_points = 30
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;0 1 0&#x27;
    sort_by = &#x27;y&#x27;
    variable = u
    type = LineValueSampler
    execute_on = &#x27;timestep_begin nonlinear timestep_end linear&#x27;
  [../]
  [./lv2]
    num_points = 30
    start_point = &#x27;1 0 0&#x27;
    end_point =   &#x27;1 1 0&#x27;
    sort_by = &#x27;y&#x27;
    variable = v
    type = LineValueSampler
    execute_on = &#x27;timestep_begin nonlinear timestep_end linear&#x27;
  [../]
  [./channel_gradient]
    lv1 = lv1
    lv2 = lv2
    var1 = u
    var2 = v
    axis = y
    type = ChannelGradientVectorPostprocessor
    execute_on = &#x27;timestep_begin nonlinear timestep_end linear&#x27;
  [../]
[]

[Functions]
  [./ffn]
    type = ParsedFunction
    value = &#x27;1&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="a65773dc-898c-43c1-9c60-648ee378c2e2"><div class="modal-content"><h4>test/tests/vectorpostprocessors/least_squares_fit_history/least_squares_fit_history.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
  [./v]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./diff_v]
    type = Diffusion
    variable = v
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = FunctionDirichletBC
    variable = u
    boundary = right
    function = &#x27;t&#x27;
  [../]
  [./left_v]
    type = FunctionDirichletBC
    variable = v
    boundary = left
    function = &#x27;t&#x27;
  [../]
  [./right_v]
    type = DirichletBC
    variable = v
    boundary = right
    value = 0
  [../]
[]

[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    variable = &#x27;u v&#x27;
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = id
    outputs = none
  [../]
  [./least_squares_fit_coeffs]
    type = LeastSquaresFitHistory
    vectorpostprocessor = line_sample
    x_name = &#x27;id&#x27;
    y_name = &#x27;u&#x27;
    order = 1
  [../]
  [./shift_and_scale_x_least_squares_fit_coeffs]
    type = LeastSquaresFitHistory
    vectorpostprocessor = line_sample
    x_name = &#x27;id&#x27;
    y_name = &#x27;u&#x27;
    x_shift = 1
    x_scale = 10
    order = 1
  [../]
  [./shift_and_scale_y_least_squares_fit_coeffs]
    type = LeastSquaresFitHistory
    vectorpostprocessor = line_sample
    x_name = &#x27;id&#x27;
    y_name = &#x27;u&#x27;
    y_shift = 1
    y_scale = 10
    order = 1
  [../]
[]

[Executioner]
  type = Transient
  start_time = 0.0
  num_steps = 3
  dt = 1.0
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  file_base = out
  execute_on = &#x27;timestep_end&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="da7f8923-7200-48b0-8f29-5e87d6b9f0e8"><div class="modal-content"><h4>modules/porous_flow/test/tests/relperm/corey3.i</h4><pre class="moose-pre"><code class="language-text"># Test Corey relative permeability curve by varying saturation over the mesh
# Residual saturation of phase 0: s0r = 0.2
# Residual saturation of phase 1: s1r = 0.3

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
    family = LAGRANGE
    order = FIRST
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./kr0]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 0
    variable = kr0aux
  [../]
  [./kr1]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 1
    variable = kr1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityCorey
    phase = 0
    n = 2
    s_res = 0.2
    sum_s_res = 0.5
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 2
    s_res = 0.3
    sum_s_res = 0.5
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux kr0aux kr1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 20
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-8
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="68db02e7-13ca-4934-a186-d884750383fd"><div class="modal-content"><h4>modules/porous_flow/test/tests/thm_rehbinder/fixed_outer_rz.i</h4><pre class="moose-pre"><code class="language-text"># A version of fixed_outer.i that uses the RZ cylindrical coordinate system
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 40 # this is the r direction
  ny = 1 # this is the height direction
  xmin = 0.1
  xmax = 1
  bias_x = 1.1
  ymin = 0.0
  ymax = 1.0
[]

[Problem]
  coord_type = RZ
[]

[GlobalParams]
  displacements = &#x27;disp_r disp_z&#x27;
  PorousFlowDictator = dictator
  biot_coefficient = 1.0
[]

[Variables]
  [./disp_r]
  [../]
  [./disp_z]
  [../]
  [./porepressure]
  [../]
  [./temperature]
  [../]
[]

[BCs]
  [./plane_strain]
    type = DirichletBC
    variable = disp_z
    value = 0
    boundary = &#x27;top bottom&#x27;
  [../]

  [./cavity_temperature]
    type = DirichletBC
    variable = temperature
    value = 1000
    boundary = left
  [../]
  [./cavity_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1E6
    boundary = left
  [../]
  [./cavity_zero_effective_stress_x]
    type = Pressure
    component = 0
    variable = disp_r
    function = 1E6
    boundary = left
    use_displaced_mesh = false
  [../]

  [./outer_temperature]
    type = DirichletBC
    variable = temperature
    value = 0
    boundary = right
  [../]
  [./outer_pressure]
    type = DirichletBC
    variable = porepressure
    value = 0
    boundary = right
  [../]
  [./fixed_outer_disp]
    type = DirichletBC
    variable = disp_r
    value = 0
    boundary = right
  [../]
[]

[AuxVariables]
  [./stress_rr]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_pp]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./stress_rr]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_rr
    index_i = 0
    index_j = 0
  [../]
  [./stress_pp] # hoop stress
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_pp
    index_i = 2
    index_j = 2
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      thermal_expansion = 0.0
      bulk_modulus = 1E12
      viscosity = 1.0E-3
      density0 = 1000.0
      cv = 1000.0
      cp = 1000.0
      porepressure_coefficient = 0.0
    [../]
  [../]
[]

[PorousFlowBasicTHM]
  coupling_type = ThermoHydroMechanical
  multiply_by_density = false
  add_stress_aux = true
  porepressure = porepressure
  temperature = temperature
  eigenstrain_names = thermal_contribution
  gravity = &#x27;0 0 0&#x27;
  fp = the_simple_fluid
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 1E10
    poissons_ratio = 0.2
  [../]
  [./strain]
    type = ComputeAxisymmetricRZSmallStrain
    eigenstrain_names = thermal_contribution
  [../]
  [./thermal_contribution]
    type = ComputeThermalExpansionEigenstrain
    temperature = temperature
    thermal_expansion_coeff = 1E-6
    eigenstrain_name = thermal_contribution
    stress_free_temperature = 0.0
  [../]
  [./stress]
    type = ComputeLinearElasticStress
  [../]
  [./porosity]
    type = PorousFlowPorosityConst # only the initial value of this is ever used
    porosity = 0.1
  [../]
  [./biot_modulus]
    type = PorousFlowConstantBiotModulus
    solid_bulk_compliance = 1E-10
    fluid_bulk_modulus = 1E12
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-12 0 0   0 1E-12 0   0 0 1E-12&#x27; # note this is ordered: rr, zz, angle-angle
  [../]
  [./thermal_expansion]
    type = PorousFlowConstantThermalExpansionCoefficient
    fluid_coefficient = 1E-6
    drained_coefficient = 1E-6
  [../]
  [./thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;1E6 0 0  0 1E6 0  0 0 1E6&#x27; # note this is ordered: rr, zz, angle-angle
  [../]
[]

[VectorPostprocessors]
  [./P]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = porepressure
  [../]
  [./T]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = temperature
  [../]
  [./U]
    type = LineValueSampler
    start_point = &#x27;0.1 0 0&#x27;
    end_point = &#x27;1.0 0 0&#x27;
    num_points = 10
    sort_by = x
    variable = disp_r
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_rtol&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           1E-8&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = Newton
[]

[Outputs]
  file_base = fixed_outer_rz
  execute_on = timestep_end
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="cd737f0b-c428-4252-a1d6-1afad9764ec5"><div class="modal-content"><h4>modules/rdg/test/tests/advection_1d/rdgP0.i</h4><pre class="moose-pre"><code class="language-text"># This test demonstrates the advection of a tracer in 1D using the RDG module.
# There is no slope limiting.  Changing the SlopeLimiting scheme to minmod, mc,
# or superbee means that a linear reconstruction is performed, and the slope
# limited according to the scheme chosen.  Doing this produces RDG(P0P1) and
# substantially reduces numerical diffusion

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[Variables]
  [./tracer]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[UserObjects]
  [./lslope]
    type = AEFVSlopeLimitingOneD
    execute_on = &#x27;linear&#x27;
    scheme = &#x27;none&#x27; #none | minmod | mc | superbee
    u = tracer
  [../]

  [./internal_side_flux]
    type = AEFVUpwindInternalSideFlux
    execute_on = &#x27;linear&#x27;
    velocity = 0.1
  [../]

  [./free_outflow_bc]
    type = AEFVFreeOutflowBoundaryFlux
    execute_on = &#x27;linear&#x27;
    velocity = 0.1
  [../]
[]

[Kernels]
  [./dot]
    type = TimeDerivative
    variable = tracer
  [../]
[]
[DGKernels]
  [./concentration]
    type = AEFVKernel
    variable = tracer
    component = &#x27;concentration&#x27;
    flux = internal_side_flux
    u = tracer
  [../]
[]

[BCs]
  [./concentration]
    type = AEFVBC
    boundary = &#x27;left right&#x27;
    variable = tracer
    component = &#x27;concentration&#x27;
    flux = free_outflow_bc
    u = tracer
  [../]
[]

[Materials]
  [./aefv]
    type = AEFVMaterial
    slope_limiting = lslope
    u = tracer
  [../]
[]


[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = PJFNK
  end_time = 6
  dt = 6E-1
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  #exodus = true
  csv = true
  execute_on = final
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="fbd61070-c3f7-470e-ad7e-1b98c0a8385a"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/s09_fully_saturated.i</h4><pre class="moose-pre"><code class="language-text"># Apply a piecewise-linear sink flux to the right-hand side and watch fluid flow to it
#
# This test has a single phase with two components.  The test initialises with
# the porous material fully filled with component=1.  The left-hand side is fixed
# at porepressure=1 and mass-fraction of the zeroth component being unity.
# The right-hand side has a very strong piecewise-linear flux that keeps the
# porepressure~0 at that side.  Fluid mass is extracted by this flux in proportion
# to the fluid component mass fraction.
#
# Therefore, the zeroth fluid component will flow from left to right (down the
# pressure gradient).
#
# The important DE is
# porosity * dc/dt = (perm / visc) * grad(P) * grad(c)
# which is true for c = mass-fraction, and very large bulk modulus of the fluid.
# For grad(P) constant in time and space (as in this example) this is just the
# advection equation for c, with velocity = perm / visc / porosity.  The parameters
# are chosen to velocity = 1 m/s.
# In the numerical world, and especially with full upwinding, the advection equation
# suffers from diffusion.  In this example, the diffusion is obvious when plotting
# the mass-fraction along the line, but the average velocity of the front is still
# correct at 1 m/s.
# This test uses the FullySaturated version of the flow Kernel.  This does not
# suffer from as much numerical diffusion as the standard PorousFlow Kernel since
# it does not employ any upwinding.
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pp frac&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1
  [../]
[]

[Variables]
  [./pp]
  [../]
  [./frac]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = 1-x
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = frac
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = pp
  [../]
  [./flux0]
    type = PorousFlowFullySaturatedDarcyFlow
    fluid_component = 0
    gravity = &#x27;0 0 0&#x27;
    variable = frac
  [../]
  [./flux1]
    type = PorousFlowFullySaturatedDarcyFlow
    fluid_component = 1
    gravity = &#x27;0 0 0&#x27;
    variable = pp
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1e10 # need large in order for constant-velocity advection
      density0 = 1 # almost irrelevant, except that the ability of the right BC to keep P fixed at zero is related to density_P0
      thermal_expansion = 0
      viscosity = 11
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pp
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = frac
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.1 0 0 0 1.1 0 0 0 1.1&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey
    n = 2 # irrelevant in this fully-saturated situation
    phase = 0
  [../]
[]

[BCs]
  [./lhs_fixed_a]
    type = DirichletBC
    boundary = &#x27;left&#x27;
    variable = frac
    value = 1
  [../]
  [./lhs_fixed_b]
    type = DirichletBC
    boundary = &#x27;left&#x27;
    variable = pp
    value = 1
  [../]
  [./flux0]
    type = PorousFlowPiecewiseLinearSink
    boundary = &#x27;right&#x27;
    pt_vals = &#x27;-100 100&#x27;
    multipliers = &#x27;-1 1&#x27;
    variable = frac # the zeroth comonent
    mass_fraction_component = 0
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 1E4
  [../]
  [./flux1]
    type = PorousFlowPiecewiseLinearSink
    boundary = &#x27;right&#x27;
    pt_vals = &#x27;-100 100&#x27;
    multipliers = &#x27;-1 1&#x27;
    variable = pp # comonent 1
    mass_fraction_component = 1
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 1E4
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu 10000 NONZERO 2&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1E-2
  end_time = 1
  nl_rel_tol = 1E-11
  nl_abs_tol = 1E-11
[]

[VectorPostprocessors]
  [./mf]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 100
    sort_by = x
    variable = frac
  [../]
[]

[Outputs]
  file_base = s09_fully_saturated
  [./console]
    type = Console
    execute_on = &#x27;nonlinear linear&#x27;
  [../]
  [./csv]
    type = CSV
    sync_times = &#x27;0.1 0.5 1&#x27;
    sync_only = true
  [../]
  interval = 10
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b3a83be4-dd9d-423e-88eb-1ce8768dca71"><div class="modal-content"><h4>modules/porous_flow/test/tests/relperm/corey2.i</h4><pre class="moose-pre"><code class="language-text"># Test Corey relative permeability curve by varying saturation over the mesh
# Corey exponent n = 2 for both phases
# No residual saturation in either phase

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
    family = LAGRANGE
    order = FIRST
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./kr0]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 0
    variable = kr0aux
  [../]
  [./kr1]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 1
    variable = kr1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityCorey
    phase = 0
    n = 2
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 2
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux kr0aux kr1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 20
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-8
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="6e26d8c7-73d3-4d35-a756-269b5c000b9e"><div class="modal-content"><h4>modules/porous_flow/test/tests/newton_cooling/nc02.i</h4><pre class="moose-pre"><code class="language-text"># Newton cooling from a bar.  1-phase steady
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1000
  ny = 1
  xmin = 0
  xmax = 100
  ymin = 0
  ymax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pressure&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Variables]
  [./pressure]
  [../]
[]

[ICs]
  [./pressure]
    type = FunctionIC
    variable = pressure
    function = &#x27;(2-x/100)*1E6&#x27;
  [../]
[]

[Kernels]
  [./flux]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    gravity = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1e6
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-15 0 0 0 1E-15 0 0 0 1E-15&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey # irrelevant in this fully-saturated situation
    n = 2
    phase = 0
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 2E6
  [../]
  [./newton]
    type = PorousFlowPiecewiseLinearSink
    variable = pressure
    boundary = right
    pt_vals = &#x27;0 100000 200000 300000 400000 500000 600000 700000 800000 900000 1000000 1100000 1200000 1300000 1400000 1500000 1600000 1700000 1800000 1900000 2000000&#x27;
    multipliers = &#x27;0. 5.6677197748570516e-6 0.000011931518841831313 0.00001885408740732065 0.000026504708864284114 0.000034959953203725676 0.000044304443352900224 0.00005463170211001232 0.00006604508815181467 0.00007865883048198513 0.00009259917167338928 0.00010800563134618119 0.00012503240252705603 0.00014384989486488752 0.00016464644014777016 0.00018763017719085535 0.0002130311349595711 0.00024110353477682344 0.00027212833465544285 0.00030641604122040985 0.00034430981736352295&#x27;
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 1
  [../]
[]

[VectorPostprocessors]
  [./porepressure]
    type = LineValueSampler
    variable = pressure
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;100 0.5 0&#x27;
    sort_by = x
    num_points = 20
    execute_on = timestep_end
  [../]
[]

[Preconditioning]
  active = &#x27;andy&#x27;
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol &#x27;
    petsc_options_value = &#x27;gmres asm lu 100 NONZERO 2 1E-12 1E-15&#x27;
  [../]
[]

[Executioner]
  type = Steady
[]

[Outputs]
  file_base = nc02
  execute_on = timestep_end
  exodus = false
  [./along_line]
    type = CSV
    execute_vector_postprocessors_on = timestep_end
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="b2fa396a-138f-4303-a5f6-667151b99bbe"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/static_deformations/beam_cosserat_01.i</h4><pre class="moose-pre"><code class="language-text"># Beam bending.  One end is clamped and the other end is subjected to
# a surface traction.
# The joint normal and shear stiffnesses are set very large, so
# that this situation should be identical to the standard (non-Cosserat)
# isotropic elasticity case.
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 40
  xmax = 10
  ny = 1
  nz = 4
  zmin = -0.5
  zmax = 0.5
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  Cosserat_rotations = &#x27;wc_x wc_y wc_z&#x27;
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./wc_x]
  [../]
  [./wc_y]
  [../]
[]

[Kernels]
  [./cx_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./cy_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./cz_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./x_couple]
    type = StressDivergenceTensors
    variable = wc_x
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 0
    base_name = couple
  [../]
  [./y_couple]
    type = StressDivergenceTensors
    variable = wc_y
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 1
    base_name = couple
  [../]
  [./x_moment]
    type = MomentBalancing
    variable = wc_x
    component = 0
  [../]
  [./y_moment]
    type = MomentBalancing
    variable = wc_y
    component = 1
  [../]
[]

[BCs]
  # zmin is called back
  # zmax is called front
  # ymin is called bottom
  # ymax is called top
  # xmin is called left
  # xmax is called right
  [./no_dispy]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;bottom top&#x27;
    value = 0.0
  [../]
  [./no_wc_x]
    type = DirichletBC
    variable = wc_x
    boundary = &#x27;bottom top back front left right&#x27;
    value = 0.0
  [../]
  [./clamp_z]
    type = DirichletBC
    variable = disp_z
    boundary = left
    value = 0.0
  [../]
  [./clamp_x]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./end_traction]
    type = VectorNeumannBC
    variable = disp_z
    vector_value = &#x27;-2E-4 0 0&#x27;
    boundary = right
  [../]
[]

[AuxVariables]
  [./wc_z]
  [../]
  [./stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./stress_zy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./couple_stress_xx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./couple_stress_xy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./couple_stress_xz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./couple_stress_yx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./couple_stress_yy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./couple_stress_yz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./couple_stress_zx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./couple_stress_zy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./couple_stress_zz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zz
    index_i = 2
    index_j = 2
  [../]
[]

[VectorPostprocessors]
  [./soln]
    type = LineValueSampler
    sort_by = x
    variable = &#x27;disp_x disp_z stress_xx stress_xz stress_zx stress_zz wc_x wc_y  couple_stress_xx couple_stress_xz couple_stress_zx couple_stress_zz&#x27;
    start_point = &#x27;0 0 0.5&#x27;
    end_point = &#x27;10 0 0.5&#x27;
    num_points = 11
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeLayeredCosseratElasticityTensor
    young = 1.2
    poisson = 0.3
    layer_thickness = 1
    joint_normal_stiffness = 1E16
    joint_shear_stiffness = 1E16
  [../]
  [./strain]
    type = ComputeCosseratSmallStrain
  [../]
  [./stress]
    type = ComputeCosseratLinearElasticStress
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it -ksp_atol -ksp_rtol -sub_pc_factor_shift_type&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-10 1E-14 10 1E-15 1E-10 NONZERO&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  num_steps = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = beam_cosserat_01
  csv = true
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="19980369-e4a3-48e1-9777-ad052d14b324"><div class="modal-content"><h4>modules/porous_flow/test/tests/numerical_diffusion/pffltvd_action.i</h4><pre class="moose-pre"><code class="language-text"># Using flux-limited TVD advection ala Kuzmin and Turek, employing PorousFlow Kernels and UserObjects, with superbee flux-limiter
# Using the PorousFlowFullySaturated Action
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer]
  [../]
[]

[ICs]
  [./porepressure]
    type = FunctionIC
    variable = porepressure
    function = &#x27;1 - x&#x27;
  [../]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[PorousFlowFullySaturated]
  porepressure = porepressure
  coupling_type = Hydro
  fp = the_simple_fluid
  mass_fraction_vars = tracer
  stabilization = KT
  flux_limiter_type = superbee
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1
    boundary = left
  [../]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_component_1]
    type = PorousFlowPiecewiseLinearSink
    variable = porepressure
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 1
    use_mobility = true
    flux_function = 1E3
  [../]
  [./remove_component_0]
    type = PorousFlowPiecewiseLinearSink
    variable = tracer
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 0
    use_mobility = true
    flux_function = 1E3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      thermal_expansion = 0
      viscosity = 1.0
      density0 = 1000.0
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-2 0 0   0 1E-2 0   0 0 1E-2&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  file_base = pffltvd_out
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="97ec7758-ae44-4d06-8ea1-cc7b35efe369"><div class="modal-content"><h4>modules/tensor_mechanics/test/tests/static_deformations/cosserat_glide.i</h4><pre class="moose-pre"><code class="language-text"># Example taken from Appendix A of
# S Forest &quot;Mechanics of Cosserat media An introduction&quot;.  Available from http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.154.4476&amp;rep=rep1&amp;type=pdf
#
# Analytically, the displacements are
# wc_z = B sinh(w_e y)
# disp_x = (2 mu_c B / w_e / (mu + mu_c)) (1 - cosh(w_e y))
# with w_e^2 = 2 mu mu_c / be / (mu + mu_c)
# and B = arbitrary integration constant
#
# Also, the only nonzero stresses are
# m_zy = 2 B be w_e cosh(w_e y)
# si_yx = -4 mu mu_c/(mu + mu_c) B sinh(w_e y)
#
# MOOSE gives these stress components correctly.
# However, it also gives a seemingly non-zero si_xy
# component.  Upon increasing the resolution of the
# mesh (ny=10000, for example), the stress components
# are seen to limit correctly to the above forumlae
#
# I use mu = 2, mu_c = 3, be = 0.6, so w_e = 2
# Also i use B = 1, so at y = 1
# wc_z = 3.626860407847
# disp_x = -1.65731741465
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 1
  ny = 100
  ymax = 1
  nz = 1
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  Cosserat_rotations = &#x27;wc_x wc_y wc_z&#x27;
[]

[Variables]
  [./disp_x]
  [../]
  [./disp_y]
  [../]
  [./disp_z]
  [../]
  [./wc_x]
  [../]
  [./wc_y]
  [../]
  [./wc_z]
  [../]
[]

[Kernels]
  [./cx_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_x
    component = 0
  [../]
  [./cy_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_y
    component = 1
  [../]
  [./cz_elastic]
    type = CosseratStressDivergenceTensors
    variable = disp_z
    component = 2
  [../]
  [./x_couple]
    type = StressDivergenceTensors
    variable = wc_x
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 0
    base_name = couple
  [../]
  [./y_couple]
    type = StressDivergenceTensors
    variable = wc_y
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 1
    base_name = couple
  [../]
  [./z_couple]
    type = StressDivergenceTensors
    variable = wc_z
    displacements = &#x27;wc_x wc_y wc_z&#x27;
    component = 2
    base_name = couple
  [../]
  [./x_moment]
    type = MomentBalancing
    variable = wc_x
    component = 0
  [../]
  [./y_moment]
    type = MomentBalancing
    variable = wc_y
    component = 1
  [../]
  [./z_moment]
    type = MomentBalancing
    variable = wc_z
    component = 2
  [../]
[]

[BCs]
  # zmin is called back
  # zmax is called front
  # ymin is called bottom
  # ymax is called top
  # xmin is called left
  # xmax is called right
  [./disp_x_zero_at_y_zero]
    type = DirichletBC
    variable = disp_x
    boundary = bottom
    value = 0
  [../]
  [./disp_x_fixed_at_y_max]
    type = DirichletBC
    variable = disp_x
    boundary = top
    value = -1.65731741465
  [../]
  [./no_dispy]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back front bottom top left right&#x27;
    value = 0
  [../]
  [./no_dispz]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back front bottom top left right&#x27;
    value = 0
  [../]
  [./no_wc_x]
    type = DirichletBC
    variable = wc_x
    boundary = &#x27;back front bottom top left right&#x27;
    value = 0
  [../]
  [./no_wc_y]
    type = DirichletBC
    variable = wc_y
    boundary = &#x27;back front bottom top left right&#x27;
    value = 0
  [../]
  [./wc_z_zero_at_y_zero]
    type = DirichletBC
    variable = wc_z
    boundary = bottom
    value = 0
  [../]
  [./wc_z_fixed_at_y_max]
    type = DirichletBC
    variable = wc_z
    boundary = top
    value = 3.626860407847
  [../]
[]

[AuxVariables]
  [./stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_xz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_yz]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zx]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zy]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./couple_stress_zz]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./stress_xx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./stress_xy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./stress_xz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./stress_yx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./stress_yy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./stress_yz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./stress_zx]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./stress_zy]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./stress_zz]
    type = RankTwoAux
    rank_two_tensor = stress
    variable = stress_zz
    index_i = 2
    index_j = 2
  [../]
  [./couple_stress_xx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xx
    index_i = 0
    index_j = 0
  [../]
  [./couple_stress_xy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xy
    index_i = 0
    index_j = 1
  [../]
  [./couple_stress_xz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_xz
    index_i = 0
    index_j = 2
  [../]
  [./couple_stress_yx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yx
    index_i = 1
    index_j = 0
  [../]
  [./couple_stress_yy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yy
    index_i = 1
    index_j = 1
  [../]
  [./couple_stress_yz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_yz
    index_i = 1
    index_j = 2
  [../]
  [./couple_stress_zx]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zx
    index_i = 2
    index_j = 0
  [../]
  [./couple_stress_zy]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zy
    index_i = 2
    index_j = 1
  [../]
  [./couple_stress_zz]
    type = RankTwoAux
    rank_two_tensor = couple_stress
    variable = couple_stress_zz
    index_i = 2
    index_j = 2
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeCosseratElasticityTensor
    B_ijkl = &#x27;1.1 0.6 0.6&#x27; # In Forest notation this is alpha=1.1 (this is unimportant), beta=gamma=0.6.
    fill_method_bending = &#x27;general_isotropic&#x27;
    E_ijkl = &#x27;1 2 3&#x27; # In Forest notation this is lambda=1 (this is unimportant), mu=2, mu_c=3
    fill_method = &#x27;general_isotropic&#x27;
  [../]
  [./strain]
    type = ComputeCosseratSmallStrain
  [../]
  [./stress]
    type = ComputeCosseratLinearElasticStress
  [../]
[]

[VectorPostprocessors]
  [./soln]
    type = LineValueSampler
    sort_by = y
    variable = &#x27;disp_x wc_z stress_yx couple_stress_zy&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;0 1 0&#x27;
    num_points = 11
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_atol -snes_rtol -snes_max_it -ksp_atol -ksp_rtol&#x27;
    petsc_options_value = &#x27;gmres asm lu 1E-10 1E-14 10 1E-15 1E-10&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  num_steps = 1
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  file_base = cosserat_glide_out
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="889a83cd-4f65-4bba-aff4-271002a01d0d"><div class="modal-content"><h4>modules/porous_flow/test/tests/capillary_pressure/brooks_corey1.i</h4><pre class="moose-pre"><code class="language-text"># Test Brooks-Corey capillary pressure curve by varying saturation over the mesh
# lambda = 2, sat_lr = 0.1, log_extension = false

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 500
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./p1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./p0]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 0
    variable = p0aux
  [../]
  [./p1]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = p1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureBC
    lambda = 2
    log_extension = false
    pe = 1e5
    sat_lr = 0.1
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityVG
    phase = 0
    m = 0.5
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityCorey
    phase = 1
    n = 2
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux p0aux p1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 500
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-6
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="aebe98a5-5a8b-45d5-82a0-8a7db0b4f508"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_advection/fltvd_2D.i</h4><pre class="moose-pre"><code class="language-text"># Using Flux-Limited TVD Advection ala Kuzmin and Turek, with antidiffusion from superbee flux limiting
# 2D version
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  xmin = 0
  xmax = 1
  ny = 4
  ymin = 0
  ymax = 0.5
[]

[Variables]
  [./tracer]
  [../]
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = MassLumpedTimeDerivative
    variable = tracer
  [../]
  [./flux]
    type = FluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = fluo
  [../]
[]

[UserObjects]
  [./fluo]
    type = AdvectiveFluxCalculatorConstantVelocity
    flux_limiter_type = superbee
    u = tracer
    velocity = &#x27;0.1 0 0&#x27;
  [../]
[]

[BCs]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_tracer]
# Ideally, an OutflowBC would be used, but that does not exist in the framework
# In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = right
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  nl_max_its = 500
  timestep_tolerance = 1E-3
[]

[Outputs]
  print_linear_residuals = false
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2a0b8bc5-7e2f-488d-bcfc-84f494215550"><div class="modal-content"><h4>modules/porous_flow/test/tests/numerical_diffusion/framework.i</h4><pre class="moose-pre"><code class="language-text"># Using framework objects: no mass lumping or upwinding
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
  xmin = 0
  xmax = 1
[]

[Variables]
  [./tracer]
  [../]
[]

[ICs]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass_dot]
    type = TimeDerivative
    variable = tracer
  [../]
  [./flux]
    type = ConservativeAdvection
    velocity = &#x27;0.1 0 0&#x27;
    variable = tracer
  [../]
[]

[BCs]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_tracer]
    # Ideally, an OutflowBC would be used, but that does not exist in the framework
    # In 1D VacuumBC is the same as OutflowBC, with the alpha parameter being twice the velocity
    type = VacuumBC
    boundary = right
    alpha = 0.2 # 2 * velocity
    variable = tracer
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-1
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="bec84908-b99e-43fa-b967-619ed7cbe819"><div class="modal-content"><h4>modules/porous_flow/test/tests/sinks/injection_production_eg.i</h4><pre class="moose-pre"><code class="language-text"># phase = 0 is liquid phase
# phase = 1 is gas phase
# fluid_component = 0 is water
# fluid_component = 1 is CO2

# Constant rate of CO2 injection into the left boundary
# 1D mesh
# The PorousFlowPiecewiseLinearSinks remove the correct water and CO2 from the right boundary

# Note i take pretty big timesteps here so the system is quite nonlinear

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 20
  xmax = 20
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[AuxVariables]
  [./saturation_gas]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./frac_water_in_liquid]
    initial_condition = 1.0
  [../]
  [./frac_water_in_gas]
    initial_condition = 0.0
  [../]
[]

[AuxKernels]
  [./saturation_gas]
    type = PorousFlowPropertyAux
    variable = saturation_gas
    property = saturation
    phase = 1
    execute_on = timestep_end
  [../]
[]

[Variables]
  [./pwater]
    initial_condition = 20E6
  [../]
  [./pgas]
    initial_condition = 20.1E6
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pwater
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = pgas
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = pgas
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pgas pwater&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    alpha = 1E-6
    m = 0.6
  [../]
[]

[Modules]
  [./FluidProperties]
    [./true_water]
      type = Water97FluidProperties
    [../]
    [./tabulated_water]
      type = TabulatedFluidProperties
      fp = true_water
      temperature_min = 275
      pressure_max = 1E8
      interpolated_properties = &#x27;density viscosity enthalpy internal_energy&#x27;
      fluid_property_file = water97_tabulated_11.csv
    [../]
    [./true_co2]
      type = CO2FluidProperties
    [../]
    [./tabulated_co2]
      type = TabulatedFluidProperties
      fp = true_co2
      temperature_min = 275
      pressure_max = 1E8
      interpolated_properties = &#x27;density viscosity enthalpy internal_energy&#x27;
      fluid_property_file = co2_tabulated_11.csv
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = 293.15
  [../]
  [./saturation_calculator]
    type = PorousFlow2PhasePP
    phase0_porepressure = pwater
    phase1_porepressure = pgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;frac_water_in_liquid frac_water_in_gas&#x27;
  [../]
  [./water]
    type = PorousFlowSingleComponentFluid
    fp = tabulated_water
    phase = 0
  [../]
  [./co2]
    type = PorousFlowSingleComponentFluid
    fp = tabulated_co2
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.2
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-12 0 0 0 1e-12 0 0 0 1e-12&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
    s_res = 0.1
    sum_s_res = 0.2
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityBC
    nw_phase = true
    lambda = 2
    s_res = 0.1
    sum_s_res = 0.2
    phase = 1
  [../]
[]

[BCs]
  [./co2_injection]
    type = PorousFlowSink
    boundary = left
    variable = pgas # pgas is associated with the CO2 mass balance (fluid_component = 1 in its Kernels)
    flux_function = -1E-2 # negative means a source, rather than a sink
  [../]

  [./right_water]
    type = PorousFlowPiecewiseLinearSink
    boundary = right

    # a sink of water, since the Kernels given to pwater are for fluid_component = 0 (the water)
    variable = pwater

    # this Sink is a function of liquid porepressure
    # Also, all the mass_fraction, mobility and relperm are referenced to the liquid phase now
    fluid_phase = 0

    # Sink strength = (Pwater - 20E6)
    pt_vals = &#x27;0 1E9&#x27;
    multipliers = &#x27;0 1E9&#x27;
    PT_shift = 20E6

    # multiply Sink strength computed above by mass fraction of water at the boundary
    mass_fraction_component = 0

    # also multiply Sink strength by mobility of the liquid
    use_mobility = true

    # also multiply Sink strength by the relperm of the liquid
    use_relperm = true

    # also multiplly Sink strength by 1/L, where L is the distance to the fixed-porepressure external environment
    flux_function = 10 # 1/L
  [../]

  [./right_co2]
    type = PorousFlowPiecewiseLinearSink
    boundary = right
    variable = pgas
    fluid_phase = 1
    pt_vals = &#x27;0 1E9&#x27;
    multipliers = &#x27;0 1E9&#x27;
    PT_shift = 20.1E6
    mass_fraction_component = 1
    use_mobility = true
    use_relperm = true
    flux_function = 10 # 1/L
  [../]
[]

[Preconditioning]
  active = &#x27;basic&#x27;
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27;gmres asm lu NONZERO 2&#x27;
  [../]
  [./preferred]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27;lu mumps&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  nl_abs_tol = 1E-13
  nl_rel_tol = 1E-10
  end_time = 1e4
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1E4
    growth_factor = 1.1
  [../]
[]

[VectorPostprocessors]
  [./pps]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;20 0 0&#x27;
    num_points = 20
    sort_by = x
    variable = &#x27;pgas pwater saturation_gas&#x27;
  [../]
[]

[Outputs]
  print_linear_residuals = false
  perf_graph = true
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="c80f0156-1854-4f4b-a286-b2f5d4ae9fc5"><div class="modal-content"><h4>modules/heat_conduction/test/tests/semiconductor_linear_conductivity/steinhart-hart_linear.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
  xmax = 1.0
  ymax = 1.0
[]

[Variables]
  [./T]
      initial_condition = 400.0   # unit in Kelvin only!!
  [../]
[]

[AuxVariables]
  [./elec_conduct]
      order = FIRST
      family = MONOMIAL
  [../]
[]

[Kernels]
  [./diff]
    type = HeatConduction
    variable = T
  [../]
[]

[AuxKernels]
  [./elec_conduct]
    type = MaterialRealAux
    variable = elec_conduct
    property = electrical_conductivity
    execute_on = timestep_end
  [../]
[]

[BCs]
  [./inlet]
    type = DirichletBC
    variable = T
    boundary = left
    value = 1000 # K
  [../]
  [./outlet]
    type = DirichletBC
    variable = T
    boundary = right
    value = 400 # K
  [../]
[]

[Materials]
  [./k]
    type = GenericConstantMaterial
    prop_names = &#x27;thermal_conductivity&#x27;
    prop_values = &#x27;10&#x27; # in W/mK
  [../]
  [./sigma]
    type = SemiconductorLinearConductivity
    temp = T
    sh_coeff_A = 0.002
    sh_coeff_B = 0.001
  [../]
[]

[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    variable = &#x27;T elec_conduct&#x27;
    start_point = &#x27;0 0. 0&#x27;
    end_point = &#x27;1.0 0. 0&#x27;
    num_points = 11
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  nl_rel_tol = 1e-12
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true
  execute_on = &#x27;initial timestep_end&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="de6fa37b-45fc-45b9-9b07-66d4adf20271"><div class="modal-content"><h4>test/tests/outputs/csv_final_and_latest/latest.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 10
  dt = 0.25
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

# Vector Postprocessor System
[VectorPostprocessors]
  [./line_sample]
    type = LineValueSampler
    execute_on = &#x27;timestep_end&#x27;
    variable = &#x27;u&#x27;
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;1 0.5 0&#x27;
    num_points = 11
    sort_by = id
  [../]
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = &#x27;TIMESTEP_END&#x27;
    create_latest_symlink = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="92288ab6-6b36-4834-adb0-fdf68afe70e4"><div class="modal-content"><h4>tutorials/darcy_thermo_mech/step08_postprocessors/problems/step8.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 30
  ny = 3
  xmax = 0.304 # Length of test chamber
  ymax = 0.0257 # Test chamber radius
  uniform_refine = 2
[]

[Variables]
  [pressure]
  []
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables]
  [velocity]
    order = CONSTANT
    family = MONOMIAL_VEC
  []
[]

[Kernels]
  [darcy_pressure]
    type = DarcyPressure
    variable = pressure
  []
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[AuxKernels]
  [velocity]
    type = DarcyVelocity
    variable = velocity
    execute_on = timestep_end
    pressure = pressure
  []
[]

[BCs]
  [inlet]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 4000 # (Pa) From Figure 2 from paper.  First data point for 1mm spheres.
  []
  [outlet]
    type = DirichletBC
    variable = pressure
    boundary = right
    value = 0 # (Pa) Gives the correct pressure drop from Figure 2 for 1mm spheres
  []
  [inlet_temperature]
    type = FunctionDirichletBC
    variable = temperature
    boundary = left
    function = &#x27;if(t&lt;0,350+50*t,350)&#x27;
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = right
  []
[]

[Materials]
  [column]
    type = PackedColumn
    radius = 1
    temperature = temperature
    porosity = &#x27;0.25952 + 0.7*y/0.0257&#x27;
  []
[]

[Postprocessors]
  [average_temperature]
    type = ElementAverageValue
    variable = temperature
  []
  [outlet_heat_flux]
    type = ADSideFluxIntegral
    variable = temperature
    boundary = right
    diffusivity = thermal_conductivity
  []
[]

[VectorPostprocessors]
  [temperature_sample]
    type = LineValueSampler
    num_points = 500
    start_point = &#x27;0.1 0      0&#x27;
    end_point =   &#x27;0.1 0.0257 0&#x27;
    variable = temperature
    sort_by = y
  []
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = X
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  automatic_scaling = true

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  end_time = 100
  dt = 0.25
  start_time = -1

  steady_state_tolerance = 1e-5
  steady_state_detection = true

  [TimeStepper]
    type = FunctionDT
    function = &#x27;if(t&lt;0,0.1,0.25)&#x27;
  []
[]

[Outputs]
  exodus = true
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="43ba3ba3-913d-4844-98ce-866ff4d8fbbb"><div class="modal-content"><h4>modules/combined/examples/phase_field-mechanics/kks_mechanics_VTS.i</h4><pre class="moose-pre"><code class="language-text"># KKS phase-field model coupled with elasticity using the Voigt-Taylor scheme as
# described in L.K. Aagesen et al., Computational Materials Science, 140, 10-21 (2017)
# Original run #170329e

[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 640
  ny = 1
  nz = 1
  xmin = -10
  xmax = 10
  ymin = 0
  ymax = 0.03125
  zmin = 0
  zmax = 0.03125
  elem_type = HEX8
[]


[Variables]
  # order parameter
  [./eta]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute concentration
  [./c]
    order = FIRST
    family = LAGRANGE
  [../]

  # chemical potential
  [./w]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute phase concentration (matrix)
  [./cm]
    order = FIRST
    family = LAGRANGE
  [../]
  # solute phase concentration (precipitate)
  [./cp]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_x]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_y]
    order = FIRST
    family = LAGRANGE
  [../]
  [./disp_z]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[ICs]
  [./eta_ic]
    variable = eta
    type = FunctionIC
    function = ic_func_eta
    block = 0
  [../]
  [./c_ic]
    variable = c
    type = FunctionIC
    function = ic_func_c
    block = 0
  [../]
  [./w_ic]
    variable = w
    type = ConstantIC
    value = 0.00991
    block = 0
  [../]
  [./cm_ic]
    variable = cm
    type = ConstantIC
    value = 0.131
    block = 0
  [../]
  [./cp_ic]
    variable = cp
    type = ConstantIC
    value = 0.236
    block = 0
  [../]
[]

[Functions]
  [./ic_func_eta]
    type = ParsedFunction
    value = &#x27;0.5*(1.0+tanh((x)/delta_eta/sqrt(2.0)))&#x27;
    vars = &#x27;delta_eta&#x27;
    vals = &#x27;0.8034&#x27;
  [../]
  [./ic_func_c]
    type = ParsedFunction
    value = &#x27;0.2388*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^3*(6*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^2-15*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))+10)+0.1338*(1-(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^3*(6*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))^2-15*(0.5*(1.0+tanh(x/delta/sqrt(2.0))))+10))&#x27;
    vars = &#x27;delta&#x27;
    vals = &#x27;0.8034&#x27;
  [../]
  [./psi_eq_int]
    type = ParsedFunction
    value = &#x27;volume*psi_alpha&#x27;
    vars = &#x27;volume psi_alpha&#x27;
    vals = &#x27;volume psi_alpha&#x27;
  [../]
  [./gamma]
    type = ParsedFunction
    value = &#x27;(psi_int - psi_eq_int) / dy / dz&#x27;
    vars = &#x27;psi_int psi_eq_int dy       dz&#x27;
    vals = &#x27;psi_int psi_eq_int 0.03125  0.03125&#x27;
  [../]
[]

[AuxVariables]
  [./sigma11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./sigma22]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./sigma33]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e12]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e22]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e33]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e_el11]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e_el12]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./e_el22]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./f_el]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./eigen_strain00]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./Fglobal]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./psi]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./matl_sigma11]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 0
    index_j = 0
    variable = sigma11
  [../]
  [./matl_sigma22]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 1
    index_j = 1
    variable = sigma22
  [../]
  [./matl_sigma33]
    type = RankTwoAux
    rank_two_tensor = stress
    index_i = 2
    index_j = 2
    variable = sigma33
  [../]
  [./matl_e11]
    type = RankTwoAux
    rank_two_tensor = total_strain
    index_i = 0
    index_j = 0
    variable = e11
  [../]
  [./matl_e12]
    type = RankTwoAux
    rank_two_tensor = total_strain
    index_i = 0
    index_j = 1
    variable = e12
  [../]
  [./matl_e22]
    type = RankTwoAux
    rank_two_tensor = total_strain
    index_i = 1
    index_j = 1
    variable = e22
  [../]
  [./matl_e33]
    type = RankTwoAux
    rank_two_tensor = total_strain
    index_i = 2
    index_j = 2
    variable = e33
  [../]
  [./f_el]
    type = MaterialRealAux
    variable = f_el
    property = f_el_mat
    execute_on = timestep_end
  [../]
  [./GlobalFreeEnergy]
    variable = Fglobal
    type = KKSGlobalFreeEnergy
    fa_name = fm
    fb_name = fp
    w = 0.0264
    kappa_names = kappa
    interfacial_vars = eta
  [../]
  [./psi_potential]
    variable = psi
    type = ParsedAux
    args = &#x27;Fglobal w c f_el sigma11 e11&#x27;
    function = &#x27;Fglobal - w*c + f_el - sigma11*e11&#x27;
  [../]
[]


[BCs]
  [./left_x]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0
  [../]
  [./right_x]
    type = DirichletBC
    variable = disp_x
    boundary = right
    value = 0
  [../]
  [./front_y]
    type = DirichletBC
    variable = disp_y
    boundary = front
    value = 0
  [../]
  [./back_y]
    type = DirichletBC
    variable = disp_y
    boundary = back
    value = 0
  [../]
  [./top_z]
    type = DirichletBC
    variable = disp_z
    boundary = top
    value = 0
  [../]
  [./bottom_z]
    type = DirichletBC
    variable = disp_z
    boundary = bottom
    value = 0
  [../]
[]

[Materials]
  # Chemical free energy of the matrix
  [./fm]
    type = DerivativeParsedMaterial
    f_name = fm
    args = &#x27;cm&#x27;
    function = &#x27;6.55*(cm-0.13)^2&#x27;
  [../]
# Elastic energy of the matrix
  [./elastic_free_energy_m]
    type = ElasticEnergyMaterial
    base_name = matrix
    f_name = fe_m
    args = &#x27; &#x27;
    outputs = exodus
  [../]
# Total free energy of the matrix
  [./Total_energy_matrix]
    type = DerivativeSumMaterial
    f_name = f_total_matrix
    sum_materials = &#x27;fm fe_m&#x27;
    args = &#x27;cm&#x27;
  [../]

  # Free energy of the precipitate phase
  [./fp]
    type = DerivativeParsedMaterial
    f_name = fp
    args = &#x27;cp&#x27;
    function = &#x27;6.55*(cp-0.235)^2&#x27;
  [../]

# Elastic energy of the precipitate
  [./elastic_free_energy_p]
    type = ElasticEnergyMaterial
    base_name = ppt
    f_name = fe_p
    args = &#x27; &#x27;
    outputs = exodus
  [../]

# Total free energy of the precipitate
  [./Total_energy_ppt]
    type = DerivativeSumMaterial
    f_name = f_total_ppt
    sum_materials = &#x27;fp fe_p&#x27;
    args = &#x27;cp&#x27;
  [../]

  # Total elastic energy
    [./Total_elastic_energy]
      type = DerivativeTwoPhaseMaterial
      eta = eta
      f_name = f_el_mat
      fa_name = fe_m
      fb_name = fe_p
      outputs = exodus
      W = 0
    [../]

  # h(eta)
  [./h_eta]
    type = SwitchingFunctionMaterial
    h_order = HIGH
    eta = eta
  [../]

  # g(eta)
  [./g_eta]
    type = BarrierFunctionMaterial
    g_order = SIMPLE
    eta = eta
  [../]

  # constant properties
  [./constants]
    type = GenericConstantMaterial
    prop_names  = &#x27;M   L   kappa     misfit&#x27;
    prop_values = &#x27;0.7 0.7 0.01704   0.00377&#x27;
  [../]

  #Mechanical properties
  [./Stiffness_matrix]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;103.3 74.25 74.25 103.3 74.25 103.3 46.75 46.75 46.75&#x27;
    base_name = matrix
    fill_method = symmetric9
  [../]
  [./Stiffness_ppt]
    type = ComputeElasticityTensor
    C_ijkl = &#x27;100.7 71.45 71.45 100.7 71.45 100.7 50.10 50.10 50.10&#x27;
    base_name = ppt
    fill_method = symmetric9
  [../]
  [./stress_matrix]
    type = ComputeLinearElasticStress
    base_name = matrix
  [../]
  [./stress_ppt]
    type = ComputeLinearElasticStress
    base_name = ppt
  [../]
  [./strain_matrix]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    base_name = matrix
  [../]
  [./strain_ppt]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
    base_name = ppt
    eigenstrain_names = &#x27;eigenstrain_ppt&#x27;
  [../]
  [./eigen_strain]
    type = ComputeEigenstrain
    base_name = ppt
    eigen_base = &#x27;1 1 1 0 0 0&#x27;
    prefactor = misfit
    eigenstrain_name = &#x27;eigenstrain_ppt&#x27;
  [../]
  [./global_stress]
    type = TwoPhaseStressMaterial
    base_A = matrix
    base_B = ppt
  [../]
  [./global_strain]
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]
[]

[Kernels]
  [./TensorMechanics]
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  [../]

  # enforce c = (1-h(eta))*cm + h(eta)*cp
  [./PhaseConc]
    type = KKSPhaseConcentration
    ca       = cm
    variable = cp
    c        = c
    eta      = eta
  [../]

  # enforce pointwise equality of chemical potentials
  [./ChemPotVacancies]
    type = KKSPhaseChemicalPotential
    variable = cm
    cb       = cp
    fa_name  = f_total_matrix
    fb_name  = f_total_ppt
  [../]

  #
  # Cahn-Hilliard Equation
  #
  [./CHBulk]
    type = KKSSplitCHCRes
    variable = c
    ca       = cm
    fa_name  = f_total_matrix
    w        = w
  [../]

  [./dcdt]
    type = CoupledTimeDerivative
    variable = w
    v = c
  [../]
  [./ckernel]
    type = SplitCHWRes
    mob_name = M
    variable = w
  [../]

  #
  # Allen-Cahn Equation
  #
  [./ACBulkF]
    type = KKSACBulkF
    variable = eta
    fa_name  = f_total_matrix
    fb_name  = f_total_ppt
    w        = 0.0264
    args = &#x27;cp cm&#x27;
  [../]
  [./ACBulkC]
    type = KKSACBulkC
    variable = eta
    ca       = cm
    cb       = cp
    fa_name  = f_total_matrix
  [../]
  [./ACInterface]
    type = ACInterface
    variable = eta
    kappa_name = kappa
  [../]
  [./detadt]
    type = TimeDerivative
    variable = eta
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;
  petsc_options_iname = &#x27;-pc_type -sub_pc_type   -sub_pc_factor_shift_type&#x27;
  petsc_options_value = &#x27;asm       ilu            nonzero&#x27;

  l_max_its = 30
  nl_max_its = 10
  l_tol = 1.0e-4
  nl_rel_tol = 1.0e-8
  nl_abs_tol = 1.0e-11
  num_steps = 200

  [./TimeStepper]
    type = SolutionTimeAdaptiveDT
    dt = 0.5
  [../]
[]

[VectorPostprocessors]
  #[./eta]
  #  type =  LineValueSampler
  #  start_point = &#x27;-10 0 0&#x27;
  #  end_point = &#x27;10 0 0&#x27;
  #  variable = eta
  #  num_points = 321
  #  sort_by =  id
  #[../]
  #[./eta_position]
  #  type = FindValueOnLineSample
  #  vectorpostprocessor = eta
  #  variable_name = eta
  #  search_value = 0.5
  #[../]
#  [./f_el]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = f_el
#  [../]
#  [./f_el_a]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = fe_m
#  [../]
#  [./f_el_b]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = fe_p
#  [../]
#  [./h_out]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = h
#  [../]
#  [./fm_out]
#    type =  LineMaterialRealSampler
#    start = &#x27;-20 0 0&#x27;
#    end   = &#x27;20 0 0&#x27;
#    sort_by = id
#    property = fm
#  [../]
[]

[Postprocessors]
  [./f_el_int]
    type = ElementIntegralMaterialProperty
    mat_prop = f_el_mat
  [../]
  [./c_alpha]
    type =  SideAverageValue
    boundary = left
    variable = c
  [../]
  [./c_beta]
    type =  SideAverageValue
    boundary = right
    variable = c
  [../]
  [./e11_alpha]
    type =  SideAverageValue
    boundary = left
    variable = e11
  [../]
  [./e11_beta]
    type =  SideAverageValue
    boundary = right
    variable = e11
  [../]
  [./s11_alpha]
    type =  SideAverageValue
    boundary = left
    variable = sigma11
  [../]
  [./s22_alpha]
    type =  SideAverageValue
    boundary = left
    variable = sigma22
  [../]
  [./s33_alpha]
    type =  SideAverageValue
    boundary = left
    variable = sigma33
  [../]
  [./s11_beta]
    type =  SideAverageValue
    boundary = right
    variable = sigma11
  [../]
  [./s22_beta]
    type =  SideAverageValue
    boundary = right
    variable = sigma22
  [../]
  [./s33_beta]
    type =  SideAverageValue
    boundary = right
    variable = sigma33
  [../]
  [./f_el_alpha]
    type =  SideAverageValue
    boundary = left
    variable = f_el
  [../]
  [./f_el_beta]
    type =  SideAverageValue
    boundary = right
    variable = f_el
  [../]
  [./f_c_alpha]
    type =  SideAverageValue
    boundary = left
    variable = Fglobal
  [../]
  [./f_c_beta]
    type =  SideAverageValue
    boundary = right
    variable = Fglobal
  [../]
  [./chem_pot_alpha]
    type =  SideAverageValue
    boundary = left
    variable = w
  [../]
  [./chem_pot_beta]
    type =  SideAverageValue
    boundary = right
    variable = w
  [../]
  [./psi_alpha]
    type =  SideAverageValue
    boundary = left
    variable = psi
  [../]
  [./psi_beta]
    type =  SideAverageValue
    boundary = right
    variable = psi
  [../]
  [./total_energy]
    type = ElementIntegralVariablePostprocessor
    variable = Fglobal
  [../]
  # Get simulation cell size from postprocessor
  [./volume]
    type = ElementIntegralMaterialProperty
    mat_prop = 1
  [../]
  [./psi_eq_int]
    type = FunctionValuePostprocessor
    function = psi_eq_int
  [../]
  [./psi_int]
    type = ElementIntegralVariablePostprocessor
    variable = psi
  [../]
  [./gamma]
    type = FunctionValuePostprocessor
    function = gamma
  [../]
[]

#
# Precondition using handcoded off-diagonal terms
#
[Preconditioning]
  [./full]
    type = SMP
    full = true
  [../]
[]


[Outputs]
  [./exodus]
    type = Exodus
    interval = 20
  [../]
  [./csv]
    type = CSV
    execute_on = &#x27;final&#x27;
  [../]
#[./console]
#    type = Console
#    output_file = true
#  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f6223922-4778-4b0f-8746-f69c58b7d726"><div class="modal-content"><h4>modules/porous_flow/test/tests/newton_cooling/nc04.i</h4><pre class="moose-pre"><code class="language-text"># Newton cooling from a bar.  Heat conduction
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 100
  ny = 1
  xmin = 0
  xmax = 100
  ymin = 0
  ymax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;temp&#x27;
    number_fluid_phases = 0
    number_fluid_components = 0
  [../]
[]

[Variables]
  [./temp]
  [../]
[]

[ICs]
  [./temp]
    type = FunctionIC
    variable = temp
    function = &#x27;2-x/100&#x27;
  [../]
[]

[Kernels]
  [./conduction]
    type = PorousFlowHeatConduction
    variable = temp
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
    temperature = temp
  [../]
  [./thermal_conductivity_irrelevant]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;1E2 0 0 0 1E2 0 0 0 1E2&#x27;
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = temp
    boundary = left
    value = 2
  [../]
  [./newton]
    type = PorousFlowPiecewiseLinearSink
    variable = temp
    boundary = right
    pt_vals = &#x27;0 1 2&#x27;
    multipliers = &#x27;-1 0 1&#x27;
    flux_function = 1
  [../]
[]

[VectorPostprocessors]
  [./temp]
    type = LineValueSampler
    variable = temp
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;100 0.5 0&#x27;
    sort_by = x
    num_points = 11
    execute_on = timestep_end
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -snes_max_it -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol &#x27;
    petsc_options_value = &#x27;gmres asm lu 100 NONZERO 2 1E-14 1E-12&#x27;
  [../]
[]

[Executioner]
  type = Steady
[]

[Outputs]
  file_base = nc04
  execute_on = timestep_end
  exodus = false
  [./along_line]
    type = CSV
    execute_vector_postprocessors_on = timestep_end
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="3b87cd0c-b442-497b-bd31-1292305abdb3"><div class="modal-content"><h4>modules/porous_flow/test/tests/relperm/vangenuchten1.i</h4><pre class="moose-pre"><code class="language-text"># Test van Genuchten relative permeability curve by varying saturation over the mesh
# van Genuchten exponent m = 0.5 for both phases
# No residual saturation in either phase

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./kr0]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 0
    variable = kr0aux
  [../]
  [./kr1]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 1
    variable = kr1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityVG
    phase = 0
    m = 0.5
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityVG
    phase = 1
    m = 0.5
    wetting = false
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux kr0aux kr1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 20
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-7
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="5c2aad3b-a3d6-4045-a184-c2373ab6440a"><div class="modal-content"><h4>modules/porous_flow/test/tests/heat_advection/heat_advection_1d_fully_saturated_action.i</h4><pre class="moose-pre"><code class="language-text"># 1phase, heat advecting with a moving fluid
# Using the PorousFlowFullySaturated Action with KT stabilization
# This should produce an identical result to heat_advection_1D_KT
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 50
  xmin = 0
  xmax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./temp]
    initial_condition = 200
  [../]
  [./pp]
  [../]
[]

[ICs]
  [./pp]
    type = FunctionIC
    variable = pp
    function = &#x27;1-x&#x27;
  [../]
[]

[BCs]
  [./pp0]
    type = DirichletBC
    variable = pp
    boundary = left
    value = 1
  [../]
  [./pp1]
    type = DirichletBC
    variable = pp
    boundary = right
    value = 0
  [../]
  [./spit_heat]
    type = DirichletBC
    variable = temp
    boundary = left
    value = 300
  [../]
  [./suck_heat]
    type = DirichletBC
    variable = temp
    boundary = right
    value = 200
  [../]
[]

[PorousFlowFullySaturated]
  porepressure = pp
  temperature = temp
  coupling_type = ThermoHydro
  fp = simple_fluid
  add_darcy_aux = false
  stabilization = KT
  flux_limiter_type = superbee
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 100
      density0 = 1000
      viscosity = 4.4
      thermal_expansion = 0
      cv = 2
    [../]
  [../]
[]

[Materials]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.2
  [../]
  [./zero_thermal_conductivity]
    type = PorousFlowThermalConductivityIdeal
    dry_thermal_conductivity = &#x27;0 0 0  0 0 0  0 0 0&#x27;
  [../]
  [./rock_heat]
    type = PorousFlowMatrixInternalEnergy
    specific_heat_capacity = 1.0
    density = 125
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1.1 0 0 0 2 0 0 0 3&#x27;
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 0.01
  end_time = 0.6
[]

[VectorPostprocessors]
  [./T]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 51
    sort_by = x
    variable = temp
  [../]
[]

[Outputs]
  file_base = heat_advection_1d_fully_saturation_action
  [./csv]
    type = CSV
    sync_times = &#x27;0.1 0.6&#x27;
    sync_only = true
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="28880924-58d4-4db6-8fcd-3e1c8ac93d9c"><div class="modal-content"><h4>modules/porous_flow/test/tests/pressure_pulse/pressure_pulse_1d_2phasePSVG.i</h4><pre class="moose-pre"><code class="language-text"># Pressure pulse in 1D with 2 phases, 2components - transient

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = 0
  xmax = 100
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./ppwater]
    initial_condition = 2e6
  [../]
  [./sgas]
    initial_condition = 0.3
  [../]
[]

[AuxVariables]
  [./massfrac_ph0_sp0]
    initial_condition = 1
  [../]
  [./massfrac_ph1_sp0]
    initial_condition = 0
  [../]
  [./ppgas]
    family = MONOMIAL
    order = FIRST
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = ppwater
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    variable = ppwater
    fluid_component = 0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = sgas
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    variable = sgas
    fluid_component = 1
  [../]
[]

[AuxKernels]
  [./ppgas]
    type = PorousFlowPropertyAux
    property = pressure
    phase = 1
    variable = ppgas
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;ppwater sgas&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.5
    alpha = 1e-4
    sat_lr = 0.3
    pc_max = 1e6
    log_extension = false
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid0]
      type = SimpleFluidProperties
      bulk_modulus = 2e9
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
    [./simple_fluid1]
      type = SimpleFluidProperties
      bulk_modulus = 2e7
      density0 = 1
      thermal_expansion = 0
      viscosity = 1e-5
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = ppwater
    phase1_saturation = sgas
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = &#x27;massfrac_ph0_sp0 massfrac_ph1_sp0&#x27;
  [../]
  [./simple_fluid0]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid0
    phase = 0
  [../]
  [./simple_fluid1]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid1
    phase = 1
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-15 0 0 0 1e-15 0 0 0 1e-15&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 0
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 1
    phase = 1
  [../]
[]

[BCs]
  [./leftwater]
    type = DirichletBC
    boundary = left
    value = 3e6
    variable = ppwater
  [../]
  [./rightwater]
    type = DirichletBC
    boundary = right
    value = 2e6
    variable = ppwater
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-15 1E-20 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  dt = 1e3
  end_time = 1e4
[]

[VectorPostprocessors]
  [./pp]
    type = LineValueSampler
    sort_by = x
    variable = &#x27;ppwater ppgas&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;100 0 0&#x27;
    num_points = 11
  [../]
[]

[Outputs]
  file_base = pressure_pulse_1d_2phasePSVG
  print_linear_residuals = false
  [./csv]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="9548e4a9-f84e-46f9-a271-830b366d69ab"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_2D_trimesh.i</h4><pre class="moose-pre"><code class="language-text"># Using flux-limited TVD advection ala Kuzmin and Turek, mploying PorousFlow Kernels and UserObjects, with superbee flux-limiter
# 2D version
[Mesh]
  type = FileMesh
  file = trimesh.msh
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
  block = &#x27;50&#x27;
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer]
  [../]
[]

[ICs]
  [./porepressure]
    type = FunctionIC
    variable = porepressure
    function = &#x27;1 - x&#x27;
  [../]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.305,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = tracer
  [../]
  [./flux0]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = advective_flux_calculator_0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = porepressure
  [../]
  [./flux1]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = porepressure
    advective_flux_calculator = advective_flux_calculator_1
  [../]
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1
    boundary = left
  [../]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_component_1]
    type = PorousFlowPiecewiseLinearSink
    variable = porepressure
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 1
    use_mobility = true
    flux_function = 1E3
  [../]
  [./remove_component_0]
    type = PorousFlowPiecewiseLinearSink
    variable = tracer
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 0
    use_mobility = true
    flux_function = 1E3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      thermal_expansion = 0
      viscosity = 1.0
      density0 = 1000.0
    [../]
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure tracer&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
  [../]
  [./advective_flux_calculator_0]
    type = PorousFlowAdvectiveFluxCalculatorUnsaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 0
  [../]
  [./advective_flux_calculator_1]
    type = PorousFlowAdvectiveFluxCalculatorUnsaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 1
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = tracer
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = the_simple_fluid
    phase = 0
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-2 0 0   0 1E-2 0   0 0 1E-2&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0.04 0&#x27;
    num_points = 101
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  print_linear_residuals = false
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="f16e0e8b-bc86-4549-be18-511fcda8558e"><div class="modal-content"><h4>modules/porous_flow/test/tests/fluidstate/theis_tabulated.i</h4><pre class="moose-pre"><code class="language-text"># Two phase Theis problem: Flow from single source using WaterNCG fluidstate.
# Constant rate injection 2 kg/s
# 1D cylindrical mesh
# Initially, system has only a liquid phase, until enough gas is injected
# to form a gas phase, in which case the system becomes two phase.
# Note: this test is the same as theis.i, but uses the tabulated version of the CO2FluidProperties

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 80
  xmax = 200
  bias_x = 1.05
[]

[Problem]
  type = FEProblem
  coord_type = RZ
  rz_coord_axis = Y
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[AuxVariables]
  [./saturation_gas]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./x1]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./y0]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./saturation_gas]
    type = PorousFlowPropertyAux
    variable = saturation_gas
    property = saturation
    phase = 1
    execute_on = timestep_end
  [../]
  [./x1]
    type = PorousFlowPropertyAux
    variable = x1
    property = mass_fraction
    phase = 0
    fluid_component = 1
    execute_on = timestep_end
  [../]
  [./y0]
    type = PorousFlowPropertyAux
    variable = y0
    property = mass_fraction
    phase = 1
    fluid_component = 0
    execute_on = timestep_end
  [../]
[]

[Variables]
  [./pgas]
    initial_condition = 20e6
  [../]
  [./zi]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pgas
  [../]
  [./flux0]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    variable = pgas
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = zi
  [../]
  [./flux1]
    type = PorousFlowAdvectiveFlux
    fluid_component = 1
    variable = zi
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pgas zi&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
  [./fs]
    type = PorousFlowWaterNCG
    water_fp = water
    gas_fp = tabulated
    capillary_pressure = pc
  [../]
[]

[Modules]
  [./FluidProperties]
    [./co2]
      type = CO2FluidProperties
    [../]
    [./tabulated]
      type = TabulatedFluidProperties
      fp = co2
      fluid_property_file = fluid_properties.csv
    [../]
    [./water]
      type = Water97FluidProperties
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./waterncg]
    type = PorousFlowFluidState
    gas_porepressure = pgas
    z = zi
    temperature_unit = Celsius
    capillary_pressure = pc
    fluid_state = fs
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.2
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1e-12 0 0 0 1e-12 0 0 0 1e-12&#x27;
  [../]
  [./relperm_water]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 0
    s_res = 0.1
    sum_s_res = 0.1
  [../]
  [./relperm_gas]
    type = PorousFlowRelativePermeabilityCorey
    n = 2
    phase = 1
  [../]
[]

[BCs]
  [./rightwater]
    type = DirichletBC
    boundary = right
    value = 20e6
    variable = pgas
  [../]
[]

[DiracKernels]
  [./source]
    type = PorousFlowSquarePulsePointSource
    point = &#x27;0 0 0&#x27;
    mass_flux = 2
    variable = zi
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason -ksp_diagonal_scale -ksp_diagonal_scale_fix -ksp_gmres_modifiedgramschmidt -snes_linesearch_monitor&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;gmres      asm      lu           NONZERO                   2               1E-8       1E-10 20&#x27;
  [../]
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  end_time = 8e2
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 2
    growth_factor = 2
  [../]
[]

[VectorPostprocessors]
  [./line]
    type = LineValueSampler
    sort_by = x
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;200 0 0&#x27;
    num_points = 1000
    variable = &#x27;pgas zi x1 saturation_gas&#x27;
    execute_on = &#x27;timestep_end&#x27;
  [../]
[]

[Postprocessors]
  [./pgas]
    type = PointValue
    point =  &#x27;1 0 0&#x27;
    variable = pgas
  [../]
  [./sgas]
    type = PointValue
    point =  &#x27;1 0 0&#x27;
    variable = saturation_gas
  [../]
  [./zi]
    type = PointValue
    point = &#x27;1 0 0&#x27;
    variable = zi
  [../]
  [./massgas]
    type = PorousFlowFluidMass
    fluid_component = 1
  [../]
  [./x1]
    type = PointValue
    point =  &#x27;1 0 0&#x27;
    variable = x1
  [../]
  [./y0]
    type = PointValue
    point =  &#x27;1 0 0&#x27;
    variable = y0
  [../]
[]

[Outputs]
  print_linear_residuals = false
  perf_graph = true
  [./csvout]
    type = CSV
    file_base = theis_tabulated_csvout
    execute_on = timestep_end
    execute_vector_postprocessors_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="84272609-4894-443a-9bca-56aaeb6673fc"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_1D_adaptivity.i</h4><pre class="moose-pre"><code class="language-text"># Using flux-limited TVD advection ala Kuzmin and Turek, mploying PorousFlow Kernels and UserObjects, with superbee flux-limiter
# 1D version with adaptivity
[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 10
  xmin = 0
  xmax = 1
[]

[Adaptivity]
  initial_steps = 1
  initial_marker = tracer_marker
  marker = tracer_marker
  max_h_level = 1
  [./Markers]
    [./tracer_marker]
      type = ValueRangeMarker
      variable = tracer
      lower_bound = 0.02
      upper_bound = 0.98
    [../]
  [../]
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer]
  [../]
[]

[ICs]
  [./porepressure]
    type = FunctionIC
    variable = porepressure
    function = &#x27;1 - x&#x27;
  [../]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = tracer
  [../]
  [./flux0]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = advective_flux_calculator_0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = porepressure
  [../]
  [./flux1]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = porepressure
    advective_flux_calculator = advective_flux_calculator_1
  [../]
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1
    boundary = left
  [../]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_component_1]
    type = PorousFlowPiecewiseLinearSink
    variable = porepressure
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 1
    use_mobility = true
    flux_function = 1E3
  [../]
  [./remove_component_0]
    type = PorousFlowPiecewiseLinearSink
    variable = tracer
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 0
    use_mobility = true
    flux_function = 1E3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      thermal_expansion = 0
      viscosity = 1.0
      density0 = 1000.0
    [../]
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure tracer&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
  [../]
  [./advective_flux_calculator_0]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 0
  [../]
  [./advective_flux_calculator_1]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 1
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = tracer
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = the_simple_fluid
    phase = 0
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-2 0 0   0 1E-2 0   0 0 1E-2&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 6
  dt = 6E-2
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="4ad2c461-4104-4e7a-b94c-3928df5816ec"><div class="modal-content"><h4>modules/porous_flow/test/tests/flux_limited_TVD_pflow/pffltvd_3D.i</h4><pre class="moose-pre"><code class="language-text"># Using flux-limited TVD advection ala Kuzmin and Turek, employing PorousFlow Kernels and UserObjects, with superbee flux-limiter
# 3D version
[Mesh]
  type = GeneratedMesh
  dim = 3
  nx = 10
  xmin = 0
  xmax = 1
  ny = 4
  ymin = 0
  ymax = 0.5
  nz = 3
  zmin = 0
  zmax = 2
[]

[GlobalParams]
  PorousFlowDictator = dictator
  gravity = &#x27;0 0 0&#x27;
[]

[Variables]
  [./porepressure]
  [../]
  [./tracer]
  [../]
[]

[ICs]
  [./porepressure]
    type = FunctionIC
    variable = porepressure
    function = &#x27;1 - x&#x27;
  [../]
  [./tracer]
    type = FunctionIC
    variable = tracer
    function = &#x27;if(x&lt;0.1,0,if(x&gt;0.3,0,1))&#x27;
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = tracer
  [../]
  [./flux0]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = tracer
    advective_flux_calculator = advective_flux_calculator_0
  [../]
  [./mass1]
    type = PorousFlowMassTimeDerivative
    fluid_component = 1
    variable = porepressure
  [../]
  [./flux1]
    type = PorousFlowFluxLimitedTVDAdvection
    variable = porepressure
    advective_flux_calculator = advective_flux_calculator_1
  [../]
[]

[BCs]
  [./constant_injection_porepressure]
    type = DirichletBC
    variable = porepressure
    value = 1
    boundary = left
  [../]
  [./no_tracer_on_left]
    type = DirichletBC
    variable = tracer
    value = 0
    boundary = left
  [../]
  [./remove_component_1]
    type = PorousFlowPiecewiseLinearSink
    variable = porepressure
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 1
    use_mobility = true
    flux_function = 1E3
  [../]
  [./remove_component_0]
    type = PorousFlowPiecewiseLinearSink
    variable = tracer
    boundary = right
    fluid_phase = 0
    pt_vals = &#x27;0 1E3&#x27;
    multipliers = &#x27;0 1E3&#x27;
    mass_fraction_component = 0
    use_mobility = true
    flux_function = 1E3
  [../]
[]

[Modules]
  [./FluidProperties]
    [./the_simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 2E9
      thermal_expansion = 0
      viscosity = 1.0
      density0 = 1000.0
    [../]
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;porepressure tracer&#x27;
    number_fluid_phases = 1
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
  [../]
  [./advective_flux_calculator_0]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 0
  [../]
  [./advective_flux_calculator_1]
    type = PorousFlowAdvectiveFluxCalculatorSaturatedMultiComponent
    flux_limiter_type = superbee
    fluid_component = 1
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = porepressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
    mass_fraction_vars = tracer
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = the_simple_fluid
    phase = 0
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityConst
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosity
    porosity_zero = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-2 0 0   0 1E-2 0   0 0 1E-2&#x27;
  [../]
[]

[Preconditioning]
  active = basic
  [./basic]
    type = SMP
    full = true
    petsc_options = &#x27;-ksp_diagonal_scale -ksp_diagonal_scale_fix&#x27;
    petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap&#x27;
    petsc_options_value = &#x27; asm      lu           NONZERO                   2&#x27;
  [../]
  [./preferred_but_might_not_be_installed]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
    petsc_options_value = &#x27; lu       mumps&#x27;
  [../]
[]

[VectorPostprocessors]
  [./tracer]
    type = LineValueSampler
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0.5 2&#x27;
    num_points = 11
    sort_by = x
    variable = tracer
  [../]
[]

[Executioner]
  type = Transient
  solve_type = Newton
  end_time = 0.3
  dt = 6E-2
  nl_abs_tol = 1E-8
  timestep_tolerance = 1E-3
[]

[Outputs]
  print_linear_residuals = false
  [./out]
    type = CSV
    execute_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="ffae3ef2-e746-4c0d-b67f-99f7ee08050c"><div class="modal-content"><h4>modules/level_set/test/tests/kernels/olsson_reinitialization/olsson_1d.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 8
  ny = 8
  uniform_refine = 2
[]

[Variables]
  [./phi]
  [../]
[]

[AuxVariables]
  [./phi_0]
    family = MONOMIAL
    order = FIRST
  [../]
  [./phi_exact]
  [../]
[]

[AuxKernels]
  [./phi_exact]
    type = FunctionAux
    function = phi_exact
    variable = phi_exact
  [../]
[]

[Functions]
  [./phi_initial]
    type = ParsedFunction
    value = &#x27;1-x&#x27;
  [../]
  [./phi_exact]
    type = ParsedFunction
    vars = epsilon
    vals = 0.05
    value = &#x27;1 / (1+exp((x-0.5)/epsilon))&#x27;
  [../]
[]

[ICs]
  [./phi_ic]
    type = FunctionIC
    function = phi_initial
    variable = phi
  [../]
  [./phi_0_ic]
    type = FunctionIC
    function = phi_initial
    variable = phi_0
  [../]
[]

[Kernels]
  [./time]
    type = TimeDerivative
    variable = phi
  [../]

  [./reinit]
    type = LevelSetOlssonReinitialization
    variable = phi
    phi_0 = phi_0
    epsilon = 0.05
  [../]
[]

[UserObjects]
  [./arnold]
    type = LevelSetOlssonTerminator
    tol = 0.1
  [../]
[]

[Postprocessors]
  [./error]
    type = ElementL2Error
    variable = phi
    function = phi_exact
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
  [./ndofs]
    type = NumDOFs
  [../]
[]

[VectorPostprocessors]
  [./line]
    type = LineValueSampler
    start_point = &#x27;0 0.5 0&#x27;
    end_point =  &#x27;1 0.5 0&#x27;
    variable = phi
    num_points = 100
    sort_by = x
    execute_on = &#x27;initial timestep_end&#x27;
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 100
  nl_max_its = 100
  solve_type = PJFNK
  num_steps = 10
  start_time = 0
  nl_abs_tol = 1e-13
  scheme = implicit-euler
  dt = 0.05
  petsc_options_iname = &#x27;-pc_type -pc_sub_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;hypre    boomeramg    300&#x27;
[]

[Outputs]
  exodus = true
  [./out]
    type = CSV
    time_data = true
    file_base = output/olsson_1d_out
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="25e98af9-cbbf-4959-9fb6-1cc4c72eb6f9"><div class="modal-content"><h4>modules/porous_flow/test/tests/newton_cooling/nc01.i</h4><pre class="moose-pre"><code class="language-text"># Newton cooling from a bar.  1-phase transient
[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1000
  ny = 1
  xmin = 0
  xmax = 100
  ymin = 0
  ymax = 1
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;pressure&#x27;
    number_fluid_phases = 1
    number_fluid_components = 1
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureVG
    m = 0.8
    alpha = 1e-5
  [../]
[]

[Variables]
  [./pressure]
    initial_condition = 2E6
  [../]
[]

[Kernels]
  [./mass0]
    type = PorousFlowMassTimeDerivative
    fluid_component = 0
    variable = pressure
  [../]
  [./flux]
    type = PorousFlowAdvectiveFlux
    fluid_component = 0
    gravity = &#x27;0 0 0&#x27;
    variable = pressure
  [../]
[]

[Modules]
  [./FluidProperties]
    [./simple_fluid]
      type = SimpleFluidProperties
      bulk_modulus = 1e6
      density0 = 1000
      thermal_expansion = 0
      viscosity = 1e-3
    [../]
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow1PhaseP
    porepressure = pressure
    capillary_pressure = pc
  [../]
  [./massfrac]
    type = PorousFlowMassFraction
  [../]
  [./simple_fluid]
    type = PorousFlowSingleComponentFluid
    fp = simple_fluid
    phase = 0
  [../]
  [./porosity]
    type = PorousFlowPorosityConst
    porosity = 0.1
  [../]
  [./permeability]
    type = PorousFlowPermeabilityConst
    permeability = &#x27;1E-15 0 0 0 1E-15 0 0 0 1E-15&#x27;
  [../]
  [./relperm]
    type = PorousFlowRelativePermeabilityCorey # irrelevant in this fully-saturated situation
    n = 2
    phase = 0
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = pressure
    boundary = left
    value = 2E6
  [../]
  [./newton]
    type = PorousFlowPiecewiseLinearSink
    variable = pressure
    boundary = right
    pt_vals = &#x27;0 100000 200000 300000 400000 500000 600000 700000 800000 900000 1000000 1100000 1200000 1300000 1400000 1500000 1600000 1700000 1800000 1900000 2000000&#x27;
    multipliers = &#x27;0. 5.6677197748570516e-6 0.000011931518841831313 0.00001885408740732065 0.000026504708864284114 0.000034959953203725676 0.000044304443352900224 0.00005463170211001232 0.00006604508815181467 0.00007865883048198513 0.00009259917167338928 0.00010800563134618119 0.00012503240252705603 0.00014384989486488752 0.00016464644014777016 0.00018763017719085535 0.0002130311349595711 0.00024110353477682344 0.00027212833465544285 0.00030641604122040985 0.00034430981736352295&#x27;
    use_mobility = false
    use_relperm = false
    fluid_phase = 0
    flux_function = 1
  [../]
[]

[VectorPostprocessors]
  [./porepressure]
    type = LineValueSampler
    variable = pressure
    start_point = &#x27;0 0.5 0&#x27;
    end_point = &#x27;100 0.5 0&#x27;
    sort_by = x
    num_points = 20
    execute_on = timestep_end
  [../]
[]

[Preconditioning]
  [./andy]
    type = SMP
    full = true
    petsc_options = &#x27;-snes_converged_reason&#x27;
    petsc_options_iname = &#x27;-ksp_type -pc_type -snes_atol -snes_rtol -snes_max_it&#x27;
    petsc_options_value = &#x27;bcgs bjacobi 1E-12 1E-15 10000&#x27;
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1E8
  dt = 1E6
[]

[Outputs]
  file_base = nc01
  [./along_line]
    type = CSV
    execute_vector_postprocessors_on = final
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="98b6d39b-55f1-4b4b-8e43-8a3240a50494"><div class="modal-content"><h4>modules/porous_flow/test/tests/relperm/vangenuchten2.i</h4><pre class="moose-pre"><code class="language-text"># Test van Genuchten relative permeability curve by varying saturation over the mesh
# van Genuchten exponent m = 0.4 for both phases
# Phase 0 residual saturation s0r = 0.1
# Phase 1 residual saturation s1r = 0.2

[Mesh]
  type = GeneratedMesh
  dim = 1
  nx = 100
[]

[GlobalParams]
  PorousFlowDictator = dictator
[]

[Variables]
  [./p0]
    initial_condition = 1e6
  [../]
  [./s1]
  [../]
[]

[AuxVariables]
  [./s0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./s1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr0aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
  [./kr1aux]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[AuxKernels]
  [./s0]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 0
    variable = s0aux
  [../]
  [./s1]
    type = PorousFlowPropertyAux
    property = saturation
    phase = 1
    variable = s1aux
  [../]
  [./kr0]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 0
    variable = kr0aux
  [../]
  [./kr1]
    type = PorousFlowPropertyAux
    property = relperm
    phase = 1
    variable = kr1aux
  [../]
[]

[Functions]
  [./s1]
    type = ParsedFunction
    value = x
  [../]
[]

[ICs]
  [./s1]
    type = FunctionIC
    variable = s1
    function = s1
  [../]
[]

[Kernels]
  [./p0]
    type = Diffusion
    variable = p0
  [../]
  [./s1]
    type = Diffusion
    variable = s1
  [../]
[]

[UserObjects]
  [./dictator]
    type = PorousFlowDictator
    porous_flow_vars = &#x27;p0 s1&#x27;
    number_fluid_phases = 2
    number_fluid_components = 2
  [../]
  [./pc]
    type = PorousFlowCapillaryPressureConst
    pc = 0
  [../]
[]

[Materials]
  [./temperature]
    type = PorousFlowTemperature
  [../]
  [./ppss]
    type = PorousFlow2PhasePS
    phase0_porepressure = p0
    phase1_saturation = s1
    capillary_pressure = pc
  [../]
  [./kr0]
    type = PorousFlowRelativePermeabilityVG
    phase = 0
    m = 0.4
    s_res = 0.1
    sum_s_res = 0.3
  [../]
  [./kr1]
    type = PorousFlowRelativePermeabilityVG
    phase = 1
    m = 0.4
    s_res = 0.2
    sum_s_res = 0.3
    wetting = false
  [../]
[]

[VectorPostprocessors]
  [./vpp]
    type = LineValueSampler
    variable = &#x27;s0aux s1aux kr0aux kr1aux&#x27;
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;1 0 0&#x27;
    num_points = 20
    sort_by = id
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
  nl_abs_tol = 1e-7
[]

[BCs]
  [./sleft]
    type = DirichletBC
    variable = s1
    value = 0
    boundary = left
  [../]
  [./sright]
    type = DirichletBC
    variable = s1
    value = 1
    boundary = right
  [../]
[]

[Outputs]
  csv = true
  execute_on = timestep_end
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="d21c5536-eed6-4768-b22b-0acc6a52031a"><div class="modal-content"><h4>modules/combined/test/tests/beam_eigenstrain_transfer/subapp_err_4.i</h4><pre class="moose-pre"><code class="language-text"># SubApp with 2D model to test multi app vectorpostprocessor to aux var transfer

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 5
  xmin = 0.0
  xmax = 0.5
  ymin = 0.0
  ymax = 0.150080
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[AuxVariables]
  [./temp]
  [../]
  [./axial_strain]
    order = FIRST
    family = MONOMIAL
  [../]
[]

[Functions]
  [./temperature_load]
    type = ParsedFunction
    value = t*(500.0)+300.0
  [../]
[]

[Modules]
  [./TensorMechanics]
    [./Master]
      [./all]
        strain = SMALL
        incremental = true
        add_variables = true
        eigenstrain_names = eigenstrain
      [../]
    [../]
  [../]
[]

[AuxKernels]
  [./tempfuncaux]
    type = FunctionAux
    variable = temp
    function = temperature_load
  [../]
  [./axial_strain]
    type = RankTwoAux
    variable = axial_strain
    rank_two_tensor = total_strain
    index_i = 1
    index_j = 1
    execute_on = timestep_end
  [../]
[]

[BCs]
  [./x_bot]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  [../]
  [./y_bot]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  [../]
[]

[Materials]
  [./elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
  [../]
  [./small_stress]
    type = ComputeFiniteStrainElasticStress
  [../]
  [./thermal_expansion_strain]
    type = ComputeThermalExpansionEigenstrain
    stress_free_temperature = 298
    thermal_expansion_coeff = 1.3e-5
    temperature = temp
    eigenstrain_name = eigenstrain
  [../]
[]

[Executioner]
  type = Transient

  #Preconditioned JFNK (default)
  solve_type = &#x27;PJFNK&#x27;

  petsc_options = &#x27;-snes_ksp_ew&#x27;
  petsc_options_iname = &#x27;-ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;101&#x27;

  line_search = &#x27;none&#x27;

  l_max_its = 50
  nl_max_its = 50
  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-8
  l_tol = 1e-9

  start_time = 0.0
  end_time = 0.075
  dt = 0.0125
  dtmin = 0.0001
[]

[Outputs]
  csv = true
  exodus = true
[]

[VectorPostprocessors]
  [./axial_str]
    type = LineValueSampler
    start_point = &#x27;0.5 0.0 0.0&#x27;
    end_point = &#x27;0.5 0.1 0.0&#x27;
    variable = axial_strain
    num_points = 21
    sort_by = &#x27;id&#x27;
  [../]
[]

[Postprocessors]
  [./end_disp]
    type = PointValue
    variable = disp_y
    point = &#x27;0.5 0.150080 0.0&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="e12d3179-2645-4f4b-afd6-fa794abf36ce"><div class="modal-content"><h4>test/tests/executioners/nullspace/singular_contaminated.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
 type = GeneratedMesh
 dim = 1
 xmin = 0
 xmax = 10
 nx = 8
[]

[Problem]
  null_space_dimension = 1
  transpose_null_space_dimension = 1
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]

  [./eig]
    type = MassEigenKernel
    variable = u
    eigen_postprocessor = 1.0002920196258376e+01
    eigen = false
  [../]

  [./force]
    type = CoupledForce
    variable = u
    v = aux_v
  [../]
[]

[AuxVariables]
  [./aux_v]
    order = FIRST
    family = LAGRANGE
    [./InitialCondition]
      type = FunctionIC
      function = eigen_mode
    [../]
  [../]
[]

[AuxKernels]
  [./set_source]
    type = FunctionAux
    variable = aux_v
    function = contaminated_second_harmonic
    execute_on = timestep_begin
  [../]
[]

[Functions]
  [./eigen_mode]
    type = ParsedFunction
    value = &#x27;sqrt(2.0 / L) * sin(mode * pi  * x / L)&#x27;
    vars = &#x27;L  mode&#x27;
    vals = &#x27;10 1&#x27;
  [../]

  [./contaminated_second_harmonic]
    type = ParsedFunction
    value = &#x27;sqrt(2.0 / L) * sin(mode * pi  * x / L) + a * sqrt(2.0 / L) * sin(pi * x / L)&#x27;
    vars = &#x27;L  mode a&#x27;
    vals = &#x27;10 2    1&#x27;
  [../]
[]

[BCs]
  [./homogeneous]
    type = DirichletBC
    variable = u
    boundary = &#x27;0 1&#x27;
    value = 0
  [../]
[]

[VectorPostprocessors]
  [./sample_solution]
    type = LineValueSampler
    variable = u
    start_point = &#x27;0 0 0&#x27;
    end_point = &#x27;10 0 0&#x27;
    sort_by = x
    num_points = 9
    execute_on = timestep_end
  [../]
[]

[Preconditioning]
  [./prec]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = SteadyWithNull
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_pc_side -snes_type -ksp_norm_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg  left ksponly preconditioned&#x27;
  nl_rel_tol = 1.0e-14
  nl_abs_tol = 1.0e-14
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section><section class="scrollspy" id="b37c9a20-065e-473a-b798-9d8f8196e107" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol></ol></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#fda11b9b-3e2e-4573-b657-a4cd4006947b" class="tooltipped" data-position="left" data-tooltip="Description">Description</a></li><li><a href="#21872134-8d96-460d-9d21-2eed926b031e" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#f6c6309e-bfea-480b-b9fa-1a751b523d83" class="tooltipped" data-position="left" data-tooltip="Input Files">Input Files</a></li><li><a href="#b37c9a20-065e-473a-b798-9d8f8196e107" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>