<!DOCTYPE html><head><meta charset="UTF-8"><title>index.md|MOOSE Ray Tracing Module</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="/modules/ray_tracing" class="left moose-logo hide-on-med-and-down">MOOSE Ray Tracing Module</a><a href="https://github.com/idaholab/moose" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="f3470874-583e-4413-835c-c8aa8a5d0eeb"><i class="material-icons">menu</i></a><ul class="sidenav" id="f3470874-583e-4413-835c-c8aa8a5d0eeb"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/modules/ray_tracing" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">syntax</a><a href="." class="breadcrumb">InterfaceKernels</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="d5da4b5f-6821-404e-8225-196e6ce26190" data-section-level="1" data-section-text="InterfaceKernels System"><h1 id="interfacekernels-system">InterfaceKernels System</h1><p>Interface kernels are meant to assist in coupling different physics across sub-domains. The most straightforward example is the case in which one wants to set the flux of a specie A in subdomain 0 equal to the flux of a specie B in subdomain 1 at the boundary between subdomains 0 and 1. In mathematical terms, we might be interested in establishing the condition:</p><p><span class="moose-katex-block-equation"><span tex="-D_0 \frac{\partial c_0}{\partial x} = -D_1 \frac{\partial c_1}{\partial x}" bookmark="moose-equation-a2e31b28-d30b-43dc-ad01-6b776f7334a4" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-a2e31b28-d30b-43dc-ad01-6b776f7334a4"></span><script>var element = document.getElementById("moose-equation-a2e31b28-d30b-43dc-ad01-6b776f7334a4");katex.render("-D_0 \\frac{\\partial c_0}{\\partial x} = -D_1 \\frac{\\partial c_1}{\\partial x}", element, {displayMode:true,throwOnError:false});</script></span></p><p>where <span tex="D_i" bookmark="moose-equation-4c702838-f15a-455c-ae42-e36f9f0e415b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4c702838-f15a-455c-ae42-e36f9f0e415b"><script>var element = document.getElementById("moose-equation-4c702838-f15a-455c-ae42-e36f9f0e415b");katex.render("D_i", element, {displayMode:false,throwOnError:false});</script></span> is the diffusion coefficient of specie <span tex="i" bookmark="moose-equation-ed69a23f-ef25-4eda-bd24-3652fe0e4cfc" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ed69a23f-ef25-4eda-bd24-3652fe0e4cfc"><script>var element = document.getElementById("moose-equation-ed69a23f-ef25-4eda-bd24-3652fe0e4cfc");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span> in subdomain <span tex="i" bookmark="moose-equation-3aebe422-836c-48b9-b306-c9f20a389450" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3aebe422-836c-48b9-b306-c9f20a389450"><script>var element = document.getElementById("moose-equation-3aebe422-836c-48b9-b306-c9f20a389450");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span>, and <span tex="c_i" bookmark="moose-equation-121846a6-cc94-4c47-ada2-6b47c77e4c8f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-121846a6-cc94-4c47-ada2-6b47c77e4c8f"><script>var element = document.getElementById("moose-equation-121846a6-cc94-4c47-ada2-6b47c77e4c8f");katex.render("c_i", element, {displayMode:false,throwOnError:false});</script></span> is the concentration of specie <span tex="i" bookmark="moose-equation-34a7fa0c-b4b7-470c-a817-7098d1ac7474" recursive="True" class="moose-katex-inline-equation" id="moose-equation-34a7fa0c-b4b7-470c-a817-7098d1ac7474"><script>var element = document.getElementById("moose-equation-34a7fa0c-b4b7-470c-a817-7098d1ac7474");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span> in subdomain <span tex="i" bookmark="moose-equation-54fe602d-5288-4336-8f63-e6e5a31de53a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-54fe602d-5288-4336-8f63-e6e5a31de53a"><script>var element = document.getElementById("moose-equation-54fe602d-5288-4336-8f63-e6e5a31de53a");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span>. An example of this condition is shown in the MOOSE test directory; see files below:</p><p><a href="#82a876d7-37d0-436b-ad05-d6462af3eb39" class="modal-trigger">coupled_value_coupled_flux.i</a></p><div class="modal moose-modal" id="82a876d7-37d0-436b-ad05-d6462af3eb39"><div class="modal-content"><h4>/test/tests/interfacekernels/2d_interface/coupled_value_coupled_flux.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 2
    xmax = 2
    ny = 2
    ymax = 2
  []
  [./subdomain1]
    input = gen
    type = SubdomainBoundingBoxGenerator
    bottom_left = &#x27;0 0 0&#x27;
    top_right = &#x27;1 1 0&#x27;
    block_id = 1
  [../]
  [./interface]
    type = SideSetsBetweenSubdomainsGenerator
    input = subdomain1
    primary_block = &#x27;0&#x27;
    paired_block = &#x27;1&#x27;
    new_boundary = &#x27;primary0_interface&#x27;
  [../]
  [./break_boundary]
    input = interface
    type = BreakBoundaryOnSubdomainGenerator
  [../]
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
    block = 0
  [../]

  [./v]
    order = FIRST
    family = LAGRANGE
    block = 1
  [../]
[]

[Kernels]
  [./diff_u]
    type = CoeffParamDiffusion
    variable = u
    D = 4
    block = 0
  [../]
  [./diff_v]
    type = CoeffParamDiffusion
    variable = v
    D = 2
    block = 1
  [../]
  [./source_u]
    type = BodyForce
    variable = u
    value = 1
  [../]
[]

[InterfaceKernels]
  [./interface]
    type = PenaltyInterfaceDiffusion
    variable = u
    neighbor_var = v
    boundary = primary0_interface
    penalty = 1e6
  [../]
[]

[BCs]
  [./u]
    type = VacuumBC
    variable = u
    boundary = &#x27;left_to_0 bottom_to_0 right top&#x27;
  [../]
  [./v]
    type = VacuumBC
    variable = v
    boundary = &#x27;left_to_1 bottom_to_1&#x27;
  [../]
[]

[Postprocessors]
  [./u_int]
    type = ElementIntegralVariablePostprocessor
    variable = u
    block = 0
  [../]
  [./v_int]
    type = ElementIntegralVariablePostprocessor
    variable = v
    block = 1
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
[]

[Outputs]
  exodus = true
  print_linear_residuals = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p><a href="#daf0d379-a20a-45fa-8dfc-6a26dd1b03ee" class="modal-trigger">InterfaceDiffusion.C</a></p><div class="modal moose-modal" id="daf0d379-a20a-45fa-8dfc-6a26dd1b03ee"><div class="modal-content"><h4>/test/src/interfacekernels/InterfaceDiffusion.C</h4><pre class="moose-pre"><code class="language-cpp">// This file is part of the MOOSE framework
// https://www.mooseframework.org
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;InterfaceDiffusion.h&quot;

registerMooseObject(&quot;MooseTestApp&quot;, InterfaceDiffusion);

InputParameters
InterfaceDiffusion::validParams()
{
  InputParameters params = InterfaceKernel::validParams();
  params.addParam&lt;MaterialPropertyName&gt;(&quot;D&quot;, &quot;D&quot;, &quot;The diffusion coefficient.&quot;);
  params.addParam&lt;MaterialPropertyName&gt;(
      &quot;D_neighbor&quot;, &quot;D_neighbor&quot;, &quot;The neighboring diffusion coefficient.&quot;);
  return params;
}

InterfaceDiffusion::InterfaceDiffusion(const InputParameters &amp; parameters)
  : InterfaceKernel(parameters),
    _D(getMaterialProperty&lt;Real&gt;(&quot;D&quot;)),
    _D_neighbor(getNeighborMaterialProperty&lt;Real&gt;(&quot;D_neighbor&quot;))
{
}

Real
InterfaceDiffusion::computeQpResidual(Moose::DGResidualType type)
{
  Real r = 0;

  switch (type)
  {
    case Moose::Element:
      r = _test[_i][_qp] * -_D_neighbor[_qp] * _grad_neighbor_value[_qp] * _normals[_qp];
      break;

    case Moose::Neighbor:
      r = _test_neighbor[_i][_qp] * _D[_qp] * _grad_u[_qp] * _normals[_qp];
      break;
  }

  return r;
}

Real
InterfaceDiffusion::computeQpJacobian(Moose::DGJacobianType type)
{
  Real jac = 0;

  switch (type)
  {
    case Moose::ElementElement:
    case Moose::NeighborNeighbor:
      break;

    case Moose::NeighborElement:
      jac = _test_neighbor[_i][_qp] * _D[_qp] * _grad_phi[_j][_qp] * _normals[_qp];
      break;

    case Moose::ElementNeighbor:
      jac = _test[_i][_qp] * -_D_neighbor[_qp] * _grad_phi_neighbor[_j][_qp] * _normals[_qp];
      break;
  }

  return jac;
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p><a href="#945721d1-c6f8-4c0b-8180-405e81434d18" class="modal-trigger">InterfaceDiffusion.h</a></p><div class="modal moose-modal" id="945721d1-c6f8-4c0b-8180-405e81434d18"><div class="modal-content"><h4>/test/include/interfacekernels/InterfaceDiffusion.h</h4><pre class="moose-pre"><code class="language-cpp">// This file is part of the MOOSE framework
// https://www.mooseframework.org
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#pragma once

#include &quot;InterfaceKernel.h&quot;

/**
 * DG kernel for interfacing diffusion between two variables on adjacent blocks
 */
class InterfaceDiffusion : public InterfaceKernel
{
public:
  static InputParameters validParams();

  InterfaceDiffusion(const InputParameters &amp; parameters);

protected:
  virtual Real computeQpResidual(Moose::DGResidualType type) override;
  virtual Real computeQpJacobian(Moose::DGJacobianType type) override;

  const MaterialProperty&lt;Real&gt; &amp; _D;
  const MaterialProperty&lt;Real&gt; &amp; _D_neighbor;
};
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p>Interface kernels can be used to provide any general flux condition at an interface, and even more generally can be used to impose any interfacial condition that requires access to values of different variables and gradients of different variables on either side of an interface. In an input file, the user will specify at a minimum the following parameters:</p><ul class="browser-default"><li><p><code>type</code>: The type of interface kernel to be used </p></li><li><p><code>variable</code>: This is the &quot;primary&quot; variable. Note that the primary variable must exist on the same subdomain as the sideset specified in the <code>boundary</code> parameter. The existence of a &quot;primary&quot; and &quot;secondary&quot; or &quot;neighbor&quot; variable ensures that the interface kernel residual and jacobian functions get called the correct number of times. <code>variable</code> could be <span tex="c_0" bookmark="moose-equation-3e51027b-9a27-472b-b1a7-dbcae05071b7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3e51027b-9a27-472b-b1a7-dbcae05071b7"><script>var element = document.getElementById("moose-equation-3e51027b-9a27-472b-b1a7-dbcae05071b7");katex.render("c_0", element, {displayMode:false,throwOnError:false});</script></span> from our example above. </p></li><li><p><code>neighbor_var</code>: The &quot;secondary&quot; variable. This could be <span tex="c_1" bookmark="moose-equation-0bf134ab-df90-4806-a5da-f2dacb46ed27" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0bf134ab-df90-4806-a5da-f2dacb46ed27"><script>var element = document.getElementById("moose-equation-0bf134ab-df90-4806-a5da-f2dacb46ed27");katex.render("c_1", element, {displayMode:false,throwOnError:false});</script></span> from our example above. </p></li><li><p><code>boundary</code>: The interfacial boundary between the subdomains. Note that this must be a sideset and again must exist on the same subdomain as the primary variable. The fact that this boundary is a sideset allows access to variable gradients.</p></li></ul><p>For additional information about the interface kernel system, don&#x27;t hesitate to email the moose list at <a href="mailto:moose-users@googlegroups.com">moose-users@googlegroups.com</a>.</p><section class="scrollspy" id="19a2d5fd-1784-4bfa-9df1-24a7bbd5fc21" data-section-level="2" data-section-text="Available Objects"><h2 id="available-objects">Available Objects</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/interfacekernels/InterfaceReaction.html">InterfaceReaction</a>Implements a reaction to establish ReactionRate=k_f*u-k_b*v at interface.</li></ul></section><section class="scrollspy" id="46016255-2d12-4046-91b3-630a70707352" data-section-level="2" data-section-text="Available Actions"><h2 id="available-actions">Available Actions</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/actions/AddInterfaceKernelAction.html">AddInterfaceKernelAction</a></li></ul></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#19a2d5fd-1784-4bfa-9df1-24a7bbd5fc21" class="tooltipped" data-position="left" data-tooltip="Available Objects">Available Objects</a></li><li><a href="#46016255-2d12-4046-91b3-630a70707352" class="tooltipped" data-position="left" data-tooltip="Available Actions">Available Actions</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>